<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebApplication" prefix="og: http://ogp.me/ns#">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2DNQFXSR6S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2DNQFXSR6S');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Theology Cosmos">
<meta name="application-name" content="Systematic Theology Cosmos">

<!-- ═══ SEO — PRIMARY META ═══ -->
<title>Systematic Theology — Interactive 3D Theological Cosmos | 269 Reformed Doctrines</title>
<meta name="description" content="The first interactive 3D theological cosmos. Explore 269 Reformed doctrines across 13 loci of systematic theology — from Prolegomena to Eschatology — with constellation navigation, 24 guided study paths, Scripture and confessional cross-references, and spaced-repetition progress tracking. A world-class study tool for seminarians, pastors, and theology students.">
<meta name="keywords" content="systematic theology, Reformed theology, interactive theology, 3D theology, theological education, Westminster Confession, Reformed doctrines, Christology, soteriology, ecclesiology, eschatology, prolegomena, pneumatology, hamartiology, anthropology, covenant theology, study tool, seminary, theological cosmos, Reformed confessions, catechism, doctrine map, theology visualization, visual theology, WCF, Three Forms of Unity, Calvin, Bavinck, Turretin, Hodge, Vos, Warfield, Owen, Berkhof">
<meta name="author" content="Visual Seminary">
<meta name="publisher" content="Visual Seminary">
<meta name="copyright" content="© 2026 Visual Seminary. All rights reserved.">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="googlebot" content="index, follow">
<meta name="bingbot" content="index, follow">
<meta name="rating" content="General">
<meta name="theme-color" content="#000000">
<meta name="theme-color" content="#0b0b16" media="(prefers-color-scheme: dark)">
<meta name="color-scheme" content="dark">
<!-- Content classification for academic/library indexers -->
<meta name="subject" content="Systematic Theology, Reformed Theology, Christian Doctrine">
<meta name="topic" content="Theology">
<meta name="classification" content="Education/Theology">
<meta name="category" content="Education">
<meta name="coverage" content="Worldwide">
<meta name="distribution" content="Global">
<meta name="language" content="en">
<meta http-equiv="content-language" content="en-US">
<meta name="revisit-after" content="7 days">
<meta name="format-detection" content="telephone=no">

<!-- ═══ SEO — CANONICAL & LINK RELATIONS ═══ -->
<!-- IMPORTANT: Replace these placeholder URLs with your actual domain before deploy -->
<link rel="canonical" href="https://cosmos.visualseminary.com/">
<link rel="author" href="https://visualseminary.com/about">
<link rel="license" href="https://visualseminary.com/terms">
<link rel="me" href="https://visualseminary.com">

<!-- ═══ SEO — OPEN GRAPH (Facebook, LinkedIn, Discord, iMessage) ═══ -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="Visual Seminary">
<meta property="og:title" content="Systematic Theology — Interactive 3D Theological Cosmos">
<meta property="og:description" content="Explore 269 Reformed doctrines in an interactive 3D constellation. 24 guided study paths from Prolegomena to Eschatology, with Scripture cross-references and spaced-repetition tracking.">
<meta property="og:url" content="https://cosmos.visualseminary.com/">
<meta property="og:locale" content="en_US">
<!-- IMPORTANT: Replace with actual hosted image (1200×630px recommended) -->
<meta property="og:image" content="https://cosmos.visualseminary.com/og-card.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:type" content="image/jpeg">
<meta property="og:image:alt" content="Interactive 3D constellation map of 269 systematic theology doctrines glowing gold on a dark cosmic background">
<!-- Article tags for topic classification -->
<meta property="article:author" content="Visual Seminary">
<meta property="article:section" content="Theology">
<meta property="article:tag" content="Systematic Theology">
<meta property="article:tag" content="Reformed Theology">
<meta property="article:tag" content="Christian Doctrine">
<meta property="article:tag" content="Westminster Confession">
<meta property="article:tag" content="Covenant Theology">
<meta property="article:tag" content="Seminary Education">
<meta property="article:tag" content="Interactive Learning">
<meta property="article:tag" content="3D Visualization">

<!-- ═══ SEO — TWITTER/X CARD ═══ -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Systematic Theology — Interactive 3D Theological Cosmos">
<meta name="twitter:description" content="269 Reformed doctrines. 24 study paths. One interactive 3D cosmos. The most beautiful way to study systematic theology.">
<!-- IMPORTANT: Replace with actual Twitter handle and hosted image -->
<meta name="twitter:site" content="@VisualSeminary">
<meta name="twitter:creator" content="@VisualSeminary">
<meta name="twitter:image" content="https://cosmos.visualseminary.com/twitter-card.jpg">
<meta name="twitter:image:alt" content="Interactive 3D constellation map of systematic theology doctrines">

<!-- ═══ SEO — DUBLIN CORE (Academic/Library Indexers: JSTOR, WorldCat, Google Scholar) ═══ -->
<meta name="DC.title" content="Systematic Theology: Interactive Theological Cosmos">
<meta name="DC.creator" content="Visual Seminary">
<meta name="DC.subject" content="Systematic theology; Reformed theology; Christian doctrine; Theological education; Interactive learning">
<meta name="DC.description" content="An interactive 3D visualization tool for systematic theology, mapping 269 Reformed doctrines across 13 theological loci with 24 guided study paths, Scripture and confessional cross-references.">
<meta name="DC.publisher" content="Visual Seminary">
<meta name="DC.type" content="InteractiveResource">
<meta name="DC.format" content="text/html">
<meta name="DC.language" content="en">
<meta name="DC.rights" content="© 2026 Visual Seminary. All rights reserved.">
<meta name="DC.date" content="2026">
<meta name="DC.identifier" content="https://cosmos.visualseminary.com/">
<meta name="DC.coverage" content="Historical and contemporary Reformed systematic theology">
<meta name="DC.relation" content="Westminster Confession of Faith; Three Forms of Unity; Second London Baptist Confession">
<meta name="DCTERMS.audience" content="Seminarians, pastors, theology students, Reformed Christians, biblical scholars">
<meta name="DCTERMS.educationLevel" content="Higher Education, Professional Development, Seminary">
<meta name="DCTERMS.instructionalMethod" content="Interactive 3D visualization, guided study paths, spaced repetition">

<!-- ═══ SEO — SCHEMA.ORG STRUCTURED DATA (JSON-LD) ═══ -->
<!-- 
 Seven interlocking schemas provide maximum search engine coverage:
 1. WebApplication — app store and software rich results
 2. Course — educational rich results and Google for Education
 3. Organization — knowledge panel and entity recognition
 4. ItemList — study paths as rich list snippets
 5. FAQPage — People Also Ask / featured snippet eligibility
 6. BreadcrumbList — navigation structure
 7. WebSite + SearchAction — sitelinks search box in SERPs
-->
<script type="application/ld+json">
[
 {
 "@context": "https://schema.org",
 "@type": "WebApplication",
 "@id": "https://cosmos.visualseminary.com/#app",
 "name": "Systematic Theology — Interactive Theological Cosmos",
 "alternateName": ["Theology Cosmos", "Visual Seminary Cosmos", "Systematic Theology Cosmos"],
 "url": "https://cosmos.visualseminary.com/",
 "description": "The first interactive 3D theological cosmos. Explore 269 Reformed doctrines across 13 loci of systematic theology with constellation navigation, 24 guided study paths, and spaced-repetition progress tracking.",
 "applicationCategory": "EducationalApplication",
 "applicationSubCategory": "Theology Study Tool",
 "operatingSystem": "Any (Web-based)",
 "browserRequirements": "Requires JavaScript and WebGL. Works in Chrome, Firefox, Safari, Edge.",
 "softwareVersion": "4.0",
 "releaseNotes": "Interactive 3D constellation graph, 24 guided study paths, meditative flythrough mode, spaced-repetition learning states, first-time user experience tour.",
 "offers": {
 "@type": "Offer",
 "price": "0",
 "priceCurrency": "USD"
 },
 "author": { "@id": "https://visualseminary.com/#org" },
 "publisher": { "@id": "https://visualseminary.com/#org" },
 "inLanguage": "en",
 "isAccessibleForFree": true,
 "audience": {
 "@type": "EducationalAudience",
 "educationalRole": ["student", "teacher", "researcher"],
 "audienceType": "Seminarians, pastors, theology students, Reformed Christians"
 },
 "about": [
 { "@type": "Thing", "name": "Systematic Theology" },
 { "@type": "Thing", "name": "Reformed Theology" },
 { "@type": "Thing", "name": "Christian Doctrine" },
 { "@type": "Thing", "name": "Westminster Confession of Faith" },
 { "@type": "Thing", "name": "Covenant Theology" }
 ],
 "featureList": [
 "Interactive 3D constellation visualization of 269 doctrines",
 "24 guided study paths from foundations to advanced topics",
 "Scripture and confessional cross-references for every doctrine",
 "Spaced-repetition progress tracking with learning states",
 "Meditative flythrough mode across theological loci",
 "Adaptive rendering for mobile, tablet, and desktop",
 "Category filtering across 13 theological loci",
 "Full-text search across doctrines, Scripture, and keywords",
 "Keyboard navigation and screen reader accessibility"
 ],
 "screenshot": "https://cosmos.visualseminary.com/og-card.jpg"
 },

 {
 "@context": "https://schema.org",
 "@type": "Course",
 "@id": "https://cosmos.visualseminary.com/#course",
 "name": "Systematic Theology: Interactive Theological Cosmos",
 "description": "A comprehensive interactive exploration of Reformed systematic theology covering 269 doctrines across 13 loci — from the knowledge of God and Scripture through Christology, soteriology, ecclesiology, and eschatology. Includes 24 guided study paths with confessional and Scriptural cross-references.",
 "url": "https://cosmos.visualseminary.com/",
 "provider": { "@id": "https://visualseminary.com/#org" },
 "inLanguage": "en",
 "isAccessibleForFree": true,
 "numberOfCredits": 0,
 "educationalLevel": "Advanced",
 "teaches": [
 "The being and attributes of God",
 "The Holy Trinity and eternal relations",
 "Covenant theology and the pactum salutis",
 "Christology: the person and work of Christ",
 "Soteriology: the order of salvation",
 "Ecclesiology, sacraments, and worship",
 "Eschatology and the new creation",
 "Reformed polemics and apologetics",
 "The Christian life, prayer, and piety"
 ],
 "hasCourseInstance": {
 "@type": "CourseInstance",
 "courseMode": "online",
 "courseWorkload": "Self-paced, approximately 40-100 hours for comprehensive coverage"
 },
 "about": [
 { "@type": "Thing", "name": "Systematic Theology", "sameAs": "https://en.wikipedia.org/wiki/Systematic_theology" },
 { "@type": "Thing", "name": "Reformed Theology", "sameAs": "https://en.wikipedia.org/wiki/Reformed_theology" },
 { "@type": "Thing", "name": "Westminster Confession of Faith", "sameAs": "https://en.wikipedia.org/wiki/Westminster_Confession_of_Faith" },
 { "@type": "Thing", "name": "Covenant Theology", "sameAs": "https://en.wikipedia.org/wiki/Covenant_theology" }
 ]
 },

 {
 "@context": "https://schema.org",
 "@type": "Organization",
 "@id": "https://visualseminary.com/#org",
 "name": "Visual Seminary",
 "url": "https://visualseminary.com",
 "description": "Creating world-class interactive tools for theological education.",
 "sameAs": [
 "https://twitter.com/VisualSeminary"
 ]
 },

 {
 "@context": "https://schema.org",
 "@type": "ItemList",
 "name": "Guided Study Paths in Systematic Theology",
 "description": "24 curated study sequences walking through systematic theology step by step, from foundations to advanced topics.",
 "numberOfItems": 24,
 "itemListElement": [
 { "@type": "ListItem", "position": 1, "name": "The Knowledge of God", "description": "From theological foundations through revelation to Scripture" },
 { "@type": "ListItem", "position": 2, "name": "The Triune God", "description": "The being and persons of the one true God" },
 { "@type": "ListItem", "position": 3, "name": "The Divine Perfections", "description": "The attributes of the one true God in their fullness" },
 { "@type": "ListItem", "position": 4, "name": "The Holy Trinity", "description": "The eternal triune life of Father, Son, and Holy Spirit" },
 { "@type": "ListItem", "position": 5, "name": "From Decree to Redemption", "description": "The eternal plan unfolding in covenant and history" },
 { "@type": "ListItem", "position": 6, "name": "The Covenant of Redemption", "description": "The eternal intra-Trinitarian covenant grounding all of salvation" },
 { "@type": "ListItem", "position": 7, "name": "Covenant Theology", "description": "The covenantal architecture of all redemption" },
 { "@type": "ListItem", "position": 8, "name": "The Christological Center", "description": "The person and work of Christ as Mediator" },
 { "@type": "ListItem", "position": 9, "name": "The Order of Salvation", "description": "Union with Christ as the controlling soteriological reality" },
 { "@type": "ListItem", "position": 10, "name": "The Holy Spirit", "description": "The Person and work of the Spirit across all theology" },
 { "@type": "ListItem", "position": 11, "name": "The Human Will in Four States", "description": "From innocence through fall to grace and glory" },
 { "@type": "ListItem", "position": 12, "name": "Law, Liberty & Life", "description": "From moral law to Christian freedom and good works" },
 { "@type": "ListItem", "position": 13, "name": "Christian Liberty & the Lordship of Conscience", "description": "God alone is Lord of the conscience" },
 { "@type": "ListItem", "position": 14, "name": "The Church & Her Ordinances", "description": "Ecclesiology from marks to means of grace and mission" },
 { "@type": "ListItem", "position": 15, "name": "The Sacraments in Full", "description": "From definition through baptism to the table" },
 { "@type": "ListItem", "position": 16, "name": "Church, State & Society", "description": "Civil authority, marriage, oaths, and public order" },
 { "@type": "ListItem", "position": 17, "name": "The Church's Mission to the Nations", "description": "The Great Commission, election and evangelism" },
 { "@type": "ListItem", "position": 18, "name": "The Life of Piety", "description": "Prayer, worship, suffering, lament, catechesis, and formation" },
 { "@type": "ListItem", "position": 19, "name": "The Old Testament's Theological Voice", "description": "The OT as a theological voice: Psalter, wisdom, temple, prophets" },
 { "@type": "ListItem", "position": 20, "name": "Creation to New Creation", "description": "The full arc of redemptive history from creation through consummation" },
 { "@type": "ListItem", "position": 21, "name": "From Garden to Glory", "description": "The protology-eschatology axis tracing Eden to Eden glorified" },
 { "@type": "ListItem", "position": 22, "name": "The Last Things", "description": "From death through the millennium to the new creation" },
 { "@type": "ListItem", "position": 23, "name": "Defending the Faith: Reformed Polemics", "description": "Against Rome, Socinianism, Arminianism, and modern errors" },
 { "@type": "ListItem", "position": 24, "name": "Against Modern Errors", "description": "The Reformed response to liberalism, criticism, naturalism, and contemporary departures" }
 ]
 },

 {
 "@context": "https://schema.org",
 "@type": "FAQPage",
 "mainEntity": [
 {
 "@type": "Question",
 "name": "What is systematic theology?",
 "acceptedAnswer": {
 "@type": "Answer",
 "text": "Systematic theology is the disciplined effort to state what the whole Bible teaches about any given topic, organized by doctrinal loci (topics) such as the doctrine of God, Christ, salvation, the church, and the last things. It draws on biblical theology, historical theology, and philosophical theology to present a coherent whole. This interactive cosmos maps 269 Reformed doctrines across 13 such loci."
 }
 },
 {
 "@type": "Question",
 "name": "What is the Westminster Confession of Faith?",
 "acceptedAnswer": {
 "@type": "Answer",
 "text": "The Westminster Confession of Faith (WCF) is the principal confessional standard of the Reformed and Presbyterian tradition, produced by the Westminster Assembly in London (1643–1649). It addresses every major locus of Christian doctrine from Scripture and God through salvation, the church, and the last things. The Systematic Theology Cosmos cross-references the WCF extensively throughout its 269 doctrine entries."
 }
 },
 {
 "@type": "Question",
 "name": "What is covenant theology?",
 "acceptedAnswer": {
 "@type": "Answer",
 "text": "Covenant theology is the architectonic framework of Reformed theology, understanding God's relationship with humanity through a series of covenants: the covenant of redemption (pactum salutis) among the persons of the Trinity, the covenant of works with Adam, and the covenant of grace in Christ. The Systematic Theology Cosmos includes a dedicated Covenant Theology study path tracing this structure."
 }
 },
 {
 "@type": "Question",
 "name": "How many doctrines are in the Systematic Theology Cosmos?",
 "acceptedAnswer": {
 "@type": "Answer",
 "text": "The Systematic Theology Cosmos contains 269 doctrines organized across 38 major loci and 231 sub-topics, spanning 13 theological categories: Prolegomena & Scripture, Theology Proper, Christology, Pneumatology, Soteriology, Anthropology & Creation, Hamartiology, Ecclesiology & Sacraments, Eschatology, Law & Ethics, Piety & the Christian Life, Biblical Theology, and Reformed Polemics."
 }
 },
 {
 "@type": "Question",
 "name": "What study paths are available?",
 "acceptedAnswer": {
 "@type": "Answer",
 "text": "There are 24 guided study paths ranging from 'The Knowledge of God' (theological foundations) through 'The Triune God,' 'Covenant Theology,' 'The Christological Center,' 'The Order of Salvation,' 'The Holy Spirit,' 'The Church & Her Ordinances,' 'The Life of Piety,' 'Creation to New Creation,' and 'Defending the Faith: Reformed Polemics.' Each path walks through theology step by step with Scripture and confessional cross-references."
 }
 }
 ]
 },

 {
 "@context": "https://schema.org",
 "@type": "BreadcrumbList",
 "itemListElement": [
 { "@type": "ListItem", "position": 1, "name": "Visual Seminary", "item": "https://visualseminary.com/" },
 { "@type": "ListItem", "position": 2, "name": "Systematic Theology Cosmos", "item": "https://cosmos.visualseminary.com/" }
 ]
 },

 {
 "@context": "https://schema.org",
 "@type": "WebSite",
 "@id": "https://cosmos.visualseminary.com/#website",
 "url": "https://cosmos.visualseminary.com/",
 "name": "Systematic Theology Cosmos",
 "publisher": { "@id": "https://visualseminary.com/#org" },
 "potentialAction": {
 "@type": "SearchAction",
 "target": {
 "@type": "EntryPoint",
 "urlTemplate": "https://cosmos.visualseminary.com/?q={search_term_string}"
 },
 "query-input": "required name=search_term_string"
 }
 }
]
</script>

<!-- ═══ ASSET LOADING ═══ -->
<!-- Favicons (IMPORTANT: replace placeholder files before deploy) -->
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✦</text></svg>">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#dcc15a">
<meta name="msapplication-TileColor" content="#000000">
<!-- ═══ RESILIENT ASSET LOADING ═══ -->
<!-- Google Fonts with onerror detection -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- P1 #9: DNS prefetch for CDN fallback -->
<link rel="dns-prefetch" href="https://unpkg.com">
<link id="google-fonts-link"
 href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;1,300;1,400&family=Cormorant:ital,wght@0,300;0,400;1,300;1,400&display=swap"
 rel="stylesheet"
 onerror="window.__fontsLoaded=false">

<!-- ── Three.js r170 - ES Module Import Map ── -->
<!-- Pinned to 0.170.0 for stability. r170 includes WebGPU groundwork, -->
<!-- improved shader compilation, better memory management, and -->
<!-- significant performance fixes over r128. -->
<script type="importmap">
{
 "imports": {
 "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.min.js"
 }
}
</script>

<script>
// ═══════════════════════════════════════════
// PRODUCTION LOGGING — Debug flag controls visibility
// Enable via: URL param ?debug=1, or localStorage stc_debug=1
// In production, only errors surface. Logs and warns are silent.
// ═══════════════════════════════════════════
window.Log = (function() {
 var DEBUG = false;
 try {
 DEBUG = (new URLSearchParams(window.location.search)).get('debug') === '1'
 || localStorage.getItem('stc_debug') === '1';
 } catch(e) {}
 var noop = function() {};
 return {
 debug: DEBUG,
 log: DEBUG ? console.log.bind(console) : noop,
 warn: DEBUG ? console.warn.bind(console) : noop,
 // Errors always surface — they indicate real failures users may report
 error: console.error.bind(console)
 };
})();
</script>

<script>
// ── Global asset availability flags ──
// null = pending, true = loaded, false = failed
// IMPORTANT: must be null (not false) so boot() waits for the ES module to resolve
window.__threeAvailable = null;
window.__fontsLoaded = null;
</script>

<!-- ── Three.js ES Module Loader with Fallback ── -->
<!-- r150+ removed the UMD build; we import the ES module and expose -->
<!-- window.THREE to keep the rest of the codebase unchanged. -->
<script type="module">
 const CDN_SOURCES = [
 'https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.min.js',
 'https://unpkg.com/three@0.170.0/build/three.module.min.js'
 ];

 async function loadThree() {
 for (const src of CDN_SOURCES) {
 try {
 const THREE = await import(src);
 window.THREE = THREE;
 window.__threeAvailable = true;
 Log.log('[CDN] Three.js r170 loaded successfully from: ' + src);
 document.dispatchEvent(new Event('three-load-success'));
 return;
 } catch (err) {
 Log.warn('[CDN Fallback] Failed to load Three.js from: ' + src, err);
 }
 }
 Log.error('[CDN Fallback] All Three.js CDN sources failed.');
 window.__threeAvailable = false;
 document.dispatchEvent(new Event('three-load-failed'));
 }

 loadThree();
</script>

<script>
(function() {
 // ── Google Fonts detection via Font Loading API with timeout ──
 var FONT_TIMEOUT_MS = 5000;
 if (document.fonts && document.fonts.ready) {
 var fontsTimer = setTimeout(function() {
 if (window.__fontsLoaded === null) {
 window.__fontsLoaded = false;
 Log.warn('[Fonts] Google Fonts timed out after ' + FONT_TIMEOUT_MS + 'ms. Using system fallbacks.');
 document.dispatchEvent(new Event('fonts-load-failed'));
 }
 }, FONT_TIMEOUT_MS);

 document.fonts.ready.then(function() {
 return document.fonts.load('400 16px "Cinzel"');
 }).then(function(faces) {
 clearTimeout(fontsTimer);
 if (faces && faces.length > 0) {
 window.__fontsLoaded = true;
 } else if (window.__fontsLoaded === null) {
 window.__fontsLoaded = false;
 document.dispatchEvent(new Event('fonts-load-failed'));
 }
 }).catch(function() {
 clearTimeout(fontsTimer);
 if (window.__fontsLoaded === null) {
 window.__fontsLoaded = false;
 document.dispatchEvent(new Event('fonts-load-failed'));
 }
 });
 }
})();
</script>
<style>
/* ═══════════════════════════════════════════════════════════
 SYSTEMATIC THEOLOGY 4.0 - INTERACTIVE THEOLOGICAL COSMOS
 A world-class theological study tool with constellation
 graph navigation. Clean architecture, responsive, accessible.
 ═══════════════════════════════════════════════════════════ */

/* ── Design Tokens ── */
:root {
 /* P2 #12: Declare dark color scheme for native form controls */
 color-scheme: dark;

 /* Backgrounds - deeper, richer darks with subtle warmth */
 --bg-primary: #000000;
 --bg-secondary: #07070f;
 --bg-tertiary: #0b0b16;
 --bg-surface: #10101c;
 --bg-elevated: #141428;
 --bg-hover: rgba(224,192,80,0.025);
 --bg-active: rgba(224,192,80,0.045);

 /* Borders - warmer, more refined */
 --border-subtle: rgba(224,192,80,0.05);
 --border-default: rgba(224,192,80,0.09);
 --border-strong: rgba(224,192,80,0.16);

 /* Text - warmer parchment tones */
 --text-primary: #ece8da;
 --text-secondary: #d0cbc0;
 --text-tertiary: #9e9a90;
 --text-muted: #8b8679;

 /* Accent - Refined Gold (richer, more luminous) */
 --gold: #dcc15a;
 --gold-dim: #b89b3e;
 --gold-glow: rgba(220,193,90,0.13);
 --gold-surface: rgba(220,193,90,0.06);
 --gold-bright: #f0d96c;
 --gold-deep: #9a7e2e;

 /* Category Colors - refined, more jewel-toned */
 --cat-theology: #e0c860;
 --cat-christology: #d9a055;
 --cat-anthropology: #5eb868;
 --cat-ecclesiology: #b888d8;
 --cat-eschatology: #50b8b8;
 --cat-prolegomena: #6da8d8;
 --cat-hamartiology: #d86868;
 --cat-pneumatology: #90d0b8;
 --cat-soteriology: #d0886c;
 --cat-ethics: #c0ac60;
 --cat-polemics: #c46050;
 --cat-piety: #d4a874;
 --cat-biblical_theology: #7db88a;

 /* Typography */
 --font-display: 'Cinzel', Georgia, serif;
 --font-heading: 'Cormorant Garamond', Georgia, serif;
 --font-body: 'EB Garamond', Georgia, serif;
 --font-ui: 'Spectral', Georgia, serif;
 --font-accent: 'Cormorant', Georgia, serif;

 /* Spacing */
 --space-xs: 4px;
 --space-sm: 8px;
 --space-md: 16px;
 --space-lg: 24px;
 --space-xl: 32px;
 --space-2xl: 48px;

 /* Transitions */
 --ease-out: cubic-bezier(0, 0, 0.2, 1);
 --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
 --duration-fast: 150ms;
 --duration-normal: 300ms;
 --duration-slow: 500ms;

 /* Layout */
 --panel-width: 520px;
 --topbar-height: 56px;
 --search-width: 380px;

 /* ── NEW: Mobile viewport height fix ── */
 /* dvh = dynamic viewport height (respects browser chrome) */
 --vh-full: 100dvh;
 --vh-full-fallback: 100vh;

 /* ── NEW: Safe area insets for notched devices ── */
 --safe-top: env(safe-area-inset-top, 0px);
 --safe-bottom: env(safe-area-inset-bottom, 0px);
 --safe-left: env(safe-area-inset-left, 0px);
 --safe-right: env(safe-area-inset-right, 0px);

 /* ── NEW: Touch target minimum (WCAG 2.5.8) ── */
 --touch-min: 44px;
}

/* ═══ APPLE-QUALITY MICRO-INTERACTIONS ═══
 Principles: physical, responsive, felt-not-seen.
 Every tap gives instant feedback. Hovers breathe life.
 Spring curves make everything feel tangible. */

/* ── Universal Interactive Foundation ──
 All clickable elements get hardware-accelerated transforms
 and a refined spring-out on release */
.enter-btn,
.control-btn,
.bottom-btn,
.flythrough-btn,
.ftue-next,
.ftue-skip,
.panel-close-btn,
.panel-study-toggle,
.panel-read-more,
.panel-tab,
.path-nav-btn,
.path-close-btn,
.banner-dismiss,
.progress-badge,
.scripture-tag,
.confessional-tag,
.keyword-tag,
.legend-item,
.picker-item,
.path-item,
.connection-item,
.search-result-item,
.study-card,
#breadcrumb span:not(.sep) {
 -webkit-tap-highlight-color: transparent;
 /* P1 #5: Removed blanket will-change + translateZ(0) to prevent
 layer explosion on low-memory mobile devices. GPU compositing
 is promoted only during active :hover/:active states via
 the transform rules below. */
}

/* ── Button Press: Tactile Scale ──
 Apple's signature: quick press-in, spring-out on release.
 120ms in, 400ms spring out : feels like touching glass */
.enter-btn:active {
 transform: scale(0.965) !important;
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1) !important;
}
.control-btn:active,
.bottom-btn:active,
.flythrough-btn:active,
.path-nav-btn:active,
.path-close-btn:active,
.banner-dismiss:active {
 transform: scale(0.94);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}
/* Spring release for all buttons */
.control-btn,
.bottom-btn,
.flythrough-btn,
.path-nav-btn,
.path-close-btn,
.banner-dismiss {
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ── Progress Badge: Haptic Press ── */
.progress-badge:active {
 transform: scale(0.93);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── FTUE Buttons: Confident Press ── */
.ftue-next:active {
 transform: scale(0.95) !important;
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1) !important;
}
.ftue-skip:active {
 transform: scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Panel Close: Subtle Rotation on Hover ── */
.panel-close-btn {
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.panel-close-btn:hover {
 transform: rotate(90deg);
}
.panel-close-btn:active {
 transform: rotate(90deg) scale(0.88);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Panel Tabs: Smooth Underline Slide ──
 Active tab gets a sliding underline via pseudo-element */
.panel-tab {
 position: relative;
 transition: all 0.4s var(--ease-out), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.panel-tab:active {
 transform: scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Tags: Micro-lift + Glow ──
 Scripture and keyword tags feel like pressable chips */
.scripture-tag,
.confessional-tag,
.keyword-tag {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.scripture-tag:hover,
.confessional-tag:hover,
.keyword-tag:hover {
 transform: translateY(-1px);
}
.scripture-tag:active,
.confessional-tag:active,
.keyword-tag:active {
 transform: translateY(0) scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Cards: Lift on Hover, Settle on Press ──
 Study cards and picker items feel like physical cards */
.study-card {
 transition: all 0.45s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.study-card:active {
 transform: translateY(0) scale(0.98) !important;
 box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1);
}

.picker-item {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.picker-item:hover {
 transform: translateX(2px);
}
.picker-item:active {
 transform: translateX(2px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Connection Items: Slide + Press ── */
.connection-item {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.connection-item:active {
 transform: translateX(3px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Path Items: Press Feedback ── */
.path-item {
 transition: background 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.path-item:hover {
 transform: translateX(2px);
}
.path-item:active {
 transform: translateX(2px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Search Results: Subtle Highlight ── */
.search-result-item {
 transition: background 0.25s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.search-result-item:active {
 transform: scale(0.985);
 background: rgba(220,193,90,0.04);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Legend Items: Dot Pulse on Press ── */
.legend-item {
 transition:
 transform 0.5s cubic-bezier(0.23, 1.1, 0.32, 1),
 opacity 0.3s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:active {
 transform: translateX(6px) scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}
.legend-item:active .legend-dot {
 transform: scale(1.8);
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Breadcrumb: Color + Lift ── */
#breadcrumb span:not(.sep) {
 transition: color var(--duration-fast), transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}
#breadcrumb span:not(.sep):active {
 transform: scale(0.93);
 transition: transform 80ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Read More: Elegant Arrow Shift ── */
.panel-read-more {
 transition: color var(--duration-fast), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), letter-spacing 0.4s var(--ease-out);
}
.panel-read-more:hover {
 letter-spacing: 0.1em;
}
.panel-read-more:active {
 transform: scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Enter Button: Enhanced Spring ──
 The most important CTA : give it extra presence */
.enter-btn {
 transition: all 0.5s var(--ease-out), transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ── Reset ── */
*, *:before, *:after { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
 width: 100%; height: 100%;
 height: var(--vh-full, var(--vh-full-fallback));
 overflow: hidden;
 background: var(--bg-primary); color: var(--text-primary);
 font-family: var(--font-body);
 font-size: 16px;
 line-height: 1.6;
 -webkit-font-smoothing: antialiased;
 -moz-osx-font-smoothing: grayscale;
 /* ── Prevent pull-to-refresh and overscroll bounce ── */
 overscroll-behavior: none;
 /* P1 #7: Removed deprecated -webkit-overflow-scrolling: touch
 (momentum scrolling is default since iOS 13) */
 /* ── Prevent accidental text selection during 3D interaction ── */
 -webkit-touch-callout: none;
}

/* ── Reduced Motion: disable all animations for vestibular sensitivity ── */
@media (prefers-reduced-motion: reduce) {
 *, *:before, *:after {
 animation-duration: 0.01ms !important;
 animation-iteration-count: 1 !important;
 transition-duration: 0.01ms !important;
 scroll-behavior: auto !important;
 }
}

/* ── Scrollbar ── */
::-webkit-scrollbar { width: 3px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(220,193,90,0.08); border-radius: 2px; }
::-webkit-scrollbar-thumb:hover { background: rgba(220,193,90,0.15); }
::selection { background: rgba(220,193,90,0.15); color: var(--text-primary); }

/* ═══ LOADING SCREEN ═══ */
#loading-screen {
 position: fixed; inset: 0; z-index: 10000;
 background: var(--bg-primary);
 display: flex; flex-direction: column; align-items: center; justify-content: center;
 transition: opacity 1.2s var(--ease-out), visibility 1.2s;
}
#loading-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
#loading-screen h1 {
 font-family: var(--font-display); font-weight: 400; font-size: 14px;
 letter-spacing: 0.6em; color: var(--gold-dim); margin-bottom: 8px;
 animation: breatheGlow 3s ease-in-out infinite;
}
/* Elegant ornamental divider below title */
#loading-screen h1:after {
 content: '';
 display: block;
 width: 48px; height: 1px;
 background: linear-gradient(90deg, transparent, var(--gold-dim), transparent);
 margin: 12px auto 0;
 opacity: 0.5;
}
@keyframes breatheGlow {
 0%, 100% { opacity: 0.5; text-shadow: 0 0 0 transparent; }
 50% { opacity: 1; text-shadow: 0 0 30px rgba(220,193,90,0.1); }
}
#loading-screen p {
 font-family: var(--font-accent), Georgia, serif; font-size: 11.5px; color: var(--text-muted);
 letter-spacing: 0.22em; font-style: italic; font-weight: 300;
}
#loading-step {
 margin-top: 16px; font-size: 10.5px; letter-spacing: 0.14em;
 color: var(--text-muted); opacity: 0.6;
 transition: opacity 0.3s var(--ease-out);
 font-family: var(--font-ui);
}
.loading-bar {
 width: 240px; height: 1px; background: rgba(220,193,90,0.08);
 margin-top: 28px; overflow: hidden; border-radius: 1px;
}
.loading-bar-fill {
 height: 100%; width: 0%;
 background: linear-gradient(90deg, var(--gold-dim), var(--gold), var(--gold-dim));
 background-size: 200% 100%;
 animation: barShimmer 1.5s ease-in-out infinite;
 transition: width 0.4s var(--ease-out);
}
@keyframes barShimmer {
 0% { background-position: 200% 0; }
 100% { background-position: -200% 0; }
}

/* ═══ ONBOARDING ═══ */
#onboarding-screen {
 position: fixed; inset: 0; z-index: 9998;
 background: #030308;
 display: flex; flex-direction: column; align-items: center; justify-content: center;
 transition: opacity 1.2s var(--ease-out), visibility 1.2s;
 padding: var(--space-lg);
}
/* Subtle radial vignette for depth */
#onboarding-screen:before {
 content: '';
 position: absolute; inset: 0;
 background: radial-gradient(ellipse 70% 60% at 50% 45%, rgba(220,193,90,0.015) 0%, transparent 60%);
 pointer-events: none;
}
#onboarding-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

.onboarding-content {
 max-width: 640px; text-align: center; position: relative;
}
.onboarding-content h1 {
 font-family: var(--font-display); font-weight: 400;
 font-size: clamp(18px, 3vw, 28px); letter-spacing: 0.55em;
 color: var(--gold); margin-bottom: 10px;
 animation: fadeUp 1s var(--ease-out) both;
}
/* Ornamental flourish beneath the title : removed */
.onboarding-content h2 {
 font-family: var(--font-accent), Georgia, serif; font-weight: 300;
 font-size: clamp(13px, 1.7vw, 17px); color: var(--text-tertiary);
 letter-spacing: 0.12em; margin-bottom: 10px; font-style: italic;
 animation: fadeUp 1s 0.15s var(--ease-out) both;
}
.ob-author {
 font-family: var(--font-heading); font-weight: 300; font-style: italic;
 font-size: clamp(11px, 1.1vw, 13px);
 color: rgba(184, 155, 62, 0.5);
 letter-spacing: 0.06em; margin-bottom: 50px;
 animation: fadeUp 1s 0.25s var(--ease-out) both;
}
.ob-row {
 display: flex; gap: 0; margin-bottom: 56px; flex-wrap: wrap;
 justify-content: center; animation: fadeUp 1s 0.35s var(--ease-out) both;
}
.ob-f {
 text-align: center; width: 140px; padding: 0 24px;
 border-right: 1px solid rgba(220,193,90,0.06);
}
.ob-f:last-child { border-right: none; }
.ob-lb {
 font-family: var(--font-ui); font-size: 11px; letter-spacing: 0.08em;
 text-transform: uppercase; color: var(--text-tertiary); line-height: 2;
}

.enter-btn {
 position: relative; overflow: hidden;
 padding: 14px 56px; background: transparent;
 border: 1px solid rgba(184,155,62,0.4); border-radius: 6px;
 font-family: var(--font-display); font-size: 10px;
 letter-spacing: 0.4em; text-transform: uppercase;
 color: var(--gold); cursor: pointer;
 transition: all 0.5s var(--ease-out), transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
 animation: fadeUp 1s 0.55s var(--ease-out) both;
}
.enter-btn:hover {
 background: rgba(220,193,90,0.05); border-color: var(--gold);
 box-shadow: 0 0 60px rgba(220,193,90,0.06), inset 0 0 30px rgba(220,193,90,0.03);
 letter-spacing: 0.5em;
}
.enter-btn:after {
 content: ''; position: absolute; inset: -1px; border-radius: 7px;
 background: transparent; pointer-events: none;
 animation: btnPulse 4s ease-in-out infinite;
}
@keyframes btnPulse {
 0%, 100% { box-shadow: 0 0 0 0 rgba(220,193,90,0); }
 50% { box-shadow: 0 0 30px 3px rgba(220,193,90,0.05); }
}

@keyframes fadeUp {
 from { opacity: 0; transform: translateY(16px); }
 to { opacity: 1; transform: none; }
}

/* ═══ MAIN LAYOUT ═══ */
#app {
 position: fixed; inset: 0; display: flex; flex-direction: column;
 /* ── Use dynamic viewport height for mobile browser chrome ── */
 height: var(--vh-full, var(--vh-full-fallback));
 /* ── Safe area padding for notched devices ── */
 padding-top: var(--safe-top);
 padding-left: var(--safe-left);
 padding-right: var(--safe-right);
}

/* ── Top Bar ── */
#topbar {
 position: relative; z-index: 100; height: var(--topbar-height);
 display: flex; align-items: center; justify-content: space-between;
 padding: 0 var(--space-lg);
 background: linear-gradient(180deg, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) 50%, rgba(0,0,0,0) 100%);
 pointer-events: none;
}
#topbar > * { pointer-events: auto; }

.brand {
 user-select: none; white-space: nowrap;
 display: flex; flex-direction: column; align-items: flex-end;
 gap: 0;
 cursor: default;
}
.brand-title {
 font-family: var(--font-display); font-weight: 400;
 font-size: 10.5px; letter-spacing: 0.5em; text-transform: uppercase;
 color: var(--gold-deep);
 opacity: 0.6;
 transition: opacity 0.4s cubic-bezier(0, 0, 0.2, 1),
 color 0.6s cubic-bezier(0, 0, 0.2, 1);
}
/* Hairline gradient rule : the hinge between classical and cosmic */
.brand-rule {
 width: 100%; height: 1px;
 background: linear-gradient(90deg, transparent 0%, var(--gold-deep) 35%, var(--gold-deep) 65%, transparent 100%);
 opacity: 0.12;
 margin: 5px 0 4px;
 transform: scaleX(0.6);
 transform-origin: right center;
 transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1),
 opacity 0.6s cubic-bezier(0, 0, 0.2, 1);
}
.brand-cosmos {
 font-family: var(--font-display); font-weight: 400;
 font-size: 10.5px; text-transform: uppercase;
 color: var(--gold-deep);
 letter-spacing: 0.82em;
 /* Compensate trailing letter-spacing so right edge aligns flush with title */
 padding-right: 0.82em;
 box-sizing: border-box;
 width: 100%;
 text-align: right;
 opacity: 0.45;
 transition: opacity 0.5s 0.06s cubic-bezier(0, 0, 0.2, 1),
 letter-spacing 0.7s cubic-bezier(0.23, 1, 0.32, 1),
 text-shadow 0.6s cubic-bezier(0, 0, 0.2, 1);
 text-shadow: 0 0 0 transparent;
}

/* ── Hover orchestration: light arrives in sequence ── */
.brand:hover .brand-title {
 opacity: 0.9;
 color: var(--gold-dim);
}
.brand:hover .brand-rule {
 transform: scaleX(1);
 opacity: 0.25;
}
.brand:hover .brand-cosmos {
 opacity: 0.55;
 letter-spacing: 0.85em;
 text-shadow: 0 0 20px rgba(220,193,90,0.08);
}

/* ── Search ── */
.search-container {
 position: relative; width: var(--search-width); max-width: 50vw;
}
.search-icon {
 position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
 color: var(--text-muted); width: 14px; height: 14px; pointer-events: none;
}
#search-input {
 width: 100%; padding: 8px 44px 8px 36px;
 background: rgba(220,193,90,0.02); border: 1px solid rgba(220,193,90,0.06);
 border-radius: 8px; color: var(--text-primary);
 font-family: var(--font-ui); font-size: 13px; outline: none;
 transition: all 0.4s var(--ease-out);
}
#search-input:focus {
 border-color: rgba(220,193,90,0.2); background: rgba(220,193,90,0.04);
 box-shadow: 0 0 0 3px rgba(220,193,90,0.05), 0 8px 32px rgba(0,0,0,0.3);
}
#search-input::placeholder { color: rgba(145,141,130,0.55); font-style: italic; }
.search-shortcut {
 position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
 font-family: var(--font-ui); font-size: 10px; color: var(--text-muted);
 padding: 2px 6px; border: 1px solid var(--border-subtle); border-radius: 3px;
 pointer-events: none;
}

/* Search Results Dropdown */
#search-results {
 position: absolute; top: calc(100% + 8px); left: 0; right: 0;
 background: rgba(11,11,22,0.96); border: 1px solid rgba(220,193,90,0.08);
 border-radius: 10px; max-height: 400px; overflow-y: auto;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
 /* P1 #8: background rgba(11,11,22,0.96) is near-opaque —
 readable without backdrop-filter on older browsers */
 display: none; z-index: 200;
}
#search-results.visible {
 display: block;
 animation: dropIn 0.2s var(--ease-out) both;
}
@keyframes dropIn {
 from { opacity: 0; transform: translateY(-6px); }
 to { opacity: 1; transform: none; }
}
.search-result-item {
 display: flex; align-items: flex-start; gap: 12px;
 padding: 12px 16px; cursor: pointer;
 border-bottom: 1px solid rgba(220,193,90,0.03);
 transition: background 0.25s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.search-result-item:last-child { border-bottom: none; }
.search-result-item:hover { background: rgba(220,193,90,0.025); }
.search-result-dot {
 width: 8px; height: 8px; border-radius: 50%;
 flex-shrink: 0; margin-top: 5px;
}
.search-result-info { flex: 1; min-width: 0; }
.search-result-name {
 font-family: var(--font-heading); font-size: 16px; color: var(--text-primary);
 margin-bottom: 2px;
}
.search-result-name mark {
 background: rgba(220,193,90,0.2); color: var(--gold); border-radius: 2px;
 padding: 0 2px;
}
.search-result-category {
 font-family: var(--font-ui); font-size: 10.5px; letter-spacing: 0.08em;
 text-transform: uppercase;
}
.search-result-snippet {
 font-family: var(--font-body); font-size: 13px; color: var(--text-tertiary);
 margin-top: 4px; line-height: 1.5;
 overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
}
.search-empty {
 padding: 24px; text-align: center;
 font-family: var(--font-ui); font-size: 13px; color: var(--text-muted);
}

/* ── Right Controls ── */
.topbar-controls {
 display: flex; align-items: center; gap: 8px;
}
.control-btn {
 padding: 6px 14px; background: rgba(220,193,90,0.015);
 border: 1px solid rgba(220,193,90,0.06); border-radius: 6px;
 font-family: var(--font-ui); font-size: 11px; letter-spacing: 0.06em;
 color: var(--text-tertiary); cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); user-select: none;
}
.control-btn:hover { border-color: rgba(220,193,90,0.15); color: var(--text-secondary); box-shadow: 0 0 20px rgba(220,193,90,0.03); }
.control-btn.active {
 background: var(--gold-surface); border-color: rgba(220,193,90,0.2); color: var(--gold);
}
.progress-badge {
 font-family: var(--font-ui); font-size: 10.5px;
 padding: 3px 10px; border-radius: 12px;
 background: rgba(220,193,90,0.04); color: var(--gold-dim);
 border: 1px solid rgba(220,193,90,0.08);
 cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
 user-select: none;
}
.progress-badge:hover {
 background: rgba(220,193,90,0.1); border-color: rgba(220,193,90,0.18);
 color: var(--gold);
 box-shadow: 0 0 24px rgba(220,193,90,0.05);
}

/* ═══ MAIN CONTENT AREA ═══ */
#main-content {
 flex: 1; display: flex; overflow: hidden; position: relative;
}

/* ── Graph Container ── */
#graph-container {
 flex: 1; position: relative; overflow: hidden;
 background: var(--bg-primary);
}

/* 3D Container */
#three-container {
 position: absolute; inset: 0; overflow: hidden;
 visibility: hidden;
 /* ── Prevent browser handling of touch gestures (we handle them) ── */
 touch-action: none;
 /* ── GPU layer isolation for independent compositing ── */
 contain: layout style paint;
 will-change: transform;
}
#three-container canvas {
 display: block; width: 100%; height: 100%; cursor: grab;
 touch-action: none;
}
#three-container canvas:active { cursor: grabbing; }

/* Graph Vignette */
#graph-vignette {
 position: absolute; inset: 0; pointer-events: none;
 background: 
 radial-gradient(ellipse 75% 70% at 50% 50%, transparent 35%, rgba(0,0,0,0.35) 100%),
 linear-gradient(180deg, rgba(0,0,0,0.15) 0%, transparent 12%, transparent 88%, rgba(0,0,0,0.2) 100%);
}

/* ── Legend ── */
#legend {
 position: absolute; left: 18px; top: 50%; transform: translateY(-50%);
 display: flex; flex-direction: column; gap: 5px; z-index: 10;
 visibility: hidden;
}
.legend-item {
 display: flex; align-items: center; gap: 8px;
 cursor: pointer; opacity: 0.6;
 padding: 3px 8px; border-radius: 4px;
 /* Spring curve on position, faster ease on opacity : staggered feels organic */
 transition:
 transform 0.5s cubic-bezier(0.23, 1.1, 0.32, 1),
 opacity 0.3s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover, .legend-item.active { opacity: 1; }
.legend-item:hover { transform: translateX(6px); }
.legend-dot {
 width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0;
 /* Dot responds slightly slower : trails behind the nudge */
 transition:
 transform 0.55s cubic-bezier(0.23, 1.1, 0.32, 1),
 box-shadow 0.6s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover .legend-dot {
 transform: scale(1.35);
 box-shadow: 0 0 6px currentColor, 0 0 12px rgba(255,255,255,0.04);
}
.legend-label {
 font-family: var(--font-ui); font-size: 10.5px;
 letter-spacing: 0.1em; text-transform: uppercase;
 color: var(--text-tertiary);
 white-space: nowrap;
 /* Label color warms up last : the finishing touch */
 transition: color 0.45s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover .legend-label { color: var(--text-secondary); }

/* ── Breadcrumb ── */
#breadcrumb {
 position: absolute; top: 8px; left: 16px;
 display: flex; gap: 4px; align-items: center; z-index: 10;
 font-family: var(--font-ui); font-size: 10px; color: var(--text-muted);
}
#breadcrumb span { cursor: pointer; transition: color var(--duration-fast); }
#breadcrumb span:hover { color: var(--gold); }
#breadcrumb .sep { color: var(--border-strong); cursor: default; }

/* ── Tooltip ── */
#tooltip {
 position: fixed; pointer-events: none; z-index: 500;
 padding: 12px 18px; background: rgba(14,14,28,0.94);
 border: 1px solid rgba(220,193,90,0.08); border-radius: 8px;
 opacity: 0; transition: opacity 100ms;
 box-shadow: 0 12px 40px rgba(0,0,0,0.5), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
 max-width: 280px;
}
#tooltip.visible { opacity: 1; }
.tooltip-name {
 font-family: var(--font-heading); font-size: 16px;
 color: var(--text-primary); margin-bottom: 3px;
}
.tooltip-category {
 font-family: var(--font-ui); font-size: 10px;
 letter-spacing: 0.08em; text-transform: uppercase;
}
.tooltip-studied {
 font-family: var(--font-ui); font-size: 10px;
 color: var(--gold-dim); margin-top: 4px;
 letter-spacing: 0.06em;
}
.tooltip-summary {
 font-family: var(--font-body); font-size: 12.5px;
 color: var(--text-tertiary); margin-top: 5px;
 line-height: 1.5;
 overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
}

/* ═══ FLYTHROUGH OVERLAY (Improvement #23) ═══ */
#flythrough-overlay {
 position: absolute; inset: 0; pointer-events: none; z-index: 25;
 display: none; flex-direction: column; justify-content: center; align-items: flex-end;
 padding: var(--space-xl);
 padding-right: calc(var(--space-xl) + var(--safe-right));
 background: none;
}
#flythrough-overlay.active { display: flex; }
.flythrough-text {
 max-width: 380px; width: 380px; opacity: 0;
 transition: opacity 0.8s var(--ease-out), transform 0.8s var(--ease-out);
 transform: translateX(12px);
 background: rgba(6,6,14,0.9);
 border: 1px solid rgba(220,193,90,0.06);
 border-radius: 12px;
 padding: 22px 24px;
 backdrop-filter: blur(20px) saturate(1.2); -webkit-backdrop-filter: blur(20px) saturate(1.2);
 box-shadow: 0 16px 48px rgba(0,0,0,0.5), 0 0 0 0.5px rgba(220,193,90,0.03);
 max-height: 70vh;
 overflow-y: auto;
 pointer-events: auto;
}
.flythrough-text.visible { opacity: 1; transform: none; }
.flythrough-locus-name {
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.12em;
 text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;
}
.flythrough-title {
 font-family: var(--font-display); font-weight: 400;
 font-size: clamp(11px, 1.6vw, 14px); letter-spacing: 0.4em;
 text-transform: uppercase; color: var(--gold);
 margin-bottom: 8px;
}
.flythrough-desc {
 font-family: var(--font-body); font-size: clamp(14px, 1.5vw, 17px);
 color: var(--text-secondary); line-height: 1.85;
}
.flythrough-progress {
 margin-top: 16px; display: flex; gap: 6px; align-items: center;
}
.flythrough-dot {
 width: 6px; height: 6px; border-radius: 50%;
 background: rgba(255,255,255,0.15); transition: all 0.4s var(--ease-out);
}
.flythrough-dot.active { background: var(--gold); box-shadow: 0 0 8px rgba(224,192,80,0.4); transform: scale(1.3); }
.flythrough-dot.past { background: rgba(224,192,80,0.35); }
.flythrough-dot:hover { background: rgba(224,192,80,0.55); transform: scale(1.2); transition: all 0.2s var(--ease-out); }
.flythrough-dot.active:hover { background: var(--gold); transform: scale(1.3); }
.flythrough-controls {
 position: absolute; top: 16px; right: 16px;
 display: flex; gap: 8px; pointer-events: auto;
}
.flythrough-btn {
 padding: 6px 14px; background: rgba(10,10,18,0.85);
 border: 1px solid var(--border-subtle); border-radius: 5px;
 font-family: var(--font-ui); font-size: 10.5px; letter-spacing: 0.06em;
 color: var(--text-tertiary); cursor: pointer;
 transition: all var(--duration-normal) var(--ease-out);
}
.flythrough-btn:hover { border-color: var(--gold-dim); color: var(--gold); }

/* Flythrough path picker popup */
#flythrough-picker {
 position: fixed; z-index: 9500;
 right: 24px; bottom: 72px;
 background: rgba(10,10,18,0.96); border: 1px solid rgba(220,193,90,0.07);
 border-radius: 14px; padding: 26px 30px; width: 340px;
 max-height: calc(var(--vh-full, 100vh) - 130px); overflow-y: auto;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.03);
 display: none;
 backdrop-filter: blur(20px) saturate(1.2); -webkit-backdrop-filter: blur(20px) saturate(1.2);
}
#flythrough-picker.visible { display: block; animation: dropIn 0.25s var(--ease-out) both; }
#flythrough-picker-backdrop {
 position: fixed; inset: 0; z-index: 9499;
 background: transparent; display: none;
}
#flythrough-picker-backdrop.visible { display: block; }
.picker-title {
 font-family: var(--font-display); font-size: 10px; letter-spacing: 0.35em;
 text-transform: uppercase; color: var(--gold-dim); margin-bottom: 4px;
}
.picker-subtitle {
 font-family: var(--font-ui); font-size: 10.5px; color: var(--text-muted);
 letter-spacing: 0.06em; margin-bottom: 20px;
}
.picker-item {
 display: flex; align-items: center; gap: 12px;
 padding: 10px 14px; border-radius: 8px; cursor: pointer;
 border: 1px solid transparent;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
 margin-bottom: 4px;
}
.picker-item:hover { background: rgba(220,193,90,0.025); border-color: rgba(220,193,90,0.05); }
.picker-item-dot {
 width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
}
.picker-item-info { flex: 1; min-width: 0; }
.picker-item-name {
 font-family: var(--font-heading); font-size: 14px; color: var(--text-primary);
 margin-bottom: 2px;
}
.picker-item-desc {
 font-family: var(--font-ui); font-size: 11px; color: var(--text-tertiary);
 margin-top: 1px;
}
.picker-item-count {
 font-family: var(--font-ui); font-size: 10.5px; color: var(--text-muted);
 letter-spacing: 0.06em;
 margin-top: 4px;
}

/* ── Path Indicator ── */
#path-indicator {
 position: absolute; top: 8px; left: 50%; transform: translateX(-50%);
 padding: 8px 22px; background: rgba(10,10,18,0.96);
 border: 1px solid rgba(220,193,90,0.12); border-radius: 20px;
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.06em;
 color: var(--gold); display: none; z-index: 20;
 box-shadow: 0 8px 32px rgba(0,0,0,0.4), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
 align-items: center; gap: 10px; white-space: nowrap;
 max-width: calc(100vw - 24px);
}
#path-indicator.visible { display: flex; }
.path-pulse {
 width: 6px; height: 6px; border-radius: 50%;
 background: var(--gold); animation: pulse 1.2s infinite;
}
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.25; } }
.path-close-btn {
 background: none; border: none; color: var(--text-muted);
 cursor: pointer; font-size: 14px; margin-left: 4px;
 transition: color var(--duration-fast);
}
.path-close-btn:hover { color: var(--text-primary); }
.path-nav-btn {
 background: none; border: 1px solid var(--border-subtle);
 border-radius: 4px; color: var(--text-tertiary); cursor: pointer;
 font-size: 11px; padding: 2px 8px; transition: all var(--duration-fast);
}
.path-nav-btn:hover { border-color: var(--gold-dim); color: var(--gold); }

/* ═══ STUDY PANEL ═══ */
#study-panel {
 position: absolute; right: 0; top: 0; bottom: 0;
 width: var(--panel-width); max-width: 100vw;
 background: rgba(6,6,12,0.98);
 border-left: 1px solid rgba(220,193,90,0.05);
 transform: translateX(100%);
 transition: transform 0.6s cubic-bezier(0.32, 0.72, 0, 1);
 overflow-y: auto; z-index: 50;
 scrollbar-width: thin; scrollbar-color: rgba(220,193,90,0.05) transparent;
 /* ── GPU compositing for smooth slide ── */
 will-change: transform;
 /* ── Layout containment - prevent reflows from propagating ── */
 contain: layout style;
 /* ── Prevent overscroll propagation to body ── */
 overscroll-behavior: contain;
 /* ── Safe area bottom padding for home indicator ── */
 padding-bottom: var(--safe-bottom);
 /* Subtle inner glow at the left edge */
 box-shadow: inset 1px 0 40px rgba(220,193,90,0.01);
}
#study-panel.open { transform: translateX(0); }
#study-panel.open .panel-title { animation: panelFadeIn 0.5s 0.1s var(--ease-out) both; }
#study-panel.open .panel-color-bar { animation: shimmerIn 1s 0.15s var(--ease-out) both; }
#study-panel.open .panel-study-toggle { animation: panelFadeIn 0.4s 0.2s var(--ease-out) both; }
#study-panel.open .panel-tabs { animation: panelFadeIn 0.4s 0.25s var(--ease-out) both; }
#study-panel.open .panel-summary { animation: panelFadeIn 0.45s 0.3s var(--ease-out) both; }
#study-panel.open .tab-pane.active { animation: panelFadeIn 0.5s 0.35s var(--ease-out) both; }

@keyframes panelFadeIn {
 from { opacity: 0; transform: translateY(10px); }
 to { opacity: 1; transform: none; }
}
@keyframes shimmerIn {
 0% { opacity: 0; background-size: 0% 100%; }
 50% { opacity: 1; }
 100% { opacity: 1; background-size: 100% 100%; }
}

.panel-header {
 position: sticky; top: 0; z-index: 5;
 display: flex; align-items: center; justify-content: space-between;
 padding: 16px 28px;
 background: rgba(6,6,12,0.97);
 border-bottom: 1px solid rgba(220,193,90,0.04);
 backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
}
.panel-layer-label {
 font-family: var(--font-ui); font-size: 10.5px;
 letter-spacing: 0.14em; text-transform: uppercase; color: var(--text-muted);
}
.panel-close-btn {
 width: 30px; height: 30px; border: none;
 background: rgba(220,193,90,0.03); border-radius: 50%;
 color: var(--text-muted); cursor: pointer; font-size: 12px;
 display: flex; align-items: center; justify-content: center;
 transition: all 0.3s;
}
.panel-close-btn:hover { background: rgba(220,193,90,0.08); color: var(--text-primary); }

.panel-inner { padding: 28px 32px 44px; }

.panel-title {
 font-family: var(--font-heading); font-weight: 400;
 font-size: 28px; line-height: 1.25; color: var(--text-primary);
 margin-bottom: 8px;
}
.panel-color-bar {
 width: 100%; height: 2px; border-radius: 1px; margin-bottom: 14px;
 opacity: 0.7;
}
.panel-study-toggle {
 display: inline-flex; align-items: center; gap: 7px;
 padding: 5px 16px; border-radius: 14px;
 font-family: var(--font-ui); font-size: 10.5px; letter-spacing: 0.08em;
 cursor: pointer; transition: all 0.4s;
 margin-bottom: 22px; border: 1px solid rgba(220,193,90,0.06);
 color: var(--text-tertiary); background: transparent;
}
.panel-study-toggle:hover { border-color: rgba(220,193,90,0.15); color: var(--gold); background: rgba(220,193,90,0.02); }
.panel-study-toggle.studied {
 background: rgba(220,193,90,0.05); border-color: rgba(220,193,90,0.15); color: var(--gold);
}
.panel-study-toggle .check-icon { font-size: 11px; }

/* ── Review Toggle Micro-interactions ── */
.panel-study-toggle {
 /* P2 #13: Merged with earlier declaration to eliminate redundancy */
 position: relative;
 overflow: visible;
}

/* Checkmark morph animation */
.panel-study-toggle .check-icon {
 display: inline-block;
 transition: transform 0.4s var(--ease-spring), opacity 0.2s var(--ease-out);
}
.panel-study-toggle.studying-in .check-icon {
 animation: checkMorphIn 0.5s var(--ease-spring) both;
}
.panel-study-toggle.studying-out .check-icon {
 animation: checkMorphOut 0.35s var(--ease-out) both;
}

@keyframes checkMorphIn {
 0% { transform: scale(0.3) rotate(-90deg); opacity: 0; }
 50% { transform: scale(1.3) rotate(10deg); opacity: 1; }
 100% { transform: scale(1) rotate(0deg); opacity: 1; }
}
@keyframes checkMorphOut {
 0% { transform: scale(1) rotate(0deg); opacity: 1; }
 40% { transform: scale(0.6) rotate(30deg); opacity: 0.5; }
 100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

/* Success ring pulse (marking reviewed) */
.panel-study-toggle.studying-in:before {
 content: '';
 position: absolute; inset: -3px; border-radius: 18px;
 border: 1.5px solid var(--gold);
 animation: ringPulse 0.6s var(--ease-out) both;
 pointer-events: none;
}
@keyframes ringPulse {
 0% { transform: scale(0.95); opacity: 0.8; }
 60% { transform: scale(1.12); opacity: 0.3; }
 100% { transform: scale(1.2); opacity: 0; }
}

/* Glow burst behind button on mark */
.panel-study-toggle.studying-in:after {
 content: '';
 position: absolute; inset: -8px; border-radius: 24px;
 background: radial-gradient(circle, var(--gold-glow) 0%, transparent 70%);
 animation: glowBurst 0.7s var(--ease-out) both;
 pointer-events: none; z-index: -1;
}
@keyframes glowBurst {
 0% { opacity: 0; transform: scale(0.6); }
 30% { opacity: 1; transform: scale(1); }
 100% { opacity: 0; transform: scale(1.3); }
}

/* Confetti particle base */
.studied-confetti {
 position: absolute;
 width: 4px; height: 4px;
 border-radius: 50%;
 pointer-events: none;
 animation: confettiBurst 0.7s var(--ease-out) both;
 z-index: 10;
}
@keyframes confettiBurst {
 0% { opacity: 1; transform: translate(0, 0) scale(1); }
 100% { opacity: 0; transform: var(--confetti-end) scale(0); }
}

/* Panel Tabs */
.panel-tabs {
 display: flex; border-bottom: 1px solid rgba(220,193,90,0.05); margin-bottom: 22px;
}
.panel-tab {
 flex: 1; padding: 11px 0; text-align: center; cursor: pointer;
 font-family: var(--font-ui); font-size: 11px;
 letter-spacing: 0.1em; text-transform: uppercase;
 color: var(--text-muted); background: none; border: none;
 border-bottom: 1.5px solid transparent;
 transition: all 0.4s var(--ease-out);
}
.panel-tab:hover { color: var(--text-secondary); }
.panel-tab.active { color: var(--gold); border-bottom-color: var(--gold-dim); }
.tab-pane { display: none; opacity: 0; transform: translateY(4px); }
.tab-pane.active { display: block; animation: panelFadeIn 0.3s var(--ease-out) both; }

/* Overview Tab */
.panel-summary {
 font-family: var(--font-heading); font-size: 17px; font-weight: 400;
 font-style: italic; color: var(--text-secondary);
 line-height: 1.65; margin-bottom: 18px;
 padding-left: 16px; border-left: 1.5px solid rgba(220,193,90,0.25);
}
.panel-desc-wrapper {
 position: relative; overflow: hidden;
 max-height: 5.7em; /* ~3 lines at 1.9 line-height */
 transition: max-height var(--duration-slow) var(--ease-out);
}
.panel-desc-wrapper.expanded {
 /* P1 #10: Actual max-height is set via JS (scrollHeight) to avoid
 layout thrash from animating to an arbitrary 2000px value */
 max-height: var(--desc-expanded-height, 2000px);
}
.panel-desc-fade {
 position: absolute; bottom: 0; left: 0; right: 0; height: 3em;
 background: linear-gradient(to bottom, transparent, rgba(6,6,12,0.98));
 pointer-events: none;
 transition: opacity var(--duration-normal) var(--ease-out);
}
.panel-desc-wrapper.expanded .panel-desc-fade,
.panel-desc-wrapper.no-overflow .panel-desc-fade {
 opacity: 0;
}
.panel-description {
 font-family: var(--font-body); font-size: 15.5px;
 line-height: 1.95; color: var(--text-secondary); margin-bottom: 0;
}
.panel-read-more {
 display: inline-block; margin: 8px 0 20px;
 background: none; border: none; padding: 0;
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.06em;
 text-transform: uppercase; color: var(--gold-dim);
 cursor: pointer; transition: color var(--duration-fast);
}
.panel-read-more:hover { color: var(--gold); }
.panel-read-more.hidden { display: none; }
/* ── Authority-Level Section Labels ── */
.refs-section-label {
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.1em;
 text-transform: uppercase; margin-bottom: 5px; display: flex;
 align-items: center; gap: 6px;
}
.refs-section-label:after {
 content: ''; flex: 1; height: 1px; opacity: 0.3;
}
.refs-section-label.norma-normans {
 color: var(--cat-prolegomena);
}
.refs-section-label.norma-normans:after {
 background: var(--cat-prolegomena);
}
.refs-section-label.norma-normata {
 color: var(--gold-dim);
}
.refs-section-label.norma-normata:after {
 background: var(--gold-dim);
}

/* ── Scripture References (<i>Norma Normans</i>) ── */
.panel-scripture-refs {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 14px;
}
.scripture-tag {
 display: inline-block; padding: 3px 11px;
 background: rgba(109,168,216,0.04); border: 1px solid rgba(109,168,216,0.1);
 border-radius: 4px; font-family: var(--font-ui); font-size: 11px;
 color: var(--cat-prolegomena); letter-spacing: 0.03em;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.scripture-tag:hover { background: rgba(109,168,216,0.08); }

/* ── Confessional Standards (<i>Norma Normata</i>) ── */
.panel-confessional-refs {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 16px;
}
.confessional-tag {
 display: inline-block; padding: 3px 11px;
 background: rgba(220,193,90,0.03); border: 1px solid rgba(220,193,90,0.10);
 border-radius: 4px; font-family: var(--font-ui); font-size: 10.5px;
 color: var(--gold-dim); letter-spacing: 0.03em; font-style: italic;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.confessional-tag:hover { background: rgba(220,193,90,0.07); }
.panel-keywords {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px;
}
.keyword-tag {
 display: inline-block; padding: 3px 11px;
 background: transparent; border: 1px solid rgba(220,193,90,0.06); border-radius: 4px;
 font-family: var(--font-ui); font-size: 10.5px; color: var(--text-muted);
 cursor: pointer; transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.keyword-tag:hover { border-color: rgba(220,193,90,0.18); color: var(--gold); background: rgba(220,193,90,0.03); }

/* Connections Tab */
.connections-section { margin-bottom: 22px; }
.connections-section h4 {
 font-family: var(--font-ui); font-size: 10.5px;
 letter-spacing: 0.14em; text-transform: uppercase;
 color: var(--text-muted); margin-bottom: 10px;
 padding-bottom: 6px; border-bottom: 1px solid rgba(220,193,90,0.04);
}
.connection-item {
 display: flex; align-items: center; gap: 10px;
 padding: 9px 12px; margin-bottom: 2px; border-radius: 6px;
 cursor: pointer; transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.connection-item:hover { background: rgba(220,193,90,0.025); transform: translateX(3px); }
.connection-dot {
 width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0;
 transition: transform var(--duration-fast), box-shadow var(--duration-fast);
}
.connection-item:hover .connection-dot { transform: scale(1.4); }
.connection-name {
 font-family: var(--font-body); font-size: 14px; color: var(--text-tertiary);
 transition: color var(--duration-fast); flex: 1;
}
.connection-item:hover .connection-name { color: var(--text-primary); }
.connection-type {
 font-family: var(--font-ui); font-size: 10px;
 color: var(--text-muted); letter-spacing: 0.05em;
 text-transform: uppercase;
}
.connection-studied {
 width: 14px; height: 14px; display: flex; align-items: center; justify-content: center;
 font-size: 10.5px; color: var(--gold-dim);
}

/* Study Tab */
.study-card {
 padding: 18px; margin-bottom: 10px;
 background: rgba(220,193,90,0.01);
 border: 1px solid rgba(220,193,90,0.04); border-radius: 8px;
 cursor: pointer; transition: all 0.45s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.study-card:hover {
 border-color: rgba(220,193,90,0.1); background: rgba(220,193,90,0.025);
 transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.25), 0 0 0 0.5px rgba(220,193,90,0.06);
}
.study-card h5 {
 font-family: var(--font-heading); font-size: 16px; font-weight: 400;
 color: var(--text-primary); margin-bottom: 6px;
}
.study-card p {
 font-family: var(--font-body); font-size: 14px;
 line-height: 1.8; color: var(--text-tertiary);
}

/* ═══ BOTTOM BAR ═══ */
#bottombar {
 position: absolute; bottom: 0; left: 0; right: 0;
 padding: 14px 24px 18px; z-index: 20; pointer-events: none;
 background: linear-gradient(0deg, rgba(0,0,0,0.92) 0%, rgba(0,0,0,0.4) 50%, transparent 100%);
 display: flex; align-items: flex-end; justify-content: space-between;
}
#bottombar > * { pointer-events: auto; }
.bottom-controls {
 display: flex; gap: 6px; flex-wrap: wrap;
}
.bottom-btn {
 padding: 6px 16px; background: rgba(220,193,90,0.015);
 border: 1px solid rgba(220,193,90,0.06); border-radius: 5px;
 font-family: var(--font-ui); font-size: 10.5px; letter-spacing: 0.06em;
 color: var(--text-muted); cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); user-select: none;
}
.bottom-btn:hover { border-color: rgba(220,193,90,0.15); color: var(--text-secondary); box-shadow: 0 0 20px rgba(220,193,90,0.03); }
.bottom-btn:active { transform: scale(0.94); transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1); }
.bottom-btn.active {
 background: var(--gold-surface); border-color: rgba(220,193,90,0.2); color: var(--gold);
}
.keyboard-hints {
 font-family: var(--font-ui); font-size: 10px; color: rgba(145,141,130,0.35);
}
.keyboard-hints kbd {
 padding: 1px 5px; border: 1px solid rgba(220,193,90,0.06);
 border-radius: 3px; font-family: inherit; font-size: inherit;
}

/* ═══ PATHS POPUP ═══ */
#paths-popup {
 position: absolute; bottom: 56px; left: 24px; width: 360px;
 max-height: calc(100vh - 120px);
 background: rgba(11,11,22,0.96); border: 1px solid rgba(220,193,90,0.08);
 border-radius: 10px; display: none; z-index: 30;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
 overflow-y: auto;
}
#paths-popup.visible { display: block; animation: dropIn 0.25s var(--ease-out) both; }
.paths-title {
 padding: 16px 20px; font-family: var(--font-ui); font-size: 10.5px;
 letter-spacing: 0.14em; text-transform: uppercase;
 color: var(--text-muted); border-bottom: 1px solid rgba(220,193,90,0.04);
}
.path-item {
 padding: 13px 20px; cursor: pointer;
 border-bottom: 1px solid rgba(220,193,90,0.03);
 transition: background 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.path-item:last-child { border-bottom: none; }
.path-item:hover { background: rgba(220,193,90,0.025); }
.path-item small {
 display: block; font-family: var(--font-ui); font-size: 10px;
 letter-spacing: 0.1em; text-transform: uppercase; color: var(--gold-dim); margin-bottom: 3px;
}
.path-item .path-name {
 display: block;
 font-family: var(--font-body); font-size: 14.5px; color: var(--text-secondary);
 line-height: 1.4; margin-bottom: 4px;
}
.path-item:hover .path-name { color: var(--text-primary); }
.path-item .path-meta {
 display: block;
 font-family: var(--font-ui); font-size: 10.5px;
 color: var(--text-muted); margin-top: 4px; line-height: 1.5;
}
.path-item .path-progress {
 margin-top: 6px; height: 2px; background: var(--border-subtle); border-radius: 1px; overflow: hidden;
}
.path-item .path-progress-fill {
 height: 100%; background: var(--gold-dim); border-radius: 1px; transition: width 0.3s;
}

/* ═══ RELATED TOPICS BADGE ═══ */
.related-badge {
 display: inline-block; font-family: var(--font-ui); font-size: 10px;
 letter-spacing: 0.06em; text-transform: uppercase;
 color: var(--text-muted); background: rgba(255,255,255,0.04);
 border: 1px solid var(--border-subtle); border-radius: 3px;
 padding: 1px 6px; margin-left: 6px; vertical-align: middle;
 font-weight: 400;
}
.related-reason {
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.04em;
 color: var(--text-muted); margin-left: auto; white-space: nowrap; flex-shrink: 0;
}

/* ═══ STUDY PATHS DISCOVERY PROMPT ═══ */

/* ═══ MOBILE RESPONSIVE ═══ */
@media (max-width: 768px) {
 :root {
 --panel-width: 100vw;
 --topbar-height: 48px;
 --search-width: 100%;
 }

 #topbar {
 padding: 0 12px; flex-wrap: nowrap;
 /* ── Safe area padding ── */
 padding-left: calc(12px + var(--safe-left));
 padding-right: calc(12px + var(--safe-right));
 }
 .brand { display: none; }
 .search-container { flex: 1; max-width: none; margin-right: 8px; }
 .search-shortcut { display: none; }
 .topbar-controls .control-btn span.desktop-label { display: none; }

 /* ── Touch-friendly control buttons (min 44px tap target) ── */
 .control-btn {
 min-height: var(--touch-min);
 min-width: var(--touch-min);
 display: flex; align-items: center; justify-content: center;
 }
 .bottom-btn {
 min-height: var(--touch-min);
 padding: 10px 18px;
 }
 .progress-badge {
 min-height: 36px;
 display: flex; align-items: center; justify-content: center;
 }

 /* ── Legend: slide-up drawer on mobile instead of hidden ── */
 #legend {
 position: fixed; bottom: 0; left: 0; right: 0;
 top: auto; transform: translateY(100%);
 flex-direction: row; flex-wrap: wrap;
 justify-content: center; gap: 8px;
 padding: 16px 12px calc(16px + var(--safe-bottom));
 background: rgba(8,8,14,0.96);
 border-top: 1px solid var(--border-subtle);
 z-index: 60;
 transition: transform 0.4s var(--ease-out), visibility 0.4s;
 visibility: hidden;
 display: flex;
 }
 #legend.mobile-open {
 transform: translateY(0);
 visibility: visible;
 }
 .legend-item { padding: 6px 10px; }

 #study-panel {
 width: 100vw; border-left: none;
 /* ── Swipe-to-close handle area ── */
 padding-top: 0;
 }

 .panel-inner { padding: 20px 16px calc(40px + var(--safe-bottom)); }
 .panel-title { font-size: 22px; }

 /* ── Panel swipe handle for mobile ── */
 .panel-header:before {
 content: '';
 position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
 width: 36px; height: 4px; border-radius: 2px;
 background: rgba(255,255,255,0.15);
 }

 #bottombar {
 padding: 10px 12px calc(14px + var(--safe-bottom));
 padding-left: calc(12px + var(--safe-left));
 padding-right: calc(12px + var(--safe-right));
 }
 #paths-popup {
 width: calc(100vw - 24px - var(--safe-left) - var(--safe-right));
 left: calc(12px + var(--safe-left));
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
 #flythrough-picker {
 right: 12px; left: 12px; width: auto;
 bottom: 68px;
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
 /* ── Flythrough info card: bottom on mobile ── */
 #flythrough-overlay {
 justify-content: flex-end; align-items: center;
 padding-bottom: calc(var(--space-xl) + var(--safe-bottom));
 }
 .flythrough-text {
 max-width: calc(100vw - 32px); width: auto;
 max-height: 40vh;
 }
 .keyboard-hints { display: none; }
 .mobile-copyright { display: block !important; }

 .ob-row { gap: 20px; }

 /* ── Tooltip repositioned for touch ── */
 #tooltip {
 bottom: 80px; left: 50% !important; top: auto !important;
 transform: translateX(-50%);
 max-width: calc(100vw - 32px);
 }

 /* ── Search results - ensure scrollable on small screens ── */
 #search-results {
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
}

@media (max-width: 480px) {
 /* ── iOS zoom prevention: input must be >= 16px ── */
 #search-input { font-size: 16px; padding: 10px 12px 10px 36px; }
 .panel-description { font-size: 15px; }
 .panel-summary { font-size: 15px; }
 .panel-read-more { font-size: 11px; }
}

/* P1 #11: Touch target compliance for small interactive elements */
@media (pointer: coarse) {
 .path-nav-btn {
 min-height: var(--touch-min);
 min-width: var(--touch-min);
 display: inline-flex; align-items: center; justify-content: center;
 }
 .path-close-btn {
 min-height: var(--touch-min);
 min-width: var(--touch-min);
 display: inline-flex; align-items: center; justify-content: center;
 }
 .flythrough-btn {
 min-height: var(--touch-min);
 padding: 10px 16px;
 }
 .flythrough-dot {
 width: 28px; height: 28px;
 display: inline-flex; align-items: center; justify-content: center;
 /* Clear visible background - the :before pseudo-element renders the visual dot */
 background: transparent !important;
 box-shadow: none !important;
 }
 .flythrough-dot:before {
 content: ''; width: 6px; height: 6px; border-radius: 50%;
 background: rgba(255,255,255,0.15);
 transition: all 0.4s var(--ease-out);
 }
 .flythrough-dot.active:before { background: var(--gold); box-shadow: 0 0 8px rgba(224,192,80,0.4); transform: scale(1.3); }
 .flythrough-dot.past:before { background: rgba(224,192,80,0.35); }
 .flythrough-dot:hover:before { background: rgba(224,192,80,0.55); transform: scale(1.2); }
 #breadcrumb span:not(.sep) {
 min-height: var(--touch-min);
 display: inline-flex; align-items: center;
 padding: 0 4px;
 }
 .panel-close-btn {
 min-height: var(--touch-min);
 min-width: var(--touch-min);
 }
 .scripture-tag, .confessional-tag, .keyword-tag {
 min-height: 36px;
 display: inline-flex; align-items: center;
 }
}

/* ═══ LARGE DESKTOP ═══ */
@media (min-width: 1600px) {
 :root {
 --panel-width: 600px;
 --search-width: 440px;
 }
}

/* ═══ HIGH DPI SCREENS ═══ */
@media (-webkit-min-device-pixel-ratio: 3), (min-resolution: 3dppx) {
 ::-webkit-scrollbar { width: 3px; }
}

/* ═══ DEGRADATION BANNER ═══ */
#degradation-banner {
 position: fixed; bottom: 0; left: 0; right: 0; z-index: 9999;
 padding: 10px 20px; text-align: center;
 font-family: var(--font-ui), Georgia, serif; font-size: 12.5px;
 letter-spacing: 0.03em; line-height: 1.7;
 color: var(--text-secondary);
 background: rgba(10,10,18,0.97);
 border-top: 1px solid rgba(220,193,90,0.08);
 backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
 transform: translateY(100%);
 transition: transform 0.5s var(--ease-out);
}
#degradation-banner.visible { transform: translateY(0); }
#degradation-banner .banner-icon { color: var(--gold-dim); margin-right: 6px; }
#degradation-banner .banner-dismiss {
 background: none; border: 1px solid var(--border-subtle); border-radius: 4px;
 color: var(--text-tertiary); font-family: var(--font-ui); font-size: 10px;
 padding: 3px 10px; margin-left: 12px; cursor: pointer; letter-spacing: 0.04em;
 transition: all var(--duration-fast);
}
#degradation-banner .banner-dismiss:hover {
 border-color: var(--border-strong); color: var(--text-secondary);
}

/* ═══ FIRST-TIME USER EXPERIENCE (FTUE) ═══ */
/* Apple HIG-inspired coach marks. Fully opaque overlay blocks
 all cosmos interaction. Spotlight is visual-only via
 radial-gradient (no SVG mask holes). */

#ftue-overlay {
 position: fixed; inset: 0; z-index: 9000;
 opacity: 0; pointer-events: none;
 transition: opacity 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
 /* This gradient IS the backdrop + spotlight. Updated by JS. */
 background: radial-gradient(
 ellipse 200px 180px at 50% 50%,
 rgba(0,0,0,0.18) 0%,
 rgba(0,0,0,0.55) 50%,
 rgba(0,0,0,0.78) 100%
 );
}
#ftue-overlay.active {
 opacity: 1; pointer-events: auto;
 /* Block EVERYTHING underneath : no accidental cosmos interaction */
 cursor: default;
}
#ftue-overlay.exiting {
 opacity: 0; pointer-events: none;
 transition: opacity 0.8s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Spotlight ring : purely decorative, floats over the target area */
.ftue-spotlight-ring {
 position: fixed; z-index: 9001;
 border-radius: 50%; pointer-events: none;
 box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.18),
 0 0 24px 2px rgba(224, 192, 80, 0.06),
 inset 0 0 20px 4px rgba(224, 192, 80, 0.03);
 opacity: 0;
 transition:
 top 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 left 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 width 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 height 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-spotlight-ring.visible { opacity: 1; }

/* Subtle breathing animation on the ring */
@keyframes ftueRingBreathe {
 0%, 100% { box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.18),
 0 0 24px 2px rgba(224, 192, 80, 0.06),
 inset 0 0 20px 4px rgba(224, 192, 80, 0.03); }
 50% { box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.30),
 0 0 36px 4px rgba(224, 192, 80, 0.10),
 inset 0 0 24px 6px rgba(224, 192, 80, 0.05); }
}
.ftue-spotlight-ring.visible {
 animation: ftueRingBreathe 3s ease-in-out infinite;
}

/* ── Card ── */
.ftue-card {
 position: fixed; z-index: 9002;
 width: 300px;
 padding: 0;
 background: rgba(10, 10, 20, 0.94);
 border: 1px solid rgba(220, 193, 90, 0.06);
 border-radius: 16px;
 box-shadow:
 0 24px 80px rgba(0, 0, 0, 0.5),
 0 2px 12px rgba(0, 0, 0, 0.3),
 0 0 0 0.5px rgba(220, 193, 90, 0.03);
 backdrop-filter: blur(40px) saturate(1.3);
 -webkit-backdrop-filter: blur(40px) saturate(1.3);
 overflow: hidden;
 opacity: 0;
 transform: translateY(8px) scale(0.98);
 transition:
 opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible {
 opacity: 1;
 transform: translateY(0) scale(1);
}
/* Transition out state */
.ftue-card.leaving {
 opacity: 0;
 transform: translateY(-6px) scale(0.98);
 transition:
 opacity 0.25s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.25s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Top accent bar */
.ftue-card-accent {
 height: 2px; width: 100%;
 background: linear-gradient(90deg,
 transparent 0%,
 rgba(224, 192, 80, 0.0) 15%,
 rgba(224, 192, 80, 0.35) 50%,
 rgba(224, 192, 80, 0.0) 85%,
 transparent 100%
 );
}

.ftue-card-body {
 padding: 22px 24px 8px;
}

/* Icon : clean SVG-based, not emoji */
.ftue-icon-wrap {
 width: 36px; height: 36px;
 border-radius: 10px;
 background: rgba(224, 192, 80, 0.06);
 border: 1px solid rgba(224, 192, 80, 0.10);
 display: flex; align-items: center; justify-content: center;
 margin-bottom: 14px;
 opacity: 0; transform: scale(0.8);
 transition: opacity 0.4s 0.15s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.4s 0.15s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.ftue-card.visible .ftue-icon-wrap {
 opacity: 1; transform: scale(1);
}
.ftue-icon-wrap svg {
 width: 18px; height: 18px;
 stroke: var(--gold); fill: none;
 stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round;
}

/* Step counter */
.ftue-counter {
 font-family: var(--font-ui); font-size: 10px;
 letter-spacing: 0.12em; text-transform: uppercase;
 color: var(--text-muted);
 margin-bottom: 10px;
 opacity: 0; transform: translateY(4px);
 transition: opacity 0.4s 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.4s 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-counter {
 opacity: 1; transform: translateY(0);
}
.ftue-counter-current { color: var(--gold-dim); font-weight: 500; }

/* Title */
.ftue-title {
 font-family: var(--font-heading); font-weight: 400;
 font-size: 20px; line-height: 1.25;
 color: var(--text-primary);
 margin-bottom: 8px;
 opacity: 0; transform: translateY(6px);
 transition: opacity 0.45s 0.22s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.45s 0.22s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-title {
 opacity: 1; transform: translateY(0);
}

/* Description */
.ftue-desc {
 font-family: var(--font-body); font-size: 14.5px;
 color: rgba(187, 183, 173, 0.92); line-height: 1.7;
 margin-bottom: 0;
 opacity: 0; transform: translateY(6px);
 transition: opacity 0.45s 0.28s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.45s 0.28s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-desc {
 opacity: 1; transform: translateY(0);
}

/* Keyboard hint */
.ftue-kbd {
 display: inline-block;
 padding: 1px 5px; margin: 0 1px;
 background: rgba(255, 255, 255, 0.06);
 border: 1px solid rgba(255, 255, 255, 0.10);
 border-radius: 4px;
 font-family: var(--font-ui); font-size: 11px;
 color: var(--text-secondary);
 vertical-align: 1px;
 letter-spacing: 0;
}

/* ── Footer ── */
.ftue-footer {
 display: flex; align-items: center; justify-content: space-between;
 padding: 14px 24px 18px;
 opacity: 0;
 transition: opacity 0.4s 0.32s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-footer { opacity: 1; }

/* Progress bar : minimal, Apple-style */
.ftue-progress {
 flex: 1; height: 2px; max-width: 100px;
 background: rgba(255, 255, 255, 0.06);
 border-radius: 1px; overflow: hidden;
}
.ftue-progress-fill {
 height: 100%;
 background: linear-gradient(90deg, var(--gold-dim), var(--gold));
 border-radius: 1px;
 transition: width 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
}

.ftue-actions { display: flex; gap: 4px; align-items: center; }

/* Skip : ghostly, minimal */
.ftue-skip {
 padding: 7px 14px; background: none; border: none;
 font-family: var(--font-ui); font-size: 11px;
 letter-spacing: 0.02em; color: var(--text-muted);
 cursor: pointer; border-radius: 8px;
 transition: color 0.2s, background 0.2s;
}
.ftue-skip:hover {
 color: var(--text-secondary);
 background: rgba(255, 255, 255, 0.04);
}

/* Next : solid, confident */
.ftue-next {
 padding: 7px 18px;
 background: rgba(224, 192, 80, 0.10);
 border: 1px solid rgba(224, 192, 80, 0.22);
 border-radius: 8px;
 font-family: var(--font-ui); font-size: 11px;
 letter-spacing: 0.02em; color: var(--gold);
 cursor: pointer; white-space: nowrap;
 transition: all 0.25s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-next:hover {
 background: rgba(224, 192, 80, 0.18);
 border-color: rgba(224, 192, 80, 0.38);
 box-shadow: 0 0 20px rgba(224, 192, 80, 0.06);
}
.ftue-next:active {
 transform: scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Mobile ── */
@media (max-width: 768px) {
 .ftue-card {
 width: calc(100vw - 32px) !important;
 left: 16px !important; right: 16px !important;
 max-width: none;
 }
 .ftue-title { font-size: 18px; }
 .ftue-desc { font-size: 13px; }
 .ftue-kbd { display: none; }
}

/* ── Accessibility ── */
.sr-only {
 position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
 overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
}

#skip-link {
 position: fixed; top: -100%; left: 50%; transform: translateX(-50%);
 z-index: 10000; padding: 12px 24px;
 background: var(--gold); color: #000;
 font-family: var(--font-ui); font-size: 13px; font-weight: 600;
 letter-spacing: 0.04em; border-radius: 0 0 8px 8px;
 text-decoration: none; transition: top 0.15s;
}
#skip-link:focus { top: 0; }

/* Focus-visible ring for all interactive elements */
*:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
}
/* Canvas and containers shouldn't show focus ring */
canvas:focus-visible, #three-container:focus-visible {
 outline: 2px solid var(--gold-dim);
 outline-offset: -2px;
}
/* Suppress outline for mouse clicks where focus-visible is not triggered */
*:focus:not(:focus-visible) { outline: none; }

/* Search result keyboard-active state */
.search-result-item[aria-selected="true"] {
 background: var(--bg-hover);
 outline: 2px solid var(--gold-dim);
 outline-offset: -2px;
}

/* Legend item keyboard focus */
.legend-item:focus-visible {
 opacity: 1;
 outline: 2px solid var(--gold);
 outline-offset: 1px;
}

/* Panel tab keyboard focus */
.panel-tab:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: -2px;
}

/* Connection items keyboard focus */
.connection-item:focus-visible, .study-card:focus-visible, .path-item:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: -1px;
}

/* ── Enhanced Focus Rings (HIG / Linear-compliant) ── */
/* Buttons in top-bar and bottom-bar */
.control-btn:focus-visible,
.bottom-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 box-shadow: 0 0 0 4px rgba(224,192,80,0.15);
}
/* Panel close button */
.panel-close-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 background: rgba(255,255,255,0.08);
}
/* Study toggle pill */
.panel-study-toggle:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 box-shadow: 0 0 0 4px rgba(224,192,80,0.12);
}
/* Keyword tags */
.keyword-tag:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 1px;
 border-color: var(--gold-dim);
 color: var(--gold);
}
/* Enter cosmos button */
.enter-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 4px;
 box-shadow: 0 0 0 6px rgba(224,192,80,0.12);
}
/* Path indicator nav/close buttons */
.path-nav-btn:focus-visible,
.path-close-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 1px;
}
/* Degradation banner dismiss */
.banner-dismiss:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
}
/* Breadcrumb links */
#breadcrumb span:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 color: var(--gold);
}
</style>
</head>
<body>

<!-- P0 #3: Fallback for users with JavaScript disabled -->
<noscript>
<div style="position:fixed;inset:0;z-index:99999;background:#000;color:#ece8da;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;font-family:Georgia,serif;">
<h1 style="font-size:1.2rem;letter-spacing:0.3em;color:#dcc15a;margin-bottom:1rem;">SYSTEMATIC THEOLOGY</h1>
<p style="font-size:0.95rem;line-height:1.7;max-width:480px;color:#9e9a90;">This interactive 3D theological cosmos requires JavaScript to run. Please enable JavaScript in your browser settings to explore the cosmos.</p>
</div>
</noscript>

<!-- ═══ SEO — CRAWLABLE CONTENT LAYER ═══
 Single-page apps are notoriously difficult for search engines to index
 because content is rendered via JavaScript. This hidden semantic HTML
 provides crawlers with indexable content that matches the JS-rendered
 experience, without being visible to users (uses sr-only pattern).
 This is the single highest-impact SEO technique for an SPA. -->
<div class="sr-only" role="document" aria-hidden="true" id="seo-content">
 <article itemscope itemtype="https://schema.org/Article">
 <header>
 <h1 itemprop="headline">Systematic Theology: The Interactive 3D Theological Cosmos</h1>
 <p itemprop="alternativeHeadline">269 Reformed Doctrines Across 13 Loci of Systematic Theology</p>
 <div itemprop="author" itemscope itemtype="https://schema.org/Organization">
 <meta itemprop="name" content="Visual Seminary">
 <meta itemprop="url" content="https://visualseminary.com">
 </div>
 <meta itemprop="datePublished" content="2026-01-01">
 <meta itemprop="dateModified" content="2026-02-24">
 </header>

 <section itemprop="articleBody">
 <h2>About the Theological Cosmos</h2>
 <p>The Systematic Theology Cosmos is the first interactive 3D visualization of Reformed systematic theology. It maps 269 doctrines as a constellation graph — each doctrine a point of light, each connection a theological relationship — allowing students, pastors, and seminarians to explore the full scope of Christian doctrine in an intuitive, visual interface.</p>

 <h2>13 Theological Categories</h2>
 <p>The cosmos organizes doctrines across 13 categories covering the complete scope of systematic theology: Prolegomena and Scripture (the foundations of theological knowledge), Theology Proper (the being and attributes of God), The Holy Trinity, Christology (the person and work of Christ), Pneumatology (the Holy Spirit), Soteriology (the doctrine of salvation), Anthropology and Creation, Hamartiology (the doctrine of sin), Ecclesiology and Sacraments, Eschatology (the last things), Law and Ethics, Piety and the Christian Life, Biblical Theology, and Reformed Polemics.</p>

 <h2>24 Guided Study Paths</h2>
 <p>Twenty-four curated study paths guide users through systematic theology step by step. Paths include: The Knowledge of God, The Triune God, The Divine Perfections, The Covenant of Redemption, Covenant Theology, The Christological Center, The Order of Salvation, The Holy Spirit, The Human Will in Four States, Law Liberty and Life, Christian Liberty and the Lordship of Conscience, The Church and Her Ordinances, The Sacraments in Full, Church State and Society, The Church's Mission to the Nations, The Life of Piety, The Old Testament's Theological Voice, Creation to New Creation, From Garden to Glory, The Last Things, Defending the Faith: Reformed Polemics, and Against Modern Errors.</p>

 <h2>Scripture and Confessional Cross-References</h2>
 <p>Every doctrine includes cross-references to Scripture (norma normans — the norming norm) and the Reformed confessional standards (norma normata — the normed norm), including the Westminster Confession of Faith, the Westminster Shorter and Larger Catechisms, the Belgic Confession, the Canons of Dort, the Heidelberg Catechism, the Second London Baptist Confession, and others.</p>

 <h2>Key Theological Loci</h2>
 <h3>Prolegomena and Scripture</h3>
 <p>The foundations of theology: theological method, the distinction between archetypal and ectypal knowledge, general and special revelation, the doctrine of Scripture including inerrancy, inspiration, and authority, the relationship between faith and reason, natural theology, and presuppositional apologetics.</p>

 <h3>Theology Proper — The Doctrine of God</h3>
 <p>The being and attributes of God including divine simplicity, aseity, immutability, infinity, omnipotence, divine knowledge, divine will, veracity, goodness, love, grace, holiness, righteousness, incomprehensibility, and blessedness. The Holy Trinity including eternal generation, the procession of the Spirit, and trinitarian relations.</p>

 <h3>Christology</h3>
 <p>The person and work of Christ: the necessity of the Mediator, the incarnation, the two natures of Christ (the hypostatic union), Christ's threefold office as Prophet, Priest, and King, active and passive obedience, definite atonement, the states of humiliation and exaltation, and the ongoing intercession of Christ.</p>

 <h3>Soteriology — The Doctrine of Salvation</h3>
 <p>The order of salvation (ordo salutis) as grounded in union with Christ: effectual calling and regeneration, faith and repentance, justification by faith alone, adoption, sanctification, perseverance of the saints, assurance of salvation, and glorification.</p>

 <h3>Covenant Theology</h3>
 <p>The covenantal architecture of redemption: the covenant of redemption (<i>pactum salutis</i>), the covenant of works, the covenant of grace, federal headship, the Mosaic covenant, the relationship between Old and New Testaments, and covenant signs including baptism and the Lord's Supper.</p>

 <h3>Ecclesiology</h3>
 <p>The doctrine of the church: the visible and invisible church, the marks of the true church, church government, officers, discipline, synods and councils, the civil magistrate, the means of grace, the preaching of the Word, the sacraments, worship, and the Sabbath.</p>

 <h3>Eschatology</h3>
 <p>The last things: death and the intermediate state, the return of Christ, the resurrection of the body, the final judgment, the new creation, amillennialism, the antichrist, the cosmic scope of redemption, the beatific vision, and the eternal state.</p>

 <h3>Reformed Polemics</h3>
 <p>The elenctic dimension of Reformed theology: polemics against Rome (justification, Scripture, sacraments, the papacy), against Socinianism (Trinity, atonement), against Arminianism (the five points of Dort: total depravity, unconditional election, definite atonement, irresistible grace, perseverance), and against modern errors including Enlightenment liberalism, higher criticism, naturalism, neo-orthodoxy, open theism, Kantianism, Darwinism, the New Perspective on Paul, progressive Christianity, and the social gospel.</p>
 </section>
 </article>
</div>

<!-- Degradation Banner (hidden by default, shown on asset failure) -->
<div id="degradation-banner" role="alert" aria-live="polite">
 <span class="banner-icon" aria-hidden="true">⚠</span>
 <span id="banner-message">Some resources failed to load. The application is running in fallback mode.</span>
 <button class="banner-dismiss" onclick="this.parentElement.classList.remove('visible')" aria-label="Dismiss notification">DISMISS</button>
</div>

<!-- Skip Link -->
<a id="skip-link" href="#main-content">Skip to main content</a>

<!-- Loading Screen -->
<div id="loading-screen" role="status" aria-label="Loading application">
 <h1>SYSTEMATIC THEOLOGY</h1>
 <p>INTERACTIVE THEOLOGICAL COSMOS</p>
 <div class="loading-bar" role="progressbar" aria-label="Loading progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"><div class="loading-bar-fill" id="loading-fill"></div></div>
 <p id="loading-step" aria-live="polite">Preparing&hellip;</p>
</div>

<!-- Onboarding Screen -->
<div id="onboarding-screen" class="hidden" role="dialog" aria-label="Welcome" aria-modal="true">
 <div class="onboarding-content" itemscope itemtype="https://schema.org/WebApplication">
 <h1 itemprop="name">SYSTEMATIC THEOLOGY</h1>
 <h2 itemprop="description">The First Interactive 3D Theological Cosmos</h2>
 <div class="ob-author">by Visual Seminary</div>
 <div class="ob-row">
 <div class="ob-f"><div style="font-family:var(--font-display);font-size:clamp(20px,3vw,28px);color:var(--gold);letter-spacing:0.05em;" itemprop="teaches">269</div><div class="ob-lb">Doctrines</div></div>
 <div class="ob-f"><div style="font-family:var(--font-display);font-size:clamp(20px,3vw,28px);color:var(--gold);letter-spacing:0.05em;">24</div><div class="ob-lb">Study Paths</div></div>
 <div class="ob-f"><div style="font-family:var(--font-display);font-size:clamp(20px,3vw,28px);color:var(--gold);letter-spacing:0.05em;">13</div><div class="ob-lb">Loci</div></div>
 </div>
 </div>
 <button class="enter-btn" id="enter-btn" style="margin-top:8px;">ENTER THE COSMOS</button>
 <div class="ob-copyright" style="margin-top:48px; animation: fadeUp 1s 0.7s var(--ease-out) both;">
 <span style="font-family:var(--font-ui); font-size:10px; letter-spacing:0.12em; color:rgba(184,155,62,0.28);">© 2026 Visual Seminary. All rights reserved.</span>
 </div>
</div>

<!-- Main App -->
<div id="app">
 <!-- Top Bar -->
 <header id="topbar" role="banner">
 <div class="brand" aria-hidden="true">
 <div class="brand-title">SYSTEMATIC THEOLOGY</div>
 <div class="brand-rule"></div>
 <div class="brand-cosmos">COSMOS</div>
 </div>
 <div class="search-container" role="search" aria-label="Search doctrines">
 <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
 <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
 </svg>
 <input type="search" id="search-input" placeholder="Search doctrines, scriptures, keywords…" autocomplete="off"
 inputmode="search" enterkeyhint="search"
 role="combobox" aria-expanded="false" aria-controls="search-results" aria-activedescendant=""
 aria-autocomplete="list" aria-label="Search doctrines, scriptures, keywords">
 <span class="search-shortcut" id="search-shortcut-label" aria-hidden="true">⌘K</span>
 <div id="search-results" role="listbox" aria-label="Search results"></div>
 <div id="search-live" class="sr-only" aria-live="polite" aria-atomic="true"></div>
 </div>
 <div class="topbar-controls">
 <div class="progress-badge" id="progress-badge" title="Click to reset progress" role="button" aria-live="polite" aria-label="Entries visited - click to reset">&nbsp;</div>
 </div>
 </header>

 <!-- Main Content -->
 <main id="main-content">
 <div id="graph-container">
 <div id="three-container" role="img" aria-label="Interactive 3D theology graph. Use mouse to orbit, scroll to zoom, click nodes to study." itemprop="image"></div>
 <div id="graph-vignette" aria-hidden="true"></div>
 <!-- Flythrough Overlay (Improvement #23) -->
 <div id="flythrough-overlay">
 <div class="flythrough-controls">
 <button class="flythrough-btn" id="flythrough-prev" aria-label="Previous stop">‹ Prev</button>
 <button class="flythrough-btn" id="flythrough-pause">Pause</button>
 <button class="flythrough-btn" id="flythrough-next" aria-label="Next stop">Next ›</button>
 <button class="flythrough-btn" id="flythrough-exit">Exit</button>
 </div>
 <div class="flythrough-text" id="flythrough-text">
 <div class="flythrough-locus-name" id="flythrough-locus-name"></div>
 <div class="flythrough-title" id="flythrough-node-title"></div>
 <div class="flythrough-desc" id="flythrough-node-desc"></div>
 <div class="flythrough-progress" id="flythrough-dots"></div>
 </div>
 </div>

 <!-- Flythrough Path Picker -->
 <div id="flythrough-picker-backdrop"></div>
 <div id="flythrough-picker">
 <div class="picker-title">Meditative Flythrough</div>
 <div class="picker-subtitle">Explore every major locus of systematic theology</div>
 <div id="flythrough-picker-list"></div>
 </div>

 <!-- Legend -->
 <div id="legend" role="toolbar" aria-label="Filter by category" aria-orientation="vertical"></div>

 <!-- Breadcrumb -->
 <nav id="breadcrumb" aria-label="Doctrine navigation breadcrumb"></nav>

 <!-- Path Indicator -->
 <div id="path-indicator" role="status" aria-live="polite" aria-label="Study path progress">
 <div class="path-pulse" aria-hidden="true"></div>
 <span id="path-name" style="overflow:hidden;text-overflow:ellipsis;"></span>
 <button class="path-nav-btn" id="path-prev" aria-label="Previous node in path">‹</button>
 <span id="path-counter" style="font-size:9px;color:var(--text-muted)"></span>
 <button class="path-nav-btn" id="path-next" aria-label="Next node in path">›</button>
 <button class="path-close-btn" id="path-close" aria-label="Close study path">✕</button>
 </div>

 <!-- Tooltip -->
 <div id="tooltip" role="tooltip" aria-hidden="true">
 <div class="tooltip-name" id="tooltip-name"></div>
 <div class="tooltip-category" id="tooltip-category"></div>
 <div class="tooltip-summary" id="tooltip-summary"></div>
 <div class="tooltip-studied" id="tooltip-studied"></div>
 </div>
 </div>

 <!-- Study Panel -->
 <aside id="study-panel" role="dialog" aria-label="Doctrine study panel" aria-modal="false" itemscope itemtype="https://schema.org/Article">
 <div class="panel-header">
 <span class="panel-layer-label" id="panel-layer"></span>
 <button class="panel-close-btn" id="panel-close" aria-label="Close study panel">✕</button>
 </div>
 <div class="panel-inner">
 <h2 class="panel-title" id="panel-title" tabindex="-1" itemprop="headline"></h2>
 <div class="panel-color-bar" id="panel-color-bar" aria-hidden="true"></div>
 <button class="panel-study-toggle" id="panel-study-toggle" aria-pressed="false">
 <span class="check-icon" aria-hidden="true">☐</span> Mark as reviewed
 </button>
 <div class="panel-tabs" role="tablist" aria-label="Panel sections">
 <button class="panel-tab active" role="tab" data-tab="overview" id="tab-btn-overview"
 aria-selected="true" aria-controls="tab-overview" tabindex="0">Overview</button>
 <button class="panel-tab" role="tab" data-tab="connections" id="tab-btn-connections"
 aria-selected="false" aria-controls="tab-connections" tabindex="-1">Connections</button>
 <button class="panel-tab" role="tab" data-tab="study" id="tab-btn-study"
 aria-selected="false" aria-controls="tab-study" tabindex="-1">Study</button>
 </div>
 <div class="tab-pane active" id="tab-overview" role="tabpanel" aria-labelledby="tab-btn-overview">
 <div class="panel-summary" id="panel-summary"></div>
 <div class="panel-desc-wrapper" id="panel-desc-wrapper">
 <div class="panel-description" id="panel-description"></div>
 <div class="panel-desc-fade" id="panel-desc-fade" aria-hidden="true"></div>
 </div>
 <button class="panel-read-more" id="panel-read-more" aria-expanded="false">Read more</button>
 <div id="panel-refs-wrapper">
 <div id="panel-scripture-section" style="display:none;">
 <div class="refs-section-label norma-normans">Scripture</div>
 <div class="panel-scripture-refs" id="panel-scriptures" aria-label="Scripture references (norma normans: the norming norm)"></div>
 </div>
 <div id="panel-confessional-section" style="display:none;">
 <div class="refs-section-label norma-normata">Confessional Standards</div>
 <div class="panel-confessional-refs" id="panel-confessionals" aria-label="Confessional standard references (norma normata: the normed norm)"></div>
 </div>
 </div>
 <div class="panel-keywords" id="panel-keywords" aria-label="Keywords"></div>
 <div class="panel-controversies" id="panel-controversies" aria-label="Historical controversies" style="margin-top:12px;display:none;">
 <div style="font-family:var(--font-ui);font-size:9px;letter-spacing:0.08em;text-transform:uppercase;color:var(--text-muted);margin-bottom:6px;">Historical Controversies</div>
 <div id="panel-controversies-list" style="display:flex;flex-wrap:wrap;gap:4px;"></div>
 </div>
 </div>
 <div class="tab-pane" id="tab-connections" role="tabpanel" aria-labelledby="tab-btn-connections">
 <div class="connections-section" id="subtopics-section">
 <h4>Sub-Topics</h4>
 <div id="subtopics-list" role="list" aria-label="Sub-topics"></div>
 </div>
 <div class="connections-section" id="crossrefs-section">
 <h4>Cross-References</h4>
 <div id="crossrefs-list" role="list" aria-label="Cross-references"></div>
 </div>
 <div class="connections-section" id="related-section" style="display:none">
 <h4>Related Topics <span class="related-badge">auto-discovered</span></h4>
 <div id="related-list" role="list" aria-label="Related topics discovered by keyword and scripture overlap"></div>
 </div>
 </div>
 <div class="tab-pane" id="tab-study" role="tabpanel" aria-labelledby="tab-btn-study">
 <div id="study-cards" aria-label="Study cards"></div>
 </div>
 </div>
 </aside>
 </main>

 <!-- Bottom Bar -->
 <footer id="bottombar" role="contentinfo">
 <div class="bottom-controls" role="toolbar" aria-label="View controls">
 <button class="bottom-btn" id="btn-paths" aria-expanded="false" aria-controls="paths-popup">Study Paths</button>
 <button class="bottom-btn" id="btn-meditate" aria-label="Meditative flythrough of redemptive history">Meditate</button>
 <button class="bottom-btn" id="btn-legend-mobile" aria-expanded="false" aria-label="Filter categories" style="display:none">Categories</button>
 <button class="bottom-btn" id="btn-reset">Reset View</button>
 </div>
 <div class="keyboard-hints" id="keyboard-hints" aria-hidden="true">
 <kbd>Esc</kbd> reset · <kbd>⌘K</kbd> search · <kbd>←→</kbd> path nav
 <span style="display:block;margin-top:3px;opacity:0.45;font-size:9px;letter-spacing:0.08em;">© 2026 Visual Seminary</span>
 </div>
 <div class="mobile-copyright" aria-hidden="true" style="display:none;font-family:var(--font-ui);font-size:8px;letter-spacing:0.1em;color:rgba(184,155,62,0.18);text-align:right;">© 2026 Visual Seminary</div>
 </footer>

 <!-- Paths Popup -->
 <div id="paths-popup" role="dialog" aria-label="Guided study paths">
 <div class="paths-title">Guided Study Paths</div>
 <div id="paths-list" role="list" aria-label="Available study paths"></div>
 </div>
</div>

<!-- FTUE Coach Mark Overlay -->
<div id="ftue-overlay" aria-hidden="true"></div>
<div class="ftue-spotlight-ring" id="ftue-ring"></div>
<div class="ftue-card" id="ftue-card" role="dialog" aria-label="Guided tour" aria-modal="false">
 <div class="ftue-card-accent" aria-hidden="true"></div>
 <div class="ftue-card-body">
 <div class="ftue-icon-wrap" id="ftue-icon"></div>
 <div class="ftue-counter" id="ftue-counter"></div>
 <div class="ftue-title" id="ftue-title"></div>
 <div class="ftue-desc" id="ftue-desc"></div>
 </div>
 <div class="ftue-footer">
 <div class="ftue-progress"><div class="ftue-progress-fill" id="ftue-progress-fill"></div></div>
 <div class="ftue-actions">
 <button class="ftue-skip" id="ftue-skip">Skip</button>
 <button class="ftue-next" id="ftue-next">Next</button>
 </div>
 </div>
</div>

<script>
// ═══════════════════════════════════════════
// FIRST-TIME USER EXPERIENCE (FTUE)
// Apple HIG-inspired coach marks.
// Fully blocking overlay : no cosmos interaction during tour.
// Spotlight is visual-only via CSS radial-gradient.
// ═══════════════════════════════════════════
window.FTUETour = {
 _active: false,
 _step: 0,
 _els: {},
 _handlers: {},
 // v2 key : avoids collision with v1 that may be cached in user's localStorage
 STORAGE_KEY: 'stc_ftue_v2_done',

 // ── SVG Icons (hand-tuned, not emoji) ──
 icons: {
 orbit: '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 2a10 10 0 0 1 0 20"/><path d="M12 2a10 10 0 0 0 0 20"/><path d="M2 12h20"/></svg>',
 click: '<svg viewBox="0 0 24 24"><path d="M15 15l-2 5L9 9l11 4-5 2z"/><path d="M5 3L3 5m4-2L5 5m4-2L7 5"/></svg>',
 search: '<svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/></svg>',
 path: '<svg viewBox="0 0 24 24"><circle cx="5" cy="6" r="2"/><circle cx="12" cy="18" r="2"/><circle cx="19" cy="6" r="2"/><path d="M5 8v2a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4V8"/></svg>',
 progress: '<svg viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>',
 },

 steps: [
 {
 icon: 'orbit',
 title: 'Orbit the Cosmos',
 desc: 'Drag to rotate your view. Scroll to zoom in and out.',
 target: function() { return document.getElementById('three-container'); },
 spotSize: { w: 320, h: 280 },
 position: 'center-above',
 },
 {
 icon: 'click',
 title: 'Select a Doctrine',
 desc: 'Each point of light is a doctrine. Click any node to open its study panel.',
 target: function() { return document.getElementById('three-container'); },
 spotSize: { w: 180, h: 180 },
 position: 'center-above',
 },
 {
 icon: 'search',
 title: 'Search Anything',
 desc: function() {
 var isMac = navigator.platform.indexOf('Mac') > -1;
 return 'Find any doctrine, scripture, or keyword. Press ' +
 (isMac ? '<kbd class="ftue-kbd">\u2318K</kbd>' : '<kbd class="ftue-kbd">Ctrl K</kbd>') +
 ' to jump here anytime.';
 },
 target: function() { return document.getElementById('search-input'); },
 spotSize: { w: 400, h: 52 },
 position: 'below-target',
 },
 {
 icon: 'path',
 title: 'Follow Study Paths',
 desc: 'Guided sequences walk you through theology step by step, from foundations to advanced topics.',
 target: function() { return document.getElementById('btn-paths'); },
 spotSize: { w: 120, h: 48 },
 position: 'above-target',
 },
 {
 icon: 'progress',
 title: 'Track Your Journey',
 desc: 'Mark doctrines as reviewed and track which entries you\u2019ve visited. Everything saves automatically.',
 target: function() { return document.getElementById('progress-badge'); },
 spotSize: { w: 80, h: 40 },
 position: 'below-target',
 },
 ],

 shouldShow: function() {
 try { return !localStorage.getItem(this.STORAGE_KEY); } catch(e) { return true; }
 },

 markComplete: function() {
 try { localStorage.setItem(this.STORAGE_KEY, '1'); } catch(e) {}
 },

 /** Public: restart the tour (e.g. from console or a UI button) */
 restart: function() {
 try { localStorage.removeItem(this.STORAGE_KEY); } catch(e) {}
 this.start(true);
 },

 /**
 * @param {boolean} force - If true, ignore localStorage and always show
 */
 start: function(force) {
 Log.log('[FTUE] start() called. force=' + !!force + ', shouldShow=' + this.shouldShow());
 if (!force && !this.shouldShow()) {
 Log.log('[FTUE] Tour already completed : skipping. Call FTUETour.restart() to replay.');
 return;
 }

 var e = this._els;
 e.overlay = document.getElementById('ftue-overlay');
 e.card = document.getElementById('ftue-card');
 e.ring = document.getElementById('ftue-ring');
 e.icon = document.getElementById('ftue-icon');
 e.counter = document.getElementById('ftue-counter');
 e.title = document.getElementById('ftue-title');
 e.desc = document.getElementById('ftue-desc');
 e.progress = document.getElementById('ftue-progress-fill');
 e.next = document.getElementById('ftue-next');
 e.skip = document.getElementById('ftue-skip');

 if (!e.overlay || !e.card) {
 Log.error('[FTUE] DOM elements not found : aborting.', {
 overlay: !!e.overlay, card: !!e.card, ring: !!e.ring
 });
 return;
 }
 Log.log('[FTUE] All DOM elements found. Starting tour.');

 this._step = 0;
 this._active = true;
 e.overlay.setAttribute('aria-hidden', 'false');

 // Wire
 var self = this;
 e.next.onclick = function(ev) { ev.stopPropagation(); self.next(); };
 e.skip.onclick = function(ev) { ev.stopPropagation(); self.dismiss(); };
 e.overlay.onclick = function() { self.next(); };

 // Resize
 this._handlers.resize = function() { if (self._active) self._position(); };
 window.addEventListener('resize', this._handlers.resize);

 // Keyboard (capture phase : intercepts before cosmos)
 this._handlers.key = function(ev) {
 if (!self._active) return;
 if (ev.key === 'Escape') { ev.preventDefault(); ev.stopPropagation(); self.dismiss(); }
 else if (ev.key === 'ArrowRight' || ev.key === 'Enter') { ev.preventDefault(); ev.stopPropagation(); self.next(); }
 else if (ev.key === 'ArrowLeft' && self._step > 0) { ev.preventDefault(); ev.stopPropagation(); self._step--; self._renderStep(); }
 };
 document.addEventListener('keydown', this._handlers.key, true);

 // Block scroll/wheel/touch on the overlay so cosmos doesn't zoom
 this._handlers.wheel = function(ev) { if (self._active) { ev.preventDefault(); ev.stopPropagation(); } };
 this._handlers.touchmove = function(ev) { if (self._active) { ev.preventDefault(); } };
 e.overlay.addEventListener('wheel', this._handlers.wheel, { passive: false, capture: true });
 e.overlay.addEventListener('touchmove', this._handlers.touchmove, { passive: false });

 // Also block pointer events from reaching the canvas underneath
 this._handlers.pointerdown = function(ev) { if (self._active) { ev.stopPropagation(); } };
 e.overlay.addEventListener('pointerdown', this._handlers.pointerdown, true);

 // Activate
 requestAnimationFrame(function() {
 e.overlay.classList.add('active');
 Log.log('[FTUE] Overlay activated. Rendering step 0 in 200ms...');
 setTimeout(function() { self._renderStep(); }, 200);
 });
 },

 next: function() {
 if (this._step < this.steps.length - 1) {
 this._step++;
 Log.log('[FTUE] Advancing to step ' + this._step);
 this._renderStep();
 } else {
 Log.log('[FTUE] Tour complete.');
 this.dismiss();
 }
 },

 dismiss: function() {
 if (!this._active) return;
 this._active = false;
 this.markComplete();

 var e = this._els;
 e.card.classList.remove('visible');
 e.card.classList.add('leaving');
 e.ring.classList.remove('visible');
 e.overlay.classList.add('exiting');

 setTimeout(function() {
 e.overlay.classList.remove('active', 'exiting');
 e.overlay.setAttribute('aria-hidden', 'true');
 e.card.classList.remove('leaving');
 e.ring.style.display = 'none';
 }, 800);

 // Cleanup listeners
 window.removeEventListener('resize', this._handlers.resize);
 document.removeEventListener('keydown', this._handlers.key, true);
 if (e.overlay) {
 e.overlay.removeEventListener('wheel', this._handlers.wheel, { capture: true });
 e.overlay.removeEventListener('touchmove', this._handlers.touchmove);
 e.overlay.removeEventListener('pointerdown', this._handlers.pointerdown, true);
 }
 Log.log('[FTUE] Dismissed and cleaned up.');
 },

 _renderStep: function() {
 var step = this.steps[this._step];
 var e = this._els;
 var target = step.target();
 if (!target) {
 Log.warn('[FTUE] Target not found for step ' + this._step + ', skipping.');
 this.next();
 return;
 }

 // ── Content ──
 e.icon.innerHTML = this.icons[step.icon] || '';
 e.counter.innerHTML = '<span class="ftue-counter-current">' + (this._step + 1) + '</span> / ' + this.steps.length;
 e.title.textContent = step.title;
 e.desc.innerHTML = typeof step.desc === 'function' ? step.desc() : step.desc;

 // Progress bar
 var pct = ((this._step + 1) / this.steps.length) * 100;
 e.progress.style.width = pct + '%';

 // Button label
 e.next.textContent = this._step === this.steps.length - 1 ? 'Begin' : 'Next';

 // ── Animate card: leave → reposition → enter ──
 e.card.classList.remove('visible');
 e.card.classList.add('leaving');

 var self = this;
 setTimeout(function() {
 e.card.classList.remove('leaving');
 self._position();
 requestAnimationFrame(function() {
 requestAnimationFrame(function() {
 e.card.classList.add('visible');
 Log.log('[FTUE] Step ' + self._step + ' rendered: "' + step.title + '"');
 // Focus next button for keyboard users
 e.next.focus({ preventScroll: true });
 });
 });
 }, this._step === 0 ? 50 : 260);
 },

 _position: function() {
 var step = this.steps[this._step];
 var e = this._els;
 var target = step.target();
 if (!target) return;

 var rect = target.getBoundingClientRect();
 var cx = rect.left + rect.width / 2;
 var cy = rect.top + rect.height / 2;
 var vw = window.innerWidth;
 var vh = window.innerHeight;
 var spotW = Math.min(step.spotSize.w, vw - 40);
 var spotH = step.spotSize.h;

 // ── Spotlight gradient (visual only : overlay stays fully blocking) ──
 var gradW = spotW * 0.8;
 var gradH = spotH * 0.8;
 e.overlay.style.background =
 'radial-gradient(ellipse ' + gradW + 'px ' + gradH + 'px at ' + cx + 'px ' + cy + 'px, ' +
 'rgba(0,0,0,0.15) 0%, rgba(0,0,0,0.50) 45%, rgba(0,0,0,0.78) 100%)';

 // ── Ring ──
 e.ring.style.display = '';
 e.ring.style.width = spotW + 'px';
 e.ring.style.height = spotH + 'px';
 e.ring.style.left = (cx - spotW / 2) + 'px';
 e.ring.style.top = (cy - spotH / 2) + 'px';
 e.ring.style.borderRadius = (Math.min(spotW, spotH) * 0.45) + 'px';
 requestAnimationFrame(function() { e.ring.classList.add('visible'); });

 // ── Card positioning ──
 var card = e.card;
 var CARD_W = 300;
 var GAP = 16;
 var isMobile = vw <= 768;

 card.style.top = ''; card.style.bottom = '';
 card.style.left = ''; card.style.right = '';

 if (isMobile) {
 card.style.left = '16px';
 card.style.right = '16px';
 card.style.width = 'auto';
 } else {
 card.style.width = CARD_W + 'px';
 }

 // Horizontal center (desktop)
 var cardLeft = isMobile ? 16 : Math.max(16, Math.min(cx - CARD_W / 2, vw - CARD_W - 16));

 switch (step.position) {
 case 'center-above':
 card.style.bottom = (vh - cy + spotH / 2 + GAP) + 'px';
 if (!isMobile) card.style.left = cardLeft + 'px';
 break;
 case 'below-target':
 card.style.top = (rect.bottom + GAP) + 'px';
 if (!isMobile) card.style.left = cardLeft + 'px';
 break;
 case 'above-target':
 card.style.bottom = (vh - rect.top + GAP) + 'px';
 if (!isMobile) card.style.left = cardLeft + 'px';
 break;
 }
 },
};
</script>

<script>
// ═══════════════════════════════════════════════════════════
// SYSTEMATIC THEOLOGY 4.0 - THEOLOGICAL COSMOS ENGINE
// Clean architecture. Descriptive names. Modular design.
// ═══════════════════════════════════════════════════════════
"use strict";

// ═══════════════════════════════════════════
// §0 - SECURITY: Safe HTML sanitization
// P0 #4: All innerHTML assignments use this helper
// to prevent XSS while preserving allowed formatting tags.
// ═══════════════════════════════════════════
const SAFE_TAGS = new Set(['i', 'em', 'b', 'strong', 'br', 'sub', 'sup', 'span']);
function safeHTML(untrusted) {
 if (typeof untrusted !== 'string') return '';
 const doc = new DOMParser().parseFromString(untrusted, 'text/html');
 const walk = (node) => {
 let out = '';
 for (const child of node.childNodes) {
 if (child.nodeType === Node.TEXT_NODE) {
 out += child.textContent
 .replace(/&/g, '&amp;')
 .replace(/</g, '&lt;')
 .replace(/>/g, '&gt;')
 .replace(/"/g, '&quot;');
 } else if (child.nodeType === Node.ELEMENT_NODE) {
 const tag = child.tagName.toLowerCase();
 if (SAFE_TAGS.has(tag)) {
 out += '<' + tag + '>' + walk(child) + '</' + tag + '>';
 } else {
 out += walk(child);
 }
 }
 }
 return out;
 };
 return walk(doc.body);
}

// ═══════════════════════════════════════════
// §0a - DEVICE CAPABILITY DETECTION
// Detects hardware capabilities and sets quality
// presets for adaptive rendering across devices.
// ═══════════════════════════════════════════
const DeviceCapabilities = {
 isMobile: false,
 isTablet: false,
 isLowEnd: false,
 hasTouch: false,
 pixelRatio: 1,
 gpuTier: 'high', // 'high' | 'mid' | 'low'
 maxTextureSize: 4096,
 prefersReducedMotion: false,

 detect() {
 const ua = navigator.userAgent || '';
 const w = window.innerWidth;
 this.hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
 this.isMobile = this.hasTouch && w <= 768;
 this.isTablet = this.hasTouch && w > 768 && w <= 1200;
 this.pixelRatio = Math.min(window.devicePixelRatio || 1, this.isMobile ? 2 : 2.5);
 this.prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

 // Hardware concurrency check (cores)
 const cores = navigator.hardwareConcurrency || 2;
 // Device memory check (GB, Chrome only)
 const memory = navigator.deviceMemory || 4;

 // GPU tier estimation
 if (this.isMobile && (cores <= 4 || memory <= 2)) {
 this.gpuTier = 'low';
 this.isLowEnd = true;
 } else if (this.isMobile || this.isTablet || cores <= 4) {
 this.gpuTier = 'mid';
 } else {
 this.gpuTier = 'high';
 }

 // WebGL capability probe
 try {
 const c = document.createElement('canvas');
 const gl = c.getContext('webgl2') || c.getContext('webgl');
 if (gl) {
 this.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
 const dbg = gl.getExtension('WEBGL_debug_renderer_info');
 if (dbg) {
 const renderer = gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL).toLowerCase();
 // Detect known low-end GPUs
 if (renderer.includes('mali-4') || renderer.includes('adreno 3') ||
 renderer.includes('sgx') || renderer.includes('swiftshader')) {
 this.gpuTier = 'low';
 this.isLowEnd = true;
 } else if (renderer.includes('mali-g5') || renderer.includes('adreno 5') ||
 renderer.includes('apple gpu') || renderer.includes('intel')) {
 this.gpuTier = this.gpuTier === 'high' ? 'mid' : this.gpuTier;
 }
 }
 // Clean up context
 const ext = gl.getExtension('WEBGL_lose_context');
 if (ext) ext.loseContext();
 }
 } catch(e) { /* ignore probe failures */ }

 Log.log(`[Device] tier=${this.gpuTier} mobile=${this.isMobile} tablet=${this.isTablet} dpr=${this.pixelRatio} cores=${cores} mem=${memory}GB`);
 return this;
 },

 // Adaptive quality presets consumed by the render engine
 get quality() {
 switch (this.gpuTier) {
 case 'low': return {
 pixelRatio: Math.min(this.pixelRatio, 1.5),
 sphereSegments: [12, 8], // [width, height] for locus spheres
 subSphereSegments: [6, 4],
 labelCanvasWidth: 640,
 settleFrames: 45, // half the desktop value
 hoverThrottle: 3, // raycast every 3rd frame
 enableGlow: false,
 enableConfetti: false,
 maxLabelSprites: 40,
 };
 case 'mid': return {
 pixelRatio: Math.min(this.pixelRatio, 2),
 sphereSegments: [18, 12],
 subSphereSegments: [8, 6],
 labelCanvasWidth: 768,
 settleFrames: 30,
 hoverThrottle: 2,
 enableGlow: true,
 enableConfetti: true,
 maxLabelSprites: 40,
 };
 default: return {
 pixelRatio: Math.min(this.pixelRatio, 2.5),
 sphereSegments: [18, 12],
 subSphereSegments: [10, 6],
 labelCanvasWidth: 1024,
 settleFrames: 40,
 hoverThrottle: 2,
 enableGlow: true,
 enableConfetti: true,
 maxLabelSprites: 999,
 };
 }
 }
}.detect();

// P2 #17: Re-evaluate mobile/tablet detection on significant viewport change (rotation)
if (typeof screen !== 'undefined' && screen.orientation) {
 screen.orientation.addEventListener('change', () => {
 const w = window.innerWidth;
 DeviceCapabilities.isMobile = DeviceCapabilities.hasTouch && w <= 768;
 DeviceCapabilities.isTablet = DeviceCapabilities.hasTouch && w > 768 && w <= 1200;
 });
}

// ═══════════════════════════════════════════
// §0b - PERFORMANCE UTILITIES
// Reusable performance primitives
// ═══════════════════════════════════════════

// Strip HTML tags for plain-text contexts (aria-labels, screen readers)
function stripHtml(html) {
 return html ? html.replace(/<[^>]*>/g, '') : '';
}

// Pooled Levenshtein - reuses a single flat array instead of allocating per call
const _levBuf = new Uint16Array(256 * 256);
function levenshteinPooled(a, b) {
 const m = a.length, n = b.length;
 if (m === 0) return n;
 if (n === 0) return m;
 const stride = n + 1;
 for (let j = 0; j <= n; j++) _levBuf[j] = j;
 for (let i = 1; i <= m; i++) {
 _levBuf[i * stride] = i;
 for (let j = 1; j <= n; j++) {
 _levBuf[i * stride + j] = a[i-1] === b[j-1]
 ? _levBuf[(i-1) * stride + (j-1)]
 : 1 + Math.min(
 _levBuf[(i-1) * stride + j],
 _levBuf[i * stride + (j-1)],
 _levBuf[(i-1) * stride + (j-1)]
 );
 }
 }
 return _levBuf[m * stride + n];
}

// Debounced requestAnimationFrame (coalesces rapid calls)
function rafDebounce(fn) {
 let id = null;
 return function(...args) {
 if (id !== null) cancelAnimationFrame(id);
 id = requestAnimationFrame(() => { id = null; fn.apply(this, args); });
 };
}

// ═══════════════════════════════════════════
// §0 - ACCESSIBILITY UTILITIES
// ═══════════════════════════════════════════
const A11y = {
 // Track what element had focus before panel opened
 panelTrigger: null,
 // Track active search result index (-1 = none)
 searchActiveIndex: -1,

 // Announce a message to screen readers via aria-live region
 announce(message) {
 const el = document.getElementById('search-live');
 if (el) { el.textContent = ''; requestAnimationFrame(() => { el.textContent = message; }); }
 },

 // Get all focusable elements within a container
 getFocusable(container) {
 return [...container.querySelectorAll(
 'button:not([disabled]):not([tabindex="-1"]), [href], input:not([disabled]), ' +
 'select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"]), ' +
 '[role="tab"][tabindex="0"], [role="option"], [role="listitem"][tabindex="0"]'
 )].filter(el => el.offsetParent !== null);
 },

 // Trap focus within panel when open
 trapFocusHandler: null,
 enableFocusTrap(container) {
 // Safety: remove any existing trap before adding new one
 this.disableFocusTrap();
 this.trapFocusHandler = (e) => {
 if (e.key !== 'Tab') return;
 const focusable = this.getFocusable(container);
 if (focusable.length === 0) return;
 const first = focusable[0];
 const last = focusable[focusable.length - 1];
 if (e.shiftKey) {
 if (document.activeElement === first || !container.contains(document.activeElement)) {
 e.preventDefault(); last.focus();
 }
 } else {
 if (document.activeElement === last || !container.contains(document.activeElement)) {
 e.preventDefault(); first.focus();
 }
 }
 };
 document.addEventListener('keydown', this.trapFocusHandler);
 },

 disableFocusTrap() {
 if (this.trapFocusHandler) {
 document.removeEventListener('keydown', this.trapFocusHandler);
 this.trapFocusHandler = null;
 }
 },

 // Reset search active descendant state
 resetSearchIndex() {
 this.searchActiveIndex = -1;
 const input = document.getElementById('search-input');
 if (input) input.setAttribute('aria-activedescendant', '');
 document.querySelectorAll('#search-results [role="option"]').forEach(el => {
 el.setAttribute('aria-selected', 'false');
 });
 }
};

// ═══════════════════════════════════════════
// §1 - CATEGORY DEFINITIONS
// ═══════════════════════════════════════════
const CATEGORIES = {
 theology_proper: { color: '#e0c860', label: 'Theology Proper' },
 pneumatology: { color: '#90d0b8', label: 'Pneumatology' },
 soteriology: { color: '#d0886c', label: 'Soteriology' },
 ethics: { color: '#c0ac60', label: 'Law & Ethics' },
 christology: { color: '#d9a055', label: 'Christology' },
 anthropology: { color: '#5eb868', label: 'Anthropology & Creation' },
 ecclesiology: { color: '#b888d8', label: 'Ecclesiology & Sacraments' },
 eschatology: { color: '#50b8b8', label: 'Eschatology' },
 prolegomena: { color: '#70a0d0', label: 'Prolegomena & Scripture' },
 hamartiology: { color: '#d86868', label: 'Hamartiology' },
 polemics: { color: '#cc6655', label: 'Reformed Polemics' },
 piety: { color: '#d4a874', label: 'Piety & the Christian Life' },
 biblical_theology: { color: '#7db88a', label: 'Biblical Theology' },
};

// ═══════════════════════════════════════════
// §2 - THEOLOGICAL DATA
// ═══════════════════════════════════════════
const LOCI = [
// Christ is the organic center of the cosmos (o:0 = origin), not counted among the 269 doctrines.
// Total: 1 center node + 269 doctrinal entries = 270 IDs.
{id:'christ',n:'The Person & Work of Christ',ct:'christology',c:'#d89848',r:2.8,o:0,
d:'Christ stands as the organic center of the entire system of doctrine. The eternal Son incarnate is the one Mediator between God and man (1 Tim 2:5; WCF 8.1). As Prophet, Priest, and King He accomplishes the full work of redemption. Two natures - divine and human - united without confusion or separation in one divine Person, constitute the ontological ground for the entire economy of salvation (John 1:14; Col 2:9; WCF 8.2). In Him all the treasures of wisdom and knowledge are hidden (Col 2:3).',
k:['christology','mediator','incarnation','two natures','hypostatic union','satisfaction','atonement','cross','resurrection','ascension','munus triplex','active obedience','passive obedience','humiliation','exaltation','federal head','last adam'],
cl:['salvation','trinity','covenant-grace','decree','eschatology','church','sacraments','incarnation','two-natures','threefold-office','active-obedience','passive-obedience','god','sin','humanity','pactum','holy-spirit','covenant-works','law','scripture','covenant-theology','biblical-theology','revelation'],
hc:['Chalcedon (451)','Nestorian controversy','Eutychian controversy','Socinian denial of deity','Reformation debates on atonement'],
s:[
{id:'incarnation',n:'The Incarnation',d:'The eternal Son, without ceasing to be God, assumed a true human nature in the womb of the Virgin Mary by the power of the Holy Spirit (Luke 1:35; John 1:14; WCF 8.2). The incarnation is the supreme act of divine condescension, uniting God permanently to His creation. He was made like His brothers in every respect yet without sin (Heb 2:17; 4:15).',k:['incarnation','virgin birth','condescension','humiliation','eternal son','assumption of human nature'],cl:['holy-spirit','humanity','creation-to-consummation','pactum'],ct:'christology'},
{id:'two-natures',n:'The Two Natures',d:'In the one Person of Christ subsist two complete, distinct natures - divine and human - without confusion, change, division, or separation (WCF 8.2). The <i>communicatio idiomatum</i> allows properties of both natures to be predicated of the one Person (Rom 9:5; John 1:1; Col 2:9). The divine nature remained infinite and immutable even in the incarnation (the <i>extra Calvinisticum</i>). Christ possesses a true human soul with a rational will (Luke 2:52; Phil 2:6–8).',k:['two natures','chalcedon','<i>communicatio idiomatum</i>','hypostatic union','<i>extra calvinisticum</i>'],cl:['simplicity','extra-calvinisticum','lords-supper','soul-body'],ct:'christology',hc:['Council of Chalcedon (451)','Apollinarian heresy','Nestorian heresy','Eutychian heresy','Lutheran-Reformed debates on <i>communicatio</i>']},
{id:'necessity-mediator',n:'Necessity & Qualifications of the Mediator',d:'Sin rendered mediation necessary: God\'s justice demands satisfaction, and man is unable to provide it (Rom 3:23–25; WCF 8.1). The Mediator must be God to bear infinite wrath, man to suffer in our nature, and both in one Person to unite the parties. He must be righteous to offer acceptable obedience and appointed by the Father (Heb 5:4–5; WCF 8.1–2).',k:['necessity','qualifications','mediator','satisfaction','justice','God-man'],cl:['sin','divine-righteousness','covenant-works','federal-headship'],ct:'christology'},
{id:'threefold-office',n:'The Threefold Office (Munus Triplex)',d:'Christ exercises His mediatorial work as Prophet revealing God\'s will (Deut 18:15; Acts 3:22; WCF 8.1), Priest offering Himself and making intercession (Heb 7:25; 9:14; WCF 8.1), and King ruling and defending His Church (Ps 2:6; Matt 28:18; WCF 8.1). These offices address humanity\'s threefold misery: ignorance, guilt, and bondage.',k:['munus triplex','prophet','priest','king','offices','mediator'],cl:['preaching-word','intercession-christ','church-government','kingdom-of-god'],ct:'christology'},
{id:'active-obedience',n:'Active Obedience',d:'Christ\'s perfect fulfillment of the entire moral law on behalf of His people - the positive righteousness imputed to believers in justification (Rom 5:19; Matt 5:17; WCF 8.5; 11.1). As the Second Adam and covenant surety, Christ merited eternal life by His lifelong obedience, satisfying the condition of the covenant of works for us.',k:['active obedience','law fulfillment','imputation','merit','second adam','positive righteousness'],cl:['justification','covenant-works','law','federal-headship','merit-covenant-works'],ct:'christology'},
{id:'passive-obedience',n:'Passive Obedience & Atonement',d:'Christ\'s voluntary submission to the penalty of the law - bearing divine wrath in His death on the cross (Isa 53:5–6; 1 Pet 2:24; WCF 8.5). Penal substitutionary satisfaction: He bore the punishment due to the elect, propitiated God\'s wrath (Rom 3:25), reconciled sinners (2 Cor 5:19), and redeemed from the curse (Gal 3:13). His sacrifice is of infinite value and definite in its intent and application (John 10:15; WCF 8.5; 8.8).',k:['passive obedience','atonement','penal substitution','satisfaction','propitiation','reconciliation','definite atonement'],cl:['justification','divine-righteousness','sin','definite-atonement','election'],ct:'christology'},
{id:'definite-atonement',n:'Definite Atonement',d:'Christ\'s death was intended by the Father and accomplished by the Son to effectually redeem all those given to Him (John 6:37–39; 10:11,15,26; 17:9; Eph 5:25; WCF 3.6; 8.5; 8.8). The atonement is sufficient for all and efficient for the elect. Christ purchased not merely the possibility but the certainty of salvation for His sheep.',k:['definite atonement','particular redemption','effectual','elect','intent','design'],cl:['election','pactum','perseverance','covenant-grace','intercession-christ'],ct:'christology',hc:['Synod of Dort (1618-1619) Canons II','Amyraldian controversy','Davenant hypothetical universalism debate']},
{id:'states-christ',n:'States of Humiliation & Exaltation',d:'Humiliation: incarnation, earthly suffering, death, burial, descent (WCF 8.4). Exaltation: resurrection vindicating His sacrifice (Rom 1:4; 4:25), ascension to heavenly kingship (Acts 1:9–11; Eph 1:20–22), session at the Father\'s right hand in intercession (Heb 7:25; WCF 8.4), and glorious return to consummate all things (Acts 1:11; WCF 8.4).',k:['humiliation','exaltation','resurrection','ascension','session','return'],cl:['resurrection-body','return-christ','eschatology','intercession-christ'],ct:'christology'},
{id:'intercession-christ',n:'The Intercession of Christ',d:'Christ\'s ongoing heavenly priesthood - He ever lives to make intercession for His people (Heb 7:25; Rom 8:34; 1 John 2:1; WCF 8.1). He appears in the presence of God on our behalf, presenting the merit of His finished work, securing perseverance, and applying His purchased benefits to every believer.',k:['intercession','heavenly priesthood','advocate','session','merit','application'],cl:['perseverance','assurance','prayer-theology','spirit-prayer'],ct:'christology'},
{id:'covenant-surety',n:'Christ the Covenant Surety',d:'Christ is the surety (guarantee) of a better covenant (Heb 7:22; WCF 8.1). In the <i>pactum salutis</i>, He undertook to fulfill all conditions of the covenant of works on behalf of the elect, assume their guilt, and secure their inheritance. His suretyship means that the covenant of grace cannot fail for any of its beneficiaries (Heb 9:15).',k:['surety','guarantee','covenant','<i>pactum salutis</i>','conditions','security'],cl:['pactum','covenant-grace','active-obedience','passive-obedience','federal-union-christ'],ct:'christology'},
{id:'extra-calvinisticum',n:'The <i>Extra Calvinisticum</i>',d:'The doctrine - affirmed by Calvin and the Reformed tradition against Lutheran Christology - that the eternal Son of God, even during and after the incarnation, continued to sustain and govern the universe beyond (extra) the human nature He assumed. The divine nature of Christ was never confined to or circumscribed by the human nature: "the Word became flesh" (John 1:14) without ceasing to be the infinite, omnipresent God who upholds all things by the word of His power (Heb 1:3; Col 1:17). Though called "Calvinisticum," this teaching is not a Calvinist innovation but reflects the catholic Christological consensus: it was taught by the church fathers, the ecumenical councils, and the medieval doctors before the Reformed tradition articulated it with special clarity . Calvin and the Reformed tradition hold that the finite cannot contain the infinite (<i>finitum non capax infiniti</i>): the human nature of Christ, being truly human and therefore finite, cannot possess the divine attributes of omnipresence, omniscience, or omnipotence. The incarnation is a true assumption of a complete human nature by the divine Person, not a fusion or mutual interpenetration of the two natures\' properties. Against the Lutheran doctrine of the <i>genus maiestaticum</i> - that the divine attributes (especially ubiquity) are really communicated to Christ\'s human nature - Calvin and the Reformed tradition maintain that the <i>communicatio idiomatum</i> is a predication of the properties of both natures to the one Person, not a transfer of divine properties into the human nature itself. Turretin defends this at length. The <i>extra Calvinisticum</i> preserves both the integrity of Christ\'s true humanity and the immutability of the divine nature, and has significant implications for the doctrine of the Lord\'s Supper (against Lutheran ubiquity) and for the proper understanding of Christ\'s heavenly session.',k:['<i>extra Calvinisticum</i>','<i>finitum non capax infiniti</i>','two natures','omnipresence','ubiquity','Lutheran','<i>communicatio idiomatum</i>','<i>genus maiestaticum</i>','catholic','incarnation','divine nature','human nature','Lord\'s Supper','heavenly session'],cl:['simplicity','two-natures','lords-supper','divine-infinity'],ct:'christology'},
{id:'anhypostasia-enhypostasia',n:'<i>Anhypostasia</i> & <i>Enhypostasia</i>',d:'Two complementary Christological principles that together safeguard the orthodox understanding of Christ\'s human nature within the hypostatic union. <i>Anhypostasia</i> (literally "without its own <i>hypostasis</i>") teaches that Christ\'s human nature never existed independently as its own person - it never had a separate human personhood or subsistence apart from the divine Person of the Son. The human nature of Christ was not a pre-existing human individual who was subsequently united to the Logos; rather, the human nature was assumed into personal existence by the eternal Son from the moment of conception (Luke 1:35). <i>Enhypostasia</i> (literally "in-personalized") is the positive complement: Christ\'s human nature has its personal subsistence in (en) the <i>hypostasis</i> of the divine Son - it is "enhypostasized" (in-hypostasized) in the Logos. The human nature is therefore not impersonal or abstract but fully personal, possessing its personhood in and through the divine Person who assumed it. Together these principles establish that: (1) there is only one Person in Christ - the eternal Son - not two persons (against Nestorianism); (2) the human nature is complete, real, and particular - not a generic humanity (against Apollinarianism); (3) the union is from conception, not a later joining of two pre-existing subjects; (4) the personal acts of Christ are the acts of the one divine Person acting in and through both natures. Turretin treats this under the hypostatic union. John of Damascus formalized the enhypostatic principle, and the Reformed orthodox tradition — Turretin, Bavinck, and the mainstream of post-Reformation Christology — consistently emphasizes that the human nature of Christ is real, complete, and particular even though it subsists in the <i>hypostasis</i> of the Logos rather than independently. This framework is essential for understanding how Christ can be truly and fully human while being only one Person.',k:['<i>anhypostasia</i>','<i>enhypostasia</i>','hypostatic union','person','nature','Logos','subsistence','Nestorianism','Apollinarianism','incarnation','one Person','two natures','conception','in-personalized'],ct:'christology'},
{id:'descensus',n:'The <i>Descensus</i> (Christ\'s State of Death)',d:'Christ continued in the state of the dead, and under the power of death, till the third day (WCF 8.4; WLC Q50; WSC Q27). The Reformed interpretation of Christ\'s \"descent\" is carefully distinguished from the Roman Catholic view of a literal descent into a locale (<i>limbus patrum</i>) to release OT saints. The Westminster Standards deliberately avoid the language of \"descended into hell\" (which appears in the Apostles\' Creed) and instead speak of Christ\'s \"being buried, and continuing under the power of death for a time\" (WSC Q27). WLC Q50 affirms that Christ\'s humiliation after death consisted \"in His being buried, and continuing in the state of the dead, and under the power of death till the third day; which hath been otherwise expressed in these words, He descended into hell.\" The \"otherwise expressed\" formulation indicates that the Standards interpret the creedal language as referring to the state of death itself, not to a literal journey to an underworld. The Reformed tradition has interpreted the descent clause as Christ\'s bearing the full weight of divine wrath and the torments of the damned in His soul \u2013 not in a post-mortem journey but in His suffering on the cross. Reformed scholastic theology carefully distinguishes multiple interpretive options and defends the view that Christ\'s soul was in a state of separation from the body, experiencing the power of death, while His divine Person sustained both natures. The theological significance is that Christ truly experienced the full reality of death on behalf of His people, entering the realm of death\'s dominion in order to destroy it from within (Heb 2:14\u201315; Acts 2:24,27,31). His body saw no corruption (Ps 16:10; Acts 2:31; 13:35\u201337), and His resurrection on the third day demonstrated His victory over death itself.',k:['<i>descensus</i>','descent','state of death','WCF 8.4','WLC Q50','WSC Q27','buried','power of death','third day','Apostles Creed','hell','humiliation','wrath','soul','body','Heb 2:14','Acts 2:24','Ps 16:10','corruption','victory','death'],cl:['death-intermediate','resurrection-eschatological-event'],ct:'christology'},
]},

{id:'prolegomena',n:'Prolegomena',ct:'prolegomena',c:'#70a0d0',r:1.5,o:10,
d:'The foundations of theology: the <i>principium essendi</i> is God Himself; the <i>principium cognoscendi externum</i> is Scripture; the <i>principium cognoscendi internum</i> is the Holy Spirit\'s illumination (1 Cor 2:10–14; WCF 1.6,10). Theology is a true science (<i>scientia</i>) grounded in divine self-revelation, not autonomous human speculation. All true knowledge of God is ectypal - derived and accommodated to the creature, never identical to God\'s own self-knowledge (archetypal theology). The archetypal/ectypal distinction is the epistemological corollary of the Creator-creature distinction. Because the self-contained ontological Trinity is the necessary presupposition of all intelligible thought, apologetic method flows necessarily from one\'s doctrine of God : it is not a strategic preference but a theological commitment. The presuppositional method is the only apologetic consistently grounded in the Reformed confession: it refuses the neutrality that autonomous reason demands and insists that the triune God is the transcendental precondition of logic, science, and morality. A METHODOLOGICAL NOTE ON PERSPECTIVAL HUMILITY: The systematic loci employed in this tool : prolegomena, theology proper, Christology, soteriology, etc. : are time-tested, confessionally grounded categories that organize the whole counsel of God for study and edification. But they are not identical to biblical reality itself. They are faithful creaturely approximations : theological perspectives on the inexhaustible truth of divine self-revelation, not the exhaustive map of that reality. As Vern Poythress argues, \"no category or system of categories gives us ultimate reality.. no single category, theme, or concept and no system of categories can furnish us with an infinitely deep analysis of the world.\" Technical theological terms (justification, sanctification, <i>perichoresis</i>, hypostatic union) are indispensable but imprecise tools: they genuinely grasp the realities they name, yet they carry fuzzy boundaries and can never replicate the infinite depth of God\'s own self-knowledge. The Bible\'s own diversity : four Gospels, prose and poetry accounts of the same events, law and wisdom and narrative and apocalypse : is itself divinely ordained multiperspectivalism, indicating that God intends His truth to be approached from multiple entry points, each illuminating what others leave implicit. This tool therefore presents its loci not as the final or only framework but as one faithful and comprehensive perspective on biblical reality : to be used alongside biblical-theological, redemptive-historical, and covenantal-canonical readings, all of which are complementary rather than competitive. The recognition that our systematic categories are ectypal : genuinely true but creaturely : is not epistemological skepticism but the epistemological corollary of the Creator-creature distinction applied to the theological enterprise itself. TRINITARIAN GROUNDING OF ALL KNOWLEDGE: Prolegomena is not a neutral preamble separable from the content of theology proper; it is itself Trinitarian from the ground up. John Frame demonstrates that \"perspectives in human knowledge imitate the Trinity\" : the normative, situational, and existential perspectives reflect the perichoretic coinherence of the divine Persons in the unity of the one divine essence. The Father is the authoritative source (normative), the Son is the Word who structures all reality (situational), and the Spirit is the one who applies and illumines (existential). Epistemology and theology proper are therefore not disconnected loci but organically inseparable: our ability to know anything at all : in theology, in science, in mathematics, in ethics : depends on the Trinitarian God who is the transcendental precondition of all intelligibility. The very structure of human knowing is patterned after the Trinitarian archetype, and this connection must be established in prolegomena rather than deferred to theology proper. Prolegomena also addresses faith and reason, the organic unity of general and special revelation (against autonomous Thomistic natural theology), the relationship between biblical and systematic theology, and the role of confessions as subordinate standards.',
k:['prolegomena','principia','theology','science','faith','reason','method','knowledge of God','dogmatics','perspectival humility','symphonic theology','Trinitarian epistemology','multiperspectivalism','ectypal','fuzzy boundaries','normative','situational','existential'],
cl:['scripture','god','trinity','revelation','presuppositional-apologetics','biblical-theology','christ'],
s:[
{id:'knowledge-god',n:'The Knowledge of God',d:'The highest knowledge, engaging the whole person - mind, heart, and will. Ectypal (derived, accommodated to creaturely capacity), never archetypal. The <i>semen religionis</i> and <i>sensus divinitatis</i> are implanted in every heart (Rom 1:19–21; Acts 17:27; WCF 1.1), yet insufficient for salvation without special revelation and the Spirit\'s work. Van Til holds that all human knowledge is analogical : a true but finite \"re-interpretation\" of God\'s original self-knowledge, never univocal with it. We think God\'s thoughts after Him, but always as creatures: derivatively, dependently, and within the limits of creaturely capacity. This does not mean our knowledge is merely approximate or unreliable : ectypal knowledge is genuine knowledge because God has truly revealed Himself : but it does mean that the Creator-creature distinction obtains epistemologically as well as ontologically (Deut 29:29; Isa 55:8–9; Rom 11:33–34). Against Clark\'s univocalism: if the content of human knowledge were qualitatively identical to divine knowledge, the Creator-creature distinction would collapse epistemologically. Against skepticism: because God has genuinely accommodated His self-revelation to the creature, ectypal knowledge is reliable, sufficient, and true (WCF 1.6–7). TRINITARIAN STRUCTURE OF KNOWING: John Frame has demonstrated that the very structure of human knowing reflects the Trinitarian being of God. Because man is made in the image of the triune God, human knowledge is inherently perspectival in a way that imitates the perichoretic coinherence of the divine Persons. The normative-situational-existential triad 2013 which Frame develops and extends 2013 is not merely a convenient heuristic but a reflection in creaturely knowing of the Trinitarian archetype: the Father as the authoritative source of all norms, the Son as the Logos who structures all situational reality, and the Spirit as the one who applies, illumines, and indwells the knowing subject. This means that epistemology and theology proper are not separable loci: the doctrine of God as triune is the ground and precondition of the doctrine of human knowledge, and any account of how we know that proceeds independently of the triune God who makes knowing possible is methodologically apostate from its inception. The implications extend beyond theology to every domain of human inquiry: because the triune God is the presupposition of all intelligibility, every act of knowing : in science, in history, in mathematics : covertly depends on the Trinitarian structure of reality, whether the knower acknowledges this or not.',k:['ectypal','archetypal','<i>semen religionis</i>','<i>sensus divinitatis</i>','accommodation','analogical','Creator-creature','re-interpretation','univocal','epistemological','Trinitarian epistemology','normative','situational','existential','perspectival','<i>perichoresis</i>','image of God','knowing'],cl:['divine-incomprehensibility','archetypal-ectypal','trinity','presuppositional-apologetics'],ct:'prolegomena'},
{id:'faith-reason',n:'Faith and Reason',d:'Properly ordered, not opposed. Reason serves as an instrument (<i>organon</i>), never the source (<i>principium</i>) of theology. Against rationalism, divine revelation is the foundation; against fideism, faith is intellectually coherent and rationally defensible. The natural man does not accept the things of the Spirit of God (1 Cor 2:14). Regeneration is prerequisite for true theological understanding (John 3:3; WCF 1.6). Crucially, reason is never neutral: it operates either in submission to the triune God as its precondition and norm, or in autonomous rebellion against Him. There is no \"bare reason\" that can be exercised in a vacuum apart from one\'s ultimate presuppositions about God, man, and the world. The Kantian and Thomistic traditions err in treating reason as an autonomous faculty capable of establishing theological truths independently of special revelation and regeneration. The Reformed position is that reason, as a creaturely gift, functions rightly only when it operates within the framework of divine self-revelation, thinking God\'s thoughts after Him analogically. Faith is therefore not irrational but supra-rational: it rests not on the conclusions of autonomous reasoning but on the self-authenticating testimony of God in His Word, sealed by the Holy Spirit (WCF 1.4–5).',k:['faith','reason','rationalism','fideism','<i>organon</i>','supra-rational','autonomy','neutral','presupposition','regeneration','noetic effects'],cl:['presuppositional-apologetics','total-depravity','spirit-illumination','natural-theology'],ct:'prolegomena'},
{id:'natural-theology',n:'Natural Theology',d:'Knowledge of God available through creation, conscience, and providence (Rom 1:19–20; 2:14–15; Ps 19:1–6; WCF 1.1; 21.1). Reveals God\'s existence, eternal power, divine nature, and moral demands : rendering all without excuse. Crucially, natural theology must not be understood in the Thomistic mode as an autonomous, pre-scriptural enterprise in which unregenerate reason, operating from a neutral standpoint, constructs valid demonstrations of God\'s existence apart from special revelation. Bavinck and Van Til insist on the organic unity of general and special revelation: even Adam in the garden received both simultaneously, and the two were never designed to function in isolation. In the fallen state, the knowledge of God through nature is genuinely revealed (it is objectively there in creation) but is universally and culpably suppressed in unrighteousness (Rom 1:18). The natural man does not lack evidence but lacks the willingness to acknowledge what the evidence declares (Rom 1:19–21). Natural theology therefore renders all without excuse but is insufficient for saving faith (WCF 1.1). The theistic proofs (cosmological, teleological, ontological, moral) articulate what creation objectively reveals, but they function truly only within the presuppositional framework of the self-attesting triune God : not as autonomous rational demonstrations from neutral common ground. The Reformed tradition affirms the reality of natural revelation while insisting that it can only be rightly received in the light of Scripture and the regenerating work of the Spirit. Reformed theology thus holds together the objective reality of general revelation and its subjective insufficiency in the hands of sinners who suppress it : a position distinct from both Thomistic natural theology (which grants too much to autonomous reason) and neo-orthodox rejection of natural theology (which denies the objective revelatory character of creation).',k:['natural theology','general revelation','theistic proofs','insufficiency','suppression','Rom 1:18','organic unity','autonomous reason','Thomistic','presuppositional','without excuse','creation','conscience','WCF 1.1'],cl:['gen-revelation','presuppositional-apologetics','creation','conscience'],ct:'prolegomena'},
{id:'archetypal-ectypal',n:'The Archetypal/Ectypal Distinction',d:'All human theology is ectypal - creaturely, derived, analogical - never identical to God\'s own self-knowledge (<i>theologia archetypa</i>). God knows Himself comprehensively, infinitely, and immediately; creatures know God only as He accommodates that knowledge to finite capacity (Deut 29:29; Isa 55:8–9; Rom 11:33–34). This distinction, developed by Junius, Turretin, and Bavinck, is the epistemological corollary of the Creator-creature distinction and the foundation of theological humility. Van Til and Frame hold it must be a foundational commitment of Reformed prolegomena: we think God\'s thoughts after Him analogically, never univocally. Against rationalism: human reason cannot penetrate to archetypal knowledge. Against skepticism: ectypal knowledge is genuine, reliable knowledge because God has truly revealed Himself.',k:['archetypal','ectypal','analogical','Creator-creature','accommodation','Junius','epistemological','humility'],cl:['divine-incomprehensibility','simplicity','knowledge-god'],ct:'prolegomena'},
{id:'bt-st-method',n:'Biblical Theology & Theological Method',d:'The relationship between biblical theology (the study of God\'s progressive self-revelation in its redemptive-historical development) and systematic theology (the logical organization of the whole counsel of God). Vos treats biblical theology as an <i>organon</i> of systematic theology; Gaffin holds programmatically that systematic theology must be informed by redemptive-historical insights, with the systematic theologian serving as "custodial interpreter of Scripture." The <i>sensus literalis</i> of Scripture in its canonical context governs dogmatic formulation. The theologian must attend to the unfolding drama of creation, fall, redemption, and consummation as the matrix within which doctrines are rightly understood. Contemporary Reformed dogmatics increasingly treat this as a standard prolegomenon topic. Gaffin sets out a chain in which biblical theology regulates exegesis, exegesis grounds systematic theology, and systematics coordinates the whole witness of Scripture. Vos was singular in his insistence that systematic theology must grow directly from meticulous biblical exegesis \u2013 not merely citing proof-texts but emerging from sustained engagement with the Hebrew and Greek text in its redemptive-historical context. He wrote that \"systematics becomes lifeless.. just to the extent to which it has become detached from exegesis,\" and that \"exegesis keeps systematics not only in direct contact with the Word but it ever imparts to systematics the power which is derived from that Word.\" This commitment means that every doctrinal formulation must remain open to revision by fresh exegetical work; no systematic presentation, however comprehensive, constitutes a closed grid immune to correction from the text of Scripture. The Reformed scholastic tradition provides indispensable conceptual precision and architectonic order, but \u2013 as Vos would insist \u2013 these categories serve exegesis rather than replace it, and must be continually tested against the living Word from which they derive their vitality. Vos holds this organic relationship between biblical and systematic theology with singular clarity. As Westminster\u2019s first president, Edmund Clowney held that exegesis was controlled by biblical theology, which in turn yielded the good fruits of systematics \u2013 neither discipline competing with the other but each serving the comprehensive witness of Scripture to Christ. Clowney\u2019s hermeneutical method traces thematic trajectories (temple, kingship, priesthood, exodus) from their Old Testament origins through their typological development to their climactic realization in Christ, demonstrating that biblical theology and systematic theology are not rival methods but complementary dimensions of the one theological task: understanding how the triune God has made Himself known in the history of redemption and organizing that knowledge for the edification of the church. Poythress\u2019s hermeneutical contribution reinforces and extends Clowney\'s: he argues that the three interpretive dimensions : grammatical-historical exegesis, biblical-theological reading within redemptive history, and systematic-theological reflection : are not three competing methods but three perspectives on the one interpretive task. Each perspective, when faithfully pursued, leads into and requires the other two. The systematic theologian who neglects the redemptive-historical shape of the text produces dead scholasticism; the biblical theologian who refuses to coordinate his findings with the whole counsel of God produces fragmented thematicism; the exegete who ignores both the redemptive-historical trajectory and the systematic coordination of doctrine produces atomistic verse-by-verse commentary with no architectonic vision. Poythress further demonstrates the organic integration of these three dimensions by showing how typological connections : which are discerned through careful exegesis (dimension 1), traced through redemptive history (dimension 2), and coordinated with the full scope of biblical doctrine (dimension 3) : constitute the divinely intended hermeneutical backbone of the Old Testament\'s witness to Christ.',k:['biblical theology','systematic theology','method','redemptive-historical','progressive revelation','custodial interpreter','<i>organon</i>','canonical','exegesis','open to revision','complementary','thematic trajectories','temple','kingship','priesthood','symphonic theology','threefold interpretive task','typological','three perspectives','grammatical-historical','systematic reflection'],cl:['interpretation','creation-to-consummation','biblical-theology','christ-old-testament'],ct:'prolegomena'},
{id:'confessions-standards',n:'Confessions as Subordinate Standards',d:'The Reformed confessions and catechisms (Westminster Standards, Three Forms of Unity, Second Helvetic Confession, etc.) serve as subordinate standards of faith - authoritative summaries of biblical teaching, binding on the church\'s officers and members, yet always subject to correction by Scripture itself (WCF 31.4; Acts 17:11). They are <i>norma normata</i> (a normed norm) under Scripture as <i>norma normans</i> (the norming norm). The church does not create doctrine by confessing but recognizes, guards, and transmits what Scripture teaches. Turretin treats this under fundamental articles; Bavinck treats it in his prolegomena on dogma and confession. The confessional principle expresses the church\'s corporate submission to Scripture and preserves doctrinal fidelity across generations.',k:['confessions','subordinate standards','<i>norma normata</i>','<i>norma normans</i>','Westminster','catechisms','binding','correction','church'],cl:['church','church-government','synods-councils','scripture'],ct:'prolegomena'},
{id:'presuppositional-apologetics',n:'Presuppositional Apologetics: The Consistently Reformed Method',d:'Apologetic method is not a matter of strategic preference but flows necessarily from one\'s doctrine of God. Van Til holds that apologetics \"stands at the outer edge of the circle of systematic truth given us by systematics in order to defend it\" : apologetics and systematic theology are inseparable, differing \"in emphasis rather than of subject matter.\" The self-contained ontological Trinity is the necessary presupposition of all intelligible thought: without the triune God of Scripture, the preconditions of logic, science, morality, and human experience cannot be accounted for. This is the transcendental argument for God (TAG). There is no neutral common ground between the regenerate and unregenerate mind (1 Cor 2:14; Rom 1:18–21; WCF 6.2–4; 9.3). The unbeliever suppresses the truth in unrighteousness (Rom 1:18) and can make any argument at all only by borrowing : inconsistently : from the Christian worldview he repudiates. The Christian faith as a whole, as a unit, must be set over against the non-Christian faith as a whole. Van Til argues that classical apologetics, while employed by men of genuine and unquestioned Reformed conviction — including B.B. Warfield, R.C. Sproul, and the Old Princeton theologians — fatally compromises Reformed theology at the methodological level by assuming the autonomy of human reason. (It should be noted that this is the Van Tilian assessment, not the unanimous Reformed position. WCF 1.1 itself — \"the light of nature, and the works of creation and providence, do so far manifest the goodness, wisdom, and power of God, as to leave men inexcusable\" — provides warrant for natural theology arguments within a theistic framework, and many theologians of impeccable Reformed orthodoxy have employed classical arguments without compromising their confessional commitments.) Van Til holds that this approach treats God\'s existence as a conclusion of probabilistic or demonstrative argument rather than its necessary foundation. This approach \"puts God in the dock\" by allowing the unregenerate mind to adjudicate God\'s existence from a supposedly neutral standpoint, and the god arrived at by Thomistic proofs is \"a god that accords with natural reason but not the God of the Bible\" : an abstract first cause, not the self-contained triune God of Scripture. The theistic proofs are not invalid in themselves but can function truly only when placed within the presuppositional framework: they demonstrate what the unbeliever already knows but suppresses (Rom 1:19–21), not what autonomous reason discovers from a neutral starting point. Frame\'s triperspectival appropriation acknowledges the theistic proofs as legitimate expressions of the normative, situational, and existential perspectives, while insisting they operate properly only within the presuppositional commitment to the triune God as the transcendental precondition of all intelligibility. Van Til and Frame provide the definitive articulations. Bavinck\'s organic motif on the self-authenticating character of revelation (<i>autopistia</i>), the noetic effects of sin, and the organic unity of general and special revelation deeply informs the presuppositional tradition. The WCF itself presupposes this method: Scripture is <i>autopiston</i> (1.4–5), the natural man cannot receive the things of the Spirit (1 Cor 2:14; WCF 1.6), and the <i>testimonium Spiritus Sancti internum</i> : not rational demonstration : is the ground of certainty (WCF 1.5). CHRIST\'S LORDSHIP OVER ALL KNOWLEDGE: Frame\'s \"Redeeming\" series extends the presuppositional insight to demonstrate that even seemingly \"secular\" academic disciplines covertly depend on divine attributes. The laws of logic reflect the self-consistency of God\'s own mind; the uniformity of nature presupposes the faithfulness of the covenanting God who sustains all things by the word of His power (Heb 1:3; Col 1:17); mathematical truths reflect the quantitative aspects of God\'s wisdom; sociological patterns reflect God\'s design for human community rooted in the image of the triune God; historical intelligibility presupposes God\'s sovereign governance of all events toward His purposed ends. This is Kuyper\'s vision made epistemologically rigorous: \"There is not a square inch in the whole domain of our human existence over which Christ, who is Sovereign over all, does not cry, Mine!\". The implication for systematic theology is that Christ\'s lordship must not be confined to the theological loci alone but recognized as extending to every area of human knowledge and endeavor. Every academic discipline, every cultural institution, every sphere of human thought operates within the framework established by the triune Creator-Redeemer, whether its practitioners acknowledge this or not (Rom 1:18-21; Col 1:15-20; 1 Cor 8:6).',k:['presuppositional','apologetics','transcendental','TAG','common ground','antithesis','autonomous reason','noetic effects','self-contained Trinity','precondition','intelligibility','classical apologetics','Thomistic','neutral','suppress','Rom 1:18','1 Cor 2:14','WCF 1.5','<i>autopistia</i>','method','systematic theology','lordship over all knowledge','Reformed','Christ lordship','every domain','science','mathematics','logic','sociology','philosophy','history'],cl:['trinity','total-depravity','sin','knowledge-god','faith-reason'],ct:'prolegomena'},
{id:'vantil-clark-controversy',n:'The Analogical Knowledge Debate',d:'A defining 20th-century debate within American Presbyterianism over the nature of human knowledge of God. Gordon Clark (ordained in the OPC in 1944 over protest) held that human knowledge and divine knowledge must overlap at points of identity - when a believer knows the proposition "God is sovereign," that proposition is qualitatively the same content known by God, though God knows it with greater comprehensiveness. Clark did not deny the Creator-creature distinction as such; rather, he denied that it entailed that no proposition could mean the same thing to God and man. His concern was that Van Til\'s position, taken to its logical conclusion, would render divine revelation unintelligible — a concern shared by some able Reformed thinkers. Van Til and his supporters (including Frame, Murray, and Stonehouse) objected that this collapsed the Creator-creature distinction epistemologically, arguing that all human knowledge is analogical - a true but creaturely reflection of God\'s archetypal knowledge, never univocal with it. Van Til holds that even true propositions known by man differ qualitatively from the same truths as known in God\'s mind, because God\'s knowledge is self-contained and comprehensive while human knowledge is derived, partial, and dependent. Clark responds that if no proposition means the same thing to God and man, then revelation fails to communicate and skepticism follows. The controversy touches the deepest issues in Reformed prolegomena: the archetypal/ectypal distinction, the nature of analogical knowledge, the possibility of genuine theological predication, and the relationship between divine incomprehensibility and human understanding (Deut 29:29; Isa 55:8-9; Rom 11:33). The OPC complaint against Clark was procedurally complex: the Presbytery of Philadelphia ordained Clark; the complaint was filed; the General Assembly sustained the complaint, though largely on procedural grounds, and did not directly adjudicate the theological substance of the controversy — which remained genuinely unresolved at the institutional level. Frame has attempted a mediating synthesis, affirming both genuine (not merely approximate) human knowledge and the qualitative Creator-creature distinction.',k:['controversy','analogical','univocal','knowledge','Creator-creature','epistemology','incomprehensibility','OPC','archetypal','ectypal','theological predication'],ct:'prolegomena'},
{id:'organic-motif',n:'The organic motif',d:'Bavinck\'s distinctive methodological contribution is the organic motif \u2013 the conviction that all doctrines are like organs in a living body, not bricks in a wall . Theology is not a mechanical assemblage of discrete propositions but a living organism in which every doctrine is vitally connected to every other. Christology, soteriology, ecclesiology, and eschatology are not independent departments but mutually interpenetrating realities, all pulsing with the life of the one redemptive purpose of the triune God. The organic motif governs Bavinck\'s entire system: creation is organically related to redemption; nature to grace; the individual to the community; the visible church to the invisible; protology to eschatology. Against the mechanical orthodoxy he saw in some post-Reformation scholasticism and the atomistic approach of Enlightenment theology, Bavinck holds that truth is a living whole \u2013 "the truth is a whole, it is organic, it lives" . This principle has methodological implications: the loci of systematic theology are not independent chapters but organically interconnected perspectives on the one counsel of God. Each doctrine illuminates and is illuminated by every other. SYMPHONIC THEOLOGY AND MULTIPERSPECTIVALISM: Poythress\u2019s \"symphonic theology\" develops Bavinck\'s organic insight in a distinctly presuppositional direction, drawing on the normative-situational-existential triad grounded in the Trinity\'s perichoretic coinherence. Where Bavinck speaks of organic unity, Poythress speaks of symphonic harmony: multiple theological themes, categories, and organizing systems each contribute genuine insight, like instruments in a symphony, but no single instrument \u2013 and no single organizing system \u2013 exhausts the whole score. Poythress\u2019s sixth maxim is architectonically significant: \"No category or system of categories gives us ultimate reality.. no single category, theme, or concept and no system of categories can furnish us with an infinitely deep analysis of the world.\" This does not relativize systematic categories but locates them rightly: they are faithful ectypal perspectives on biblical reality, indispensable for theological understanding, yet always pointing beyond themselves to the inexhaustible depth of God\'s own self-knowledge. The Bible\'s own diversity \u2013 four Gospels telling the same events from different vantage points, prose and poetry accounts of the same redemptive acts (Exodus 14\u201315; Judges 4\u20135), law and wisdom and narrative and apocalypse addressing the same realities \u2013 is divinely ordained multiperspectivalism, indicating that God intends His truth to be received through multiple complementary entry points. This tool\'s spatial visualization of doctrinal relationships \u2013 with its cross-references, interconnecting lines, and multiple navigational paths \u2013 embodies both Bavinck\'s organic motif and Poythress\u2019s symphonic principle: the connections between doctrines are as important as the doctrines themselves, and no single path through the constellation exhausts its meaning. The organic motif also serves as a secondary visualization principle: where the traditional loci method structures theology as a topical index, the organic motif restructures it as a living body in which the connections are as important as the nodes \u2013 every doctrine pulsing with interconnected life, growing from the same root (the self-revelation of the triune God) and oriented toward the same telos (the glory of God in the consummation). The supreme instantiation of this organic principle is the creation-to-consummation axis: creation, fall, redemption, and consummation are not isolated episodes but organically connected moments in the one purpose of the triune God, and every doctrine between protology and eschatology participates in this irreversible forward movement from Garden to Glory.',k:['organic motif','living organism','interconnected','holistic','mechanical','loci','method','nature and grace','prolegomena','truth is organic','visualization','connections','telos','creation-to-consummation','protology-eschatology','Garden to Glory','symphonic theology','multiperspectivalism','perspectives','fuzzy boundaries','entry points','Bible diversity','four Gospels'],cl:['bt-st-method','creation-to-consummation','biblical-theology'],ct:'prolegomena'},
]},

{id:'scripture',n:'Holy Scripture',ct:'prolegomena',c:'#70a0d0',r:1.6,o:9.5,
d:'The Word of God written - divinely authoritative, infallible, sufficient, perspicuous, and self-authenticating (<i>autopiston</i>) (2 Tim 3:16; 2 Pet 1:19–21; WCF 1.2–5). An organic whole whose central message is Christ (Luke 24:27; John 5:39). The <i>testimonium Spiritus Sancti internum</i> seals its authority upon the believing heart (1 John 2:20,27; WCF 1.5). Scripture is the <i>norma normans</i> - the supreme judge of all controversies (WCF 1.10).',
k:['scripture','word of god','authority','inspiration','infallibility','inerrancy','sufficiency','perspicuity','canon','<i>testimonium</i>','<i>autopiston</i>','<i>sola scriptura</i>'],
cl:['prolegomena','revelation','holy-spirit','christ','church','spirit-scripture','spirit-testimonium','inerrancy','canon','interpretation','means-grace','salvation'],
s:[
{id:'inspiration',n:'Inspiration',d:'The organic view: the Holy Spirit guided human authors using their personalities and styles to write exactly what God intended (2 Pet 1:21; 2 Tim 3:16). <i>Theopneustos</i> — God-breathed — is passive in force: Scripture is the product of God\'s expiration (breathing out), not the object of His inhalation (breathing into). The term affirms that Scripture originates from God, not that God subsequently inspired an existing text. Warfield\'s classic essay on this term remains definitive. Verbal (extending to the words) and plenary (extending to all parts). Not mechanical dictation but organic superintendence (WCF 1.2).',k:['inspiration','<i>theopneustos</i>','organic','verbal','plenary','god-breathed'],cl:['spirit-scripture','inerrancy','divine-veracity'],ct:'prolegomena'},
{id:'authority-scripture',n:'Authority of Scripture',d:'<i>Autopiston</i> - self-authenticating (WCF 1.4). The <i>testimonium Spiritus Sancti internum</i> persuades believers of its divine authority (WCF 1.5). The <i>norma normans</i> - the supreme judge of all controversies in faith and life (WCF 1.10). Scripture does not derive authority from the church but from God its author (WCF 1.4). <i>Sola Scriptura</i>: Scripture alone is the rule of faith and practice.',k:['authority','<i>autopiston</i>','<i>testimonium</i>','<i>norma normans</i>','<i>sola scriptura</i>'],cl:['spirit-testimonium','church','confessions-standards','preaching-word'],ct:'prolegomena'},
{id:'sufficiency',n:'Sufficiency & Perspicuity',d:'Contains all things necessary for God\'s glory, man\'s salvation, faith, and life (WCF 1.6). Nothing may be added by new revelations or human traditions. Its essential message is clear enough for ordinary believers using ordinary means, with the Spirit\'s aid (WCF 1.7). Not all parts are equally clear, yet all things necessary for salvation are sufficiently plain (2 Pet 3:16; Ps 119:105,130).',k:['sufficiency','perspicuity','clarity','accessible'],cl:['necessity-scripture','regulative-principle'],ct:'prolegomena'},
{id:'canon',n:'The Canon',d:'The sixty-six books recognized (not created) by the church as the complete Word of God (WCF 1.2-3). Canonical authority is intrinsic to the books themselves, not conferred by ecclesiastical decision - the church\'s role is ministerial (recognizing what God has given), not magisterial (creating authority). The Old Testament canon was progressively recognized as Moses, the prophets, and the wisdom writers produced inspired Scripture under the Spirit\'s superintendence. By the time of Christ, the Hebrew canon of 39 books (Law, Prophets, Writings) was substantially settled, as attested by Christ\'s own usage (Luke 24:44; Matt 23:35 spanning Genesis to Chronicles). The NT authors cite the OT as authoritative Scripture throughout. The New Testament canon emerged as the apostles and their associates wrote under divine inspiration. The early church recognized apostolicity (direct or delegated), catholicity (universal reception), orthodoxy (doctrinal consistency), and the internal witness of the Spirit as marks of canonicity. The major canonical lists (Muratorian Fragment, c. 170; the 39th Festal Letter, 367; Councils of Hippo, 393, and Carthage, 397) did not create the canon but formally recognized what the church had already received. Turretin argues extensively that the church did not give Scripture its authority but acknowledged the authority Scripture already possessed from God. The Apocrypha are of no authority in the church of God nor to be any otherwise approved or made use of than other human writings (WCF 1.3). Bavinck treats the canonical process as a work of providence, the Spirit guiding the church to recognize His own Word.',k:['canon','sixty-six','apostolicity','recognition','apocrypha','OT canon','NT canon','Muratorian','Hippo','Carthage','ministerial','magisterial','canonical process','marks of canonicity'],cl:['church'],ct:'prolegomena',hc:['Marcionite heresy (c. 144)','Council of Trent Session 4 (1546) on Apocrypha','Protestant-Roman canon dispute','Reformation <i>sola Scriptura</i> debates']},
{id:'scripture-self-attestation',n:'Scripture\'s Self-Attestation (<i>Autopiston</i>)',d:'Scripture is <i>autopiston</i> - self-authenticating, bearing within itself the marks of its divine origin and authority (WCF 1.4-5). The ground of our believing Scripture to be the Word of God is not primarily the testimony of the church, the evidence of historical criticism, or rational demonstration, but the inherent qualities of Scripture itself (the heavenliness of the matter, the efficacy of the doctrine, the majesty of the style, the consent of all its parts, the scope of the whole to give all glory to God, the full discovery it makes of the only way of man\'s salvation) together with the internal testimony of the Holy Spirit bearing witness by and with the Word in our hearts (WCF 1.5; 1 John 2:20,27; 1 Cor 2:10-12). Calvin holds this principle against Rome\'s claim that Scripture derives its authority from the church: the church does not authenticate Scripture but is built upon it. Turretin distinguishes between the <i>autopistia</i> of Scripture (its self-authenticating character) and the means by which believers come to recognize that authority (the <i>testimonium Spiritus Sancti internum</i>). Bavinck treats Scripture\'s self-attestation as integral to the doctrine of its authority: because Scripture is God-breathed, it carries its own credentials and needs no external validation. The indicia (marks) of divinity in Scripture are real and objective, but they are savingly perceived only through the Spirit\'s illuminating work. This doctrine stands against both Roman Catholic ecclesiastical positivism (the church gives Scripture its authority) and Enlightenment evidentialism (reason establishes Scripture\'s authority).',k:['<i>autopiston</i>','self-authenticating','self-attestation','WCF 1.4','WCF 1.5','<i>testimonium</i>','indicia','marks','church','authority','internal testimony','heavenliness','majesty','efficacy'],ct:'prolegomena'},
{id:'interpretation',n:'Interpretation & Hermeneutics',d:'Scripture interprets Scripture (WCF 1.9). The analogy of faith (<i>analogia fidei</i>): the infallible rule of interpretation is Scripture itself. Grammatical-historical method, attention to context, genre, and the unity of Old and New Testaments in the one covenant of grace. When a passage admits of multiple senses, the sense most agreeable to other places should prevail (WCF 1.9; Luke 24:27,44). THE THREEFOLD INTERPRETIVE TASK: Frame, building on the Westminster tradition from Vos through Clowney, insists that faithful interpretation requires the integration of three complementary dimensions: (1) Historical-grammatical exegesis \u2013 attending to the text in its original linguistic, literary, and historical context, establishing what the human author communicated to his original audience under the Spirit\'s inspiration. This is the foundational discipline: no biblical-theological or systematic-theological conclusion can stand that contradicts the grammatical-historical sense of the text in its canonical context. (2) Biblical-theological reading within redemptive history \u2013 locating each text within the unfolding drama of God\'s progressive self-revelation from creation through fall, covenant, exodus, exile, and return to Christ and consummation. Every text has a redemptive-historical address: it occurs at a particular stage in the <i>historia salutis</i>, and its full significance is grasped only when its place in that trajectory is understood. This includes the discernment of typology \u2013 the divinely intended patterns by which earlier persons, events, and institutions in redemptive history prefigure and anticipate their escalated fulfillment in Christ and the new covenant (Rom 5:14; 1 Cor 10:6,11; Heb 8\u201310). (3) Systematic-theological reflection \u2013 coordinating the exegetical and biblical-theological findings with the whole counsel of God, employing the conceptual precision of the Reformed dogmatic tradition to articulate what Scripture teaches on any given topic across the entire canon. These three dimensions are not three competing methods but three aspects of the one interpretive task: each one, when faithfully pursued, includes and requires the other two (cf. Gaffin ; Clowney\'s hermeneutical method). BIBLICAL TYPOLOGY: G.K. Beale provides the most comprehensive contemporary Reformed framework for understanding how the OT points to Christ. Against reductionistic approaches that treat typology as a simple one-to-one prophecy-fulfillment scheme (type A predicts antitype B), Beale demonstrates that typological connections are multi-layered, operating simultaneously along several axes: (a) the Christological axis \u2013 OT types prefigure Christ\'s person and work (Adam, Melchizedek, Moses, David, the temple, the sacrificial system); (b) the ecclesiological axis \u2013 types prefigure the church as the eschatological people of God (Israel as firstborn son, the exodus, the assembly at Sinai); (c) the consummation axis \u2013 types prefigure the new creation and the eschatological state (the land, the Sabbath, the Edenic temple). Typological connections also operate at multiple levels of generality: individual persons, corporate entities, institutions, events, and the overall pattern of the redemptive-historical narrative itself. Beale holds that these typological patterns are grounded in God\'s sovereign design of history, not in the interpreter\'s ingenuity, and that they are discerned by attending to the canonical context and the inner-biblical development of themes across the testaments. The typological method is therefore not a supplement to grammatical-historical exegesis but its organic extension \u2013 the same God who inspired each text also designed the historical patterns to which the texts bear witness, and both the text and the pattern point to Christ (Luke 24:27,44; John 5:39,46).',k:['hermeneutics','analogy of faith','grammatical-historical','typology','progressive revelation','threefold interpretive task','redemptive-historical','biblical theology','systematic theology','Christological','ecclesiological','consummation','multi-layered','canonical context','inner-biblical','Luke 24:27','John 5:39','exegesis','WCF 1.9'],cl:['bt-st-method','christ-old-testament','spirit-illumination','confessions-standards'],ct:'prolegomena'},
{id:'necessity-scripture',n:'Necessity of Scripture',d:'Although general revelation makes God known, it is not sufficient for saving knowledge (WCF 1.1). The former ways of God\'s revealing His will (prophecy, theophany) have ceased, making the Scriptures most necessary (WCF 1.1; Heb 1:1–2). Without Scripture the church has no certain foundation for doctrine, worship, government, or discipline.',k:['necessity','saving knowledge','revelation ceased','foundation'],ct:'prolegomena'},
{id:'inerrancy',n:'Inerrancy & Infallible Truth',d:'Scripture is entirely true and trustworthy in all that it affirms - free from all falsehood, fraud, or deceit (WCF 1.5; Ps 119:160; John 17:17; Prov 30:5). The WCF speaks of the "infallible truth" of Scripture (1.5) and its character as "the Word of God written" (1.2). In the modern context, the 1978 Chicago Statement on Biblical Inerrancy articulated this doctrine with precision: Scripture is without error in all its teaching, including what it states about God\'s acts in creation, the events of world history, and its own literary origins. Inerrancy is a property and consequence of inspiration: because God is truthful (Titus 1:2) and Scripture is God-breathed (2 Tim 3:16), Scripture necessarily shares in the divine attribute of veracity. This doctrine does not require a wooden literalism but recognizes the use of figures of speech, approximation, observational language, and literary genre. Inerrancy is foundational to the authority of Scripture and the certainty of all doctrine derived from it.',k:['inerrancy','infallible','truth','Chicago Statement','trustworthy','without error','veracity','inspiration','WCF 1.5','Ps 119:160'],cl:['inspiration','divine-veracity','authority-scripture'],ct:'prolegomena'},
]},

{id:'god',n:'The Being & Attributes of God',ct:'theology_proper',c:'#dcc050',r:1.7,o:8.5,
d:'God is the infinite, eternal, unchangeable Spirit - perfect in all attributes, utterly self-sufficient (Exod 3:14; Isa 40:28; WCF 2.1). He is simple (not composed of parts), His attributes identical with His essence (WCF 2.1). There is but one only living and true God (Deut 6:4; 1 Cor 8:4; WCF 2.1), who is most holy, most wise, most free, most absolute, working all things according to the counsel of His own immutable and most righteous will (Eph 1:11).',
k:['God','essence','attributes','simplicity','aseity','infinity','eternity','immutability','omnipresence','omniscience','omnipotence','holiness','justice','goodness','incomprehensibility','love','grace','mercy','blessedness','righteousness'],
cl:['trinity','decree','prolegomena','christ','creation','simplicity','aseity','providence','revelation','law','sin','salvation','eschatology'],
s:[
{id:'simplicity',n:'Divine Simplicity',d:'God is not composed of parts - His attributes are identical with His essence (WCF 2.1). Simplicity guards all other attributes: if composed, God would depend on His parts. He is actus purus (pure act), with no potentiality. In God there is no distinction between His being and His attributes. He does not have goodness; He is goodness (Exod 3:14; John 4:24).',k:['simplicity','actus purus','composition','essence','unity'],cl:['aseity','trinity'],ct:'theology_proper'},
{id:'aseity',n:'Divine Aseity & Independence',d:'God exists by the necessity of His own nature - a se (from Himself). The uncaused cause, the I AM (Exod 3:14; WCF 2.2). All that God is and has, He has from Himself. He is the fountain of all being, life, glory, blessedness (Acts 17:24–25; Rom 11:36). Foundation of the Creator-creature distinction and absolute sovereignty.',k:['aseity','self-existence','independence','I AM','creator-creature'],cl:['creation','simplicity','covenant-condescension'],ct:'theology_proper'},
{id:'immutability',n:'Immutability & Impassibility',d:'God does not change in being, perfections, purposes, or promises (Mal 3:6; Jas 1:17; WCF 2.1). With Him there is no variation or shadow due to change. Not subject to involuntary emotional change from creatures, though not rendered unfeeling - His affections are eternally perfect and self-determined (Num 23:19; Ps 102:26–27).',k:['immutability','impassibility','constancy','faithfulness','eternal'],cl:['decree','perseverance','covenant-grace'],ct:'theology_proper'},
{id:'divine-knowledge',n:'The Knowledge of God',d:'God\'s knowledge is infinite, perfect, and immediate (Ps 147:5; Heb 4:13; WCF 2.2). <i>Scientia</i> necessaria: God\'s knowledge of Himself and all possibilities. <i>Scientia</i> libera: God\'s knowledge of all actualities flowing from His decree. Against the Jesuit middle knowledge (<i>scientia</i> media), God\'s knowledge of what free creatures would do is grounded not in their autonomous choices but in His sovereign decree (Isa 46:10; Acts 15:18).',k:['omniscience','<i>scientia</i> necessaria','<i>scientia</i> libera','middle knowledge','foreknowledge'],cl:['decree','election','providence'],ct:'theology_proper'},
{id:'communicable',n:'Communicable Attributes',d:'Perfections with creaturely analogy: knowledge, wisdom, goodness, love, grace, mercy, longsuffering, holiness, righteousness, wrath (WCF 2.1–2). These are reflected finitely in the image of God. God is love (1 John 4:8), light (1 John 1:5), holy (Isa 6:3), righteous (Ps 145:17), jealous for His own glory (Exod 34:14). These are known to creatures analogically, never univocally.',k:['communicable','knowledge','wisdom','goodness','love','grace','mercy','holiness','righteousness','wrath','omniscience'],ct:'theology_proper'},
{id:'incommunicable',n:'Incommunicable Attributes',d:'Perfections with no creaturely analogy: independence (aseity), immutability, infinity, eternity, simplicity, omnipresence (WCF 2.1–2). The absolute Creator-creature distinction means these perfections cannot be shared. God is infinitely above all that which any creature can comprehend (Isa 40:25; Rom 11:33–36). These define the gulf between the Creator and the creature.',k:['incommunicable','transcendence','wholly other','distinction'],ct:'theology_proper'},
{id:'divine-will',n:'The Will of God',d:'Decretive will (voluntas decreti): sovereign, efficacious, always accomplished (Isa 46:10; Eph 1:11; WCF 3.1). Preceptive will (voluntas praecepti): revealed moral commands which may be disobeyed (Matt 23:37; 1 Thess 4:3). Not contradictory - operating at different levels. God\'s secret will determines what comes to pass; His revealed will prescribes duty (Deut 29:29).',k:['will','decretive','preceptive','sovereignty','efficacious','secret','revealed'],cl:['decree','law','free-offer-gospel','providence'],ct:'theology_proper'},
{id:'names-god',n:'The Names of God',d:'Elohim (God as mighty Creator), YHWH (the self-existent covenant Lord), Adonai (Sovereign Master), El Shaddai (God Almighty) - genuine revelations of character, not arbitrary labels (Exod 3:14–15; 6:3; Gen 17:1). YHWH reveals God as self-existent, faithful, and covenant-keeping (Exod 34:6–7). His name is holy and reverend (Ps 111:9; WCF 21.2).',k:['names','YHWH','Elohim','Adonai','El Shaddai','covenant'],ct:'theology_proper'},
{id:'divine-infinity',n:'Eternity, Infinity, & Omnipresence',d:'God is without bounds or limits (1 Kgs 8:27; Ps 139:7–10; WCF 2.1). He is eternal - without beginning or end, not subject to time (Ps 90:2; 2 Pet 3:8). He is everywhere present (Jer 23:23–24; Acts 17:28) yet not diffused through space. His infinity is not quantitative but qualitative - He transcends all spatial and temporal limitation.',k:['eternity','infinity','omnipresence','immensity','timelessness'],ct:'theology_proper'},
{id:'omnipotence',n:'Divine Omnipotence',d:'God is almighty - able to do all things consistent with His nature and perfections (Gen 17:1; Jer 32:17; Matt 19:26; WCF 2.1; 5.1). His power is infinite, never exhausted, and the ground of all creaturely existence and operation. He works all things according to the counsel of His own will (Eph 1:11). Omnipotence does not extend to what is self-contradictory or contrary to His holy nature (2 Tim 2:13; Titus 1:2; Heb 6:18). He cannot deny Himself.',k:['omnipotence','almighty','power','sovereignty','El Shaddai','ability'],ct:'theology_proper'},
{id:'divine-veracity',n:'Divine Veracity (Truth)',d:'God is the God of truth (Deut 32:4; Ps 31:5; John 14:6). WCF 2.1 lists God as "abundant in goodness and truth." Turretin identifies three aspects of God\'s veracity: (1) metaphysical truth - God is the true God as distinguished from all false gods, His being and knowledge perfectly correspond to reality; (2) ethical truth (faithfulness, fidelity) - He is faithful to His promises, His covenant cannot fail (Num 23:19; 2 Tim 2:13; Heb 6:18); (3) logical truth - God knows things as they truly are, and His revelation is perfectly reliable. God cannot lie (Titus 1:2; Heb 6:18). His veracity grounds the trustworthiness of Scripture, the certainty of His promises, and the reliability of all His self-revelation. It is the foundation of human truthfulness (Ninth Commandment) and the basis of all lawful oaths and vows (WCF 22.1).',k:['veracity','truth','faithfulness','fidelity','metaphysical','ethical','logical','Titus 1:2','Heb 6:18','WCF 2.1','promises','trustworthiness'],cl:['inerrancy','inspiration','covenant-grace','oaths-vows'],ct:'theology_proper'},
{id:'divine-goodness',n:'Divine Goodness',d:'God is good, and He does good (Ps 119:68; Ps 145:9; Mark 10:18; WCF 2.1). Goodness is not an attribute alongside others but, by divine simplicity, identical with the divine essence itself. Turretin treats goodness as the comprehensive perfection under which love, grace, mercy, and patience are grouped as specific modes of divine goodness directed toward different objects and conditions. Turretin argues that God is the <i>summum bonum</i> - the highest good, the fountain of all creaturely good, and the final end of all desire. Bavinck treats divine goodness as the ground of creation: God creates not from need but from the overflow of His perfect goodness, communicating being and blessedness to creatures . Calvin opens with the claim that knowledge of God includes knowing Him as "the fountain of every good" - the one from whom we receive all things. God\'s goodness is universal in its benevolent reach (Matt 5:45; Acts 14:17; Ps 145:9) yet particular in its saving application to the elect (Rom 8:28; Ps 73:1). It grounds the doctrines of creation, providence, common grace, and the covenant itself (WCF 7.1).',k:['goodness','<i>summum bonum</i>','benevolence','Ps 119:68','Ps 145:9','fountain','creation'],cl:['common-grace','creation','providence'],ct:'theology_proper'},
{id:'divine-love',n:'Divine Love',d:'God is love (1 John 4:8,16). His love is not a reaction to creaturely worth but an eternal, self-determined, sovereign perfection (Deut 7:7\u20138; Rom 9:13; Eph 1:4\u20135). Turretin distinguishes: (1) the intra-Trinitarian love of complacency among the Persons (John 3:35; 17:24), which is the ontological foundation of all love; (2) the love of benevolence toward creatures generally (John 3:16; Matt 5:44\u201345); and (3) the electing love of complacency toward His people in Christ (Jer 31:3; Rom 8:35\u201339; Eph 2:4\u20135). Turretin identifies divine love as the perfection that moves God to communicate Himself and His goodness to creatures. Bavinck holds God\'s love as inseparable from His justice: it is not sentimental indulgence but holy love that is satisfied only through the cross (Rom 5:8; 1 John 4:10). Against modern sentimentalism, Reformed theology insists that God\'s love never operates apart from His holiness, justice, and wisdom. The love of God is the ultimate source of election, the covenant of grace, the gift of the Son, and the mission of the Spirit (John 3:16; Rom 5:5; 8:32; Gal 2:20).',k:['love','1 John 4:8','complacency','benevolence','electing love','intra-Trinitarian','sovereign','holy','cross','election','covenant'],cl:['election','covenant-grace','definite-atonement','pactum'],ct:'theology_proper'},
{id:'divine-grace',n:'Divine Grace & Mercy',d:'Grace (<i>gratia</i>) is God\'s free, unmerited favor toward those who deserve only condemnation (Eph 2:8\u20139; Rom 3:24; 11:6; Titus 2:11; WCF 7.3). Mercy (<i>misericordia</i>) is God\'s goodness directed toward those in misery and distress - His compassionate disposition to relieve the wretched (Exod 34:6\u20137; Ps 103:8\u201313; Eph 2:4; Titus 3:5; Lam 3:22\u201323). Turretin treats grace and mercy as distinct modes of divine goodness: grace addresses guilt (demerit), while mercy addresses misery (affliction). Bavinck insists that both are free and sovereign, never compelled by creaturely need. Turretin locates grace and mercy within the broader perfection of divine love, as love expressing itself toward sinful and suffering creatures respectively. Bavinck holds that grace is the foundation of the entire covenant of grace: apart from divine favor freely bestowed, sinners have no claim on God and no hope . Turretin and Bavinck distinguish common grace (non-saving, universal) from special or saving grace (effectual, particular to the elect). God\'s patience (longsuffering, <i>makrothumia</i>) is closely related: He endures with much patience vessels of wrath prepared for destruction (Rom 9:22; 2 Pet 3:9,15), giving space for repentance while His eternal purposes unfold (Rom 2:4).',k:['grace','mercy','<i>gratia</i>','<i>misericordia</i>','unmerited','free','compassion','longsuffering','patience','<i>makrothumia</i>','Exod 34:6','common grace','special grace','sovereign','covenant'],cl:['salvation','common-grace','calling-regen','justification'],ct:'theology_proper'},
{id:'divine-holiness',n:'Divine Holiness',d:'Holy, holy, holy is the LORD of hosts (Isa 6:3; Rev 4:8; WCF 2.1). Holiness is the attribute Bavinck treats as most fundamental to the divine character - the majestic purity that sets God infinitely apart from all creation and all sin. Turretin identifies two aspects: (1) God\'s absolute transcendence and separation from all that is creaturely and sinful - His majestic otherness (Exod 15:11; 1 Sam 2:2; Isa 57:15); and (2) His moral perfection and self-affirming righteousness by which He maintains His own honor and demands conformity to His character (Lev 19:2; 1 Pet 1:15\u201316; Hab 1:13). Turretin treats holiness as the rule and measure of all moral goodness, arguing that God does not conform to an external standard of holiness but is Himself the standard. Bavinck writes that holiness is "the very being of God" in His ethical self-affirmation: God is committed to His own glory, His own name, and His own moral perfection above all things. Holiness grounds the necessity of the atonement (God cannot overlook sin, Hab 1:13; Rom 3:25\u201326), the call to sanctification (Lev 11:44; 1 Thess 4:3\u20137), the wrath of God against sin, and the worship of the church (Ps 99:5,9). It pervades every doctrine: God\'s law is holy (Rom 7:12), His covenant is holy, His people are called to be holy, and the eschatological goal is a creation in which holiness dwells (2 Pet 3:13).',k:['holiness','<i>qadosh</i>','transcendence','purity','majestic','separation','moral perfection','Isa 6:3','Hab 1:13','atonement','sanctification','glory','worship'],cl:['sin','passive-obedience','sanctification','worship'],ct:'theology_proper'},
{id:'divine-righteousness',n:'Divine Righteousness & Justice',d:'Righteous is the LORD in all His ways (Ps 145:17; Deut 32:4; Rom 3:25\u201326; WCF 2.1). Turretin distinguishes: (1) rectoral (legislative) justice - God as the supreme Lawgiver imposing righteous laws with sanctions (Ps 99:4; Isa 33:22; Jas 4:12); (2) distributive justice, comprising both remunerative justice (rewarding obedience, Deut 7:9,12\u201313; Ps 58:11; 2 Thess 1:6\u20137) and retributive (punitive) justice (punishing transgression, Exod 34:7; Rom 1:32; 2:5\u20136; 2 Thess 1:8). Turretin argues that retributive justice is not merely an exercise of divine will but a necessary perfection of the divine nature: God must punish sin because His nature demands it, not because He arbitrarily chooses to. This is the foundation of the necessity of the atonement - God cannot simply forgive sin without satisfaction, for to do so would deny His own righteousness (Rom 3:25\u201326). Bavinck identifies justice as the self-maintenance of God\'s holiness in relation to creatures. Bavinck holds that God\'s mercy and justice are not in tension but perfectly harmonized at the cross: the same act that displays infinite mercy also satisfies infinite justice (Rom 3:26). Divine justice also grounds the final judgment (Acts 17:31), the imputation of sin to Christ (2 Cor 5:21), and the imputation of righteousness to believers (Rom 4:5\u20136). It is the foundation of all creaturely justice, civil government (Rom 13:1\u20134), and the moral law.',k:['righteousness','justice','rectoral','distributive','remunerative','retributive','punitive','necessity of atonement','satisfaction','Ps 145:17','Rom 3:25','imputation','cross','moral law','final judgment'],cl:['justification','passive-obedience','final-judgment','law','necessity-mediator'],ct:'theology_proper'},
{id:'divine-incomprehensibility',n:'Divine Incomprehensibility',d:'O the depth of the riches and wisdom and knowledge of God! How unsearchable are His judgments and how inscrutable His ways! (Rom 11:33; Job 11:7\u20139; Ps 145:3; Isa 40:28; WCF 2.1). God is truly and reliably known through His self-revelation, yet never exhaustively comprehended by any finite mind. Bavinck devotes sustained attention to this doctrine: God can be known (<i>cognoscibilis</i>) but not comprehended (<i>comprehensibilis</i>). To know God truly is not to know Him totally. The incomprehensibility of God is the epistemological corollary of His infinity: as His being is without limits, so His being exceeds the capacity of any creaturely intellect (1 Cor 13:12; 1 Tim 6:16). Bavinck treats incomprehensibility as foundational to all theology: it establishes the posture of reverence, humility, and adoration that must characterize every theological enterprise. Calvin opens with the overwhelming majesty of God that reduces the creature to humble dependence on revelation. Against rationalism, incomprehensibility means that human reason can never master divine truth; against agnosticism, it affirms that ectypal knowledge, though finite and analogical, is genuine and sufficient for faith and godliness (Deut 29:29; 2 Pet 1:3). The glorified saints will know God more fully but never comprehensively - the beatific vision is an ever-deepening, never-exhausting knowledge of the infinite God (1 John 3:2; 1 Cor 13:12).',k:['incomprehensibility','mystery','unsearchable','Rom 11:33','Job 11:7','Ps 145:3','<i>cognoscibilis</i>','<i>comprehensibilis</i>','infinity','humility','reverence','ectypal','beatific vision','rationalism','agnosticism'],cl:['archetypal-ectypal','knowledge-god','beatific-vision'],ct:'theology_proper'},
{id:'divine-blessedness',n:'Divine Blessedness',d:'The blessed and only Sovereign, the King of kings and Lord of lords, who alone has immortality (1 Tim 6:15\u201316; 1 Tim 1:11). God is infinitely blessed in Himself - perfectly happy, perfectly satisfied, perfectly complete in the eternal enjoyment of His own infinite perfections and the communion of the three Persons (Ps 16:11; Acts 17:25). Turretin treats divine blessedness (<i>beatitudo Dei</i>) as a distinct attribute: God possesses in Himself the fullness of all good and is the source of all blessedness in creatures. He derives nothing from creatures and would be no less blessed had He never created (Job 35:6\u20137; Acts 17:25). Bavinck identifies blessedness as the perfection in which all other attributes find their repose: God\'s infinite knowledge, holiness, love, and power are not burdens but the content of His eternal joy. Divine blessedness grounds the doctrine of divine aseity (God needs nothing), the gratuity of creation (God creates freely, not from lack), and the ultimate telos of humanity: the chief end of man is to glorify God and enjoy Him forever (WSC Q1), reflecting back in creaturely fashion the blessedness that God possesses infinitely in Himself. The glorification of the saints is participation in the blessedness of God - entering into the joy of the Lord (Matt 25:21,23).',k:['blessedness','beatitudo','happiness','self-sufficiency','joy','1 Tim 6:15','aseity','glory','WSC Q1','telos','glorification','intra-Trinitarian'],cl:['glorification','chief-end','beatific-vision'],ct:'theology_proper'},
]},

{id:'trinity',n:'The Holy Trinity',ct:'theology_proper',c:'#dcc050',r:1.65,o:7.5,
d:'One God eternally exists in three distinct Persons - Father, Son, Holy Spirit - same in substance, equal in power and glory (Matt 28:19; 2 Cor 13:14; WCF 2.3). The Trinity is not merely one doctrine among many but the heart and foundation of every locus of systematic theology: every other doctrine : creation, providence, covenant, redemption, ecclesiology, eschatology : is Trinitarian in structure and cannot be rightly understood apart from the triune being of God. Works <i>ad extra</i> are undivided (<i>opera trinitatis ad extra indivisa</i>), yet appropriated according to personal properties. The Father begets the Son, the Spirit proceeds from both (WCF 2.3). Van Til\'s distinctive contribution was to demonstrate that the self-contained ontological Trinity is the \"concrete universal\" : the ultimate solution to the philosophical problem of the one and the many that has vexed Western thought from the pre-Socratics to the present. \"In God\'s being there are no particulars not related to the universal and there is nothing universal that is not fully expressed in the particulars\". The three Persons (ultimate plurality) and the one essence (ultimate unity) are equally basic, equally ultimate, mutually exhaustive : neither is reducible to or derivative from the other. This means the triune God is the necessary presupposition of all intelligible predication: without the Trinity, the unity and diversity in creation, in logic, in science, and in human experience cannot be accounted for. Every non-Christian philosophy either sacrifices unity to plurality (empiricism, nominalism, polytheism) or plurality to unity (rationalism, monism, pantheism) : only the ontological Trinity provides the metaphysical ground for both. The Trinity is thus not merely a dogma to be believed but the transcendental precondition of all thought, and systematic theology must make this Trinitarian foundation architectonically operative throughout every locus, not merely confess it in theology proper and leave it behind. TRINITARIAN GROUND OF EPISTEMOLOGY: Frame has demonstrated with sustained rigor that the Trinity is not only the ground of metaphysics (solving the one-and-many problem) but the ground of epistemology itself. Human knowing is inherently perspectival because human knowers are made in the image of the triune God: the normative perspective (what does God\'s Word say?) reflects the Father\'s authority, the situational perspective (what are the facts?) reflects the Son\'s structuring of all reality as Logos, and the existential perspective (what does the knowing subject bring?) reflects the Spirit\'s indwelling presence. These perspectives coinhere just as the divine Persons coinhere: each contains the other two, and no one perspective can be absolutized without distortion. This means that the Trinity is not merely one locus among twelve but the architectonic reality that funds and structures every other locus : including prolegomena, which is itself Trinitarian in its deepest logic. A systematic theology that treats the Trinity as confined to theology proper, leaving epistemology as a neutral preamble, has failed to reckon with the Trinitarian ground of all intelligibility.',
k:['trinity','Father','Son','Holy Spirit','begotten','procession','<i>perichoresis</i>','<i>homoousios</i>','<i>filioque</i>','generation','appropriation','concrete universal','one and many','presupposition','transcendental','foundation','self-contained'],
cl:['god','christ','holy-spirit','decree','pactum','eternal-generation','procession-spirit','prolegomena','creation','salvation','worship'],
hc:['Arian controversy (325)','Nicaea (325)','Constantinople (381)','<i>Filioque</i> controversy (1054)','Socinian denial of Trinity'],
s:[
{id:'eternal-generation',n:'Eternal Generation of the Son',d:'The Son is eternally begotten of the Father - not made, not created, but of one substance with the Father (John 1:14,18; 3:16; WCF 2.3). The whole divine essence is communicated without division or diminution. This eternal relation of origin grounds His personal distinction and His mission as Mediator (Heb 1:3,5; Ps 2:7).',k:['eternal generation','begotten','essence','<i>communicatio</i>n','mission'],cl:['pactum-son','incarnation'],ct:'theology_proper',hc:['Nicaea (325) vs. Arianism','Eternal Functional Subordination debate (21st c.)']},
{id:'procession-spirit',n:'Procession of the Holy Spirit',d:'The Spirit eternally proceeds from the Father and the Son (<i>filioque</i>) (John 15:26; Gal 4:6; WCF 2.3). This grounds His personal distinction and His economic mission of applying the Son\'s accomplished redemption. He is sent by both Father and Son (John 14:26; 16:7), reflecting the eternal order of procession.',k:['procession','<i>filioque</i>','spiration','application'],cl:['pactum-spirit','spirit-deity','spirit-regeneration'],ct:'theology_proper'},
{id:'trinitarian-relations',n:'Trinitarian Relations & Appropriation',d:'Persons distinguished by eternal relations of origin: paternity (Father), filiation (Son), spiration (Spirit) (John 5:26; 15:26; WCF 2.3). <i>Perichoresis</i>: mutual indwelling - where one Person acts, all are present and active (John 14:10–11). The economic appropriations (creation to Father, redemption to Son, application to Spirit) reflect but do not divide the single divine operation.',k:['relations','paternity','filiation','spiration','<i>perichoresis</i>','appropriation'],cl:['pactum','salvation'],ct:'theology_proper'},
{id:'filioque-controversy',n:'The <i>Filioque</i> Controversy',d:'The Western church\'s addition of <i>filioque</i> ("and the Son") to the Nicene-Constantinopolitan Creed, affirming that the Holy Spirit proceeds from the Father and the Son, became the primary theological point of division with Eastern Orthodoxy. The original creed (381) stated only that the Spirit "proceeds from the Father" (John 15:26). The <i>filioque</i> was added locally in Spain (Third Council of Toledo, 589) and gradually spread throughout the West, becoming a catalyst for the Great Schism of 1054. The Reformed confessions robustly affirm the <i>filioque</i> as biblical and theologically necessary (WCF 2.3; John 15:26; 16:7; Gal 4:6; Rom 8:9). Turretin defends the double procession extensively, arguing that: (1) Scripture calls the Spirit both "the Spirit of the Father" (Matt 10:20) and "the Spirit of the Son" (Gal 4:6); (2) the Son sends the Spirit (John 15:26; 16:7), and the economic mission reflects the eternal procession; (3) without the <i>filioque</i> the Son and Spirit lack a distinguishing relation to each other, collapsing the personal distinctions. The Eastern Orthodox objection - that the <i>filioque</i> introduces two principia (sources) in the Godhead and subordinates the Spirit - is answered by the Western insistence that Father and Son spirate the Spirit as one principle (<i>unum principium</i>), the Father being the <i>fons trinitatis</i> (fountain of the Trinity) who communicates the power of spiration to the Son through eternal generation. Calvin affirms the double procession while showing pastoral restraint about the creedal controversy itself. Bavinck provides a thorough historical and theological treatment, defending the <i>filioque</i> as guarding the full consubstantiality and co-equality of the Son with the Father.',k:['<i>filioque</i>','double procession','Eastern Orthodoxy','Great Schism','Nicene Creed','Constantinople','Toledo','WCF 2.3','spiration','<i>unum principium</i>','<i>fons trinitatis</i>','John 15:26','Gal 4:6'],ct:'theology_proper'},
{id:'social-trinitarianism-critique',n:'Critique of Social Trinitarianism',d:'Social Trinitarianism, associated with various modern theologians, emphasizes the three Persons as distinct centers of consciousness, will, and action, modeling the Trinity primarily as a divine community or society of love. Against this, classical Reformed trinitarianism - following the <i>pro-Nicene</i> tradition - insists on the numerical unity of the divine essence: God is one being with one will, one intellect, and one act of existence, subsisting in three relationally distinct Persons. The Persons are not three individuals who together compose God (tritheism) but three subsistences of the one undivided divine nature. Social Trinitarianism\'s errors include: (1) it risks tritheism by treating the Persons as three agents with distinct wills, undermining divine simplicity and the unity of the divine operations <i>ad extra</i> (<i>opera trinitatis ad extra indivisa</i>); (2) it often projects modern democratic or egalitarian social ideals back onto the immanent Trinity, using the Trinity as a model for human political or ecclesiastical arrangements; (3) it tends to collapse the distinction between the immanent Trinity (God as He is in Himself) and the economic Trinity (God as He acts in history); (4) it frequently rejects or undermines the classical doctrines of divine simplicity, inseparable operations, and eternal relations of origin. Bavinck warns against any construction that would make the Trinity "a plurality of gods united by bonds of love." The Reformed confessions ground Trinitarian unity in the one divine essence (WCF 2.3), not in a social compact among three divine individuals.',k:['social Trinitarianism','tritheism','divine simplicity','inseparable operations','<i>pro-Nicene</i>','one will','three Persons','community','classical','immanent','economic','WCF 2.3','unity of essence'],ct:'theology_proper'},
]},

{id:'decree',n:'The Divine Decree',ct:'theology_proper',c:'#dcc050',r:1.35,o:11.5,
d:'God from all eternity did, by the most wise and holy counsel of His own will, freely and unchangeably ordain whatsoever comes to pass (Eph 1:11; Rom 9:15–18; WCF 3.1). His decree encompasses creation, providence, redemption, free acts of creatures, and even sin by permission - yet without being the author of sin (WCF 3.1). It is the foundation of all certainty, providence, and hope (Acts 2:23; 4:27–28).',
k:['decree','foreordination','predestination','election','reprobation','sovereignty','permission','second causes','infralapsarianism','supralapsarianism'],
cl:['god','trinity','providence','salvation','pactum','covenant-theology','election','reprobation','covenant-works','christ','sin','eschatology','creation'],
hc:['Arminian Remonstrance (1610)','Synod of Dort (1618-1619)','Infra- vs. Supralapsarian debate'],
s:[
{id:'election',n:'Election',d:'God\'s eternal, unconditional, immutable choice of particular persons to salvation in Christ - not based on foreseen faith or merit but solely on sovereign good pleasure (Eph 1:4–6; Rom 9:11–13; 2 Tim 1:9; WCF 3.5). The fountain of all saving benefits. Those elected are effectually called, justified, adopted, sanctified, and kept by His power (Rom 8:30; WCF 3.6).',k:['election','unconditional','sovereign','grace','in Christ','predestination'],cl:['perseverance','calling-regen','definite-atonement','adoption','assurance','pactum'],ct:'theology_proper'},
{id:'reprobation',n:'Reprobation',d:'God\'s decree to pass by the non-elect (preterition) and ordain them to just punishment for their sins (condemnation) (Rom 9:17–22; 1 Pet 2:8; WCF 3.7). Not unjust - no one deserves mercy. God is not the author of their sin, but in justice withholds grace that He was under no obligation to give (Jude 4; Prov 16:4).',k:['reprobation','preterition','condemnation','justice'],cl:['final-judgment','total-depravity','divine-righteousness','free-offer-gospel'],ct:'theology_proper'},
{id:'decree-order',n:'Order of the Decrees',d:'Infralapsarianism: election and reprobation after the decree to permit the fall - God elects from the mass of fallen humanity. Supralapsarianism: election before the decree to permit the fall - redemption as the primary divine purpose. Both affirm unconditional election and divine sovereignty. The WCF is consistent with both but more naturally reads infralapsarian (WCF 3.3; 6.1).',k:['infralapsarianism','supralapsarianism','logical order'],ct:'theology_proper'},
{id:'decree-sin',n:'The Decree & Sin',d:'God\'s decree includes sin by permission, not by positive causation (WCF 3.1; 5.4). God is not the author of sin (Jas 1:13), yet sin does not fall outside the compass of His decree (Acts 2:23; 4:27–28). He most wisely and powerfully bounds, orders, and governs sinful actions of creatures to His own holy ends (Gen 50:20; WCF 5.4).',k:['permission','author of sin','governance','second causes','holy ends'],cl:['providence','the-fall','governance'],ct:'theology_proper'},
]},

{id:'pactum',n:'The <i>Pactum Salutis</i> (Covenant of Redemption)',ct:'theology_proper',c:'#dcc050',r:1.4,o:11,
d:'The pre-temporal, intra-Trinitarian covenant in which the three Persons covenanted for the redemption of the elect (Ps 2:7\u20138; Ps 110; Zech 6:13; John 6:37\u201339; 17:2\u20135; Eph 1:3\u201314; WCF 8.1). In classic Reformed dogmatics the <i>pactum salutis</i> is architectonically co-equal with the covenant of works and the covenant of grace \u2013 the eternal foundation upon which both historical covenants rest. The Father appointed the Son as Mediator and gave Him a people; the Son undertook to assume human nature, fulfill the covenant of works by His perfect obedience, bear the penalty for sin, and merit eternal life for the elect; the Spirit covenanted to apply the Son\'s accomplished work to every one of those for whom it was intended. The Reformed tradition holds the pactum as "the basis of all covenants in the eternal counsel of God, in a covenant between the very persons of the Trinity." The three-covenant structure (<i>pactum salutis</i> \u2192 covenant of works \u2192 covenant of grace) is treated as fundamental by Witsius, Bavinck, Turretin, Vos, and Hodge. Christ\'s suretyship (Heb 7:22) and His mediatorial mission flow directly from this eternal appointment. Without the pactum, the historical covenants of works and grace lack their Trinitarian foundation, and soteriology becomes a unilateral divine act rather than a covenantal economy involving all three Persons.',
k:['<i>pactum salutis</i>','counsel of peace','eternal covenant','covenant of redemption','three-covenant','Trinitarian','architectonic','suretyship','intra-Trinitarian','pre-temporal'],
cl:['trinity','decree','covenant-works','covenant-grace','christ','holy-spirit','covenant-theology','salvation','election'],
hc:['17th-century Reformed scholasticism','Cocceian-Voetian debates'],
s:[
{id:'pactum-father',n:'The Father\'s Role in the Pactum',d:'The Father, as the offended party and fount of the Trinity, initiated the covenant of redemption by appointing the Son as Mediator and giving Him a people (John 6:37\u201339; 17:2,6,9; Eph 1:3\u20136; Isa 42:1\u20134; WCF 8.1). The Father determined the conditions: a people chosen in Christ before the foundation of the world (Eph 1:4), to be redeemed through the Son\'s obedience and sacrifice, and applied by the Spirit. He promised the Son a reward \u2013 the joy set before Him (Heb 12:2), a name above every name (Phil 2:9\u201311), the nations as His inheritance (Ps 2:8), and the eternal glory of the accomplished work (John 17:5,24). Turretin treats the Father\'s appointment of the Mediator as the logical first moment of the pactum.',k:['Father','appointment','Mediator','elect','given','reward','Ps 2:8','John 6:37','initiation'],cl:['election','decree','divine-will'],ct:'theology_proper'},
{id:'pactum-son',n:'The Son\'s Undertaking in the Pactum',d:'The Son voluntarily undertook to assume human nature in the fullness of time, to place Himself under the law as covenant surety for the elect (Gal 4:4\u20135; Heb 7:22; 10:5\u20137; WCF 8.1), to fulfill the covenant of works by His perfect active obedience, to bear the penalty of sin by His passive obedience unto death, and to merit eternal life for all those given to Him by the Father. His suretyship (Heb 7:22) is the covenantal ground of both imputation and substitution: the guilt of the elect is transferred to Christ, and Christ\'s righteousness is imputed to them (2 Cor 5:21; Rom 5:18\u201319). Turretin treats the Son\'s voluntary self-engagement as the heart of the pactum. Bavinck argues that without this eternal undertaking, the incarnation and atonement lack their covenantal rationale.',k:['Son','surety','active obedience','passive obedience','assumption','incarnation','merit','Heb 7:22','voluntary','imputation'],cl:['incarnation','active-obedience','passive-obedience','covenant-surety'],ct:'theology_proper'},
{id:'pactum-spirit',n:'The Spirit\'s Role in the Pactum',d:'The Holy Spirit covenanted to apply the Son\'s accomplished redemption to every one of those for whom it was intended (WCF 8.8; John 16:7\u201315; Titus 3:5\u20136). The Spirit would regenerate the elect, work faith and repentance in their hearts, unite them to Christ, sanctify them progressively, seal them unto the day of redemption, and bring them to glory. The Spirit\'s application work is not an afterthought but an eternal covenantal commitment \u2013 He is the bond of union between Christ and His people (Rom 8:9\u201311; Eph 1:13\u201314). The Reformed tradition emphasizes that the pactum secures the Trinitarian shape of salvation: the Father plans, the Son accomplishes, the Spirit applies \u2013 and this economic distinction reflects the eternal personal properties.',k:['Spirit','application','regeneration','union','sealing','Trinitarian','bond','WCF 8.8','eternal commitment','economic'],cl:['spirit-regeneration','calling-regen','spirit-sanctification','spirit-indwelling'],ct:'theology_proper'},
{id:'pactum-biblical-basis',n:'Biblical Basis of the <i>Pactum Salutis</i>',d:'The scriptural evidence for the <i>pactum salutis</i> includes: (1) Passages describing an eternal arrangement between Father and Son: Ps 2:7\u20138 (the decree of the Lord \u2013 "You are my Son; ask of me and I will give you the nations"); Ps 110:1,4 (the LORD\'s oath to the Lord \u2013 "You are a priest forever"); Zech 6:13 ("the counsel of peace shall be between them both"); Isa 42:1\u20134; 49:1\u20136; 53:10\u201312 (the Servant\'s commission and reward). (2) Christ\'s repeated testimony that He was sent by the Father with a specific mission and a specific people: John 6:37\u201339; 10:17\u201318; 17:2\u20135,6,9,24. (3) The eternal, pre-creation character of redemption: Eph 1:3\u201314; 2 Tim 1:9; Titus 1:2; Rev 13:8; 1 Pet 1:20. (4) The covenantal language of suretyship and mediation: Heb 7:22; 9:15; 12:24; 1 Tim 2:5. Turretin builds the case systematically. Some recent critics have questioned whether the pactum introduces a division within the immanent Trinity or lacks sufficient exegetical basis. J. V. Fesko provides the most comprehensive recent defense.',k:['biblical basis','Ps 2:7','Ps 110','Zech 6:13','John 6:37','John 17','Eph 1:3','Heb 7:22','Isa 53:10','suretyship','pre-creation','eternal'],ct:'theology_proper'},
{id:'pactum-historical-development',n:'Historical Development of the Pactum Doctrine',d:'The <i>pactum salutis</i> emerged as a distinct doctrinal locus in 17th-century Reformed scholasticism, though its roots are found in earlier theology. Early Reformed scholastics are credited with its formulation, and it was systematized by major 17th-century covenant theologians. Turretin offers the most rigorous scholastic defense. Witsius, Bavinck, Charles and A.A. Hodge, and Vos all treat it as a standard locus. The doctrine was not without controversy: some feared it risked tritheism by depicting three divine "parties" negotiating; the Reformed response was that the pactum reflects the eternal personal properties and relations of origin, not three independent wills. In the 20th century, some modern critics rejected the pactum as speculative mythology; Barth expressed reservations about the covenantal language while affirming the underlying reality. The contemporary recovery has demonstrated the doctrine\'s exegetical basis and its indispensable role in the architectonics of covenant theology.',k:['historical development','17th century','Reformed scholasticism','controversy'],ct:'theology_proper'},
]},

{id:'creation',n:'Creation',ct:'anthropology',c:'#60b060',r:1.45,o:12.5,
d:'The free act of the triune God bringing all things from nothing (<i>ex nihilo</i>) - in the space of six days, all very good (Gen 1:1,31; Heb 11:3; WCF 4.1). Establishes the Creator-creature distinction, the goodness of matter, and the purposiveness of all things. God made the world to manifest the glory of His eternal power, wisdom, and goodness (Rom 1:20; WCF 4.1). ARCHITECTONIC PRINCIPLE: In Reformed theology, the eschatological orientation of creation is not a secondary observation but a structural principle governing the entire system. Creation was from the beginning oriented toward consummation \u2013 Eden was never the endpoint but the starting point of a forward movement toward glorification. The Garden of Eden was a proto-temple, the Sabbath was eschatological in character (pointing to the eternal rest, Heb 4:9\u201311), the covenant of works offered eschatological life beyond the mutable state (WCF 7.2; 19.1), and the tree of life signified confirmed, glorified existence (Gen 3:22; Rev 2:7; 22:2). Bavinck and Vos treat this as architectonically fundamental: creation and redemption are organically related; protology is incomplete without eschatology; the new creation is not a return to Eden but Eden glorified and consummated (Rev 21\u201322; Isa 65:17; 2 Pet 3:13). The trajectory is irreversibly forward: creation \u2192 covenant of works \u2192 fall \u2192 covenant of grace \u2192 Christ the Last Adam \u2192 new creation. This means that every doctrine between protology and eschatology \u2013 covenant, sin, Christology, soteriology, ecclesiology \u2013 participates in this forward movement and must be understood within it. The creation-to-consummation axis is not one theme among many but the redemptive-historical backbone upon which the entire organic system hangs.',
k:['creation','<i>ex nihilo</i>','six days','good','free','contingent','Creator-creature','fiat','eschatological orientation','protology-eschatology axis','forward movement','Eden glorified','proto-temple'],
cl:['god','providence','humanity','covenant-works','trinity','eschatology','covenant-grace','decree','revelation','sin','biblical-theology'],
s:[
{id:'creation-to-consummation',n:'The Creation-to-Consummation Axis',d:'The architectonic principle that creation was from the beginning oriented toward eschatological consummation \u2013 not as an addendum but as a structural reality woven into the very fabric of the created order. This principle, drawn from Vos, Kline, Beale, and supremely from Bavinck\u2019s organic motif, governs the Reformed understanding of the entire <i>historia salutis</i>. (1) THE GARDEN AS PROTO-TEMPLE: Eden was not merely a garden but a sanctuary \u2013 the place of God\u2019s special presence, with eastward orientation, cherubim guardianship (Gen 3:24; cf. Exod 25:18\u201320), and Adam as priest-king tending and keeping (Gen 2:15; the same Hebrew terms \u05E9\u05C1\u05B8\u05DE\u05B7\u05E8 and \u05E2\u05B8\u05D1\u05B7\u05D3 used for Levitical service, Num 3:7\u20138). Beale demonstrates that the temple theology of the Old Testament recapitulates and expands Eden, and the new creation consummates it as the cosmic temple where God dwells with His people without mediation (Rev 21:22). (2) THE SABBATH AS ESCHATOLOGICAL: God\u2019s rest on the seventh day (Gen 2:2\u20133) is not merely retrospective but prospective \u2013 pointing forward to the eternal Sabbath rest that remains for the people of God (Heb 4:9\u201311). The Sabbath was always eschatological in character: it invited Adam and his posterity into the divine rest, which the covenant of works would have secured permanently. (3) THE COVENANT OF WORKS AS ESCHATOLOGICAL OFFER: The promise of confirmed, glorified, immutable life \u2013 eschatological life \u2013 was built into the original covenant arrangement. Adam in innocence was mutable (<i>posse peccare</i>, <i>posse non peccare</i>); the eschatological state is immutable blessedness (<i>non posse peccare</i>). The covenant of works offered the transition from the one to the other. The tree of life was the sacramental seal of this eschatological promise (Gen 3:22; Rev 2:7; 22:2,14). (4) FORWARD, NOT CIRCULAR: The fall did not cancel the eschatological goal but necessitated a new way of reaching it: Christ the Last Adam (1 Cor 15:45\u201349; Rom 5:12\u201321). He fulfilled the covenant of works by His active obedience, bore its curse by His passive obedience, and secured the eschatological inheritance for His people. The trajectory is thus: creation \u2192 covenant of works (eschatological promise) \u2192 fall (promise broken) \u2192 covenant of grace (promise renewed in Christ) \u2192 Christ\u2019s obedience, death, and resurrection (promise fulfilled) \u2192 new creation (promise consummated). This is not a circle back to Eden but an irreversible forward movement to Eden glorified (Rev 21\u201322). (5) BAVINCK\u2019S ORGANIC PRINCIPLE: Bavinck holds that creation, fall, redemption, and consummation are not isolated episodes but organically connected moments in the one purpose of the triune God . Grace does not destroy nature but restores and perfects it. The new creation is the old creation glorified \u2013 identity preserved, quality transformed. \"God does not make all new things but makes all things new\" (Rev 21:5). The protology-eschatology axis is thus the backbone of the organic system: every doctrine \u2013 from the decree through covenant, Christology, soteriology, and ecclesiology \u2013 hangs on this redemptive-historical spine and participates in this forward movement from Garden to Glory.',k:['creation-to-consummation','protology-eschatology axis','architectonic','forward movement','Eden glorified','proto-temple','Sabbath eschatological','covenant of works','tree of life','Last Adam','organic motif','Garden to Glory','mutable to immutable','pactum','<i>non posse peccare</i>','cosmic temple','Rev 21','1 Cor 15:45','Rom 5:12','Gen 2:15','Heb 4:9','redemptive-historical backbone'],cl:['eschatology','covenant-works','new-creation','temple-theology','sabbath-lords-day','organic-motif'],ct:'anthropology'},
{id:'ex-nihilo',n:'Creation <i>Ex Nihilo</i>',d:'From nothing - not from pre-existing matter, not from God\'s substance (Gen 1:1; Heb 11:3; WCF 4.1). Distinguishes Christianity from dualism, emanationism, and pantheism. The world is utterly contingent upon God\'s free will - it need not have existed. Creation is a free act of divine grace, not a necessary emanation.',k:['<i>ex nihilo</i>','sovereignty','dualism','pantheism','contingency'],cl:['aseity'],ct:'anthropology'},
{id:'angels',n:'Angels, Demons & the Spiritual World',d:'God created all the angels - spiritual, intelligent, incorporeal beings who serve as His messengers and ministers, organized in ranks and orders (Ps 103:20; Heb 1:14; Col 1:16; WCF 4.1). Turretin devotes his entire seventh topic to angels; The major Reformed dogmatics devote extensive attention to the spiritual world; Berkhof has a full chapter; Calvin treats them in Institutes 1.14. The elect angels are confirmed in grace and holiness (1 Tim 5:21; Matt 18:10). They worship God continually (Isa 6:2–3; Rev 5:11–12), minister to the heirs of salvation (Heb 1:14), execute God\'s providential judgments (2 Kgs 19:35; Acts 12:23), and rejoice at the conversion of sinners (Luke 15:10). Some angels, under Satan their chief, fell from their original holiness by voluntary rebellion and became demons - spirits of wickedness reserved in everlasting chains under darkness for the judgment of the great day (2 Pet 2:4; Jude 6; WCF 6.1; Rev 12:7–9). Satan is the adversary who tempts, accuses, and opposes the work of God (Gen 3:1–5; Job 1:6–12; Zech 3:1; 1 Pet 5:8; Rev 12:10). Believers are called to resist the devil (Jas 4:7; Eph 6:10–18), armed with the whole armor of God, knowing that Christ has decisively triumphed over all principalities and powers (Col 2:15).',k:['angels','demons','Satan','spiritual warfare','cherubim','seraphim','elect angels','fallen','principalities','powers','armor of God','Col 2:15'],cl:['providence','christ'],ct:'anthropology'},
{id:'cultural-mandate',n:'The Cultural Mandate',d:'God blessed humanity and gave dominion over the earth - to be fruitful, multiply, fill, subdue, and have dominion (Gen 1:28; 2:15; Ps 8:6–8). This mandate grounds the goodness of human culture, labor, science, and the development of creation\'s potential. It is not abrogated by the fall but renewed under the covenant of grace.',k:['cultural mandate','dominion','labor','stewardship','vocation'],cl:['common-grace','church-mission','good-works','christs-kingship-nations'],ct:'anthropology'},
{id:'six-days',n:'The Six Days & Goodness of Creation',d:'God created all things in the space of six days, and all very good (Gen 1:1–31; Exod 20:11; WCF 4.1). The ordered progression of creation - light, firmament, land and vegetation, luminaries, sea and air creatures, land creatures, and finally man as the crown - displays divine wisdom and purposiveness. Each day concludes with divine evaluation: it was good. The whole is declared very good (Gen 1:31), establishing the original integrity of the created order before the entrance of sin.',k:['six days','very good','ordered','progression','wisdom','fiat','Exod 20:11'],ct:'anthropology'},
]},

{id:'providence',n:'Providence',ct:'anthropology',c:'#60b060',r:1.3,o:13,
d:'God\'s most holy, wise, and powerful preserving and governing all His creatures and all their actions (Heb 1:3; Dan 4:34–35; WCF 5.1). Three aspects: preservation (sustaining all in being), concurrence (cooperating with second causes), and governance (directing all to His appointed end). It extends to the first fall and all other sins of angels and men (WCF 5.4).',
k:['providence','preservation','concurrence','governance','second causes','sovereignty'],
cl:['creation','god','decree','sin','eschatology','church','humanity','salvation'],
s:[
{id:'preservation',n:'Preservation',d:'God upholds all creatures in being and operation by the word of His power (Heb 1:3; Acts 17:28; Col 1:17; WCF 5.1). Active, ongoing - not passive permission. Without God\'s continual sustaining, all would collapse to nothingness. He gives to all life and breath and everything.',k:['preservation','upholding','sustaining'],cl:['aseity','creation'],ct:'anthropology'},
{id:'concurrence',n:'Concurrence',d:'God cooperates with second causes so that creatures act freely (according to the nature of second causes), yet God efficaciously determines the outcome (Phil 2:13; Prov 21:1; WCF 5.2). He does not destroy freedom but sovereignly directs it. Creatures are real agents, but God is the first cause working in and through all secondary causes.',k:['concurrence','second causes','cooperation','sovereignty','agency'],cl:['free-will','decree-sin'],ct:'anthropology'},
{id:'governance',n:'Governance',d:'God directs all things - including sin and suffering - to His glory and His people\'s good (Rom 8:28; Gen 50:20; WCF 5.1,4). His governance extends to the greatest and least events alike (Matt 10:29–30). He makes even the wrath of man to praise Him (Ps 76:10).',k:['governance','direction','glory','purpose'],cl:['decree','eschatology'],ct:'anthropology'},
{id:'extraordinary-providence',n:'Ordinary & Extraordinary Providence',d:'God ordinarily works through means (second causes) yet is free to work without, above, or against them as He pleases (WCF 5.3). The Red Sea, the virgin birth, the resurrection - extraordinary acts of divine power transcending natural order. God is not bound by the laws of nature He Himself established (Isa 38:8; Dan 3:27).',k:['ordinary','extraordinary','means','miracles','above means'],ct:'anthropology'},
{id:'providence-church',n:'Special Providence toward the Church',d:'God\'s providence, in a most special manner, takes care of His church and disposes all things to the good thereof (WCF 5.7; Isa 43:14; Rom 8:28; Eph 3:10–11). He governs the rise and fall of nations, the course of history, and the movements of peoples for the sake of gathering and preserving His elect (Matt 24:22; Dan 2:21). The church is the theater of His redemptive purpose, and all of history serves the coming of Christ\'s kingdom.',k:['special providence','church','protection','history','nations','kingdom'],cl:['church','eschatology','marks-church'],ct:'anthropology'},
]},

{id:'humanity',n:'Humanity & the Image of God',ct:'anthropology',c:'#60b060',r:1.4,o:11.5,
d:'The crown of creation - male and female made in God\'s image (<i>imago Dei</i>) for covenant fellowship (Gen 1:26–28; 2:7; WCF 4.2). The image encompasses knowledge, righteousness, and holiness (Eph 4:24; Col 3:10; WCF 4.2). Psychosomatic unity of body and soul - a rational, embodied creature designed for communion with God and dominion over creation.',
k:['humanity','image of God','<i>imago Dei</i>','male','female','dominion','knowledge','righteousness','holiness','soul','body'],
cl:['creation','sin','christ','covenant-works','salvation','original-righteousness','the-fall','cultural-mandate','free-will','law','imago-dei','eschatology'],
s:[
{id:'imago-dei',n:'The Image of God (<i>Imago Dei</i>)',d:'Broader sense: rationality, morality, spirituality, dominion - remaining after the fall though corrupted (Gen 9:6; Jas 3:9). Narrower sense: original righteousness - true knowledge, holiness, and justice - lost in the fall, restored progressively in Christ (Eph 4:24; Col 3:10; WCF 4.2). The image is not a part of man but his whole being in relation to God.',k:['<i>imago Dei</i>','broader','narrower','original righteousness','restored'],cl:['trinity','cultural-mandate','original-righteousness','soul-body','knowledge-god'],ct:'anthropology'},
{id:'soul-body',n:'Soul and Body',d:'God formed man of the dust and breathed into his nostrils the breath of life (Gen 2:7; WCF 4.2). Two substances - material body and immaterial, rational, immortal soul - united in one person. Against both trichotomy and materialism. Death is the temporary separation of soul and body; the resurrection reunites them (Eccl 12:7; 2 Cor 5:1–8; WCF 32.1).',k:['soul','body','dichotomy','trichotomy','death','resurrection'],cl:['death-intermediate','resurrection-body','incarnation'],ct:'anthropology'},
{id:'conscience',n:'Conscience & Moral Sense',d:'God\'s law written on the heart (Rom 2:14–15; WCF 20.1). Conscience accuses or excuses, witnesses to the moral order, and renders all accountable before God. Damaged by the fall but never entirely extinguished (Rom 1:32). It binds to obey God\'s will but no human power may bind the conscience contrary to His Word (WCF 20.2).',k:['conscience','moral sense','natural law','accountability'],cl:['natural-law','law','christian-liberty'],ct:'anthropology'},
{id:'original-righteousness',n:'Original Righteousness & the State of Innocence',d:'Adam and Eve were created with the law of God written upon their hearts, with power to fulfill it (Eccl 7:29; Gen 1:31; WCF 4.2; 19.1). They had true knowledge of God, holiness of affection, and righteousness of will - all in a mutable condition, capable of being lost. This original state was one of true blessedness yet probationary, not yet confirmed in glory.',k:['original righteousness','innocence','mutable','holiness','probation'],cl:['the-fall','will-innocence','covenant-works','imago-dei'],ct:'anthropology'},
]},

{id:'covenant-works',n:'The Covenant of Works',ct:'anthropology',c:'#60b060',r:1.2,o:13.5,
d:'Life was promised to Adam upon condition of perfect, personal, perpetual obedience - with a prohibition not to eat of the tree of knowledge as the specific test (Gen 2:16\u201317; Hos 6:7; WCF 7.2; 19.1). Adam stood as federal head. The promise was eschatological life \u2013 confirmation in glory beyond the mutable state, the transition from <i>posse non peccare</i> to <i>non posse peccare</i> (WCF 9.5). This is the architectonic link between protology and eschatology: the covenant of works establishes that creation was from the beginning oriented toward a higher, glorified, permanent state. The tree of life was the sacramental seal of this eschatological promise (Gen 3:22; Rev 2:7; 22:2,14). Adam\u2019s failure did not cancel the eschatological goal but transferred it to Christ the Last Adam, who fulfills the covenant of works by His active obedience and secures the eschatological inheritance for His people (Rom 5:12\u201321; 1 Cor 15:45\u201349). The meritorious principle established here is the same principle Christ fulfills: the new creation is what Adam would have attained had he passed the probation.',
k:['covenant of works','Adam','federal head','obedience','probation','life','death','meritorious','tree of life','eschatological life','Last Adam','forward movement','mutable','immutable'],
cl:['humanity','sin','christ','covenant-grace','law','creation','eschatology','salvation','federal-headship','probation','active-obedience','creation-to-consummation','decree','pactum','covenant-theology','free-will','god'],
s:[
{id:'federal-headship',n:'Federal Headship',d:'Adam stood as legal representative (federal head) of all his natural descendants (Rom 5:12–19; 1 Cor 15:21–22; WCF 6.3). His obedience would have secured confirmed life for all; his disobedience plunged all into guilt and death. This representative principle is the foundation of imputation - both Adam\'s sin to his posterity and Christ\'s righteousness to the elect.',k:['federal headship','representative','imputation','solidarity'],cl:['original-sin','active-obedience','justification','typology-of-adam'],ct:'anthropology'},
{id:'probation',n:'Probation & the Tree',d:'The tree of knowledge embodied the principle of obedience - the test of willingness to live by God\'s word (Gen 2:16–17; WCF 4.2). The tree of life symbolized confirmed eschatological life (Gen 3:22; Rev 2:7). A gracious arrangement for irrevocable blessedness. The probation was not burdensome but entirely reasonable given man\'s created capacities.',k:['probation','tree','knowledge','life','eschatological'],cl:['creation-to-consummation','the-fall','will-innocence'],ct:'anthropology'},
{id:'covenant-works-condition',n:'The Condition of the Covenant of Works',d:'The specific condition of the covenant of works was perfect, personal, and perpetual obedience to the whole revealed will of God. WCF 7.2 teaches that life was promised to Adam \"upon condition of perfect and personal obedience,\" and WCF 19.1 states that God \"gave to Adam a law, as a covenant of works, by which He bound him and all his posterity to personal, entire, exact, and perpetual obedience.\" The obedience required was: (1) perfect — without any defect or shortcoming in degree or quality, corresponding to the holiness of the Lawgiver (Gal 3:10; Jas 2:10); (2) personal — performed by the covenant head himself, not by a substitute (until the provision of the Second Adam); (3) perpetual — extending throughout the entire probationary period until confirmed in righteousness. This threefold condition establishes the ground upon which Christ\'s active obedience is rightly understood: as the Last Adam, Christ rendered the perfect, personal, and perpetual obedience that the first Adam failed to render, thereby fulfilling the condition of the covenant of works and meriting eschatological life for all whom He represents (Rom 5:19; Phil 2:8; Gal 4:4–5; WCF 8.5). The condition of the covenant of works thus has direct Christological and soteriological significance: without it, the imputation of Christ\'s active obedience lacks its proper covenantal framework.',k:['condition','perfect obedience','personal obedience','perpetual obedience','WCF 7.2','WCF 19.1','Gal 3:10','covenant of works','active obedience','Last Adam','imputation'],cl:['active-obedience','federal-headship','probation','covenant-works','justification'],ct:'anthropology'},
{id:'covenant-condescension',n:'Divine Condescension in Covenant',d:'The distance between God and the creature is so great that rational creatures owe Him obedience, but could never attain blessedness as a reward unless by some voluntary condescension on God\'s part expressed by way of covenant (WCF 7.1). Even the covenant of works was gracious in its promise - God owed man nothing beyond mere existence. All covenantal blessing is rooted in divine condescension (Isa 40:13–17; Job 35:7–8).',k:['condescension','distance','voluntary','reward','covenant','graciousness'],cl:['aseity','divine-goodness','covenant-grace'],ct:'anthropology'},
]},

{id:'sin',n:'Sin & the Fall',ct:'hamartiology',c:'#d86868',r:1.5,o:10.5,
d:'Sin entered through Adam\'s disobedience - any want of conformity unto, or transgression of, the law of God (1 John 3:4; WCF 6.6). Original sin (imputed guilt + inherited corruption) constitutes total depravity, affecting every faculty without destroying the image entirely (Gen 6:5; Rom 3:10–18; WCF 6.2–4). By this sin, Adam and all his posterity fell from original righteousness and communion with God, became dead in sin, and wholly defiled (WCF 6.2).',
k:['sin','fall','Adam','disobedience','death','curse','original sin','total depravity','corruption','guilt','imputation','spiritual death','bondage'],
cl:['covenant-works','humanity','christ','salvation','creation','eschatology','covenant-grace','law','total-depravity','the-fall','common-grace','god','free-will','providence','decree','holy-spirit'],
hc:['Pelagian controversy (418)','Council of Orange (529)','Semi-Pelagian debates','Socinian denial of original sin'],
s:[
{id:'the-fall',n:'The Historical Fall',d:'A real, historical event - Adam violated the covenant of works, eating the forbidden fruit (Gen 3:1–7; WCF 6.1). God permitted the fall according to His wise and holy counsel, having purposed to order it to His own glory (WCF 6.1). Cosmic consequences: all posterity and all creation affected. The ground cursed; death, toil, and sorrow made universal (Gen 3:16–19; Rom 8:20–22).',k:['fall','historical','covenant of works','curse','death'],cl:['original-sin','covenant-works','federal-headship','will-sin','total-depravity'],ct:'hamartiology'},
{id:'original-sin',n:'Original Sin',d:'Original guilt: Adam\'s first transgression imputed to all his posterity by ordinary generation (Rom 5:12,18–19; WCF 6.3). Original corruption: the inherited pervasive depravity of the whole nature (Ps 51:5; WCF 6.4). Every person is born in spiritual death - alienated from God, inclined only to evil, utterly unable to perform any saving good or to convert themselves (Eph 2:1–3; WCF 6.2,4).',k:['original sin','guilt','imputation','corruption','spiritual death','inability'],cl:['the-fall','federal-headship','calling-regen','baptism','total-depravity'],ct:'hamartiology'},
{id:'total-depravity',n:'Total Depravity',d:'Sin extends to every faculty - mind darkened (Eph 4:18), will in bondage (John 8:34; Rom 8:7), affections disordered (Gen 6:5), conscience defiled (Titus 1:15). Total in extent (pervasive) not in degree (not as wicked as possible) (WCF 6.4; 9.3). Man retains the natural faculties of reason and will but is wholly inclined to all evil and utterly indisposed to all spiritual good (WCF 6.4; 9.3).',k:['total depravity','pervasive','mind','will','affections','bondage'],cl:['will-sin','calling-regen','faith-reason','presuppositional-apologetics','free-will','original-sin'],ct:'hamartiology'},
{id:'actual-sin',n:'Actual Sin',d:'All transgressions flowing from original corruption - in thought, word, and deed, by omission or commission (WCF 6.6; Jas 1:14–15). From original corruption proceed all actual transgressions (Matt 15:19; WCF 6.4). Every sin, being a transgression of the righteous law of God, and contrary thereunto, does in its own nature bring guilt upon the sinner (WCF 6.6; Rom 6:23; Gal 3:10).',k:['actual sin','transgression','omission','commission','guilt'],ct:'hamartiology'},
{id:'common-grace',n:'Common Grace',d:'NOTE ON PLACEMENT: While common grace is treated under hamartiology in the Reformed tradition, it has vital connections to theology proper (divine goodness), anthropology (preserving the created order), providence (sustaining the world), ethics (natural law), and ecclesiology (the civil magistrate). It is a positive expression of God\'s goodness in preserving creation for the sake of redemption, not merely a sin-management doctrine. DEFINITION: God\'s unmerited favor toward all creatures - restraining sin, maintaining creation, distributing gifts, enabling culture, science, art, and ordered society (Gen 8:21–22; Matt 5:45; Acts 14:16–17; WCF 5.6). Berkhof devotes a full chapter (Part 4, Chapter III) to this doctrine. Abraham Kuyper developed an entire theology of common grace, and Van Til and Bavinck have further developed the theology of common grace. The distinction between the Spirit\'s common and special operations is a hallmark of Reformed pneumatology against Arminianism: common grace does not regenerate, does not produce saving faith, and is not effectual unto salvation - yet it is genuine divine goodness that preserves the world as a theater for redemption. It explains the genuine good, beauty, and truth found among the unregenerate (Rom 2:14–15), the civic righteousness of unbelievers, and the cultural achievements of fallen humanity. Common grace also grounds the possibility of cooperation between believers and unbelievers in civil life (Jer 29:7). It is not saving grace resisted but a categorically distinct divine operation.',k:['common grace','restraint','culture','science','preservation','special grace','Arminianism','civic righteousness','beauty','truth'],cl:['divine-goodness','providence','cultural-mandate','civil-magistrate','natural-law','spirit-common-ops'],ct:'hamartiology'},
{id:'degrees-sin',n:'Degrees of Sin',d:'Some sins in themselves, and by reason of several aggravations, are more heinous in the sight of God than others (John 19:11; Ezek 8:6,13; 1 John 5:16; WCF 15.4). Sins are aggravated by the persons offending (age, office, gifts, eminence), the parties offended (directly against God, His attributes, Christ, the Spirit), the nature and quality of the offense (against the letter or spirit of the law, scandalous, premeditated, persistent), and the attendant circumstances (time, place, public nature, consequences to others) (LC 151). This distinction is pastorally essential for the exercise of church discipline and the assurance of conscience.',k:['degrees','aggravations','heinousness','circumstances','conscience','discipline','LC 151'],ct:'hamartiology'},
]},

{id:'free-will',n:'Free Will',ct:'hamartiology',c:'#d86868',r:1.15,o:14.5,
d:'The will of man operates differently in four states (WCF 9.1–5). In innocence, Adam had freedom and power to will and do good; yet was mutable and fell (WCF 9.2). In sin, man is utterly unable to convert himself or prepare himself thereunto; the will is in bondage (WCF 9.3). In grace, the will is freed by the Spirit to will and do that which is spiritually good, yet not perfectly (WCF 9.4). In glory, the will is made perfectly and immutably free to good alone (WCF 9.5).',
k:['free will','four states','innocence','bondage','liberty','grace','glory','voluntas'],
cl:['sin','humanity','salvation','eschatology','covenant-works','covenant-theology','decree','calling-regen'],
hc:['Pelagian controversy (418)','Semi-Pelagian controversy','Luther-Erasmus debate on the will (1525)','Synod of Dort (1618-1619)'],
s:[
{id:'will-innocence',n:'The Will in Innocence',d:'Adam had freedom to will and do that which is good and well-pleasing to God; yet was mutable, so that he might fall from it (WCF 9.2; Eccl 7:29; Gen 2:16–17). His will was inclined to good but not confirmed - he could sin (<i>posse peccare</i>) and could not sin (<i>posse non peccare</i>).',k:['innocence','mutable','<i>posse peccare</i>','<i>posse non peccare</i>'],cl:['original-righteousness','covenant-works','probation'],ct:'hamartiology'},
{id:'will-sin',n:'The Will in Sin',d:'Man by his fall has wholly lost all ability of will to any spiritual good accompanying salvation; he is not able by his own strength to convert himself or prepare himself thereunto (WCF 9.3; John 6:44; Rom 8:7–8). The sinner is free from external compulsion but is in bondage to sin - not able not to sin (<i>non posse non peccare</i>).',k:['bondage','inability','dead in sin','<i>non posse non peccare</i>'],cl:['total-depravity','the-fall','original-sin','calling-regen'],ct:'hamartiology'},
{id:'will-grace',n:'The Will in Grace',d:'By the effectual work of the Spirit, the will is renewed and made free from its natural bondage to sin (WCF 9.4; Phil 2:13; John 8:36). The regenerate person is enabled to will and do that which is spiritually good, yet not perfectly - remaining corruption prevents perfect obedience (Rom 7:15–25; Gal 5:17; WCF 9.4; 13.2).',k:['renewal','freedom','Spirit','imperfection','struggle'],cl:['calling-regen','sanctification','spirit-regeneration','perseverance'],ct:'hamartiology'},
{id:'will-glory',n:'The Will in Glory',d:'In the state of glory, the will of man is made perfectly and immutably free to good alone (WCF 9.5; Rev 21:27; 1 John 3:2). This is the eschatological telos of the will\'s restoration - not able to sin (<i>non posse peccare</i>). The glorified saints are confirmed in holiness beyond all possibility of falling, enjoying uninterrupted communion with God. What Adam possessed mutably, the glorified saints possess immutably through the merit and mediation of the last Adam (1 Cor 15:45–49).',k:['glory','immutable','freedom','<i>non posse peccare</i>','confirmed','eschatological','last Adam'],cl:['glorification','new-creation','beatific-vision','eternal-state'],ct:'hamartiology'},
]},

{id:'law',n:'The Law of God',ct:'ethics',c:'#c8b468',r:1.2,o:14,
d:'The expression of God\'s holy will binding upon all creatures. The moral law is perpetual and universal, summarily comprehended in the Ten Commandments (WCF 19.1–2; Matt 22:37–40). Ceremonial laws typified Christ and are abrogated under the New Testament (WCF 19.3; Col 2:17; Heb 10:1). Judicial laws expired with the theocracy, though their general equity continues (WCF 19.4).',
k:['law','moral','ceremonial','judicial','decalogue','threefold use','obedience','general equity'],
cl:['god','covenant-works','sin','christ','salvation','threefold-use','decalogue','law-gospel','natural-law','good-works','humanity','covenant-theology','christian-liberty','christian-life','worship','church','sanctification'],
s:[
{id:'threefold-use',n:'Threefold Use of the Law',d:'First use (civil/political): restraining evil in society (1 Tim 1:9–10). Second use (pedagogical/convicting): exposing sin and driving sinners to Christ (Rom 3:20; Gal 3:24). Third use (normative/didactic): guiding believers in grateful obedience - the principal use, the rule of life for the regenerate (Ps 119:105; Rom 8:4; WCF 19.6).',k:['threefold use','civil','convicting','normative','rule of life'],cl:['sanctification','sin','justification','law-gospel'],ct:'ethics'},
{id:'decalogue',n:'The Decalogue (Ten Commandments)',d:'Summary of the moral law given by God at Sinai (Exod 20:1–17; Deut 5:6–21; WCF 19.2). The preface declares God\'s sovereignty and redemptive grace as the ground of obedience (Exod 20:2). First table (1–4): duty to God - no other gods, no idols, reverence for His name, Sabbath. Second table (5–10): duty to neighbor - honor, life, purity, property, truth, contentment. Comprehended in the double command of love (Matt 22:37–40). The WLC devotes 62 questions (Q91–152) to the moral law - roughly 31% of the entire catechism - treating each commandment with duties required, sins forbidden, and reasons annexed.',k:['decalogue','ten commandments','love','duty','WLC','moral law','Sinai'],cl:['worship','covenant-theology','natural-law'],ct:'ethics'},
{id:'decalogue-preface',n:'The Preface to the Decalogue: Hermeneutical Key to the Entire Law',d:'\"I am the LORD thy God, which have brought thee out of the land of Egypt, out of the house of bondage\" (Exod 20:2; WLC Q101). The Westminster Standards treat this preface not as a mere historical preamble but as the theological foundation governing the interpretation of every commandment that follows. WLC Q101 teaches that the preface to the moral law contains three things: (1) God\'s sovereignty \u2013 \"I am the LORD,\" asserting His absolute right to give law as the self-existent covenant God (Yahweh); (2) God\'s covenant proprietorship \u2013 \"thy God,\" declaring that this law comes not from a distant legislator but from a God who has bound Himself to His people in covenant relation; and (3) His prior redemptive act \u2013 \"which have brought thee out of the land of Egypt,\" establishing that obedience is grounded in antecedent grace, not bare command. This is architectonically significant for the entire law-gospel relationship. Calvin insists that the preface demonstrates the law was given to an already-redeemed people \u2013 Israel did not obey in order to be delivered but was delivered in order to obey. The indicative of redemption precedes and grounds the imperative of obedience. This is the pattern that pervades the whole of Scripture: grace precedes and enables duty (cf. Rom 12:1 \u2013 \"I beseech you therefore, brethren, by the mercies of God\"; Eph 2:8\u201310 \u2013 saved by grace unto good works; Titus 2:11\u201314 \u2013 the grace of God teaches us to live godly). Calvin reads the preface as establishing that the Lawgiver is simultaneously the Redeemer: the God who commands is the God who saves, and therefore His commands are not a burden but the grateful response of a liberated people. The preface thereby destroys both antinomianism (which severs law from the redeemed life) and legalism (which severs obedience from prior grace). Kline notes that the Decalogue is cast not in the form of abstract moral axioms but in the covenantal form of a suzerain addressing His redeemed vassal \u2013 making the law inescapably personal, relational, and redemptive-historical. Calvin and Owen both argue that separating the commandments from their preface produces either servile terror or Pharisaic externalism \u2013 the preface is what makes obedience evangelical rather than legal. For the Reformed tradition, therefore, the preface is the hermeneutical key that unlocks the proper use of every commandment: each \"thou shalt\" and \"thou shalt not\" is to be read as the word of a redeeming God to a redeemed people, grounded in covenant love, enabled by covenant grace, and directed toward covenant fellowship. This principle is the practical outworking of WCF 19.6\u20137: the moral law is of use to believers not as a covenant of works demanding merit but as a rule of life revealing the will of their covenant God, who has already secured their salvation by free grace in Christ.',k:['preface','Exodus 20:2','WLC Q101','hermeneutical key','indicative-imperative','grace before law','redemption','covenant','antinomianism','legalism','law-gospel','evangelical obedience','suzerain','covenant proprietorship','Yahweh','redeemed people'],ct:'ethics'},
{id:'decalogue-rules',n:'Rules for Understanding the Commandments',d:'The WLC Q99 provides eight hermeneutical rules for interpreting the Ten Commandments: (1) the law is spiritual and reaches the understanding, will, and affections; (2) where a duty is commanded the contrary sin is forbidden, and where a sin is forbidden the contrary duty is commanded; (3) where a promise is annexed a threatening is included, and vice versa; (4) what is forbidden is at no time to be done, and what is commanded is always our duty; (5) what God forbids is at no time to be done; what He commands is always our duty, yet every particular duty is not to be done at all times; (6) under one sin or duty all of the same kind are forbidden or commanded, together with all the causes, means, occasions, and provocations thereunto; (7) what is forbidden or commanded to ourselves we are bound to endeavor that it may be avoided or performed by others; (8) what is commanded to others we are bound to help them in, and what is forbidden to them we ought not to share in.',k:['hermeneutical rules','WLC Q99','spiritual','duty','sin','causes','means','occasions','provocations'],ct:'ethics'},
{id:'first-table',n:'The First Table: Duties to God (Commandments 1–4)',d:'The first four commandments define humanity\'s duty toward God. The First Commandment (Exod 20:3) requires knowing, acknowledging, worshipping, glorifying, and enjoying God alone as the only true God and our God - forbidding atheism, idolatry, and giving to any other the worship due to God (WLC Q103–106). The Second Commandment (Exod 20:4–6) requires receiving, observing, and keeping pure all religious worship and ordinances as God has appointed, forbidding all devising, counseling, commanding, or practicing of worship not instituted by God (the Regulative Principle; WLC Q107–110). The Third Commandment (Exod 20:7) requires the holy and reverent use of God\'s names, titles, attributes, ordinances, Word, and works - forbidding all abuse of anything whereby God makes Himself known, including perjury and frivolous oaths (WLC Q111–114). The Fourth Commandment (Exod 20:8–11) requires sanctifying one whole day <i>in se</i>ven as a holy Sabbath to the Lord (WLC Q115–121).',k:['First Table','First Commandment','Second Commandment','Third Commandment','Fourth Commandment','worship','name','Sabbath','Regulative Principle','WLC Q103–121'],cl:['worship','sabbath-lords-day','regulative-principle','oaths-vows'],ct:'ethics'},
{id:'second-table',n:'The Second Table: Duties to Neighbor (Commandments 5–10)',d:'The last six commandments define humanity\'s duty toward neighbor. The Fifth Commandment (Exod 20:12) requires preserving the honor and performing the duties belonging to every relationship - superiors, inferiors, and equals. The WLC devotes 11 questions (Q123–133) constituting a complete social ethic covering authority structures in family, church, and commonwealth. The Sixth Commandment (Exod 20:13) requires all lawful endeavors to preserve our own life and the life of others (WLC Q134–136). The Seventh Commandment (Exod 20:14) requires the preservation of our own and our neighbor\'s chastity in heart, speech, and behavior (WLC Q137–139). The Eighth Commandment (Exod 20:15) requires the lawful procuring and furthering of the wealth and outward estate of ourselves and others (WLC Q140–142). The Ninth Commandment (Exod 20:16) requires the maintaining and promoting of truth between man and man, and of our own and our neighbor\'s good name (WLC Q143–145). The Tenth Commandment (Exod 20:17) requires full contentment with our own condition and a charitable disposition toward our neighbor and all that is his (WLC Q146–148).',k:['Second Table','Fifth Commandment','Sixth Commandment','Seventh Commandment','Eighth Commandment','Ninth Commandment','Tenth Commandment','honor','life','chastity','property','truth','contentment','social ethic','WLC Q123–148'],cl:['marriage-divorce','civil-magistrate','church-discipline'],ct:'ethics'},
{id:'aggravations-sin',n:'Aggravations of Sin',d:'Some sins in themselves, and by reason of several aggravations, are more heinous in the sight of God than others (WLC Q150–151; John 19:11; Ezek 8:6,13). WLC Q151 is one of the longest answers in the entire catechism, cataloging aggravations by: the persons offending (age, experience, office, eminence, gifts, profession, position of leadership), the parties offended (directly against God, Christ, the Holy Spirit, superiors, the weak, the souls of others), the nature and quality of the offense (against the express letter of the law, against many commands, against the light of nature, against conscience, against public or private admonition, against censures, against prayer, against repentance), and circumstances of time and place (on the Lord\'s Day, immediately after worship, in public). This doctrine is pastorally essential for church discipline, the examination of conscience, and distinguishing degrees of guilt.',k:['aggravations','degrees','WLC Q150','WLC Q151','heinous','circumstances','persons','quality','pastoral','discipline'],ct:'ethics'},
{id:'natural-law',n:'Natural Law & Moral Law',d:'God gave to Adam a law as a covenant of works, which was the moral law comprehensively and perfectly obliging him to exact obedience (WCF 19.1). This same law continues to bind all people (Rom 2:14–15; WCF 19.5). It is written on the heart of every person and is the light of nature, though sin obscures its apprehension (Rom 1:32; 2:14–15). The Decalogue is the full positive republication of this natural law.',k:['natural law','light of nature','moral obligation','creation','republication'],cl:['conscience','gen-revelation','common-grace','civil-magistrate','creation'],ct:'ethics'},
{id:'law-gospel',n:'Law and Gospel',d:'The law commands perfect obedience and curses transgressors (Gal 3:10; WCF 19.6). The gospel offers free grace for sinners through Christ (Rom 3:21\u20136). These are not contradictory but complementary: the law drives to Christ, and Christ fulfills the law (Matt 5:17; Rom 10:4). The moral law is of use to regenerate persons as a rule of life (WCF 19.6), and the gospel does not dissolve but strengthens obedience (Rom 3:31). GOSPEL LOGIC \u2013 THE PRIORITY OF INDICATIVES OVER IMPERATIVES: The proper relationship between law and gospel cannot be reduced to a simple \u201Cthree uses of the law\u201D schema without showing how the gospel itself transforms the believer\u2019s relationship to the law. Sinclair Ferguson demonstrates that the controlling structural principle is what he terms \u201Cgospel logic\u201D: the priority of divine indicatives (what God has done) over human imperatives (what God commands). Paul devotes 308 of 315 verses in Romans to declaring what God has accomplished in Christ before launching the imperatives of chapters 12\u201316. The indicative of redemption precedes and grounds the imperative of obedience (Rom 12:1 \u2013 \u201CI beseech you therefore, brethren, by the mercies of God\\\"; Eph 2:8\u201310 \u2013 saved by grace unto good works; Titus 2:11\u201314 \u2013 the grace of God teaches us). Ferguson warns: \u201CIf we reverse the order of gospel logic it will not be long before we are smuggling our sanctification into the foundations of our justification.\u201D A systematic presentation that treats doctrines as abstract propositions without maintaining this indicative-imperative structure risks the very legalism the Reformation diagnosed. LEGALISM AND ANTINOMIANISM AS NON-IDENTICAL TWINS: Ferguson\u2019s most penetrating contribution is the demonstration that legalism and antinomianism are \u201Cnon-identical twins from the same womb\u201D \u2013 both rooted in a fundamental distrust of God\u2019s generosity. The legalist distrusts God\u2019s grace and seeks to establish security through law-keeping; the antinomian distrusts God\u2019s goodness and concludes that His commands must be restrictive rather than liberating. Both errors share the same root \u2013 the Edenic suspicion that God is not truly generous, that His character cannot be trusted \u2013 and both are cured by the same medicine: receiving \u201Cthe whole Christ,\u201D not merely His benefits abstracted from His person. When sinners receive Christ Himself \u2013 not just forgiveness, not just moral instruction, but the living Person of the Mediator in all His offices \u2013 both errors are dissolved simultaneously. The law is no longer a threatening accuser (against legalism) nor an irrelevant relic (against antinomianism) but the beloved will of a trusted Father, obeyed with evangelical gratitude by those who have first received His grace. This insight recovers the Marrow tradition\u2019s central conviction: the law as a covenant of works condemns, but the same law in the hands of Christ as a rule of life guides the redeemed with paternal tenderness (WCF 19.6\u20137). The gospel does not merely add forgiveness alongside the law\u2019s demands but fundamentally transforms the believer\u2019s posture toward the law \u2013 from servile terror to filial delight (Ps 119:97; Rom 7:22). The three uses of the law (pedagogical, civil, normative) remain valid and indispensable categories (WCF 19.1\u20136), but they must be situated within this larger gospel-logic framework: the law\u2019s third use (as a rule of life for believers) functions properly only within the context of prior union with Christ by faith, where obedience flows from gratitude rather than from a quest for acceptance. Calvin insists that the preface to the Decalogue (Exod 20:2) establishes this pattern architectonically: the law was given to an already-redeemed people. Israel did not obey in order to be delivered but was delivered in order to obey. Calvin reads this as establishing that the Lawgiver is simultaneously the Redeemer, thereby destroying both antinomianism and legalism at their shared root.',k:['law','gospel','curse','grace','complementary','antinomianism','legalism','gospel logic','indicative-imperative','non-identical twins','distrust','generosity','three uses','rule of life','WCF 19.6','Marrow','evangelical obedience','filial delight','Ps 119:97','Rom 12:1','Titus 2:11'],cl:['justification','free-offer-gospel','threefold-use','marrow-controversy','covenant-works','covenant-grace'],ct:'ethics'},
{id:'abrogation-law',n:'Abrogation of Ceremonial & Judicial Law',d:'The ceremonial laws, being types and shadows of Christ and the good things to come, are now abrogated under the New Testament (WCF 19.3; Col 2:14,16–17; Heb 9–10). The judicial laws given to Israel as a body politic expired together with that state, not obliging any other now further than the general equity thereof may require (WCF 19.4). Only the moral law, summarized in the Ten Commandments, continues in perpetual obligation upon all mankind (WCF 19.5; Rom 13:8–10; Jas 2:8–12).',k:['abrogation','ceremonial','judicial','general equity','moral','perpetual','types','shadows','expired'],cl:['new-covenant','christ','mosaic-covenant'],ct:'ethics'},
{id:'triperspectivalism',n:'Triperspectivalism (the Three Perspectives)',d:'The triperspectival method proposes that every ethical question - and indeed every theological question - can and should be approached from three complementary perspectives, each of which illuminates the whole but from a different angle. (1) The normative perspective asks: What do God\'s norms (His law, His Word) require? This corresponds to the traditional focus on divine commands, moral principles, and biblical exegesis. It examines the standard by which actions are measured. (2) The situational perspective asks: What are the facts of the situation to which God\'s norms must be applied? This corresponds to attention to circumstances, consequences, and the created order. It examines the world in which obedience takes place - the physical, social, historical, and relational context of moral action. (3) The existential perspective asks: What inner attitudes, motivations, and character qualities does God require of the moral agent? This corresponds to virtue ethics and the emphasis on the heart, the affections, and the work of the Spirit in sanctification. It examines the person who acts. Frame holds that these three perspectives are not three different ethical systems but three aspects of every ethical judgment - each one, when fully pursued, includes the other two. A normative analysis that ignores the situation or the agent is incomplete; a situational analysis that ignores God\'s commands is secular; an existential analysis that ignores norms and facts is subjectivist. The three perspectives correspond to the three lordship attributes Frame identifies in Scripture: God\'s authority (normative), His control (situational), and His presence (existential). Frame draws on Van Til\'s insight that the self, the world, and God\'s law are equally ultimate epistemological starting points for the regenerate mind, since each presupposes and leads to the others. This method has been applied beyond ethics to apologetics (presuppositional argument from norms, facts, and self-awareness), theology proper, and practical ministry. Critics (including some Reformed theologians) question whether the three perspectives are genuinely interchangeable or whether the normative perspective retains logical priority as the Creator\'s authoritative Word. Frame responds that priority belongs to God Himself, who is equally the Author of norm, situation, and person. Frame developed and extended the triperspectival method across the breadth of his polymathic career, applying it not only to ethics and apologetics but to hermeneutics, science, mathematics, sociology, philosophy, and historical method. Frame grounds the three perspectives explicitly in the Trinitarian relations: the normative perspective reflects the Father\'s authoritative speech, the situational perspective reflects the Son\'s structuring of all reality as Logos, and the existential perspective reflects the Spirit\'s indwelling application. The three perspectives thus coinhere because the three divine Persons coinhere : <i>perichoresis</i> in the Godhead is the archetype of perspectival coinherence in human knowing. This Trinitarian grounding transforms triperspectivalism from a mere heuristic into a theological claim about the structure of reality itself.',k:['triperspectivalism','normative','situational','existential','three perspectives','lordship','authority','control','presence','ethics','virtue','law','situation','agent','motivation','heart','sanctification','interchangeable','Trinitarian','<i>perichoresis</i>','polymathic','science','mathematics','sociology','philosophy','history'],ct:'ethics'},
]},


{id:'covenant-theology',n:'Covenant Theology: The Organizing Principle',ct:'soteriology',c:'#d8907c',r:1.6,o:8.5,
d:'Covenant theology is the single most important structural and organizing principle of the Westminster confessional system. WCF chapters 7\u20138 are not merely one locus among many \u2013 covenant is the architectonic spine of the entire confession. The three covenants \u2013 the <i>pactum salutis</i> (covenant of redemption), the covenant of works, and the covenant of grace \u2013 form a Trinitarian-shaped, redemptive-historical architecture that holds the entire system together. The <i>pactum salutis</i> is the eternal, intra-Trinitarian foundation in which the Father appoints the Son as Mediator and the Spirit undertakes to apply redemption. The covenant of works is the probationary arrangement with Adam as federal head, offering confirmed life for perfect obedience. The covenant of grace is the historical outworking of the pactum, in which God freely offers life and salvation to sinners through Jesus Christ, requiring faith as the instrument of reception (WCF 7.3). The bicovenantal structure of the WCF (works/grace) is distinctive and architectonically significant. Against monocovenantal schemes (which collapse the covenant of works into the covenant of grace, denying any pre-fall works arrangement), the WCF insists on a genuine covenant of works with Adam (WCF 7.2; 19.1) \u2013 a point essential for understanding Christ\'s active obedience as the fulfillment of the Adamic covenant and the ground of imputed righteousness in justification. Against dispensationalism (which multiplies covenants and discontinuities between Israel and the church), the WCF affirms the substantial unity of the covenant of grace across all its administrations: \u201CThere are not therefore two covenants of grace, differing in substance, but one and the same, under various dispensations\u201D (WCF 7.6). The golden chain of Reformed soteriology is thus: eternal decree of election \u2192 <i>pactum salutis</i> (Trinitarian covenantal commitment) \u2192 covenant of works (probation and fall) \u2192 covenant of grace (promise and fulfillment in Christ) \u2192 application of redemption by the Spirit. This chain connects theology proper (decree, pactum) to anthropology (covenant of works, fall), to Christology (Christ as covenant surety and Last Adam), to soteriology (justification through imputed covenant righteousness), to ecclesiology (the church as the covenant community), to eschatology (the consummation of the covenant promises). Every major doctrine in the Westminster system has a covenantal address. The Reformed scholastic tradition is organized covenantally; Witsius provides the most comprehensive early modern treatment; Vos and Murray have provided significant modern expositions. Bavinck treats covenant theology as the architectonic framework of the entire Reformed system, insisting that \u201Cthe doctrine of the covenant is the dogmatic expression of the idea that religion is fellowship between God and man.\u201D',
k:['covenant theology','organizing principle','architectonic','WCF 7','WCF 8','bicovenantal','<i>pactum salutis</i>','covenant of works','covenant of grace','Trinitarian','monocovenantal','dispensationalism','unity','golden chain','decree','election','fellowship','spine','confessional'],
cl:['pactum','covenant-works','covenant-grace','decree','christ','salvation','church','eschatology','law','biblical-theology','sacraments','free-will','creation'],
s:[
{id:'noahic-covenant',n:'The Noahic Covenant',d:'The universal covenant of preservation established by God with Noah, his seed, and every living creature after the Flood (Gen 8:20\u20139:17; WCF 7.5 by implication; Isa 54:9\u201310). God covenanted never again to destroy the earth by flood, establishing the regularity of the seasons, the stability of the creation order, and the continuity of common life as the theater for redemptive history. The rainbow is the covenant sign (Gen 9:12\u201317). The Noahic covenant is the covenantal ground of common grace: God preserves the created order, restrains the full expression of sin, and sustains human culture, government, and life for the sake of His redemptive purpose. It connects to providence (God\'s sustaining governance), common grace (non-salvific divine goodness), the civil magistrate (the institution of capital punishment as a restraint on violence, Gen 9:5\u20136), and natural law (the moral order preserved through the Noahic arrangement). Meredith Kline assigns the Noahic covenant architectonic significance as the covenant of common grace par excellence, distinguishing it from the particularistic covenants of special grace. Bavinck treats it as the foundation for God\'s providential preservation of the world.',k:['Noahic covenant','Noah','Gen 9','preservation','common grace','rainbow','creation order','providence','civil magistrate','Gen 9:6','universal','seasons','flood','theater','restraint'],cl:['common-grace','providence','civil-magistrate','creation'],ct:'soteriology'},
{id:'abrahamic-covenant',n:'The Abrahamic Covenant',d:'The foundational promissory covenant in which God unconditionally committed Himself to Abraham and his seed: \u201CI will establish my covenant between me and you and your offspring after you throughout their generations for an everlasting covenant, to be God to you and to your offspring after you\u201D (Gen 17:7; cf. Gen 12:1\u20133; 15:1\u201321; 17:1\u201327; 22:15\u201318). The Abrahamic covenant is the mother-promise of the entire covenant of grace, and its structure governs the Reformed understanding of the relationship between the testaments. Three features are architectonically significant: (1) The covenant sign of circumcision was given not only to Abraham but to his seed, including infant males on the eighth day (Gen 17:10\u201314). This establishes the principle that the covenant community includes believers and their children \u2013 the foundational argument for infant baptism in the Reformed tradition (Acts 2:39; Col 2:11\u201312; 1 Cor 7:14; WCF 28.4). (2) The covenant was sealed by a self-maledictory oath: God Himself passed between the severed animals in Gen 15:17, signifying that He would bear the curse of covenant-breaking rather than allow His promises to fail (Gal 3:13\u201314; Heb 6:13\u201318). (3) The promise encompasses both spiritual and typological-earthly blessings: justification by faith (Gen 15:6; Rom 4:3; Gal 3:6\u20139), the land as a type of the eschatological inheritance, and the worldwide blessing through the Seed (Gen 22:18; Gal 3:16,29). Paul\'s argument in Galatians 3\u20134 and Romans 4 is that the Abrahamic covenant is the permanent and controlling covenantal framework into which all subsequent administrations must be fitted. The Mosaic law does not annul the Abrahamic promise but serves it (Gal 3:17\u201321). The New Covenant is the fulfillment of the Abrahamic promise (Luke 1:54\u201355,72\u201373; Gal 3:29).',k:['Abrahamic covenant','Abraham','Gen 17:7','Gen 15','promise','circumcision','infant baptism','seed','believers and their children','Acts 2:39','Col 2:11','WCF 28.4','paedobaptism','self-maledictory oath','Gen 15:17','justification by faith','Gen 15:6','Rom 4','Gal 3','land','inheritance','Seed','worldwide blessing','foundational','mother-promise'],cl:['baptism','justification','covenant-signs','elect-infants'],ct:'soteriology'},
{id:'davidic-covenant',n:'The Davidic Covenant',d:'God\'s covenant with David promising an everlasting kingdom, an eternal throne, and a Son who would reign forever (2 Sam 7:12\u201316; Ps 89:3\u20134,19\u201337; Ps 132:11\u201318; Isa 9:6\u20137; 11:1\u201310). The Davidic covenant is the covenantal basis of Christ\'s kingship: Jesus is the Son of David (Matt 1:1; Rom 1:3; Rev 22:16), born to sit on David\'s throne (Luke 1:32\u201333; Acts 2:30\u201336), and exalted as King of kings and Lord of lords (Rev 19:16). The Davidic covenant connects Christology to eschatology: Christ\'s mediatorial reign from the Father\'s right hand (Ps 110:1\u20132; Acts 2:33\u201336; 1 Cor 15:25) is the present fulfillment of the Davidic promise, and His return in glory will consummate it. The Psalter\'s royal psalms (Ps 2; 45; 72; 89; 110; 132) celebrate this covenant and its messianic trajectory. Vos and Bavinck treat the Davidic covenant as a crucial stage in the progressive unfolding of the kingdom of God.',k:['Davidic covenant','David','2 Sam 7','Ps 89','Ps 132','throne','kingdom','eternal','kingship','Christ','Son of David','mediatorial reign','Ps 110','eschatology','royal psalms','kingdom of God','Luke 1:32','Acts 2:30','Rev 19:16','messianic'],cl:['kingdom-of-god','christ','eschatology','return-christ','theology-psalter'],ct:'soteriology'},
{id:'new-covenant',n:'The New Covenant',d:'The covenant in which all prior covenants find their substance and consummation: \u201CBehold, the days are coming, declares the LORD, when I will make a new covenant with the house of Israel and the house of Judah\u201D (Jer 31:31\u201334; cf. Ezek 36:25\u201327; Heb 8:6\u201313; 10:15\u201318; Luke 22:20; 1 Cor 11:25). The New Covenant is not a replacement of the covenant of grace but its fullest, final, and most glorious administration (WCF 7.6). Its distinguishing features include: (1) the internalization of the law \u2013 God writes His law on the hearts of His people (Jer 31:33; Ezek 36:26\u201327; 2 Cor 3:3); (2) the universal knowledge of God among covenant members (Jer 31:34; Heb 8:11); (3) the definitive forgiveness of sins through the once-for-all sacrifice of Christ (Jer 31:34; Heb 9:12\u201315; 10:11\u201318); (4) the gift of the Holy Spirit poured out in eschatological fullness (Joel 2:28\u201332; Acts 2:16\u201321; Ezek 36:27). The New Covenant is ratified in Christ\'s blood (Luke 22:20; 1 Cor 11:25; Heb 9:15\u201322), administered through the preaching of the Word and the sacraments of baptism and the Lord\'s Supper (WCF 7.6), and consummated at the return of Christ when the covenant promises are fully and finally realized in the new creation (Rev 21:3\u20134 \u2013 \u201CBehold, the dwelling place of God is with man\u201D). Hebrews 8\u201310 provides the fullest NT exposition, demonstrating that the New Covenant is \u201Cbetter\u201D (Heb 7:22; 8:6) because of its better Mediator, better sacrifice, and better promises.',k:['New Covenant','Jer 31:31','Heb 8','Heb 10','Luke 22:20','internalization','law on hearts','forgiveness','Holy Spirit','Joel 2:28','Acts 2','consummation','substance','fulfillment','WCF 7.6','blood','ratified','better covenant','Mediator','sacrifice','new creation','Rev 21:3','Ezek 36:26','definitiveness'],cl:['covenant-grace','holy-spirit','lords-supper','baptism','justification','sanctification','spirit-pentecost','new-creation'],ct:'soteriology'}
]},

{id:'covenant-grace',n:'The Covenant of Grace',ct:'soteriology',c:'#d8907c',r:1.55,o:9,
d:'After the fall, God freely offered life and salvation by Jesus Christ in the covenant of grace - requiring faith in Him for salvation (Gen 3:15; WCF 7.3). One covenant in substance throughout all ages: same Mediator (Christ), same condition (faith), same benefits (forgiveness, adoption, eternal life) - though administered differently under Old and New Testaments (WCF 7.5–6). Grounded in the eternal <i>pactum salutis</i>.',
k:['covenant of grace','one covenant','substance','administration','faith','mediator','protoevangelium','Abrahamic','Mosaic','Davidic','new covenant','progressive','fulfillment'],
cl:['christ','pactum','salvation','church','covenant-works','eschatology','covenant-theology','mosaic-covenant','old-new-testament','covenant-unity','sin','creation','sacraments','holy-spirit','biblical-theology'],
hc:['Cocceian-Voetian debate','Marrow Controversy (1718-1723)','Dispensationalism vs. Covenant Theology'],
s:[
{id:'covenant-unity',n:'Unity & Diversity of the Covenants',d:'One substance, different administrations (WCF 7.5–6). Abrahamic (Gen 17:7), Mosaic (Exod 19–24), Davidic (2 Sam 7:12–16), and New Covenants (Jer 31:31–34) are successive administrations of the one covenant of grace. Under the Old Testament, it was administered by promises, prophecies, sacrifices, circumcision, the paschal lamb, and other types, all foresignifying Christ to come (WCF 7.5).',k:['unity','diversity','Abrahamic','Mosaic','Davidic','new covenant','progressive'],ct:'soteriology'},
{id:'covenant-signs',n:'Covenant Signs & Seals',d:'Circumcision and Passover under the Old; baptism and Lord\'s Supper under the New (Col 2:11–12; 1 Cor 5:7; WCF 27.1; 28.1; 29.1). They signify, seal, and exhibit covenant benefits to faith - not <i>ex opere operato</i>. The sacraments of the Old Testament were in substance the same with those of the New (WCF 7.5–6; 1 Cor 10:1–4).',k:['signs','seals','circumcision','baptism','Lord\'s Supper'],cl:['baptism','lords-supper','abrahamic-covenant','sacraments'],ct:'soteriology'},
{id:'old-new-testament',n:'Old and New Testament Administrations',d:'Under the Old Testament: promise, type, shadow - fewer in number, more obscure, less efficacious in administration (WCF 7.5; Gal 4:1–3; Heb 10:1). Under the New Testament: fulfillment, substance, clarity - the covenant is administered in the preaching of the Word and the sacraments of Baptism and the Lord\'s Supper with greater fullness, evidence, and spiritual efficacy (WCF 7.6; 2 Cor 3:7–18; Heb 8:6).',k:['Old Testament','New Testament','type','shadow','fulfillment','continuity'],cl:['mosaic-covenant','new-covenant','abrahamic-covenant','interpretation'],ct:'soteriology'},
{id:'mosaic-covenant',n:'The Mosaic Covenant',d:'The Mosaic administration of the covenant of grace (WCF 7.5; 19.1–2). NOTE ON COMPLEXITY: While the confessional position rightly identifies the Mosaic covenant as an administration of the covenant of grace, the republication debate demonstrates significant complexity. Was the Mosaic covenant at Sinai a republication of the covenant of works in some sense, overlaid upon the covenant of grace? The Kline school and contributors argue for a typological works principle at the national level, while critics warn against introducing merit within the covenant of grace. The OPC report on republication adjudicates carefully. See the Intra-Reformed Debates section for fuller treatment. Given at Sinai with the moral, ceremonial, and judicial law. The moral law republished the covenant of works as a rule of life (WCF 19.1–2); the ceremonial and judicial laws served typological and civil purposes. The Mosaic economy was a genuine administration of the covenant of grace, directing Israel to Christ (Gal 3:17–24).',k:['Mosaic','Sinai','law','typology','pedagogue','covenant of grace administration'],cl:['law','decalogue','abrogation-law','republication-debate'],ct:'soteriology'},
]},

{id:'holy-spirit',n:'The Holy Spirit',ct:'pneumatology',c:'#a0d8c0',r:1.3,o:10,
d:'The third Person of the Trinity - true and eternal God, of one substance with the Father and the Son (Acts 5:3\u20134; 2 Cor 3:17\u201318; WCF 2.3). The Lord and Giver of life: active in creation (Gen 1:2), the Author of Scripture (2 Pet 1:21), the Agent of all application of redemption, and the bond of communion between Christ and His people (Rom 8:9\u201311; WCF 8.8). Reformed pneumatology distinguishes the Spirit\u2019s common operations (restraining sin, enabling culture) from His special saving operations (regenerating, sanctifying, sealing the elect). Calvin has been called \u201Cthe theologian of the Holy Spirit\u201D largely for the doctrine of the <i>testimonium internum</i>. A fully articulated pneumatology spans creation, inspiration, the internal testimony, regeneration, sanctification, indwelling, gifting, prayer, and the Spirit\u2019s constituting of the Church. THE REFORMED TRADITION ON CHRISTOLOGICAL PNEUMATOLOGY: Sinclair Ferguson has argued that the Spirit \u201Cremains to many Christians an anonymous, faceless aspect of the divine being,\u201D and that the remedy for this deficiency is a rigorously Christological pneumatology. The Spirit is fundamentally \u201Cthe Spirit of Christ\u201D (Rom 8:9; Phil 1:19; 1 Pet 1:11; Gal 4:6) whose primary ministry is to glorify the Son (John 16:14). Ferguson\u2019s distinctive and architectonically important insight is that the Spirit\u2019s work must not be treated as an appendage to soteriology \u2013 as though Christ accomplishes salvation and the Spirit merely delivers the package \u2013 but as the very mode by which believers possess Christ Himself. \u201CHaving the Spirit is equivalent, indeed the very mode, of having the incarnate, obedient, crucified, resurrected and exalted Christ indwelling us\u201D. This means that every pneumatological topic \u2013 regeneration, sanctification, indwelling, gifting, intercession \u2013 must be understood not as the Spirit working independently of Christ but as the Spirit mediating the living Christ to His people. The Spirit does not bring gifts separate from Christ but brings Christ Himself, and in bringing Christ brings all His benefits simultaneously. This Christological principle guards against two errors: (a) treating the Spirit as an impersonal force or energy rather than as a divine Person whose personal identity is defined by His eternal relation to the Son; and (b) abstracting the \u201Cbenefits\u201D of salvation (justification, sanctification, adoption) from the Person of Christ who is their source and substance \u2013 the very error Ferguson identifies as the root of both legalism and antinomianism. When believers receive the Spirit, they receive Christ; when they receive Christ, they receive \u201Cthe whole Christ\u201D with all His benefits inseparably. ESCHATOLOGICAL-CHRISTOLOGICAL DIMENSION: The Spirit\u2019s primary saving work is to unite believers to the resurrected Christ, effecting their participation in His eschatological life. Gaffin\u2019s decisive exegetical contribution is the demonstration that the Spirit is the eschatological gift par excellence: the \u201Clast Adam became the life-giving Spirit\u201D (1 Cor 15:45) is Paul\u2019s one-sentence commentary on the meaning of Pentecost \u2013 the resurrected, exalted Christ now communicates His resurrection life to His people by and as the Spirit. The Spirit is thus not merely the applier of benefits earned elsewhere but the mode of Christ\u2019s own eschatological presence with His people. He is the <i>arrabon</i> (down payment, guarantee) of the eschatological inheritance (Eph 1:13\u201314; 2 Cor 1:22; 5:5), the firstfruits of the age to come (Rom 8:23), and the power by which believers already participate in the new creation while awaiting its consummation. Every dimension of the Spirit\u2019s saving work \u2013 regeneration, sanctification, indwelling, gifting, intercession \u2013 is an expression of this one fundamental reality: incorporation into the eschatological life of the risen Christ.',
k:['Holy Spirit','deity','procession','regeneration','illumination','indwelling','sealing','sanctification','gifts','communion','application','anointing','<i>testimonium</i>','<i>Creator Spiritus</i>','common operations','special operations','fruit','prayer','church','eschatological gift','<i>arrabon</i>','firstfruits','1 Cor 15:45','life-giving Spirit','Pentecost','union with Christ','resurrection life','Spirit of Christ','Christological pneumatology','glorify the Son','John 16:14','mode of having Christ','anonymous','whole Christ'],
cl:['trinity','christ','salvation','scripture','church','eschatology','spirit-deity','spirit-regeneration','spirit-sanctification','spirit-church','spirit-pentecost','pactum','sacraments','means-grace','covenant-grace','sin'],
s:[
{id:'spirit-deity',n:'The Personality & Deity of the Holy Spirit',d:'The Holy Spirit is a distinct divine Person - not a mere force, energy, or attribute - possessing intellect (1 Cor 2:10–11), will (1 Cor 12:11), and affections (Eph 4:30). He is fully God: consubstantial with the Father and the Son, equal in power and glory (Matt 28:19; 2 Cor 13:14; WCF 2.3). He eternally proceeds from the Father and the Son (<i>filioque</i>, WCF 2.3; John 15:26; Gal 4:6). To lie to the Spirit is to lie to God (Acts 5:3–4). Against the Pneumatomachi and Socinians: He is not a creature but the eternal, uncreated God.',k:['personality','deity','consubstantial','divine Person','intellect','will','Pneumatomachi','Lord','Creator','<i>filioque</i>','procession'],ct:'pneumatology'},
{id:'spirit-creation',n:'The Spirit in Creation & Providence',d:'The Spirit of God was hovering over the face of the waters (Gen 1:2) - the <i>Creator Spiritus</i> active in the original formation and ongoing sustenance of the created order. When God sends forth His Spirit, creatures are created; He renews the face of the ground (Ps 104:30). The breath of the Almighty gives life (Job 33:4). The Spirit upholds all things in providence, distributing natural gifts, sustaining the order of creation, and governing the course of nature. This cosmological dimension of pneumatology is foundational: the Spirit who recreates in salvation is the same Spirit who creates and sustains all things.',k:['<i>Creator Spiritus</i>','creation','Gen 1:2','Ps 104:30','providence','sustenance','cosmological','Job 33:4'],ct:'pneumatology'},
{id:'spirit-scripture',n:'The Spirit & Scripture (Inspiration)',d:'Holy men of God spoke as they were carried along by the Holy Spirit (2 Pet 1:21). All Scripture is <i>theopneustos</i> - God-breathed (2 Tim 3:16). The Spirit is the divine Author who organically superintended the human authors, using their personalities, styles, and circumstances to produce exactly what God intended (WCF 1.2). This pneumatological ground of Scripture is distinct from both illumination (the Spirit\'s help in understanding Scripture) and the <i>testimonium</i> (the Spirit\'s work in producing certainty of Scripture\'s authority). Bavinck treats this extensively as the <i>principium cognoscendi externum</i> in its pneumatological aspect.',k:['inspiration','<i>theopneustos</i>','carried along','2 Pet 1:21','2 Tim 3:16','organic','superintendence','divine authorship'],cl:['inspiration','inerrancy','authority-scripture'],ct:'pneumatology'},
{id:'spirit-testimonium',n:'The <i>Testimonium Internum</i> Spiritus Sancti',d:'The internal testimony of the Holy Spirit - arguably the distinctive Calvinist pneumatological contribution. Our full persuasion and assurance of the infallible truth and divine authority of Scripture is from the inward work of the Holy Spirit, bearing witness by and with the Word in our hearts (WCF 1.5; 1 John 2:20,27; 1 Cor 2:10–12). This is not new revelation but the Spirit producing in the regenerate heart a settled certainty and conviction of Scripture\'s divine origin and authority. Calvin and Bavinck treat this as the <i>principium internum</i> of theology. It is categorically distinct from illumination: the <i>testimonium</i> concerns the certainty that Scripture IS God\'s Word; illumination concerns understanding what Scripture MEANS.',k:['<i>testimonium internum</i>','internal testimony','WCF 1.5','certainty','assurance','<i>principium internum</i>','<i>autopiston</i>','divine authority'],cl:['assurance','authority-scripture','scripture-self-attestation'],ct:'pneumatology'},
{id:'spirit-illumination',n:'Illumination',d:'The Spirit illuminates the minds of believers to understand Scripture savingly (1 Cor 2:10–14; Eph 1:17–18; WCF 1.6). The natural man does not accept the things of the Spirit of God, for they are folly to him (1 Cor 2:14). Illumination is the Spirit\'s ongoing work in helping believers comprehend, apply, and profit from what Scripture teaches. It is not new revelation but the opening of eyes to see what is already written (Ps 119:18; Luke 24:45). Distinct from the <i>testimonium</i> (which produces certainty of Scripture\'s authority) and from inspiration (which produced Scripture itself).',k:['illumination','understanding','1 Cor 2:14','Ps 119:18','WCF 1.6','ongoing','comprehension','application'],cl:['interpretation','preaching-word','knowledge-god'],ct:'pneumatology'},
{id:'spirit-regeneration',n:'The Spirit as Regenerator',d:'Regeneration is the sovereign, instantaneous, monergistic work of the Holy Spirit in which He imparts new spiritual life to the elect, renewing the will, enlightening the mind, and opening the heart (John 3:3–8; Ezek 36:26–27; Titus 3:5; WCF 10.1). The Spirit breathes where He wishes (John 3:8) - regeneration is entirely a divine act, not a human decision. It is logically prior to faith: the dead heart must be made alive before it can believe. The Reformed tradition holds this under "Spiritus Recreator." The Spirit removes the heart of stone and gives a heart of flesh (Ezek 36:26), effectually calling and drawing the elect to Christ (John 6:44,63).',k:['regeneration','new birth','monergistic','Ezek 36:26','John 3:3','Spiritus Recreator','effectual','sovereign','heart of flesh'],cl:['calling-regen','will-grace','total-depravity','pactum-spirit','faith-repentance'],ct:'pneumatology'},
{id:'spirit-pentecost',n:'Pentecost as <i>Historia Salutis</i> Event',d:'Pentecost (Acts 2:1\u201341) is not primarily a repeatable <i>ordo salutis</i> experience but a once-for-all, unrepeatable event in the <i>historia salutis</i> \u2013 as consequential and epoch-making as the incarnation, death, and resurrection of Christ. Gaffin\u2019s decisive contribution is to locate the outpouring of the Spirit within the series of Christ\u2019s eschatological acts: just as the cross and resurrection are unrepeatable redemptive-historical events that accomplish salvation, so Pentecost is the unrepeatable redemptive-historical event by which the exalted Christ begins to apply that accomplished salvation through the Spirit. Paul\u2019s statement that \u201Cthe last Adam became the life-giving Spirit\u201D (1 Cor 15:45) functions as a one-sentence commentary on the meaning of Pentecost: the resurrected and exalted Christ, having entered upon His eschatological existence, now communicates His resurrection life to His people by and as the Spirit. This is not a confusion of the persons of the Trinity (modalism) but a functional-eschatological identification: the Spirit is the mode of Christ\u2019s post-ascension, eschatological presence with His people (2 Cor 3:17\u201318; Rom 8:9\u201311). At Pentecost, the age to come invaded the present age in its applicatory dimension: the Spirit is the eschatological gift promised by the prophets (Joel 2:28\u201332; Ezek 36:26\u201327; Isa 32:15; 44:3), poured out in the \u201Clast days\u201D (Acts 2:17) as the <i>arrabon</i> (down payment, guarantee) of the eschatological inheritance (Eph 1:13\u201314; 2 Cor 1:22; 5:5) and the firstfruits of the consummation (Rom 8:23). The Spirit\u2019s primary saving work, inaugurated at Pentecost, is to unite believers to the resurrected Christ and thereby effect their participation in His death, resurrection, and exaltation (Rom 6:3\u20135; Eph 2:5\u20136; Col 3:1\u20134). Every subsequent reception of the Spirit by individual believers is an <i>ordo salutis</i> participation in what was accomplished once for all at Pentecost in the <i>historia salutis</i> \u2013 just as every believer\u2019s justification is an <i>ordo salutis</i> participation in what was accomplished once for all at the cross and resurrection. Against Pentecostalism and the <i>charis</i>matic movement: the extraordinary phenomena of Acts 2 (tongues, miraculous signs) belong to the foundational, unrepeatable character of the event itself and are not normative for subsequent Christian experience. Pentecost stands with Good Friday and Easter as a completed, constitutive redemptive event \u2013 its benefits are continually applied, but the event itself is not repeated. Herman Ridderbos developed Gaffin\u2019s insight by demonstrating how the Pentecost event anchors the pneumatological dimension of the already/not-yet eschatological framework: the Spirit given at Pentecost is the power of the age to come operative within the present age, creating the eschatological tension that defines the Christian life between Christ\u2019s first and second advents.',k:['Pentecost','<i>historia salutis</i>','Acts 2','1 Cor 15:45','life-giving Spirit','last Adam','eschatological gift','<i>arrabon</i>','firstfruits','Joel 2:28','Ezek 36:26','unrepeatable','redemptive-historical','Reformed eschatology','already not yet','age to come','tongues','cessation','functional identification','2 Cor 3:17','application','ascension','exaltation','inaugurated'],cl:['spirit-church','new-covenant','resurrection-eschatological-event','historia-ordo-relationship'],ct:'pneumatology'},
{id:'spirit-sanctification',n:'The Spirit of Holiness',d:'The Spirit is the agent of both definitive and progressive sanctification \u2013 the renewal of the whole person after the image of God (WCF 13.1; 2 Thess 2:13; 1 Pet 1:2; Rom 8:13). He enables believers to mortify the deeds of the body (Rom 8:13), produces the fruit of holiness (Gal 5:22\u201323), and works in them both to will and to do of His good pleasure (Phil 2:13). Sanctification is imperfect in this life due to remaining corruption, creating the war between flesh and Spirit (Gal 5:17; Rom 7:14\u201325; WCF 13.2\u20133). Ferguson devotes a dedicated chapter to \u201CThe Spirit of Holiness,\u201D distinguishing the Spirit\u2019s sanctifying work as categorically different from justification \u2013 infused renewal versus forensic declaration. Murray\u2019s crucial contribution distinguishes definitive sanctification (the Spirit\u2019s once-for-all breach of sin\u2019s dominion at the moment of union with Christ, Rom 6:1\u201314) from progressive sanctification (the ongoing work described here): both are the Spirit\u2019s work, but the former is a decisive, irreversible event coincident with effectual calling, while the latter is the lifelong process of renewal flowing from it. ESCHATOLOGICAL GROUND: Gaffin holds that the Spirit\u2019s sanctifying work is fundamentally eschatological in character \u2013 the application of Christ\u2019s resurrection power to the believer. The deepest motive for sanctification is not psychological but eschatological: it is \u201Cnot our psychology, not how I \u2018feel\u2019 about God and Jesus.. but the resurrection power of Christ and the new creation that we are and have already been made a part of\u201D. The Spirit who sanctifies is the \u201CSpirit of Him who raised Jesus from the dead\u201D (Rom 8:11), and His sanctifying work is the progressive realization in the believer\u2019s experience of the eschatological life already inaugurated in Christ\u2019s resurrection. Definitive sanctification is thus sanctification as an eschatological event; progressive sanctification is the outworking of that eschatological reality in the believer\u2019s daily existence between the already and the not-yet. CHRISTOLOGICAL PNEUMATOLOGY APPLIED TO SANCTIFICATION: Ferguson insists that the Spirit\u2019s sanctifying work must not be treated as an appendage to soteriology \u2013 as though the Spirit merely delivers benefits that Christ has earned elsewhere \u2013 but as the very mode by which believers possess Christ Himself in His sanctifying power. \"Having the Spirit is equivalent, indeed the very mode, of having the incarnate, obedient, crucified, resurrected and exalted Christ indwelling us\". This means that the Spirit does not bring sanctification as a separate gift alongside Christ; rather, the Spirit brings Christ, and in bringing Christ brings His sanctifying presence. The Spirit\u2019s sanctifying work is fundamentally Christological: He is \"the Spirit of Christ\" (Rom 8:9) whose primary ministry is to glorify the Son (John 16:14), and He sanctifies by conforming believers to the image of Christ (2 Cor 3:18; Rom 8:29). This Christological principle guards against reducing sanctification to a self-help program of moral effort: sanctification is not something the believer achieves with the Spirit\u2019s assistance but something the Spirit accomplishes by deepening the believer\u2019s union with and devotion to the living Christ.',k:['sanctification','progressive','definitive sanctification','mortification','vivification','holiness','Gal 5:17','Rom 8:13','renewal','image of God','WCF 13','Rom 6','resurrection power','eschatological','new creation','Rom 8:11','Spirit of Him who raised Jesus','Christological pneumatology','Spirit of Christ','mode of having Christ','John 16:14','2 Cor 3:18','devotion'],cl:['sanctification','spirit-fruit','threefold-use'],ct:'pneumatology'},
{id:'spirit-common-ops',n:'Common & Special Operations of the Spirit',d:'A hallmark of Reformed pneumatology distinguishing it from Arminianism: the Spirit operates both commonly toward all creatures and specially toward the elect alone. Common operations include restraining sin (Gen 6:3; 2 Thess 2:6–7), enabling culture, science, art, and ordered society (Gen 4:20–22), distributing natural gifts and talents, and maintaining the moral order. These operations do not save. Special (saving) operations include regeneration, effectual calling, sanctification, sealing, and indwelling - bestowed exclusively upon the elect and always effectual unto salvation. Turretin, Bavinck, and Berkhof all treat this distinction as architectonic for Reformed pneumatology against the Arminian claim that the Spirit\'s grace is universal and resistible.',k:['common operations','special operations','common grace','restraint','Arminianism','effectual','resistible','non-saving','saving'],cl:['common-grace','calling-regen'],ct:'pneumatology'},
{id:'spirit-indwelling',n:'Indwelling, Sealing & Baptism of the Spirit',d:'The Spirit permanently indwells every believer as God\'s temple (1 Cor 6:19; Rom 8:9–11; John 14:16–17). He seals believers unto the day of redemption as the guarantee (<i>arrabon</i>) of the inheritance to come (Eph 1:13–14; 4:30; 2 Cor 1:22). The baptism of the Holy Spirit is the Spirit\'s work of incorporating believers into the body of Christ (1 Cor 12:13), distinct from water baptism though signified by it. Against Pentecostalism, Reformed theology holds that Spirit baptism is not a second blessing subsequent to conversion but is coincident with regeneration and union with Christ. ESCHATOLOGICAL SIGNIFICANCE: The Spirit\'s indwelling, sealing, and baptism are fundamentally eschatological realities. The Spirit is not merely a present comfort but the <i>arrabon</i> \u2013 the down payment and guarantee \u2013 of the eschatological inheritance (Eph 1:13\u201314; 2 Cor 1:22; 5:5), and the firstfruits of the age to come (Rom 8:23). The Spirit\'s indwelling means that believers already participate in the powers of the age to come (Heb 6:5) while awaiting the consummation. Gaffin holds that the Spirit\'s indwelling is the mode of the resurrected Christ\'s eschatological presence with His people: because the last Adam became the life-giving Spirit (1 Cor 15:45), the Spirit\'s dwelling in believers is Christ\'s dwelling in them (Rom 8:9\u201311; cf. 2 Cor 3:17\u201318). The sealing of the Spirit \"unto the day of redemption\" (Eph 4:30) marks believers as belonging to the eschatological people of God, those who have been transferred from the dominion of this present evil age into the kingdom of the beloved Son (Col 1:13). THE CHRISTOLOGICAL KEY: Ferguson provides the decisive interpretive key for the Spirit\u2019s indwelling: \"Having the Spirit is equivalent, indeed the very mode, of having the incarnate, obedient, crucified, resurrected and exalted Christ indwelling us.\" This means that the Spirit\u2019s indwelling is not an impersonal divine energy filling the believer but the personal presence of Christ Himself mediated through the Spirit. Paul\u2019s language confirms this Christological identification: \"the Spirit of God dwells in you\" and \"Christ is in you\" are functionally equivalent descriptions of the same reality (Rom 8:9\u201311). The Spirit is fundamentally \"the Spirit of Christ\" (Rom 8:9; Phil 1:19; Gal 4:6), and His primary ministry is to glorify the Son (John 16:14) by making Christ\u2019s person and work experientially real to believers. This Christological principle means that every benefit the indwelling Spirit produces \u2013 assurance, sanctification, comfort, gifting, prayer \u2013 is a dimension of possessing Christ Himself, not a separate commodity distributed independently of the Mediator.',k:['indwelling','sealing','baptism','temple','<i>arrabon</i>','guarantee','1 Cor 6:19','Eph 1:13','1 Cor 12:13','incorporation','eschatological','firstfruits','Rom 8:23','Heb 6:5','age to come','1 Cor 15:45','down payment','Col 1:13','Spirit of Christ','mode of having Christ','Christological pneumatology','John 16:14','glorify the Son'],cl:['mystical-union-christ','adoption','assurance','perseverance'],ct:'pneumatology'},
{id:'spirit-gifts',n:'Spiritual Gifts',d:'Diverse gifts distributed by the Spirit for the edification of the body (1 Cor 12:4–11; Eph 4:11–12; Rom 12:6–8). Not for personal display but for mutual upbuilding. The extraordinary gifts (prophecy, tongues, healings, miracles) belonged to the foundational apostolic era and have ceased with the completion of the canon (WCF 1.1; Eph 2:20; Heb 2:3–4). The ordinary gifts of preaching, teaching, ruling, mercy, giving, and administration continue as the Spirit equips the church for its ministry in every age.',k:['gifts','<i>charis</i>mata','edification','body','ministry','cessation','ordinary','extraordinary'],ct:'pneumatology'},
{id:'cessation-gifts',n:'The Cessation of Extraordinary Gifts: A Redemptive-Historical Argument',d:'Those former ways of God\'s revealing His will unto His people being now ceased (WCF 1.1; Heb 1:1\u20132). The case for the cessation of the extraordinary gifts of the Spirit \u2013 prophecy, tongues, miraculous healings, and apostolic signs \u2013 is not primarily pragmatic (\"miracles don\'t happen anymore\") but redemptive-historical: the extraordinary gifts belonged to the foundational, unrepeatable epoch of redemptive history, just as Christ\'s death and resurrection are unrepeatable. Gaffin\'s decisive Reformed argument locates the extraordinary gifts within the <i>historia salutis</i> framework that governs the entire pneumatology locus. Pentecost is a once-for-all event in the <i>historia salutis</i> \u2013 as consequential and epoch-making as the incarnation, crucifixion, and resurrection \u2013 not a repeatable <i>ordo salutis</i> experience (see the entry on Pentecost as <i>Historia Salutis</i> Event). The extraordinary gifts were the signs accompanying this foundational epoch: the apostles and prophets are the foundation of the church (Eph 2:20), and foundations are laid once. Just as the Mosaic ceremonies ceased when their typological purpose was fulfilled in Christ, so the extraordinary gifts cease when their foundational, attestational purpose was fulfilled with the completion of the apostolic era and the closing of the canon. The signs of an apostle (2 Cor 12:12) \u2013 signs, wonders, and mighty works \u2013 were precisely that: marks distinguishing the unique, unrepeatable apostolic office from all subsequent ministry. Hebrews 2:3\u20134 speaks of salvation \"attested to us by those who heard, while God also bore witness by signs and wonders\" \u2013 placing the signs in the foundational era, not as a permanent feature of church life. The already/not-yet eschatological framework explains why the Spirit\'s ordinary operations (regeneration, sanctification, illumination, indwelling, intercession, gifting for ministry) continue in full power while the extraordinary signs of the new age\'s inauguration do not: the ordinary gifts belong to the ongoing life of the church between the advents, while the extraordinary gifts belonged to the once-for-all inaugurating events themselves. This connects the pneumatology locus directly to the eschatology locus: cessation is an eschatological conclusion, not merely a historical observation. God now works savingly through the ordinary means of Word, sacrament, and prayer, by the internal operation of the Spirit (WCF 1.1,6; 7.6; 14.1). The Spirit\'s power is in no way diminished \u2013 the ordinary means of grace are themselves Spirit-empowered and effectual unto salvation.',k:['cessation','extraordinary gifts','redemptive-historical','Reformed cessationism','<i>historia salutis</i>','foundational epoch','unrepeatable','Eph 2:20','2 Cor 12:12','Heb 2:3','apostolic','ordinary means','WCF 1.1','already not yet','eschatological','Mosaic ceremonies','typological','foundation laid once','canon','signs','wonders','inauguration','Spirit power','ordinary gifts continue'],cl:['spirit-pentecost','canon','sufficiency'],ct:'pneumatology'},
{id:'spirit-fruit',n:'The Fruit of the Spirit',d:'The fruit of the Spirit is love, joy, peace, patience, kindness, goodness, faithfulness, gentleness, self-control (Gal 5:22–23). Distinct from spiritual gifts: fruit is the moral character produced by the Spirit in every believer through sanctification, while gifts are varied abilities distributed for service. The fruit is singular - one unified cluster of Christlike virtues, the visible evidence of the Spirit\'s indwelling and sanctifying work. Against those who walk by the flesh (Gal 5:19–21), the Spirit produces in believers the character of Christ Himself (2 Cor 3:18; Rom 8:29). The fruit of the Spirit is the test of genuine spiritual life.',k:['fruit','Gal 5:22','love','joy','peace','patience','kindness','goodness','faithfulness','gentleness','self-control','character','Christlikeness'],cl:['sanctification','good-works','spirit-sanctification'],ct:'pneumatology'},
{id:'spirit-prayer',n:'The Spirit & Prayer',d:'The Spirit helps us in our weakness, for we do not know what to pray for as we ought, but the Spirit Himself intercedes for us with groanings too deep for words (Rom 8:26–27). Prayer is offered by the help of the Spirit, according to God\'s will, with understanding, reverence, humility, fervency, faith, love, and perseverance (WCF 21.3; Eph 6:18; Jude 20). The Spirit prompts, directs, and empowers believing prayer. He enables access to the Father through Christ (Eph 2:18). The Spirit\'s intercession complements Christ\'s heavenly intercession (Rom 8:34; Heb 7:25), ensuring that the prayers of the saints are effectual according to God\'s sovereign purpose.',k:['prayer','intercession','Rom 8:26','groaning','access','Eph 2:18','help','weakness','WCF 21.3'],cl:['prayer-theology','intercession-christ','trinitarian-prayer'],ct:'pneumatology'},
{id:'trinitarian-prayer',n:'The Trinitarian Shape of Prayer',d:'For through Him we both have access in one Spirit to the Father (Eph 2:18). This single verse discloses the Trinitarian architecture of all genuine Christian prayer: prayer is access to the Father, mediated through the Son, enabled by the Spirit. This is not a devotional nicety but a doctrinal reality that organically connects theology proper, Christology, and pneumatology in the believer\'s daily experience \u2013 exactly the kind of organic interconnection that the tool\'s Bavincian method claims as its organizing principle. TO THE FATHER: Prayer is ultimately directed to God the Father as the one from whom every good gift comes (Jas 1:17; Matt 6:9; 7:11). Jesus teaches His disciples to pray \"Our Father who art in heaven\" (Matt 6:9), grounding prayer in the filial relationship established by adoption (Rom 8:15; Gal 4:6). The Spirit of adoption causes believers to cry \"Abba! Father!\" (Rom 8:15; Gal 4:6), making prayer an exercise of the adopted child\'s access to the Father\'s presence and provision. THROUGH THE SON: Christ is the sole Mediator between God and man (1 Tim 2:5), and all prayer is offered in His name (John 14:13\u201314; 16:23\u201324). His heavenly intercession (Rom 8:34; Heb 7:25; 1 John 2:1) is the objective ground upon which the believer\'s prayers are presented to the Father. Calvin insists that prayer apart from the mediation of Christ is presumption: sinners have no access to God except through the blood of the Mediator, and the name of Christ is not a magical formula appended to prayer but the covenantal ground upon which the Father receives the petitions of His adopted children. BY THE SPIRIT: The Spirit is the one who enables, prompts, directs, and empowers prayer. He helps our weakness, for we do not know what to pray for as we ought, but the Spirit Himself intercedes for us with groanings too deep for words (Rom 8:26\u201327). He is the Spirit of supplication (Zech 12:10). Prayer \"in the Spirit\" (Eph 6:18; Jude 20) is prayer empowered and directed by the Spirit, not mere human effort. The Spirit\'s intercession complements Christ\'s heavenly intercession (Rom 8:34), ensuring that the prayers of the saints are effectual according to God\'s sovereign purpose. Calvin and Ferguson both insist that this Trinitarian structure is not an abstract theological observation but the living reality of the believer\'s communion with God: in prayer, the believer is drawn by the Spirit into the Son\'s own relationship with the Father, participating in the Trinitarian fellowship that is the source and goal of all redemption. Prayer is thus the believer\'s most intimate participation in the life of the triune God \u2013 the experiential nexus where theology proper, Christology, and pneumatology converge in the daily life of faith.',k:['Trinitarian prayer','Eph 2:18','Father','Son','Spirit','access','mediation','intercession','Rom 8:15','Rom 8:26','Gal 4:6','John 14:13','Heb 7:25','1 Tim 2:5','Reformed pneumatology','Abba','adoption','filial','communion','Spirit of supplication','Zech 12:10','Jude 20','Eph 6:18','organic interconnection','experiential'],cl:['trinity','spirit-prayer','intercession-christ','adoption'],ct:'pneumatology'},
{id:'spirit-church',n:'The Spirit & the Church',d:'The Church is a Spirit-constituted community - the dwelling place of God in the Spirit (Eph 2:22; 1 Cor 3:16). The Spirit baptizes believers into one body (1 Cor 12:13), distributes gifts for ministry (1 Cor 12:4\u201311), empowers witness (Acts 1:8), and preserves the Church through every age. Bavinck devotes his entire chapter 9 of volume 4 to the church as Spirit-constituted. The Spirit calls, gathers, enlightens, and sanctifies the whole Christian church on earth and keeps it with Jesus Christ in the one true faith. He makes the means of grace effectual to the elect for salvation (WCF 25.3). Without the Spirit the Church would be a mere human institution; by the Spirit she is the living body of Christ. The Spirit\u2019s constitutive work is one dimension of what Bavinck describes as the church\u2019s Trinitarian identity: the Fellowship of the Holy Spirit (2 Cor 13:14; Phil 2:1) \u2013 a community whose <i>koinonia</i> is not merely sociological bonding but participation in the life of the Spirit who unites believers to Christ and through Christ to the Father. The Spirit creates, sustains, and will consummate the church as the eschatological temple of God (Eph 2:19\u201322).',k:['church','Eph 2:22','body','1 Cor 12:13','Acts 1:8','means of grace','gathering','sanctifying','empowering','Fellowship of the Spirit','<i>koinonia</i>','Trinitarian ecclesiology','eschatological temple'],cl:['church','marks-church','church-mission','spirit-pentecost'],ct:'pneumatology'},
]},

{id:'salvation',n:'The Application of Salvation',ct:'soteriology',c:'#d8907c',r:1.7,o:8,
d:'The <i>ordo salutis</i>: effectual calling, regeneration, faith and repentance, justification, adoption, sanctification, perseverance, glorification (Rom 8:30; WCF 10\u201318). Not isolated acts but organically interconnected - all flowing from and subsumed under union with the resurrected Christ by the Spirit through faith (WCF 8.8; 25.1). Union with Christ is the overarching framework: justification, sanctification, adoption, and glorification are different facets of the one reality of incorporation into Christ. The Spirit effectually applies to the elect the redemption purchased by Christ (WCF 8.8). The already/not-yet eschatological framework permeates the application of salvation: believers possess the firstfruits of the Spirit (Rom 8:23) while awaiting the consummation. Soteriology is eschatology - Christ\'s resurrection is constitutive of redemption, not merely confirmatory. NOTE ON CONTEMPORARY DEBATE: The classic Murray ordering presents the ordo as a logical-causal sequence. The Gaffin/Ridderbos redemptive-historical critique \u2013 now standard in the best Reformed theology (e.g., Ferguson, Letham, Lane, Tipton) \u2013 argues that the ordo is not a temporal sequence of discrete acts but an analytic distinction of aspects of the one act of union with the resurrected Christ. In his later classroom teaching after publishing his initial work, Murray repositioned union with Christ immediately after effectual calling and before justification, adoption, and sanctification \u2013 making structurally explicit what he had always affirmed materially: that all salvific benefits flow from and are comprehended within the believer\'s incorporation into Christ. The Reformed tradition holds union with Christ "really the central truth of the whole doctrine of salvation," encompassing election, accomplishment, and application. His concept of "definitive sanctification" (a once-for-all breach with sin\'s dominion at the moment of union with Christ, based on Romans 6) must appear alongside progressive sanctification as a distinct and irreducible aspect, not subsumed under it. The Reformed tradition holds this further: "Union with Christ is the central soteriological reality; justification, sanctification, adoption, and glorification are not successive steps but simultaneous facets of incorporation into the Last Adam who is life-giving Spirit (1 Cor 15:45)." The ordo thus functions best not as a timeline but as a theological grammar for distinguishing inseparable benefits that all flow from the one controlling reality of union with the resurrected Christ. Both approaches affirm the same doctrinal content; the difference is structural and hermeneutical. Every formulation of the ordo must remain open to correction and refinement by fresh exegetical work \u2013 reflecting the lifelong conviction that systematic categories serve the exegetical task and never replace it. GOSPEL LOGIC AND SOTERIOLOGICAL ARCHITECTURE: Ferguson deepens this discussion by insisting that the <i>ordo salutis</i> must maintain what he calls \"gospel logic\" \u2013 the structural priority of divine indicatives over human imperatives. Paul devotes 308 of 315 verses in Romans to what God has done in Christ before launching the imperatives of chapters 12\u201316. Any systematic presentation of soteriology that reverses this order \u2013 presenting doctrines as abstract propositions or moral demands without first grounding them in the accomplished work of Christ \u2013 risks the very legalism the Reformation diagnosed. Ferguson warns: \"If we reverse the order of gospel logic it will not be long before we are smuggling our sanctification into the foundations of our justification.\" Furthermore, Gaffin\u2019s innovative argument that the soteriological categories (justification, adoption, sanctification, glorification) apply first to Christ Himself and only derivatively to believers through union with Him provides a Christological architecture for the entire ordo: Christ was justified by the Spirit (1 Tim 3:16), declared Son of God in power by the resurrection (Rom 1:4), sanctified and consecrated by the Father (John 10:36; 17:19), and glorified at the right hand of God (John 17:1,5; Phil 2:9\u201311). The believer\'s experience of these realities is therefore participatory \u2013 a sharing by the Spirit in what Christ has already accomplished and received as the federal head and representative of His people. This Christ-first soteriological architecture reinforces the inseparability of justification and sanctification as twin benefits received simultaneously in union with Christ: to separate them is, as Calvin puts it, to \"tear Christ in pieces\" . The tool\'s soteriological presentation must therefore embody this architecture: not a sequence of isolated doctrinal modules but an organic unity in which every benefit flows from and remains tethered to the Person of Christ received by faith through the Spirit.',
k:['salvation','<i>ordo salutis</i>','calling','regeneration','faith','repentance','justification','adoption','sanctification','definitive sanctification','perseverance','glorification','union with Christ','grace','redemptive-historical','gospel logic','indicative-imperative','tear Christ in pieces','soteriological categories','Christ-first','participatory'],
cl:['christ','holy-spirit','covenant-grace','church','decree','calling-regen','justification','sanctification','adoption','perseverance','glorification','sin','humanity','law','covenant-works','free-will','eschatology','good-works','covenant-theology','pactum'],
hc:['Reformation vs. Rome on justification','Arminian controversy','Murray-Gaffin ordo debate'],
s:[
{id:'calling-regen',n:'Effectual Calling & Regeneration',d:'God by His Spirit, working in due and effectual season, calls His elect out of their natural state of sin and death into grace and salvation by Jesus Christ (WCF 10.1; 2 Tim 1:9; Rom 8:30). Regeneration: the sovereign, instantaneous, monergistic new birth - the Spirit renewing the will, enlightening the mind, opening the heart (John 3:3–8; Ezek 36:26; WCF 10.1). Logically prior to faith.',k:['effectual calling','regeneration','new birth','irresistible','monergistic'],cl:['spirit-regeneration','election','total-depravity','will-grace','pactum-spirit'],ct:'soteriology'},
{id:'faith-repentance',n:'Faith & Repentance',d:'Faith: knowledge (notitia) of what Scripture teaches, assent (assensus) that it is true, personal trust (fiducia) in Christ alone for salvation (WCF 14.1\u20132; Heb 11:1; John 3:16). The principal act of saving faith is accepting, receiving, and resting upon Christ alone for justification, sanctification, and eternal life (WCF 14.2). Repentance: evangelical grace involving grief for and hatred of sin, turning to God with full purpose of and endeavor after new obedience (WCF 15.1\u20132; Acts 11:18; 2 Cor 7:10). THE SEQUENCING OF FAITH AND REPENTANCE: Ferguson, following Thomas Boston and the Marrow Men, insists that the proper gospel order is: faith grasps Christ, and repentance flows as its fruit. \u201CRepentance does not go before but comes after remission of sin\u201D. This is not to deny that repentance accompanies faith from the first moment of conversion, but to insist that the logical and motivational ground of evangelical repentance is the prior apprehension of grace, not the prior achievement of sufficient sorrow. Against a legalistic tendency to make repentance, conviction of sin, or law-work a prerequisite to coming to Christ, the Marrow tradition taught that the first act of faith is not self-examination but looking to Christ. The sinner does not repent in order to be forgiven; the sinner is forgiven in Christ and therefore repents. Genuine repentance is born of the knowledge that one is already loved, not of the fear that one might be accepted if the repentance is deep enough. Ferguson holds that reversing this order \u2013 demanding repentance as a qualification for grace \u2013 is precisely the neonomianism that the Marrow Controversy exposed: it turns the gospel into a new law with repentance as its entrance condition, smuggling human performance back into the foundation of salvation. WCF 15.3 affirms that no sin is so small as to deserve condemnation yet no sin is so great as to bring damnation upon those who truly repent, and the Confession grounds repentance in the \u201Capprehensions of the mercy of God in Christ\u201D (WCF 15.2) \u2013 mercy apprehended, not first earned by penitential effort. This sequencing is architectonically important for the entire <i>ordo salutis</i>: it reflects the gospel-logic principle that indicatives precede imperatives throughout the application of redemption.',k:['faith','repentance','notitia','assensus','fiducia','trust','Marrow','sequencing','remission','evangelical repentance','looking to Christ','neonomianism','gospel logic','WCF 14','WCF 15','mercy apprehended','grace before repentance'],cl:['calling-regen','justification','law-gospel','spirit-regeneration','free-offer-gospel'],ct:'soteriology'},
{id:'justification',n:'Justification',d:'A judicial act of God declaring believing sinners righteous on the basis of Christ\'s imputed righteousness, received by faith alone (Rom 3:24\u201328; 4:5\u20138; 5:1; WCF 11.1). Forensic - not infusion but declaration. Twofold: remission of all sins and imputation of Christ\'s active and passive obedience (WCF 11.1; 2 Cor 5:21). Once for all, complete, irreversible. Faith is the alone instrument, not the ground (WCF 11.2). Against Rome: justification is not by inherent righteousness but by imputed righteousness alone. INSEPARABLE FROM SANCTIFICATION IN UNION WITH CHRIST: Calvin holds that justification and sanctification are inseparable but distinguishable benefits received simultaneously in union with Christ. To separate them \u2013 to treat justification as if it could exist without sanctification, or sanctification without justification \u2013 is, in Calvin\'s vivid language, to \"tear Christ in pieces.\" The believer does not receive justification from one hand and sanctification from another: both flow from the one act of incorporation into the living Christ by the Spirit through faith. Ferguson holds that this union-with-Christ framework is the only safeguard against two perennial errors: (a) legalism, which smuggles sanctification into the foundations of justification by making moral progress a condition of acceptance; and (b) antinomianism, which abstracts justification from Christ\'s transforming presence and treats it as a bare legal transaction with no necessary connection to holiness. Both errors arise from separating what God has joined in Christ. The forensic declaration of justification and the renovative work of sanctification are analytically distinct \u2013 justification is not sanctification, and sanctification is not justification \u2013 but they are existentially inseparable in the believer\'s experience because both are dimensions of the one reality of possessing Christ Himself. The redemptive-historical soteriological architecture further deepens this point: Christ was Himself justified by the Spirit (1 Tim 3:16), and the believer\'s justification is a participatory sharing in Christ\'s own vindication at the resurrection (Rom 4:25). Justification is thus not merely a courtroom metaphor applied to isolated individuals but the believer\'s incorporation into the justified and vindicated Christ.',k:['justification','forensic','imputation','<i>sola fide</i>','declaration','complete','irreversible','tear Christ in pieces','inseparable','union with Christ','sanctification','legalism','antinomianism','participatory','1 Tim 3:16','Rom 4:25','Inst 3.11.1'],cl:['active-obedience','passive-obedience','faith-repentance','law-gospel','adoption','federal-union-christ','divine-righteousness','polemic-justification'],ct:'soteriology',hc:['Reformation (1517)','Council of Trent Session 6 (1547)','Osiander controversy','New Perspective on Paul debate']},
{id:'free-offer-gospel',n:'The Free Offer of the Gospel',d:'The question of whether God genuinely and well-meaningly offers Christ to the non-elect in the preaching of the gospel, and how this relates to definite atonement and the divine will, is a live confessional issue in Presbyterian theology. The Murray-Stonehouse report to the OPC (1948) is one of the most important mid-20th-century Presbyterian documents, arguing that God sincerely and genuinely offers salvation to all who hear the gospel \u2013 including the reprobate \u2013 and that this offer expresses a genuine divine desire for their salvation, not merely a bare command. Murray and Turretin ground the free offer in the distinction between God\'s decretive will (which determines the elect) and His preceptive will (which commands all to repent and believe, Acts 17:30; 2 Pet 3:9). The preceptive will expresses a genuine divine disposition of benevolence and compassion toward sinners as sinners (Ezek 33:11; Matt 23:37; Lam 3:33). This does not contradict definite atonement: Christ died effectually for the elect alone, but God\'s command and invitation to all hearers is genuine, reflecting His revealed character of goodness and His delight not in the death of the wicked but in their turning and living. The free offer connects to several loci: the divine will (decretive/preceptive distinction), common grace (God\'s non-salvific goodness toward all), the Marrow Controversy (the Marrow Men\'s defense of free and universal gospel offer against neonomian restrictions), and the nature of preaching (the minister offers Christ freely to all, inviting and commanding faith). The Reformed tradition treats the gospel offer within the broader framework of God\'s revealed will. It should be noted that there has been a minority tradition within Reformed theology — associated with certain strict Calvinists in the Netherlands and some hyper-Calvinist voices in the English-speaking world — that has questioned the well-meant offer, arguing that the language of divine desire for the salvation of the reprobate introduces an unresolved tension with the decree of reprobation. While these voices are outside the mainstream OPC/PCA consensus and the Murray-Stonehouse position represents the settled confessional judgment in those communions, their existence should be acknowledged to give a complete picture of the intra-Reformed debate.',k:['free offer','gospel','OPC','1948','sincere','genuine','well-meant','decretive will','preceptive will','definite atonement','Ezek 33:11','Matt 23:37','2 Pet 3:9','Acts 17:30','common grace','Marrow','preaching','invitation','command','divine desire','benevolence','compassion','reprobate'],cl:['divine-will','divine-love','preaching-word','election-evangelism','marrow-controversy','calling-regen'],ct:'soteriology'},
{id:'adoption',n:'Adoption',d:'Those justified are received into the number of God\'s children, have His name put upon them, receive the Spirit of adoption, have access to the throne of grace, are enabled to cry Abba Father, are pitied, protected, provided for, and disciplined as by a father, never cast off, sealed to the day of redemption, and inherit the promises as heirs of everlasting salvation (WCF 12; Rom 8:15–17; Gal 4:4–7; Eph 1:5).',k:['adoption','sons','heirs','co-heirs','Abba','privilege'],cl:['spirit-indwelling','justification','prayer-theology','assurance'],ct:'soteriology'},
{id:'duplex-gratia',n:'The <i>Duplex Gratia</i> (Double Grace)',d:'From union with Christ flow simultaneously the two great benefits of justification and sanctification \u2013 the <i>duplex gratia</i> (double grace) of Calvin. This doctrine is the hinge between Christology, pneumatology, and soteriology, and the mechanism that prevents both antinomian and legalistic distortions. Calvin holds that Christ \"is made unto us wisdom and righteousness and sanctification and redemption\" (1 Cor 1:30) \u2013 these benefits come together, inseparably, in the one act of receiving Christ by faith through the Spirit. To separate justification from sanctification is to \"tear Christ in pieces\" ; to confuse them is to undermine the freeness of justification. The <i>duplex gratia</i> preserves the proper distinction-without-separation: justification is forensic (a declaration of righteousness based on imputed alien righteousness, Rom 4:5\u20136; 2 Cor 5:21), while sanctification is transformative (a real change in the believer\'s moral character by the Spirit\'s work, Rom 6:1\u201314; 2 Cor 3:18). Yet both flow simultaneously from the same source \u2013 union with Christ by the Spirit through faith \u2013 and neither exists without the other. Bavinck holds this insight with the precision of Gaffin\'s redemptive-historical framework: justification and sanctification are \"not successive steps but simultaneous facets of incorporation into the Last Adam who is life-giving Spirit\" (1 Cor 15:45). Ferguson recovers this principle against both the legalist (who makes sanctification the ground of assurance) and the antinomian (who divorces justification from its transformative twin). The <i>duplex gratia</i> is thus the structural guarantee that the Reformed <i>ordo salutis</i> is not a mere logical chain but an organic reality rooted in the Person of the living Christ.',k:['<i>duplex gratia</i>','double grace','justification','sanctification','union with Christ','simultaneous','inseparable','distinction','tear Christ in pieces','forensic','transformative','antinomian','legalism','1 Cor 1:30','Rom 4:5','2 Cor 5:21','hinge','Christology','pneumatology','soteriology'],cl:['justification','sanctification','mystical-union-christ'],ct:'soteriology'},
{id:'sanctification',n:'Sanctification',d:'The work of God\'s free grace whereby the whole man is renewed after the image of God, enabled more and more to die unto sin and live unto righteousness (WCF 13.1; 1 Thess 5:23; Rom 6:6,14). THE POSITIVE DEFINITION: Ferguson holds that sanctification must be defined positively as \"pure devotion to God\" rather than merely negatively as separation from sin. The reason is theological: the Trinity was holy before creation existed for God to be \"separate from.\" Holiness in its deepest sense is not primarily about what one is separated from but about what \u2013 and Whom \u2013 one is devoted to. This positive definition governs the believer\'s experience: sanctification is not fundamentally a program of sin-avoidance but a growing devotion to the living God, enabled by the Spirit, modeled on the pattern of Christ\'s own consecration to the Father (John 17:19). When sanctification is defined negatively, believers become introspective sin-monitors; when defined positively, they become Christ-gazing worshippers whose increasing devotion to God progressively crowds out remaining corruption. SOTERIOLOGICAL CATEGORIES APPLIED FIRST TO CHRIST: the innovative argument is that the categories of salvation \u2013 justification, adoption, sanctification, glorification \u2013 apply first to Christ Himself and only derivatively to believers through union with Him. Christ was Himself justified by the Spirit (1 Tim 3:16); He was declared the Son of God in power by the resurrection (Rom 1:4); He was sanctified and consecrated by the Father (John 10:36; 17:19); and He was glorified through His exaltation (John 17:1,5; Phil 2:9\u201311). The believer\'s justification, adoption, sanctification, and glorification are therefore not abstract categories applied in isolation but participatory realities \u2013 the believer shares in what Christ Himself has already experienced as the representative and federal head of His people. This Christological grounding reinforces the centrality of union with Christ: every benefit is \"in Christ\" because Christ Himself has already traversed the path of redemption on behalf of His people, and the Spirit now incorporates believers into that completed reality. Reformed theology distinguishes three aspects: (1) DEFINITIVE SANCTIFICATION: the crucial exegetical contribution, drawn from sustained engagement with Romans 6:1\u201314. At the moment of union with Christ by the Spirit through faith, there is a once-for-all, decisive, irreversible breach with the dominion of sin. The believer has died to sin (Rom 6:2), has been crucified with Christ (Rom 6:6), and is freed from sin\'s enslaving lordship (Rom 6:7,18,22). This is not progressive but definitive \u2013 a translation from the realm of sin\'s reign into the realm of grace\'s reign (Rom 6:14; Col 1:13). Definitive sanctification is the subjective counterpart of what was objectively accomplished in Christ\'s death and resurrection: because the believer is united to the Christ who died and rose, the believer\'s relationship to sin has been decisively and irrevocably altered. Murray holds that this definitive breach must not be subsumed under progressive sanctification or confused with justification: it is a real, ontological change in the believer\'s relation to sin\'s dominion, grounded in participation in Christ\'s death and resurrection life, not merely a change of legal status. Gaffin extends this further: definitive sanctification is the application to the believer of the eschatological power of Christ\'s resurrection \u2013 it is sanctification as an eschatological event, not merely a moral process. (2) PROGRESSIVE SANCTIFICATION: the ongoing, lifelong renewal in which the believer, by the Spirit, mortifies the deeds of the body (Rom 8:13) and is transformed from glory to glory (2 Cor 3:18). This involves the continual warfare between the flesh and the Spirit (Gal 5:17; Rom 7:14\u201325), the daily exercise of mortification and vivification, and the gradual conformity to the image of Christ (Phil 3:12\u201314; WCF 13.1\u20133). Progressive sanctification is imperfect in this life due to remaining corruption (WCF 13.2; 1 John 1:8). (3) ESCHATOLOGICAL SANCTIFICATION: completed at glorification when all remaining corruption is purged and the believer is made perfectly holy (1 John 3:2; Heb 12:23; Rev 21:27). These three aspects are organically related: definitive sanctification is the root from which progressive sanctification grows, and eschatological sanctification is its consummation. All three flow from union with Christ \u2013 the believer\'s participation in Christ\'s death (definitive breach with sin), Christ\'s resurrection life (progressive renewal), and Christ\'s coming glory (final perfection). Gaffin holds that the deepest motive for the believer\'s sanctification is not psychological but eschatological: \"the deepest motive for our sanctification.. is not our psychology, not how I \u2018feel\u2019 about God and Jesus.. but the resurrection power of Christ and the new creation that we are and have already been made a part of.\" The Spirit who sanctifies is the \"Spirit of Him who raised Jesus from the dead\" (Rom 8:11), and sanctification \u2013 in all three aspects \u2013 is the progressive unfolding in the believer\'s experience of the eschatological life already inaugurated by Christ\'s resurrection.',k:['sanctification','definitive sanctification','progressive sanctification','eschatological','mortification','vivification','holiness','image of God','Rom 6','dominion of sin','breach','union with Christ','death to sin','resurrection life','WCF 13','remaining corruption','resurrection power','new creation','Rom 8:11','pure devotion to God','positive definition','Christ sanctified','soteriological categories','John 17:19','1 Tim 3:16','participatory','Christ-gazing'],cl:['spirit-sanctification','threefold-use','good-works','law','perseverance','glorification'],ct:'soteriology',hc:['Augustinian-Pelagian controversy on grace and free will','Reformation debates on sanctification and justification','Antinomian Controversy (1630s New England)','Wesleyan perfectionism vs. Reformed progressive sanctification','Keswick "higher life" movement','Murray-Gaffin definitive sanctification development']},
{id:'federal-union-christ',n:'Federal Union with Christ',d:'Federal (or representative, legal, covenantal) union is the foundational juridical relationship between Christ and the elect established in the eternal <i>pactum salutis</i> and executed in the covenant of grace. In this union, Christ stands as the federal head : the second Adam : representing His people before the bar of divine justice, just as the first Adam stood as federal head of the whole human race (Rom 5:12–19; 1 Cor 15:21–22,45–49; WCF 7.2; 8.1). Federal union is the ground of imputation in both directions: the elect\'s sins are imputed to Christ (2 Cor 5:21; Isa 53:6; WCF 11.1), and Christ\'s active and passive obedience is imputed to them (Rom 5:18–19; Phil 3:9; WCF 11.1,3). This union is antecedent to : and the legal basis of : the Spirit\'s subjective application of redemption. Murray identifies two pre-temporal aspects: (1) the federal union proper : in the <i>pactum salutis</i>, the Father appointed the Son as surety and representative head of the elect, and the Son covenanted to bear their guilt, fulfill the law in their name, and merit their salvation (Heb 7:22; Isa 42:6; 49:8; WCF 8.1); (2) the ideal union : in God\'s eternal counsel, the elect were chosen in Christ before the foundation of the world (Eph 1:4; 2 Tim 1:9; Rev 13:8). And one <i>historia salutis</i> aspect: (3) the objective union : in Christ\'s historical work of incarnation, obedience, death, and resurrection, the elect were representatively and judicially present so that what He did, He did as their covenant head and substitute (Rom 6:3–6; 2 Cor 5:14; Gal 2:20; Col 3:3; WCF 8.5). Thus federal union is not experiential or existential but legal and covenantal : it is the de jure ground upon which the de facto application of salvation proceeds. Without federal union, there is no basis for the imputation of Christ\'s righteousness in justification, no ground for the transfer of guilt in the atonement, and no legal warrant for the Spirit\'s application of redemption to the elect rather than to others. Turretin treats this extensively under the covenant of redemption and the imputation of Christ\'s satisfaction. Murray insists that the federal or representative aspect is the fountainhead from which all other dimensions of union flow. Federal union thus answers the question: on what legal ground does God save sinners without compromising His justice? The answer: because those sinners were in Christ their federal head, and His obedience and satisfaction are reckoned as theirs (Rom 8:1; 5:19; WCF 11.1,3).',k:['federal union','representative','legal','covenantal','imputation','federal head','second Adam','<i>pactum salutis</i>','covenant of redemption','Rom 5:12–19','1 Cor 15:45','2 Cor 5:21','WCF 8.1','WCF 11.1','surety','substitute','ideal union','objective union','ground of justification','de jure'],cl:['covenant-surety','active-obedience','justification','election','pactum'],ct:'soteriology'},
{id:'mystical-union-christ',n:'Mystical Union with Christ',d:'Mystical (or vital, spiritual, existential, subjective) union is the real, Spirit-wrought, experiential bond by which believers are personally and vitally joined to the living, resurrected Christ in time through faith (Eph 2:5–6; John 15:1–5; Rom 6:3–5; 8:1,10; Gal 2:20; WCF 25.1; 26.1; WSC 30; WLC 66,69). Whereas federal union is the legal ground antecedent to experience, mystical union is the Spirit\'s actual work of engrafting believers into Christ : it is the de facto realization of what was de jure true in the federal arrangement. The Holy Spirit is the <i>vinculum</i> (bond) of this union: He dwells in believers, communicates the life of Christ to them, and makes them partakers of His benefits (Rom 8:9–11; 1 Cor 6:17,19; 1 John 3:24; 4:13; WCF 8.8). Calvin calls it the \"mystical union\" (<i>unio mystica</i>) and the \"sacred marriage\" by which we become bone of His bone and flesh of His flesh , insisting that until the Spirit joins us to Christ, all that He has accomplished for us remains external and of no profit. This union is: (a) spiritual : effected by the Holy Spirit, not by any physical or local presence (1 Cor 6:17; John 14:16–17,23); (b) vital and organic : Christ is the vine, believers the branches; He communicates His resurrection life to them (John 15:1–5; Eph 5:30; Col 3:3–4); (c) real but mysterious : Scripture uses the analogies of head and body (Eph 1:22–23; Col 1:18), vine and branches (John 15), bridegroom and bride (Eph 5:25–32), and cornerstone and living stones (1 Pet 2:4–5), none of which are exhaustive; (d) personal and mutual : the believer is in Christ and Christ is in the believer (John 14:20; 15:4; Gal 2:20; Col 1:27); (e) by faith : faith is the instrument by which the Spirit-wrought union is consciously received and exercised (Eph 3:17; John 1:12; WCF 14.2). Mystical union is the overarching soteriological reality from which all benefits of salvation flow simultaneously: justification and sanctification are not sequential steps but twin and inseparable facets of the one act of incorporation into the resurrected Christ. Gaffin holds that \"not justification by faith but union with the resurrected Christ by faith is the central motif of Paul\'s applied soteriology.\" From this union the believer shares in Christ\'s death (Rom 6:3–6), resurrection (Eph 2:5–6), and exaltation (Eph 2:6; Col 3:1–4). Murray calls this the \"subjective union\" : the believer\'s actual, lived incorporation into Christ by the Spirit. Murray insists that while federal union is the legal ground, mystical union is \"the central truth of the whole doctrine of salvation.\" In his later classroom teaching, Murray repositioned union with Christ immediately after effectual calling and before justification, adoption, and sanctification in the <i>ordo salutis</i> : making structurally explicit that these benefits are not an independent causal chain but simultaneous aspects of the one reality of incorporation into the resurrected Christ. The concept of \"definitive sanctification\" (the once-for-all breach with sin\'s dominion at the moment of union, based on Rom 6:1–14) flows directly from this placement: union with Christ effects an immediate, decisive, irreversible change in the believer\'s relation to sin\'s reign, distinct from both the forensic act of justification and the ongoing process of progressive sanctification. The distinction is critical: federal union without mystical union would leave the elect legally acquitted but spiritually dead; mystical union without federal union would provide experiential vitality but no legal ground for it. Both are necessary; neither is reducible to the other. Together they constitute the full reality of the believer\'s union with Christ : de jure and de facto, legal and vital, in the eternal counsel and in lived experience.',k:['mystical union','vital union','spiritual union','subjective union','Spirit-wrought','bond','<i>vinculum</i>','<i>unio mystica</i>','Inst 3.1.1','Inst 3.11.1','vine and branches','head and body','bride','Eph 2:5','John 15:1','Rom 6:3','Rom 8:9','Gal 2:20','WCF 25.1','WCF 26.1','faith','central truth','incorporation','resurrected Christ','de facto','experiential','organic','indwelling','definitive sanctification','classroom teaching'],cl:['spirit-indwelling','calling-regen','sanctification','duplex-gratia','lords-supper','glorification'],ct:'soteriology'},
{id:'perseverance',n:'Perseverance of the Saints',d:'Those God has accepted in Christ can neither totally nor finally fall away from the state of grace but shall certainly persevere therein to the end and be eternally saved (WCF 17.1; John 10:28–29; Phil 1:6; Rom 8:28–39). Based on the immutability of the decree of election, the abiding of the Spirit, Christ\'s continual intercession, and the nature of the covenant of grace (WCF 17.2). Believers may fall into grievous sins, but the seed of God remains (WCF 17.3; 1 John 3:9).',k:['perseverance','preservation','eternal security','election','intercession'],cl:['election','definite-atonement','intercession-christ','spirit-indwelling','assurance','immutability','warning-passages'],ct:'soteriology'},
{id:'historia-ordo-relationship',n:'The Relationship between <i>Historia Salutis</i> & <i>Ordo Salutis</i>',d:'The most architectonically significant contribution of the Reformed redemptive-historical school is the demonstration that the <i>ordo salutis</i> (the order in which salvation is applied to the individual believer) is grounded in and shaped by the <i>historia salutis</i> (the history of salvation accomplished by Christ). The ordo is not an independent logical chain operating alongside redemptive history but the individual\'s participatory entry into what Christ has already accomplished in the <i>historia salutis</i>. Justification in the ordo is the believer\'s participation in Christ\'s own justification-vindication at the resurrection (Rom 4:25; 1 Tim 3:16). Sanctification in the ordo is the believer\'s progressive realization of the eschatological life inaugurated by Christ\'s resurrection (Rom 6:4\u20135; 8:11). Glorification in the ordo is the consummation of the believer\'s conformity to the glorified Christ (Rom 8:29\u201330; Phil 3:21). The Spirit who applies salvation is specifically the Spirit of the resurrected Christ (1 Cor 15:45; Rom 8:11) \u2013 the eschatological gift poured out at Pentecost. This means the traditional sequential chain (calling \u2192 regeneration \u2192 faith \u2192 justification \u2192 sanctification \u2192 glorification) must be reconceived: not as a temporal sequence of discrete acts but as an analytic distinction of inseparable aspects of the one act of incorporation into the resurrected Christ by the Spirit through faith. Union with Christ \u2013 both federal (legal, covenantal, antecedent) and mystical (vital, experiential, Spirit-wrought) \u2013 is the controlling soteriological reality from which all benefits flow simultaneously, not one link in the chain alongside others. This theological insight has been made structurally explicit in later Reformed systematics by repositioning union with Christ immediately after effectual calling. Gaffin states it further: \"Union with Christ is the central soteriological reality; justification, sanctification, adoption, and glorification are not successive steps but simultaneous facets of incorporation into the Last Adam who is life-giving Spirit\". This Christ-first soteriological architecture reinforces the point: the categories of justification, adoption, sanctification, and glorification apply first to Christ Himself and only derivatively to believers through their Spirit-wrought union with Him. The <i>historia salutis</i> / <i>ordo salutis</i> distinction thus functions as the hermeneutical key that prevents the ordo from degenerating into an abstract logical chain detached from the living Christ in whom all benefits cohere.',k:['<i>historia salutis</i>','<i>ordo salutis</i>','relationship','union with Christ','participatory','resurrection','1 Cor 15:45','Rom 4:25','eschatological','Christ-first','simultaneous','not sequential','controlling reality','hub','reconceived','Spirit','Pentecost','incorporation'],cl:['spirit-pentecost','creation-to-consummation','biblical-theology','resurrection-eschatological-event'],ct:'soteriology'},
{id:'assurance',n:'Assurance of Salvation',d:'Grounded in God\'s promises, the inward evidence of graces unto which the promises are made, and the testimony of the Spirit of adoption (WCF 18.2; Rom 8:16; 2 Pet 1:10). Not of the essence of faith, but an infallible assurance attainable by diligent use of means (WCF 18.1,3). True assurance incites holiness, not carelessness (1 John 3:2–3; WCF 18.3).',k:['assurance','promises','witness','sanctification','diligence'],cl:['spirit-testimonium','perseverance','adoption','election','good-works','faith-repentance'],ct:'soteriology'},
{id:'glorification',n:'Glorification',d:'The final step of the <i>ordo salutis</i> - the complete and irreversible conformity of the believer to the image of Christ in body and soul (Rom 8:29–30; 1 John 3:2; Phil 3:20–21). At the resurrection, the body is raised incorruptible and glorious (1 Cor 15:42–44), the soul is perfected in holiness without any remaining corruption (Heb 12:23; Rev 21:27), and the whole person enters into the full and eternal enjoyment of God (WCF 32.1; 33.2). Glorification is the consummation of election, the completion of sanctification, and the final vindication of justification. Those whom He predestined, He also glorified (Rom 8:30).',k:['glorification','consummation','resurrection','perfection','image of Christ','incorruptible','eternal life','Rom 8:30'],cl:['new-creation','resurrection-body','beatific-vision','will-glory','eternal-state','sanctification'],ct:'soteriology'},
{id:'elect-infants',n:'Elect Infants & Those Incapable of Outward Calling',d:'Elect infants, dying in infancy, are regenerated and saved by Christ through the Spirit, who works when and where and how He pleases (WCF 10.3; Luke 18:15–16; Acts 2:39; 2 Sam 12:23). So also are all other elect persons who are incapable of being outwardly called by the ministry of the Word (WCF 10.3). The Spirit is not limited to the ordinary means, though He ordinarily works through them. This doctrine preserves both the sovereignty of God in salvation and the pastoral comfort of the church.',k:['elect infants','infancy','incapable','regeneration','Spirit','sovereignty','pastoral','WCF 10.3'],cl:['election','baptism','covenant-grace'],ct:'soteriology'},
{id:'marrow-controversy',n:'The Marrow Controversy & the Free Offer of the Gospel',d:'The Marrow Controversy (1718-1723) in the Church of Scotland was a defining debate over the nature of the gospel offer and the relationship between law and grace. It was sparked by the republication of the Marrow, which the Marrow tradition discovered and promoted. The General Assembly of the Church of Scotland condemned the Marrow in 1720 as containing antinomian errors. The "Marrow Men" protested, arguing that the Assembly had condemned vital evangelical truths. The central issues included: (1) The free offer of the gospel: whether Christ may be freely and indiscriminately offered to all sinners as such, or only to those who show signs of election and preparation. The Marrow Men insisted on a universal, unconditional offer - that the gospel warrant is to be preached to every creature without exception, and that every sinner has a right and duty to believe in Christ (Isa 55:1; Matt 11:28; Rev 22:17). This does not imply universal redemption but that the gospel command and invitation extend to all who hear it. (2) The nature of saving faith: against a legalistic tendency to make repentance, conviction of sin, or law-work a prerequisite to coming to Christ, the Marrow Men taught that faith is simply receiving and resting upon Christ as offered in the gospel. The first act of faith is not self-examination but looking to Christ. (3) The relationship between law and gospel: the Marrow tradition carefully distinguished the law as a covenant of works (which demands and condemns) from the law as a rule of life for believers (which guides in gratitude), warning against both antinomianism (rejecting the law\'s normative function) and neonomianism (turning the gospel into a new law with easier conditions). (4) Assurance and the nature of the gospel promise: the Marrow taught that assurance belongs to the essence of faith, grounding this in the objective promise of the gospel rather than subjective experiences. (It must be noted, however, that this point was and remains debated within the confessional tradition. WCF 14.3 and 18.1–3 distinguish faith from assurance: \"This infallible assurance doth not so belong to the essence of faith, but that a true believer may wait long, and conflict with many difficulties before he be partaker of it\" [WCF 18.3]. The Marrow Men\'s position on assurance is a minority report within Westminster orthodoxy, and the entry should not leave the impression that the Marrow position on this point is the confessional standard.) The controversy resurfaced in the 20th century in the OPC and CRC debates over the "free offer of the gospel," culminating in the 1948 OPC report by John Murray and Ned Stonehouse defending the well-meant offer, which affirmed that God sincerely desires the salvation of all to whom the gospel comes, even those not elected. This report established the free offer as confessionally Reformed while acknowledging the mystery of the relationship between God\'s decretive will and His revealed will (Deut 29:29; Ezek 33:11; 2 Pet 3:9; WCF 7.3; 3.1). THE REFORMED TRADITION ON THE MARROW CONTROVERSY: The definitive modern Reformed treatment of the Marrow Controversy demonstrates that its theological significance extends far beyond its 18th-century Scottish context. The central thesis of this tradition is that the Marrow Controversy reveals legalism and antinomianism to be \"non-identical twins from the same womb\" \u2013 both rooted in a fundamental distrust of God\'s generosity, both springing from the Edenic suspicion that God is not truly good and cannot be trusted. The legalist responds to this distrust by seeking security through law-keeping; the antinomian responds by concluding that God\'s commands must be restrictive rather than liberating. Both errors share the same root, and both are cured by the same medicine: receiving \"the whole Christ\" \u2013 not merely His benefits (forgiveness, justification, moral guidance) abstracted from His Person, but Christ Himself in the fullness of His mediatorial office. When sinners receive the living Christ, they receive simultaneously both pardon and renewal, both justification and sanctification, because these benefits are inseparable in the Person who bestows them. This tradition also surfaces a crucial pastoral insight from the Marrow tradition: \"repentance does not go before but comes after remission of sin.\" Faith grasps Christ, and repentance flows as its fruit. The sinner does not repent in order to qualify for grace; the sinner is received in Christ and therefore repents from a heart transformed by grace. This sequencing is not merely academic but pastorally revolutionary: it liberates the anxious conscience from the impossible task of producing sufficient sorrow as a prerequisite for coming to Christ, and grounds evangelical repentance in the prior apprehension of divine mercy. This analysis also demonstrates that the Marrow Controversy has direct implications for the law-gospel relationship: the gospel itself transforms the believer\'s relationship to the law. The three uses of the law remain valid, but they must be situated within the larger framework of \"gospel logic\" \u2013 the priority of indicatives over imperatives \u2013 lest the third use of the law (as a rule of life) degenerate into the first use (as an accusing pedagogue) in the believer\'s experience. The Marrow tradition\'s insistence on the free, unconditional offer of Christ to sinners as sinners \u2013 without prior qualifications of sufficient conviction, repentance, or moral preparation \u2013 is the practical outworking of this gospel logic in the pulpit.',k:['Marrow Controversy','free offer','gospel','antinomianism','neonomianism','legalism','law and gospel','assurance','universal offer','warrant','well-meant offer','OPC','saving faith','Christ offered','Isa 55:1','Matt 11:28','WCF 7.3','decretive will','revealed will','non-identical twins','distrust','generosity','gospel logic','repentance after remission','whole Christ received','Person not merely benefits'],cl:['free-offer-gospel','law-gospel','assurance'],ct:'soteriology'},
]},

{id:'good-works',n:'Good Works',ct:'soteriology',c:'#d8907c',r:1.1,o:14.5,
d:'Only those works are truly good which God has commanded in His holy Word, done from a true and living faith, and directed to the glory of God (WCF 16.1; Heb 13:21; Col 3:17). Good works are the fruit and evidence of a true and lively faith (Jas 2:18,22; WCF 16.2). They cannot merit pardon of sin or eternal life due to the great disproportion between them and the glory to come, and the infinite distance between us and God (WCF 16.5; Luke 17:10; Isa 64:6).',
k:['good works','fruit','faith','obedience','merit','reward','gratitude','law'],
cl:['salvation','law','christian-life','christian-liberty','sanctification','church'],
s:[
{id:'works-merit',n:'Good Works & Merit',d:'Believers cannot by their best works merit pardon of sin or eternal life at the hand of God because of the great disproportion and the infinite distance between God and the creature (WCF 16.5; Rom 3:20; Gal 2:16; Eph 2:8–9). Yet God is pleased to reward those who obey - not from debt but from the gracious promise of the covenant (WCF 16.6; Heb 6:10; Matt 25:21). All merit belongs to Christ alone.',k:['merit','disproportion','reward','grace','covenant promise'],cl:['merit-covenant-works','justification','active-obedience'],ct:'soteriology'},
{id:'works-unregenerate',n:'Works of Unregenerate Persons',d:'Works done by unregenerate persons, though for the matter of them they may be things which God commands, yet because they proceed not from a heart purified by faith, nor are done in a right manner according to the Word, nor to a right end (the glory of God), they are therefore sinful and cannot please God (WCF 16.7; Isa 64:6; Rom 14:23; Heb 11:6; Matt 6:2). They cannot make a man meet to receive grace.',k:['unregenerate','sinful','inability','splendid vices'],cl:['total-depravity','common-grace','calling-regen'],ct:'soteriology'},
{id:'works-nature',n:'The Nature & Source of Good Works',d:'Only those works are truly good which God has commanded in His holy Word (WCF 16.1; Mic 6:8; Rom 12:2; Heb 13:21). They must proceed from a heart purified by faith (Heb 11:6; 1 Tim 1:5), be performed in a right manner according to the Word (1 Cor 10:31; Col 3:17), and be directed to the glory of God as their ultimate end (WCF 16.1; 1 Cor 10:31). Good works are the fruit - not the root - of saving faith, wrought by the Spirit dwelling in believers (Jas 2:18,22; Gal 5:22–23; Phil 2:13; WCF 16.3). Believers are not able to do good works without the assistance of the Spirit (WCF 16.3; John 15:4–5).',k:['nature','source','commanded','faith','Spirit','fruit','glory of God','WCF 16.1'],cl:['sanctification','spirit-fruit','law','threefold-use'],ct:'soteriology'},
]},

{id:'church',n:'The Church',ct:'ecclesiology',c:'#b088d0',r:1.45,o:11,
d:'The catholic or universal church, which is invisible, consists of the whole number of the elect (WCF 25.1; Eph 1:22\u201323). The visible church consists of all those throughout the world that profess the true religion, together with their children (WCF 25.2; 1 Cor 1:2; Acts 2:39). Christ is the sole Head of the Church (Eph 1:22; Col 1:18; WCF 25.6). Out of the visible church there is no ordinary possibility of salvation (WCF 25.2; Acts 2:47). TRINITARIAN ECCLESIOLOGY: The church must be understood not merely through institutional or structural categories but through the Trinitarian dimensions of her existence, as Bavinck demonstrates with singular depth in his ecclesiology. The church is simultaneously: (1) the People of God (the Father\u2019s dimension) \u2013 chosen by the Father before the foundation of the world (Eph 1:4\u20135), called into covenant relationship, and gathered as His own possession (Titus 2:14; 1 Pet 2:9\u201310; Deut 7:6); (2) the Body of Christ (the Son\u2019s dimension) \u2013 united to the incarnate, crucified, risen, and ascended Mediator as His body to its Head (Eph 1:22\u201323; 4:15\u201316; Col 1:18; 1 Cor 12:12\u201327), His bride being prepared for the eschatological wedding feast (Eph 5:25\u201332; Rev 19:7\u20139; 21:2,9), and His temple built of living stones (1 Pet 2:4\u20135; Eph 2:19\u201322); and (3) the Fellowship of the Holy Spirit (the Spirit\u2019s dimension) \u2013 constituted, indwelt, gifted, and preserved by the Spirit who baptizes believers into one body (1 Cor 12:13), distributes gifts for ministry (1 Cor 12:4\u201311), dwells in the church as His temple (1 Cor 3:16; Eph 2:22), and maintains the communion (<i>koinonia</i>) of the saints (2 Cor 13:14; Phil 2:1). These three dimensions are not alternative models to be chosen among but co-inherent realities reflecting the perichoretic life of the triune God Himself. Bavinck insists that ecclesiology divorced from this Trinitarian ground reduces the church to a merely sociological entity. The church\u2019s identity, mission, worship, government, and eschatological hope are all rooted in the triune God\u2019s redemptive purpose: the Father elects and sends, the Son accomplishes and rules, the Spirit applies and indwells. The church\u2019s government by elders and deacons, its exercise of discipline and censures (WCF 30), its synods and councils (WCF 31), its confession of faith through subordinate standards (WCF 31.4), and its mission to all nations (Matt 28:18\u201320) must all be understood within this Trinitarian framework. As the eschatological people of God, the church exists between the already of Christ\u2019s accomplished redemption and the not-yet of the consummation, living as the first-fruits of the new creation (Jas 1:18; 2 Cor 5:17) and the pillar and buttress of the truth (1 Tim 3:15).',
k:['church','invisible','visible','one','holy','catholic','apostolic','Word','sacraments','discipline','body','bride','temple','People of God','Body of Christ','Fellowship of the Spirit','Trinitarian ecclesiology','<i>koinonia</i>','<i>perichoresis</i>','living stones','eschatological'],
cl:['salvation','christ','holy-spirit','sacraments','eschatology','covenant-grace','visible-invisible','marks-church','church-government','means-grace','church-mission','scripture','covenant-theology','law','christian-liberty','biblical-theology','worship','providence'],
hc:['Donatist controversy','Reformation ecclesiology','Erastianism vs. Presbyterian government','Oxford Movement'],
s:[
{id:'marks-church',n:'Marks of the True Church',d:'The pure preaching of the Word of God, the right administration of the sacraments, and the faithful exercise of church discipline (Matt 28:19\u201320; Matt 18:15\u201320; WCF 25.4). These marks are not merely institutional criteria but the means through which the exalted Christ exercises His threefold office in and through His body: He speaks prophetically through the preaching of His Word, nourishes His people as priest through the sacraments, and governs them as king through discipline. Some churches are more pure and some less pure, but the purest are subject to mixture and error (WCF 25.4\u20135; Rev 2\u20133). Yet Christ preserves a church on earth in every age (WCF 25.5; Matt 16:18).',k:['marks','preaching','sacraments','discipline','true church','threefold office','prophetic','priestly','kingly','Christ'],cl:['preaching-word','sacraments','church-discipline'],ct:'ecclesiology'},
{id:'christs-headship-church',n:'Christ\'s Headship over the Church',d:'Christ alone is the Head of the Church (WCF 25.6; Eph 1:22\u201323; 5:23; Col 1:18; 2:19). This is not merely the kingly office applied to the church but the direct assertion of Christ\'s sole, immediate, spiritual kingship over His body. The Pope of Rome cannot in any sense be head of the church but is that Antichrist, that man of sin and son of perdition, that exalteth himself in the church against Christ and all that is called God (WCF 25.6). Against Erastianism (which subordinates the church to the state), the headship of Christ means that the church receives her government, doctrine, worship, and discipline from Christ alone through His Word, not from any civil magistrate (WCF 23.3; 30.1). Against papal claims (which interpose a human vicar between Christ and His people), Christ exercises His headship immediately and directly \u2013 not through any earthly representative who claims universal jurisdiction. Against Congregationalist independence (which can practically deny any authority beyond the local assembly), Christ\'s headship is exercised through the system of graded courts that He has appointed \u2013 session, presbytery, and general assembly (WCF 31.1\u20133; Acts 15). This doctrine grounds the entire Presbyterian polity: because Christ is the sole Head, the church\'s government is a Christocracy administered through representative assemblies of elders, not a democracy, monarchy, or oligarchy. Bannerman provides the classic Presbyterian exposition of this doctrine.',k:['headship','Christ','Head of the Church','WCF 25.6','Eph 1:22','Col 1:18','Pope','Antichrist','Erastianism','civil magistrate','papal','Presbyterian polity','sole','immediate','spiritual kingship','Bannerman','graded courts','representative','session','presbytery','general assembly'],cl:['threefold-office','church-government','regulative-principle'],ct:'ecclesiology'},
{id:'church-government',n:'Church Government',d:'Christ has appointed a government in the hand of church officers distinct from the civil magistrate (WCF 30.1; Eph 4:11–12; 1 Cor 12:28). THE BIBLICAL ARGUMENT FOR PRESBYTERIAN POLITY: (1) The parity of elders: Scripture distinguishes teaching elders and ruling elders sharing the same office but with distinct functions (1 Tim 5:17; Acts 20:17,28; Titus 1:5–7). Against Episcopalianism, no single elder has monarchical authority; against Congregationalism, elders exercise real governing authority (Heb 13:17; 1 Pet 5:1–4). (2) Government by assemblies: Acts 15 (the Jerusalem Council) is the paradigmatic example of conciliar church government. (3) Ordinary and extraordinary offices: apostles, prophets, and evangelists were extraordinary offices that ceased; pastors, ruling elders, and deacons are permanent ordinary offices (Eph 4:11–12; 1 Tim 3:1–13; WCF 30–31). (4) The graded courts: session (local), presbytery (regional, including ordination and appeals), and general assembly (supreme jurisdiction in doctrine, worship, government, discipline; WCF 31.1–4).',k:['government','elder','deacon','Presbyterian','polity','keys','parity','1 Tim 5:17','Acts 15','graded courts','session','presbytery','general assembly','WCF 30','WCF 31','teaching elder','ruling elder','Episcopalian','Congregational','conciliar','ordination'],cl:['confessions-standards','synods-councils','scripture','civil-magistrate'],ct:'ecclesiology'},
{id:'church-discipline',n:'Church Discipline & Censures',d:'The Lord Jesus, as King and Head of His Church, has appointed a government in the hand of church officers distinct from the civil magistrate (WCF 30.1). The keys of the kingdom are committed to church officers to retain and remit sins (WCF 30.2; Matt 16:19; 18:15–20; John 20:21–23). THE PURPOSES OF DISCIPLINE (WCF 30.3): (1) Reclaiming offending brethren (Gal 6:1; 2 Cor 2:6–8). (2) Deterring others (1 Tim 5:20). (3) Purging out the leaven (1 Cor 5:6–7). (4) Vindicating the honor of Christ (2 Sam 12:14). (5) Preventing God\'s wrath on the church. THE CENSURES (WCF 30.4): Admonition (formal warning, Titus 3:10), suspension from the Lord\'s Supper, and ex<i>communicatio</i>n : cutting off the offender and delivering unto Satan for the destruction of the flesh (1 Cor 5:4–5; Matt 18:17). THE PROCESS (Matt 18:15–18): private admonition, admonition with witnesses, report to the session, and if no repentance, ex<i>communicatio</i>n. Restoration is always the goal: the church yearns for repentance and welcomes the penitent back with joy (2 Cor 2:6–8). Discipline is not punitive vengeance but medicinal love under Christ\'s authority.',k:['discipline','censures','admonition','suspension','ex<i>communicatio</i>n','keys','WCF 30','Matt 18:15','1 Cor 5','Matt 16:19','reclaim','deter','purge','vindicate','restoration','medicinal','pastoral','session','2 Cor 2:6'],cl:['sanctification','sin','lords-supper','visible-invisible'],ct:'ecclesiology'},
{id:'church-unity-catholicity',n:'The Church\'s Unity, Catholicity, & Apostolicity',d:'The four classical marks of the church \u2013 one, holy, catholic, and apostolic (Nicene-Constantinopolitan Creed) \u2013 receive their own treatment in Reformed dogmatics alongside the three Reformation marks (Word, sacraments, discipline). The oneness of the church flows from the one Lord, one faith, one baptism, one God and Father of all (Eph 4:4\u20136); it is grounded in the unity of Christ\'s body and the Spirit\'s indwelling (1 Cor 12:12\u201313). The holiness of the church is both definitive (set apart in Christ) and progressive (being sanctified by the Spirit, Eph 5:25\u201327). The catholicity of the church is especially important for confessional Presbyterianism: we are not sectarians but claimants to the one holy catholic church. The visible church \"consists of all those throughout the world that profess the true religion, together with their children\" (WCF 25.2) \u2013 this is a catholic claim, not a sectarian one. Against Rome\'s claim to exclusive catholicity, the Reformed tradition insists that catholicity belongs to the church universal as defined by Scripture, not to any single institutional communion. The apostolicity of the church consists not in an unbroken chain of episcopal ordination (apostolic succession) but in fidelity to the apostolic doctrine deposited in Scripture (Eph 2:20; Acts 2:42; Jude 3). Turretin treats the four marks extensively. Bavinck provides the most comprehensive modern Reformed treatment, arguing that the true marks are not institutional structures but faithfulness to Christ\'s Word, proper administration of the sacraments, and godly discipline. This node connects to the visible/invisible distinction (the invisible church possesses these marks perfectly; the visible church, imperfectly), to ecumenism (the Reformed commitment to the visible unity of Christ\'s church under His Word), and to the polemic against Rome\'s claim to exclusivity.',k:['unity','catholicity','apostolicity','one','holy','catholic','apostolic','Nicene Creed','four marks','Eph 4:4','1 Cor 12:12','Eph 5:25','Eph 2:20','apostolic succession','apostolic doctrine','sectarian','ecumenism','visible','invisible','WCF 25.2','universal','fidelity','Scripture'],ct:'ecclesiology'},
{id:'visible-invisible',n:'Visible & Invisible Church',d:'The invisible church is the whole number of the elect gathered unto Christ - known fully only to God (2 Tim 2:19; WCF 25.1). The visible church is the kingdom of the Lord Jesus Christ, consisting of all who profess the true religion and their children (WCF 25.2; Acts 2:39). The visible church is a mixed body of wheat and tares (Matt 13:24–30), yet the gates of hell shall not prevail against it (Matt 16:18).',k:['visible','invisible','elect','mixed','professing','children'],cl:['election','covenant-grace','means-grace','baptism'],ct:'ecclesiology'},
{id:'communion-saints',n:'The Communion of Saints',d:'All saints united to Christ by the Spirit have communion in His graces, sufferings, death, resurrection, glory, and in one another - obligated to mutual edification and the duties of fellowship (WCF 26.1–2; 1 John 1:3,7; Eph 4:15–16; Heb 10:24–25). This communion does not make any person partaker of the substance of another or infringe personal property rights (WCF 26.3; Acts 5:4).',k:['communion','fellowship','mutual edification','love','body of Christ'],cl:['mystical-union-christ','church','means-grace','lords-supper'],ct:'ecclesiology'},
{id:'synods-councils',n:'Synods and Councils',d:'For the better government and further edification of the church, there ought to be assemblies called synods or councils (WCF 31.1; Acts 15:2,4,6). They may authoritatively determine controversies of faith and cases of conscience, set rules for public worship and church government (WCF 31.2–3). Their decrees bind only insofar as they are consonant with the Word of God (WCF 31.4; Acts 17:11).',k:['synods','councils','assembly','authority','Word of God'],cl:['church-government','confessions-standards','scripture'],ct:'ecclesiology'},
{id:'church-mission',n:'The Great Commission & the Church\'s Mission',d:'All authority in heaven and on earth has been given to Me. Go therefore and make disciples of all nations, baptizing them in the name of the Father and of the Son and of the Holy Spirit, teaching them to observe all that I have commanded you (Matt 28:18\u201320; Acts 1:8; Mark 16:15; Luke 24:46\u201349). The church exists not merely as a gathered community but as a sent people \u2013 Bavinck insists that ecclesiology without missiology is truncated ecclesiology, because the church\'s identity as the people of God is inseparable from her calling to be the people of God for the world. The Great Commission is grounded in Christ\'s universal authority (\"all authority,\" Matt 28:18) \u2013 it is a kingly mandate flowing from the exalted Mediator\'s sovereign lordship over all nations (Ps 2:8; Dan 7:14; Phil 2:9\u201311). The scope is cosmic: not merely individual conversion but the discipling of nations \u2013 the comprehensive claim of Christ\'s kingship over every sphere of human life and culture. The content is Trinitarian: baptism in the name of the Father, Son, and Holy Spirit incorporates converts into the covenant community and the Trinitarian life of God. The means are ordinary: preaching the Word, administering the sacraments, teaching obedience \u2013 the same means of grace that sustain the church internally are the instruments of her external mission (WCF 25.3). Van Til would add that apologetics is itself a missionary discipline \u2013 defending the faith not as a mere intellectual exercise but as a dimension of bringing every thought captive to Christ (2 Cor 10:5). The church\'s mission is not a supplement to her worship and edification but their necessary outward expression: a church that does not send is a church that has misunderstood her own identity. Bavinck treats the church\'s mission as the instrument through which Christ gathers His elect from all nations. The relationship between divine sovereignty and human responsibility in mission is not paradoxical but complementary: because God has chosen a people from every tribe and tongue (Rev 5:9; 7:9), the church goes with confidence that her labor is not in vain in the Lord (1 Cor 15:58). Murray and Stonehouse, in the 1948 OPC report on the free offer of the gospel, established that definite atonement motivates rather than undermines evangelistic urgency: precisely because Christ has a people whom He will infallibly save, the church preaches with the assurance that the gospel call will be effectual in the elect. Election is the ground of evangelistic confidence, not its obstacle.',k:['Great Commission','mission','Matt 28:18','Acts 1:8','discipling nations','sent people','ecclesiology','missiology','kingly mandate','Ps 2:8','Dan 7:14','Trinitarian','baptism','ordinary means','apologetics','every sphere','sovereignty','evangelism','free offer','definite atonement','1948 OPC','election','Rev 5:9','cosmic scope','kingdom'],cl:['election-evangelism','free-offer-gospel','preaching-word','kingdom-of-god'],ct:'ecclesiology'},
{id:'election-evangelism',n:'Election & Evangelism',d:'The doctrines of sovereign election, definite atonement, and irresistible grace, far from undermining evangelistic urgency, provide its only secure theological foundation. Murray and Stonehouse argue in the 1948 OPC report on the free offer of the gospel that God sincerely desires the salvation of all to whom the gospel comes (Ezek 33:11; 2 Pet 3:9), even as His decretive will infallibly secures the salvation of the elect alone. This is not a contradiction but a mystery grounded in the distinction between God\'s decretive and preceptive will (Deut 29:29; WCF 3.1; 7.3). Definite atonement means that Christ actually saves all for whom He died (John 10:11,15,27\u201329; 6:37\u201339) \u2013 and this gives the preacher unshakable confidence that the gospel call will not return void (Isa 55:11). The Canons of Dort (III/IV.8\u20139) insist that the gospel must be promiscuously and indiscriminately preached to all nations and peoples, and that as many as are called by the gospel are unfeignedly called. The Reformed preaching tradition has exemplified the practical integration of sovereign election and evangelistic urgency. The church evangelizes not despite election but because of it \u2013 knowing that among those to whom she preaches, God has His chosen ones who will certainly be brought to faith (Acts 18:10; John 10:16). The Reformed missionary tradition (from through the Great Awakening to modern global missions) demonstrates that Calvinistic theology has consistently produced some of the most zealous and sacrificial missionary endeavors in church history.',k:['election','evangelism','definite atonement','free offer','1948 OPC','decretive will','preceptive will','Dort','Isa 55:11','John 10:16','Acts 18:10','missions','Reformed','confidence','sovereignty','responsibility','indiscriminate preaching'],cl:['election','free-offer-gospel','definite-atonement','church-mission'],ct:'ecclesiology'},
{id:'christs-kingship-nations',n:'Christ\'s Kingship over the Nations',d:'All authority in heaven and on earth has been given to Me (Matt 28:18). The exalted Christ reigns not merely over the church but over all nations, all cultures, and all spheres of human life (Ps 2:6\u20139; Dan 2:44; 7:13\u201314; Phil 2:9\u201311; Eph 1:20\u201322; Rev 11:15; 19:16). His kingship is the theological foundation of both the Great Commission and the cultural mandate. Psalm 2 is architectonically significant: the Father installs His Son as King on Zion (v. 6), gives Him the nations as His inheritance (v. 8), and warns the kings of the earth to serve the LORD with fear and kiss the Son lest He be angry (vv. 10\u201312). This universal kingship means that no realm of human existence is exempt from Christ\'s sovereign claim \u2013 not politics, not education, not science, not art, not commerce (Col 1:15\u201320; 1 Cor 8:6). The famous Reformed dictum expresses this conviction: \"There is not a square inch in the whole domain of our human existence over which Christ, who is Sovereign over all, does not cry, Mine!\" Yet Christ\'s kingship in the present inter-advent era is exercised primarily through the Word, the Spirit, and the means of grace \u2013 not through political coercion or theocratic imposition (John 18:36; 2 Cor 10:3\u20135). The church advances the kingdom by preaching, prayer, and the faithful witness of holy lives, not by the sword (WCF 25.3; 23.3). At the consummation, every knee shall bow and every tongue confess that Jesus Christ is Lord, to the glory of God the Father (Phil 2:10\u201311; Rev 11:15).',k:['kingship','nations','Ps 2','Dan 2:44','Dan 7:13','Matt 28:18','Phil 2:9','Eph 1:20','Rev 11:15','every sphere','sovereignty','cultural mandate','Great Commission','kingdom','Col 1:15','consummation','all authority','political theology'],ct:'ecclesiology'},
{id:'civil-magistrate',n:'The Civil Magistrate',d:'God, the supreme Lord and King of all the world, has ordained civil magistrates to be under Him over the people, for His own glory and the public good (Rom 13:1–4; 1 Pet 2:13–14; WCF 23.1). The magistrate is God\'s minister to execute wrath on the evildoer (Rom 13:4) and bears the power of the sword for the punishment of wickedness and vice and the maintenance of justice and peace (WCF 23.1; 1 Tim 2:1–2). Calvin and Turretin devote extensive treatment to civil government. It is the duty of all to pray for magistrates, honor their persons, obey their lawful commands, and be subject for conscience sake (WCF 23.4; 1 Tim 2:1–2; Titus 3:1). The civil magistrate may not assume the administration of the Word and sacraments, nor the power of the keys of the kingdom (WCF 23.3). Church and state have distinct spheres under Christ\'s universal lordship, neither absorbing the other. The 1788 American revision of WCF 23.3 - which removed the magistrate\'s duty to suppress heresies and blasphemies and added protections for religious liberty - represents one of the most significant confessional changes in American Presbyterian history, enshrining the principle that the magistrate\'s duty is to protect the church\'s freedom rather than to enforce its doctrine. Just war, the duties of citizens, resistance to tyranny, and the limits of civil obedience belong to this locus.',k:['civil magistrate','government','authority','Romans 13','church and state','conscience','obedience','distinct spheres','WCF 23','1788 revision','religious liberty','just war','sword','justice'],cl:['natural-law','common-grace','christian-liberty','noahic-covenant'],ct:'ecclesiology'},
{id:'marriage-divorce',n:'Marriage & Divorce',d:'Marriage is a divine ordinance instituted by God between one man and one woman for mutual help, the propagation of mankind, and the prevention of uncleanness (Gen 2:18,24; Matt 19:4–6; WCF 24.1–2; Heb 13:4). It is lawful for all sorts of people to marry who are able with judgment to give their consent, observing the prohibitions of consanguinity (Lev 18; WCF 24.4). Nothing but adultery or such willful desertion as can no way be remedied by the church or civil magistrate is sufficient cause for dissolving the bond of marriage (WCF 24.5–6; Matt 5:32; 19:9; 1 Cor 7:15). Remarriage is permitted to the innocent party as if the offending party were dead (WCF 24.5).',k:['marriage','divorce','one man one woman','adultery','desertion','remarriage','ordinance','consanguinity','WCF 24'],ct:'ecclesiology'},
{id:'oaths-vows',n:'Lawful Oaths & Vows',d:'A lawful oath is a part of religious worship wherein the person swears by God alone, calling Him to witness what is asserted or promised, and to judge the swearer according to the truth or falsehood of what is sworn (WCF 22.1–2; Deut 6:13; 2 Cor 1:23; Isa 65:16). It is to be taken in the plain and common sense of the words, without equivocation or mental reservation (WCF 22.4; Ps 24:4). A vow is a voluntary engagement to God, binding on the conscience (WCF 22.5–6; Ps 76:11; Eccl 5:4–6). No man may vow to do what is forbidden by the Word of God (WCF 22.7; Acts 23:12–14). Oath-taking in lawful causes is not forbidden by Christ (Matt 5:34–37 addresses false and frivolous oaths, not solemn judicial oaths; WCF 22.2).',k:['oaths','vows','worship','conscience','witness','truth','binding','WCF 22'],ct:'ecclesiology'},
{id:'church-officers',n:'Church Officers',d:'Christ has appointed the offices of minister of the Word (teaching elder), ruling elder, and deacon for the government and service of the church (1 Tim 3:1–13; 5:17; Titus 1:5–9; Acts 6:1–6; WCF 30.1; 31.1). The teaching elder labors in the Word and doctrine; the ruling elder joins in government and discipline; the deacon ministers to the temporal needs of the church (1 Tim 5:17; Acts 6:2–4; Rom 12:8). All officers must meet the qualifications of Scripture: above reproach, apt to teach (for elders), and proven in character (1 Tim 3:1–13; Titus 1:6–9). Officers are ordained by the laying on of hands of the presbytery (1 Tim 4:14).',k:['officers','teaching elder','ruling elder','deacon','ordination','qualifications','presbytery','government','service'],cl:['preaching-word','church-discipline','sacraments','church-government'],ct:'ecclesiology'},
]},

{id:'sacraments',n:'The Sacraments',ct:'ecclesiology',c:'#b088d0',r:1.3,o:12,
d:'Holy ordinances instituted by Christ in the church as signs and seals of the covenant of grace to represent Christ and His benefits, to confirm our interest in Him, to put a visible difference between those that belong to the church and the world, and to engage them to the service of God (WCF 27.1; Rom 4:11; Gen 17:7,10; Matt 28:19; 1 Cor 11:23–26). Two only: Baptism and the Lord\'s Supper (WCF 27.4). Effectual not <i>ex opere operato</i>, but by the Spirit working in and by them in those who by faith receive them (WCF 27.3).',
k:['sacraments','signs','seals','covenant','baptism','Lord\'s Supper','means of grace','faith'],
cl:['church','covenant-grace','christ','holy-spirit','means-grace','covenant-theology','covenant-signs','baptism','lords-supper','scripture'],
hc:['Lutheran-Reformed debate on Lord\'s Supper','Marburg Colloquy (1529)','Reformation rejection of Rome\'s seven sacraments','Trent Session 7 (1547)'],
s:[
{id:'baptism',n:'Baptism',d:'Sacrament of initiation : a sign and seal of the covenant of grace, of ingrafting into Christ, of regeneration, of remission of sins, and of yielding up to God through Jesus Christ to walk in newness of life (WCF 28.1; Rom 6:3–4; Col 2:11–12; Gal 3:27). Administered once with water in the name of the Father, Son, and Holy Spirit (Matt 28:19; WCF 28.2). THE COVENANTAL ARGUMENT FOR INFANT BAPTISM: The most distinctive sacramental commitment of Presbyterianism rests on the continuity of the covenant sign from circumcision to baptism. The argument proceeds: (1) God established a covenant with Abraham and his seed, commanding that the sign of the covenant (circumcision) be administered to believers and their infant children (Gen 17:7,10–14). (2) The New Covenant does not narrow the scope of the covenant community but expands it (Acts 2:39 : the promise is to you and to your children and to all who are far off). (3) Baptism replaces circumcision as the covenant sign (Col 2:11–12). (4) The household baptisms of Acts (Acts 16:15,33; 18:8; 1 Cor 1:16) assume the inclusion of children. (5) Paul affirms that children of even one believing parent are holy (1 Cor 7:14) : covenantally set apart. (6) WCF 28.4: Not only those that do actually profess faith in and obedience unto Christ, but also the infants of one or both believing parents, are to be baptized. BAPTISMAL EFFICACY: WCF 28.6 carefully states that the efficacy of baptism is not tied to that moment of time wherein it is administered; yet the grace promised is not only offered but really exhibited and conferred by the Holy Ghost, to such as that grace belongeth unto, according to the counsel of God\'s own will, in His appointed time. This means baptism is a genuine means of grace : yet its efficacy operates not <i>ex opere operato</i> but by the Spirit\'s sovereign application.',k:['baptism','initiation','union','regeneration','infant baptism','covenant','circumcision','Col 2:11','Acts 2:39','Gen 17:7','1 Cor 7:14','WCF 28.4','WCF 28.6','household baptisms','paedobaptism','sign','seal','efficacy','Holy Spirit','means of grace','covenant children'],cl:['covenant-signs','abrahamic-covenant','calling-regen','covenant-grace','original-sin','visible-invisible'],ct:'ecclesiology'},
{id:'lords-supper',n:'The Lord\'s Supper',d:'Sacrament of spiritual nourishment \u2013 a perpetual remembrance of the sacrifice of Christ\'s death, a seal of all benefits to true believers, and a bond of their communion with Him and with each other (WCF 29.1; 1 Cor 11:23\u201326; 10:16\u201317). Christ is really, truly, and spiritually present to faith in the Supper \u2013 not corporally in, with, or under the elements, but spiritually received and fed upon by the believer\'s faith through the operation of the Holy Spirit (WCF 29.7; John 6:53\u201358). THE PNEUMATOLOGICAL DIMENSION: The Holy Spirit is the <i>vinculum</i> (bond) who makes the sacrament effectual. Calvin\'s profound contribution is the doctrine of the <i>sursum corda</i> \u2013 the Spirit lifts the believer\'s soul to heaven, where the ascended Christ is seated at the Father\'s right hand, to feed upon His body and blood by faith. This is neither the Roman error of transubstantiation (which brings Christ down to the elements) nor the Zwinglian reduction (which makes the Supper a bare memorial with no real spiritual nourishment) but the genuine spiritual feeding on the whole Christ \u2013 His body and blood, His person and work \u2013 by the secret and marvelous operation of the Spirit. WCF 29.7 states that \"worthy receivers, outwardly partaking of the visible elements in this sacrament, do then also inwardly by faith, really and indeed, yet not carnally and corporally, but spiritually, receive and feed upon Christ crucified and all benefits of His death: the body and blood of Christ being then not corporally or carnally in, with, or under the bread and wine; yet as really, but spiritually, present to the faith of believers in that ordinance as the elements themselves are to their outward senses.\" Calvin insists that this is not merely a cognitive exercise but genuine spiritual nourishment \u2013 what Calvin calls the \"wonderful exchange\" (<i>admirabile commercium</i>) that happens at the Table: the believer truly feeds on Christ by faith, and the Spirit deepens the union between Christ and His people through the appointed means. The Supper is thus a means of grace in the fullest sense: the Spirit uses the visible signs to strengthen and deepen the believer\'s union with the ascended Christ, nourishing faith, confirming the promises, and sustaining the spiritual life. The eschatological dimension is equally significant: \"For as often as you eat this bread and drink the cup, you proclaim the Lord\'s death until He comes\" (1 Cor 11:26). The Supper is an eschatological foretaste of the marriage supper of the Lamb (Rev 19:9; Matt 26:29), a pledge of the consummation, and a participation in the powers of the age to come.',k:['Lord\'s Supper','communion','spiritual presence','memorial','nourishment','pneumatological','Spirit','<i>vinculum</i>','bond','<i>sursum corda</i>','ascended Christ','WCF 29.7','wonderful exchange','<i>admirabile commercium</i>','genuine feeding','union with Christ','means of grace','eschatological','1 Cor 11:26','Rev 19:9','marriage supper','foretaste','transubstantiation','Zwinglian','spiritual nourishment','<i>extra Calvinisticum</i>','<i>finitum non capax infiniti</i>','consubstantiation','Lutheran ubiquity','heavenly session','WCF 29.1'],cl:['communion-saints','covenant-signs','passive-obedience','mystical-union-christ','new-covenant','extra-calvinisticum','fencing-table'],ct:'ecclesiology'},
{id:'sacrament-word',n:'Sacraments & the Word',d:'The sacraments are effectual means of salvation not from any virtue in them or in him that administers them, but only by the blessing of Christ and the working of His Spirit in them that by faith receive them (WCF 27.3; 1 Cor 3:7; 1 Pet 3:21). The Word of God is necessary for a right understanding; without the Word the sacraments are not complete (WCF 27.3). They confirm and strengthen the faith that the Word creates (Rom 10:17; WCF 14.1).',k:['word','sacrament','effectual','Spirit','faith','blessing'],ct:'ecclesiology'},
{id:'sacrament-definition',n:'The Number & Nature of Sacraments',d:'A sacrament is a holy ordinance instituted by Christ in His church, to signify, seal, and exhibit to those within the covenant of grace the benefits of His mediation, to strengthen and increase their faith, to oblige them to obedience, to testify and cherish their love and communion with one another (WCF 27.1; Rom 4:11; 1 Cor 11:25; Gen 17:7,10). There are only two sacraments ordained by Christ: Baptism and the Lord\'s Supper (WCF 27.4; Matt 28:19; 1 Cor 11:23). Against Rome, the five additional rites (confirmation, penance, orders, matrimony, extreme unction) are not sacraments instituted by Christ (WCF 27.4). The sacramental union between the sign and the thing signified is real but spiritual, not physical or local (WCF 27.2).',k:['sacrament','definition','number','two','sign','seal','exhibit','spiritual','WCF 27','against Rome'],ct:'ecclesiology'},
{id:'fencing-table',n:'Fencing the Table & Worthy Receiving',d:'The Lord\'s Supper is not to be administered to those who are ignorant or scandalous, until they receive instruction and manifest reformation (WCF 29.8; 1 Cor 11:27–29; Matt 7:6). Self-examination is required: the communicant must discern the Lord\'s body, examine his knowledge, faith, repentance, love, and new obedience (1 Cor 11:28–29; WCF 29.8). Those who receive unworthily are guilty of the body and blood of the Lord, eating and drinking judgment upon themselves (1 Cor 11:27–29). The elders are charged to fence the table - admitting the worthy and barring the scandalous - for the purity of the sacrament and the protection of the congregation. The confessional requirement of self-examination (1 Cor 11:28) presupposes a professing, credible faith capable of discerning the Lord\'s body, which excludes both the ignorant and the scandalous. This position also addresses the paedocommunion question, which has become a live intra-Reformed debate particularly in Federal Vision circles: the confessional standard requires that communion presupposes self-examination and a profession of faith (WCF 29.8; LC 177), which by their nature are not possible for those who have not yet made a credible profession. The confessional position thus distinguishes the sacrament of baptism (administered to covenant children on the basis of the promise) from the sacrament of the Lord\'s Supper (administered to those who can examine themselves and discern the body).',k:['fencing','worthy','self-examination','discipline','ignorant','scandalous','discern','WCF 29.8','elders'],cl:['church-discipline','lords-supper','warning-passages'],ct:'ecclesiology'},
]},

{id:'means-grace',n:'The Means of Grace',ct:'ecclesiology',c:'#b088d0',r:1.15,o:13,
d:'The outward and ordinary means whereby Christ communicates the benefits of redemption are His ordinances - especially the Word, sacraments, and prayer (WCF 7.6; Rom 10:14–17; 1 Pet 2:2). All of these are made effectual to the elect for salvation by the Spirit (WCF 25.3). God ordinarily works through these means, binding Himself to use them in the economy of grace, yet remaining free in His sovereignty (WCF 5.3; 10.1).',
k:['means of grace','Word','sacraments','prayer','ordinances','Spirit','effectual'],
cl:['church','sacraments','scripture','holy-spirit','worship','preaching-word','baptism','lords-supper','prayer-theology','salvation','christian-life'],
s:[
{id:'preaching-word',n:'The Preaching of the Word',d:'The reading, and especially the preaching, of the Word of God is an effectual means of convincing and converting sinners and building them up in holiness and comfort (Rom 10:14,17; 1 Cor 1:21; 2 Tim 3:15\u201317; WCF 1.8; 7.6). The Spirit makes the preaching of the Word an effectual means of enlightening, convicting, and humbling sinners, of driving them out of themselves, and drawing them unto Christ (WCF 10.1). CHRISTOLOGICAL AND DOXOLOGICAL DIMENSIONS: Edmund Clowney, as Westminster\u2019s first president and the patriarch of redemptive-historical preaching, insisted that the entirety of Scripture \u2013 Old and New Testaments \u2013 has Christ as its ultimate subject and aim (Luke 24:27,44\u201345; John 5:39,46; 1 Pet 1:10\u201312). Preaching that ignores the history of redemption ignores the witness of the Holy Spirit to Jesus in all the Scriptures. Against moralistic interpretation \u2013 which reduces biblical narratives to mere examples of human virtue or vice (e.g., treating David and Goliath as primarily about courage rather than about God\u2019s anointed champion who prefigures Christ\u2019s victory over the enemies of God\u2019s people) \u2013 Clowney developed a hermeneutical method (sometimes called \\\"Clowney\u2019s Triangle\\\") that moves from an Old Testament symbol or event to its theological meaning within its own epoch of redemptive history, and then traces that meaning\u2019s fulfillment and climactic realization in Christ. This method embodies the conviction that biblical theology and systematic theology are not competitive but organically related: exegesis is controlled by biblical theology, which in turn yields the good fruits of systematics . Preaching is thus not merely the <i>communicatio</i>n of propositional information but a doxological encounter with the living Christ through the Spirit. Clowney lamented that \\\"our sermons are so centered on men that they neglect to bless God,\\\" and insisted that preaching is itself an act of worship \u2013 the Spirit-empowered proclamation through which the risen Christ speaks to His people and they respond in faith, repentance, and praise. The preacher does not merely transmit doctrine; he heralds the person and work of Christ from every text of Scripture, so that the congregation meets Christ in the Word proclaimed. The content of preaching is not abstract moral maxims but the unfolding drama of redemption: creation, fall, covenant promise, typological anticipation, prophetic expectation, incarnation, atonement, resurrection, ascension, Pentecost, and the consummated hope of the new creation. Every sermon must set forth not only what Scripture says but how that text participates in the redemptive-historical trajectory that culminates in Christ\u2019s person and work. Preaching that treats doctrines as isolated propositions rather than facets of Christ\u2019s accomplished redemption falls into what Clowney calls \\\"mere doctrinal moralizing.\\\" The ordained minister preaches not by human authority but by divine appointment, as an ambassador of Christ (2 Cor 5:20), a steward of the mysteries of God (1 Cor 4:1), and a herald of the gospel of the glory of the blessed God (1 Tim 1:11). The Directory for the Public Worship of God provides the regulative framework for the preaching office within the assembly.',k:['preaching','Word','effectual','conversion','edification','redemptive-historical','Christological','doxological','moralistic','biblical theology','Clowney\u2019s Triangle','Christ in all Scripture','Luke 24:27','John 5:39','typology','herald','ambassador','worship','encounter','Spirit','proclamation','drama of redemption'],cl:['calling-regen','free-offer-gospel','spirit-illumination','threefold-office','scripture'],ct:'ecclesiology'},
{id:'prayer-means',n:'Prayer as Means of Grace',d:'Prayer is offered in the name of the Son, by the help of the Spirit, according to His will, with understanding, reverence, humility, fervency, faith, love, and perseverance (WCF 21.3; John 16:23; Rom 8:26; Phil 4:6). It is a part of religious worship required by God of all people (WCF 21.3; Matt 6:6–13; 1 Tim 2:1–4). Through prayer God communicates His grace and blessings to His people (Jas 5:16; 1 John 5:14–15).',k:['prayer','intercession','worship','Spirit','petition','thanksgiving'],cl:['prayer-theology','spirit-prayer','trinitarian-prayer','intercession-christ'],ct:'ecclesiology'},
{id:'lords-prayer',n:'The Lord\'s Prayer',d:'The whole Word of God directs us in prayer, but the special rule of direction is that form of prayer which Christ taught His disciples, commonly called the Lord\'s Prayer (Matt 6:9–13; Luke 11:2–4; LC 186; SC 99). It contains six petitions: the hallowing of God\'s name, the coming of His kingdom, the doing of His will, provision for daily needs, forgiveness of sins (as we forgive), and deliverance from temptation and evil (Matt 6:9–13). The preface (Our Father in heaven) teaches us to draw near to God with holy reverence and confidence, as children to a father able and ready to help us (LC 189; SC 100). The conclusion (for thine is the kingdom, and the power, and the glory, forever, Amen) teaches us to take our encouragement in prayer from God alone and to praise Him (LC 196; SC 107).',k:['Lord\'s Prayer','petitions','model','hallowing','kingdom','will','provision','forgiveness','temptation','LC 186','SC 99'],ct:'ecclesiology'},
]},

{id:'worship',n:'Worship & the Lord\'s Day',ct:'ecclesiology',c:'#b088d0',r:1.1,o:14.5,
d:'The light of nature shows that there is a God who has lordship and sovereignty over all, and that He is to be worshipped - but the acceptable way is instituted by God Himself in Scripture alone (WCF 21.1; the Regulative Principle). The Christian Sabbath (Lord\u2019s Day) is to be observed to the end of the world as the Christian Sabbath - a day of holy rest and worship (WCF 21.7\u20138; Acts 20:7; 1 Cor 16:1\u20132; Rev 1:10). WORSHIP AS DOXOLOGICAL ENCOUNTER: Worship in Reformed theology is not merely the performance of prescribed duties but a Spirit-mediated encounter with the living God through the person and work of Christ. Vos holds that biblical theology is \\\"a labor of worship\\\" and that true worship is the redeemed community\u2019s response to God\u2019s self-revelation in the history of redemption. Worship is Trinitarian in its deepest structure: believers are brought by the Spirit into the presence of the Father through the mediation of Christ the Son (Eph 2:18; Heb 10:19\u201322; John 4:23\u201324). The elements of worship \u2013 the reading and preaching of the Word, prayer, the singing of praise, and the administration of the sacraments \u2013 are not isolated religious acts but the means through which the covenant community meets the risen Christ and responds with faith, repentance, adoration, and self-offering. Clowney lamented sermons and services \\\"so centered on men that they neglect to bless God,\\\" and urged that worship must be theocentric and Christological at every point: we do not merely learn about God in worship but are drawn into communion with Him through Christ by the Spirit. The eschatological dimension of worship is essential: the earthly assembly participates in the heavenly worship of the Lamb (Heb 12:22\u201324; Rev 4\u20135), and the Lord\u2019s Supper is an eschatological foretaste of the marriage supper of the Lamb (1 Cor 11:26; Rev 19:9). The Reformed tradition grounds worship in the sovereignty of God over His own ordinances and treats worship as the church\u2019s response to divine revelation; and the Westminster Directory for Public Worship provides the confessional framework for the ordering of corporate worship.',
k:['worship','regulative principle','Lord\'s Day','sabbath','prayer','singing','preaching','reading','ordinances','doxological','Trinitarian worship','encounter','theocentric','Christological','Eph 2:18','Heb 12:22','eschatological','Directory for Public Worship'],
cl:['church','means-grace','scripture','law','christ','holy-spirit','sabbath-lords-day','prayer-theology','trinitarian-prayer','singing-praise','trinity','regulative-principle'],
s:[
{id:'regulative-principle',n:'The Regulative Principle of Worship',d:'The Regulative Principle of Worship (RPW) is among the most distinctive and consequential doctrines of the Reformed tradition, distinguishing it from both Roman Catholic and broadly evangelical approaches to worship. It holds that God may not be worshipped in any other way than He has prescribed in His own Word - whatever is not commanded is forbidden in the worship of God (WCF 21.1; Deut 12:32; Lev 10:1-2; Col 2:23; Matt 15:9). This stands against the normative principle (held by Lutherans and many evangelicals), which permits whatever Scripture does not expressly forbid. The biblical foundation rests on texts like Nadab and Abihu\'s offering of "strange fire" not commanded by the Lord (Lev 10:1-2), Uzzah\'s presumption (2 Sam 6:6-7), and Christ\'s condemnation of human traditions imposed as worship (Matt 15:1-9; Mark 7:6-8). The RPW distinguishes between elements and circumstances of worship. Elements are those parts of worship that God has instituted and that constitute worship itself: the reading of Scripture, the preaching and hearing of the Word, prayer with thanksgiving, the singing of psalms, hymns, and spiritual songs, the administration of the sacraments (Baptism and the Lord\'s Supper), and on appropriate occasions religious oaths, vows, solemn fasting, and days of thanksgiving (WCF 21.3-5). These may not be added to, subtracted from, or replaced by human invention. Circumstances are those matters "common to human actions and societies" that are not specifically prescribed but must be ordered by the light of nature and Christian prudence according to the general rules of the Word (WCF 1.6) - such as the time of meeting, the language used, the arrangement of seating, and similar logistical details. The Reformed tradition has consistently insisted that "God disapproves of all modes of worship not expressly sanctioned by His Word." Turretin provides systematic argumentation distinguishing elements from circumstances and defending the principle against both Roman additions and Anabaptist innovations. Van Til grounds the RPW in the sovereignty of God over His own worship: because God alone is the proper object of worship, He alone has the right to determine its form. The RPW has practical implications for debates over exclusive psalmody vs. hymns, the use of instruments, the inclusion of drama or dance, the observance of the church calendar, and the nature of the sacraments. It is also the theological basis for rejecting images in worship (Second Commandment; WCF 21.1; WLC Q109), human priesthood, and all liturgical innovations not warranted by Scripture.',k:['regulative principle','RPW','elements','circumstances','WCF 21.1','Deut 12:32','Nadab Abihu','normative principle','commanded','worship','preaching','sacraments','singing','prayer','reading','exclusive psalmody','images','Second Commandment','sovereignty','human traditions','strange fire'],cl:['worship','scripture','sufficiency','christs-headship-church','first-table'],ct:'ecclesiology'},
{id:'sabbath-lords-day',n:'The Christian Sabbath (Lord\'s Day)',d:'The Sabbath is to be sanctified by a holy resting all that day, even from such worldly employments and recreations as are lawful on other days, and spending the whole time in the public and private exercises of God\'s worship, except so much as is taken up in works of necessity and mercy (WCF 21.8; Isa 58:13–14; Matt 12:1–12). From the beginning of the world to the resurrection of Christ it was the last day of the week, and from the resurrection has been changed to the first day of the week, which in Scripture is called the Lord\'s Day, and is to be continued to the end of the world as the Christian Sabbath (WCF 21.7; Acts 20:7; 1 Cor 16:1–2; Rev 1:10). The Sabbath is a perpetual moral obligation, not a ceremonial type abrogated in Christ.',k:['Sabbath','Lord\'s Day','rest','worship','first day','perpetual','moral','WCF 21.7–8','necessity','mercy'],cl:['creation-to-consummation','creation','worship','first-table','new-creation'],ct:'ecclesiology'},
{id:'religious-worship',n:'The Elements & Parts of Religious Worship',d:'The acceptable way of worshipping the true God is instituted by Himself and limited by His own revealed will (WCF 21.1). The parts of ordinary religious worship include: the reading of the Scriptures with godly fear, the sound preaching and conscionable hearing of the Word, singing of psalms with grace in the heart, and the due administration and worthy receiving of the sacraments (WCF 21.5; Acts 15:21; 2 Tim 4:2; Col 3:16). Also prayer with thanksgiving (WCF 21.3; Phil 4:6), religious oaths and vows, solemn fastings, and thanksgivings on special occasions (WCF 21.5; Joel 2:12; Esth 4:16). These and only these are the elements of worship appointed by God.',k:['elements','worship','reading','preaching','singing','psalms','sacraments','prayer','oaths','fasting','WCF 21.5'],ct:'ecclesiology'},
]},

{id:'christian-liberty',n:'Christian Liberty & Liberty of Conscience',ct:'ethics',c:'#c8b468',r:1.3,o:13.5,
d:'A major Reformed distinctive spanning soteriology, ethics, ecclesiology, and political theology. WCF devotes an entire chapter (20) to this doctrine. The liberty Christ has purchased for believers includes freedom from the guilt of sin, the condemning wrath of God, the curse of the moral law, the dominion of sin, the evil of afflictions, the sting of death, and the victory of the grave (WCF 20.1; Gal 5:1). Under the New Testament the liberty of Christians is further enlarged: freedom from the yoke of the ceremonial law, greater boldness of access to the throne of grace, and fuller <i>communicatio</i>ns of the free Spirit (WCF 20.1; Gal 3:13; Heb 4:16; John 7:38\u201339). God alone is Lord of the conscience, which He has set free from the doctrines and commandments of men contrary to His Word or beside it in matters of faith or worship (WCF 20.2; Jas 4:12; Acts 4:19; 1 Cor 7:23). This principle has been a foundation of Western political liberty \u2013 from Knox\'s resistance theory through Rutherford\'s Lex Rex to the American founding.',
k:['liberty','conscience','freedom','lordship','obedience','WCF 20','guilt','curse','ceremonial','access','Spirit','ecclesiastical','civil','foundational','Knox','Rutherford','Lex Rex','Covenanters','political liberty'],
cl:['law','salvation','church','worship','conscience-freedom','law-gospel','good-works'],
hc:['Scottish Covenanters','English Civil War','American Presbyterian revision of WCF'],
s:[
{id:'liberty-conscience-wcf20-1-2',n:'Liberty of Conscience (WCF 20.1\u20132)',d:'The liberty which Christ has purchased for believers under the gospel consists in their freedom from the guilt of sin, the condemning wrath of God, the curse of the moral law; and in their being delivered from this present evil world, bondage to Satan, and dominion of sin, from the evil of afflictions, the sting of death, the victory of the grave, and everlasting damnation; as also in their free access to God, and their yielding obedience unto Him, not out of slavish fear, but a childlike love and willing mind (WCF 20.1; Gal 5:1; Titus 2:14; 1 Thess 1:10; Rom 8:1,15). God alone is Lord of the conscience, and has left it free from the doctrines and commandments of men which are in anything contrary to His Word, or beside it, in matters of faith or worship (WCF 20.2; Jas 4:12; Acts 4:19; Rom 14:4). To require implicit faith and an absolute blind obedience is to destroy liberty of conscience and reason also (WCF 20.2). This principle, that no human authority \u2013 whether ecclesiastical or civil \u2013 may bind the conscience beyond what God has revealed, is among the most consequential contributions of Reformed theology to Western civilization.',k:['liberty of conscience','WCF 20.1','WCF 20.2','guilt','wrath','curse','bondage','access','childlike','Lord of conscience','blind obedience','human authority'],cl:['conscience','scripture','worship'],ct:'ethics'},
{id:'liberty-not-license',n:'Christian Liberty Not a License for Sin (WCF 20.3)',d:'They who, upon pretense of Christian liberty, do practice any sin or cherish any lust, do thereby destroy the end of Christian liberty, which is that, being delivered out of the hands of our enemies, we might serve the Lord without fear, in holiness and righteousness before Him, all the days of our life (WCF 20.3; Gal 5:13; 1 Pet 2:16; 2 Pet 2:19; John 8:34; Luke 1:74\u201375). Liberty is not autonomy but freedom for godliness. The antinomian abuse of liberty is self-refuting: to use freedom as a pretext for sin is to return to the very bondage from which Christ redeemed us. Calvin insists that Christian liberty has three parts: freedom from the law as a means of justification, willing obedience from a grateful heart, and freedom in adiaphora (things indifferent) \u2013 none of which permits licentiousness.',k:['not license','sin','Gal 5:13','1 Pet 2:16','antinomianism','holiness','adiaphora','WCF 20.3','bondage','freedom for godliness'],cl:['sanctification','good-works','threefold-use'],ct:'ethics'},
{id:'liberty-vs-authority',n:'Liberty vs. Lawful Authority (WCF 20.4)',d:'The civil magistrate and church officers have legitimate authority under God, and Christian liberty does not exempt believers from lawful obedience. Those who publish opinions or maintain practices contrary to the light of nature, the known principles of Christianity, or the power of godliness, or who are destructive to the external peace and order of the church, may lawfully be called to account and proceeded against by the censures of the church and the power of the civil magistrate (WCF 20.4; Rom 13:1\u20137; 1 Tim 2:1\u20132; Heb 13:17). The genius of the Reformed position is the simultaneous affirmation of liberty of conscience AND the legitimate authority of both church and state within their proper spheres. Neither anarchism (no authority) nor tyranny (unlimited authority) is permitted. The boundaries of lawful authority are defined by Scripture, the light of nature, and the principles of Christian godliness.',k:['authority','magistrate','church','censures','WCF 20.4','obedience','boundaries','Rom 13','spheres','peace','order'],cl:['church-government','civil-magistrate','synods-councils'],ct:'ethics'},
{id:'liberty-historical',n:'Historical Significance: Knox, Rutherford & the Covenanters',d:'The Reformed doctrine of liberty of conscience has had incalculable historical significance. John Knox carried Calvin\'s theology of resistance to Scotland, insisting that rulers who contravene God\'s law may be resisted. Samuel Rutherford\'s Lex, Rex (1644) argued from covenant theology that the king is under the law, not above it \u2013 a direct application of the principle that God alone is Lord of the conscience. The Scottish Covenanters (from the National Covenant of 1638 through the Killing Time of the 1680s) suffered persecution precisely because they refused to acknowledge any human claim to lordship over conscience in matters of worship and church government. The Covenanter tradition directly influenced the American founding through John Witherspoon (President of Princeton and signer of the Declaration of Independence) and the broader Scotch-Irish Presbyterian immigration. The 1788 American revision of WCF 23.3 \u2013 which removed the magistrate\'s power to suppress heresy and added protections for religious liberty \u2013 is a direct institutional expression of WCF 20\'s principle. Kuyper\'s sphere sovereignty is a later Dutch Reformed development of the same root principle: each sphere of life has its own God-given authority, and no sphere may usurp another.',k:['Knox','Rutherford','Lex Rex','Covenanters','National Covenant','Killing Time','Witherspoon','1788 revision','American founding','religious liberty','sphere sovereignty','resistance','covenant theology'],ct:'ethics'},
{id:'conscience-freedom',n:'Conscience & Freedom',d:'Liberty of conscience is not a license to sin or to destroy Christian liberty (WCF 20.3; Gal 5:13; 1 Pet 2:16). God alone is Lord of the conscience (WCF 20.2). Neither magistrate nor church may bind the conscience beyond what Scripture requires. Yet this freedom must not be used as a cloak for vice (Rom 14:1\u201323; 1 Cor 8:7\u201313). The weak and strong must bear with one another in matters indifferent, and no one may judge another\'s servant in adiaphora (Rom 14:1\u201313). But in matters where Scripture speaks, conscience is bound to God\'s Word and no human tradition may override it.',k:['conscience','freedom','limits','responsibility','sin','adiaphora','weak and strong','Rom 14'],cl:['natural-law','christian-liberty'],ct:'ethics'},
]},

{id:'eschatology',n:'Eschatology',ct:'eschatology',c:'#50b0b0',r:1.5,o:12.5,
d:'The doctrine of the last things - Christ\u2019s return, the resurrection of the dead, the final judgment, and the eternal state (WCF 32\u201333; 1 Thess 4:13\u201318; Rev 20\u201322). The consummation of God\u2019s redemptive purpose: creation restored and glorified, evil judged, and the covenant of grace brought to its eternal fullness. ARCHITECTONIC PRINCIPLE: Eschatology is not merely the final locus of systematic theology but a dimension permeating the entire system from creation onward. The eschatological orientation was built into creation from the beginning: the covenant of works offered eschatological life beyond the mutable state (WCF 7.2); the Sabbath pointed to eternal rest (Heb 4:9\u201311); Eden was a proto-temple oriented toward the cosmic temple of the new creation (Rev 21:22; Beale). The trajectory is irreversibly forward: creation \u2192 covenant of works \u2192 fall \u2192 covenant of grace \u2192 Christ the Last Adam \u2192 new creation. The eschatological state is not a return to Eden but Eden glorified \u2013 what Adam would have attained had he passed the probation, now secured through the Last Adam\u2019s obedience (1 Cor 15:45\u201349). The already/not-yet framework shapes soteriology (believers possess the firstfruits of the Spirit, Rom 8:23), pneumatology (the Spirit is the <i>arrabon</i> of the inheritance, Eph 1:14), and Christology (Christ\u2019s resurrection is the firstfruits of the eschaton, 1 Cor 15:20). As Vos holds, \u201Csoteriology is eschatology\u201D \u2013 the resurrection of Christ inaugurates the age to come within the present age. Bavinck insists that the protology-eschatology axis is organic and architectonic: grace perfects nature; the new creation is the old creation glorified; and the entire <i>historia salutis</i> moves forward from Garden to Glory. The Christian life is lived between the first and second advents: the kingdom inaugurated but not yet consummated. Gaffin captures this with precision: the believer\u2019s existence is an eschatological tension between \u201Cresurrection realized and yet to be realized\u201D \u2013 already sharing in Christ\u2019s resurrection life by the Spirit (Rom 6:4\u20135; Eph 2:5\u20136; Col 3:1\u20134), yet groaning for the redemption of the body (Rom 8:23) and the full unveiling of what it means to be a new creation in Christ (2 Cor 5:17; 1 John 3:2). Pentecost belongs to this eschatological framework: the Spirit poured out at Pentecost is the eschatological gift, the <i>arrabon</i> of the inheritance (Eph 1:14), the power of the age to come operative in believers who live between the ages (Heb 6:5). Eschatology is thus not primarily about end-times chronology but about the present reality of the inaugurated new creation \u2013 and the already/not-yet framework must govern not only the eschatology locus but the entire system.',
k:['eschatology','consummation','return','resurrection','judgment','new creation','hope','kingdom','glory','transformation','eternal','already','not yet','amillennialism','millennium','antichrist','apostasy','warning passages','protology','creation-to-consummation','forward movement','Garden to Glory'],
cl:['christ','creation','church','salvation','covenant-grace','covenant-works','holy-spirit','return-christ','resurrection-body','final-judgment','new-creation','death-intermediate','decree','god','sin','covenant-theology','biblical-theology','humanity','beatific-vision'],
hc:['Pre/Post/Amillennial debates','Dispensationalist controversy','Vos-Ridderbos-Gaffin already/not-yet revolution'],
s:[
{id:'two-age-model',n:'The Two-Age Model (This Age / The Age to Come)',d:'The foundational structural framework of New Testament eschatology is the Jewish and apostolic distinction between "this age" (ho aion houtos) and "the age to come" (ho aion mellon) (Matt 12:32; Mark 10:30; Luke 18:30; Eph 1:21; Heb 6:5). In Jewish expectation, these two ages were sharply sequential: this present evil age (Gal 1:4) would end catastrophically with the Day of the Lord, and the age to come - the age of resurrection, the Spirit, and the messianic kingdom - would dawn. The decisive Christian modification, articulated by Vos and Ridderbos, is that Christ\'s resurrection has inaugurated the age to come within the continuing framework of this present age. The two ages now overlap: believers already participate in the powers of the age to come (Heb 6:5) through union with the risen Christ, yet still live in this present evil age awaiting the consummation. This "already/not-yet" framework - the eschatological tension between the inaugurated and the consummated kingdom - is the hermeneutical key to the entire New Testament. It shapes every major locus of theology: soteriology (believers possess the firstfruits of the Spirit, Rom 8:23, while groaning for final redemption), sanctification (the decisive victory over sin has been won in Christ\'s death and resurrection, Rom 6:2-10, yet the struggle continues, Gal 5:17), ecclesiology (the church is the eschatological community of the new creation living in the old world), and ethics (the indicative of what God has done in Christ grounds the imperative of new obedience). Ridderbos holds this structure as the organizing principle of Pauline theology. Vos holds that Christ\'s resurrection is not merely a proof of His deity or a guarantee of future hope but is itself the beginning of the eschatological harvest - the "firstfruits" (1 Cor 15:20,23) of the general resurrection, making eschatology constitutive of soteriology rather than merely its appendix. Ridderbos systematized the two-age framework as the architectonic structure of Pauline thought. The two-age model provides the essential corrective to both overrealized eschatology (triumphalism that denies the ongoing reality of suffering and sin) and underrealized eschatology (defeatism that fails to reckon with the decisive victory Christ has already won). The Christian life is lived in the overlap of the ages - between the "D-Day" of Christ\'s resurrection and the "V-Day" of His return .',k:['two-age model','this age','age to come','already not yet','inaugurated','consummated','firstfruits','1 Cor 15:20','Rom 8:23','Heb 6:5','overlap','eschatological tension','kingdom','resurrection','Pauline','structural framework','hermeneutical key'],cl:['creation-to-consummation','kingdom-of-god'],ct:'eschatology'},
{id:'death-intermediate',n:'Death & the Intermediate State',d:'Physical death: the separation of soul from body (Eccl 12:7; WCF 32.1). The souls of the righteous are received into the highest heavens where they behold the face of God in light and glory, waiting for the full redemption of their bodies (WCF 32.1; 2 Cor 5:6–8; Phil 1:23; Luke 23:43). The souls of the wicked are cast into hell, in torments and utter darkness, reserved to the judgment of the great day (WCF 32.1; Luke 16:23–24; 2 Pet 2:9). No purgatory (WCF 32.1).',k:['death','intermediate state','conscious','blessedness','temporary','no purgatory'],cl:['soul-body','glorification','resurrection-body'],ct:'eschatology'},
{id:'return-christ',n:'The Return of Christ',d:'Personal, visible, bodily, glorious return - the same Jesus who ascended (Acts 1:11; Matt 24:30; 1 Thess 4:16; WCF 33.1). Sudden, unexpected (Matt 24:36,44), universally visible. The blessed hope - consummation of the entire history of redemption (Titus 2:13; Rev 1:7). God has appointed a day wherein He will judge the world in righteousness by Jesus Christ (WCF 33.1; Acts 17:31).',k:['return','par<i>ousia</i>','visible','bodily','hope','consummation'],cl:['final-judgment','resurrection-body','new-creation','states-christ','amillennialism'],ct:'eschatology'},
{id:'resurrection-body',n:'The Resurrection of the Body',d:'At the last day all the dead shall be raised up with the selfsame bodies and none other, although with different qualities - righteous to life, wicked to dishonor (WCF 32.2–3; 1 Cor 15:42–44; John 5:28–29; Dan 12:2). The bodies of the just shall be conformed to Christ\'s glorious body (Phil 3:21; 1 Cor 15:43). Not escape from but the redemption of the body (Rom 8:23).',k:['resurrection','body','incorruption','glorified','transformation'],cl:['soul-body','glorification','creation-to-consummation','death-intermediate','resurrection-eschatological-event'],ct:'eschatology'},
{id:'final-judgment',n:'The Final Judgment',d:'God has appointed a day wherein He will judge the world in righteousness by Jesus Christ, to whom all power and judgment is given of the Father (WCF 33.1; Acts 17:31; Matt 25:31–46; 2 Cor 5:10). The righteous shall go into everlasting life and the wicked into everlasting punishment (Matt 25:46; WCF 33.2). The purpose is to manifest the glory of God\'s mercy in the eternal salvation of the elect, and of His justice in the damnation of the reprobate (Rom 9:22–23; WCF 33.2).',k:['judgment','righteousness','vindication','eternal','mercy','justice'],cl:['divine-righteousness','reprobation','good-works','hell-eternity','new-creation'],ct:'eschatology'},
{id:'new-creation',n:'The New Creation',d:'Not annihilation but radical renewal - new heavens and a new earth in which righteousness dwells (2 Pet 3:13; Rev 21:1\u20135; Isa 65:17; WCF 33.2). Culture and embodiment brought to perfection. God dwelling with His people - no more death, mourning, crying, or pain (Rev 21:3\u20134). The eternal sabbath rest (Heb 4:9\u201311). The consummation of the covenant of grace and the fullness of Christ\'s kingdom. The new creation is protology consummated: the Garden of Eden brought to its telos, not returned to its origin. Every structural element of creation reappears in glorified form: the tree of life reappears (Rev 22:2); the sanctuary-garden becomes the cosmic temple where God dwells without mediation (Rev 21:22); the cultural mandate finds its eternal fulfillment in glorified humanity reigning with Christ (Rev 22:5); the Sabbath rest achieves its permanent form (Heb 4:9\u201311). The covenant of works, which offered eschatological life that Adam forfeited, is fulfilled by the Last Adam (1 Cor 15:45\u201349), and the new creation is the state that Adam would have attained had he passed the probation. The trajectory is irreversibly forward: creation \u2192 covenant of works \u2192 fall \u2192 covenant of grace \u2192 Christ \u2192 new creation. Eschatology is not the negation of creation but its glorification \u2013 God makes all things new (Rev 21:5), not all new things, preserving identity while transforming quality.',k:['new creation','new heavens','new earth','renewal','sabbath','eternal','protology consummated','telos','Garden','cosmic temple','tree of life','consummation','covenant','glory','beatific vision','forward movement','Eden glorified','creation-to-consummation','cultural mandate','Last Adam','covenant of works fulfilled'],cl:['creation-to-consummation','cosmic-redemption','glorification','beatific-vision','eternal-state','marriage-supper'],ct:'eschatology'},
{id:'hell-eternity',n:'Eternal Punishment',d:'The wicked who know not God and obey not the gospel of Jesus Christ shall be cast into eternal torments and be punished with everlasting destruction from the presence of the Lord (WCF 33.2; 2 Thess 1:9; Matt 25:41,46; Mark 9:48; Rev 14:11). This punishment is conscious, unending, and proportionate to God\'s righteous judgment. Against annihilationism: the duration of punishment parallels the duration of the life of the blessed.',k:['hell','eternal punishment','destruction','wrath','justice','conscious'],ct:'eschatology'},
{id:'amillennialism',n:'The Millennium & Amillennialism',d:'The Reformed confessional tradition, as represented by Bavinck, Ridderbos, Vos, Berkhof, and the mainstream of Reformed orthodoxy, understands the "thousand years" of Revelation 20:1\u20136 as a symbolic designation for the entire inter-advent period - the era between Christ\'s first and second comings in which Satan is bound (Matt 12:29; Col 2:15; Rev 20:2\u20133), the saints reign spiritually with Christ (Eph 2:6; Rev 20:4\u20136), and the kingdom advances through the preaching of the gospel. This amillennial reading holds that the first resurrection (Rev 20:4\u20135) refers to spiritual regeneration (John 5:24\u201325; Eph 2:5\u20136; Col 3:1) or the blessedness of the intermediate state, while the second resurrection (Rev 20:12\u201313) is the bodily resurrection at Christ\'s return. Berkhof argues at length that premillennialism (both historic and dispensational) contradicts the unity of the covenant of grace, introduces a reversion to Old Testament shadows, and fragments the single return of Christ and general judgment into multiple stages. Calvin rejects chiliasm as contrary to the spiritual nature of Christ\'s kingdom (John 18:36) and as resting on an overly literalistic reading of apocalyptic imagery. Postmillennialism, held by theologians of impeccable Reformed credentials (Hodge, Warfield, Boettner, and Kuyper in certain formulations), shares Reformed optimism about the gospel\'s power and the advance of Christ\'s kingdom. The amillennial tradition, however, questions whether the expectation of a golden age prior to the par<i>ousia</i> is sustained by Christ\'s own teaching about tribulation until the end (Matt 24:21\u201329; Luke 18:8; 2 Tim 3:1\u20135). Both amillennialism and postmillennialism fall within the bounds of confessional Reformed orthodoxy; premillennialism (especially in its dispensational form) is more difficult to reconcile with the confessional framework. The WCF does not specify a millennial position but its eschatology - a single return, general resurrection, and final judgment (WCF 32\u201333) - is most naturally read amillennially. The already/not-yet framework, articulated by Vos, Ridderbos, and Gaffin, provides the hermeneutical key: the kingdom is present in power but not yet consummated in glory, and will be fully realized only at the par<i>ousia</i>.',k:['amillennialism','millennium','Rev 20','thousand years','already/not yet','kingdom','first resurrection','premillennialism','postmillennialism','dispensationalism','chiliasm','WCF 32\u201333','inter-advent','spiritual reign','binding of Satan'],cl:['kingdom-of-god','return-christ','two-age-model'],ct:'eschatology'},
{id:'antichrist',n:'The Antichrist & the Man of Lawlessness',d:'Scripture teaches that a great apostasy and the revelation of the man of lawlessness will precede Christ\'s return (2 Thess 2:3\u201312; 1 John 2:18,22; 4:3; 2 John 7; Rev 13; 17). The WCF (25.6) historically identifies the Pope of Rome as "that Antichrist, that man of sin and son of perdition, that exalteth himself in the Church against Christ and all that is called God." Calvin holds that the papacy fulfills Paul\'s prophecy in 2 Thessalonians 2, usurping Christ\'s authority, claiming infallibility, and tyrannizing the consciences of believers. Turretin likewise identifies the Roman papacy as the Antichrist, arguing from the marks given by Paul: sitting in the temple of God (the visible church), exalting himself above all that is called God, and performing lying wonders (2 Thess 2:4,9). Bavinck offers a more nuanced treatment, acknowledging the Reformation identification while noting that the Antichrist principle manifests in every age through forces of apostasy, false teaching, and opposition to Christ\'s kingdom. Bavinck holds the Antichrist as both a present reality (the spirit of antichrist already at work, 1 John 4:3) and a future intensification (a personal or institutional embodiment of concentrated evil before the end, 2 Thess 2:8\u201310). The Reformed tradition holds that Antichrist will be destroyed by the brightness of Christ\'s coming (2 Thess 2:8) and that the church must be vigilant against all forms of the antichristian spirit: false prophecy, doctrinal corruption, and the usurpation of Christ\'s sole headship over the church.',k:['Antichrist','man of lawlessness','2 Thess 2','papacy','WCF 25.6','apostasy','1 John 2:18','Rev 13','false prophet','usurpation','headship'],ct:'eschatology'},
{id:'warning-passages',n:'The Warning Passages & Apostasy',d:'Several New Testament passages warn professing believers in the strongest terms against falling away (Heb 6:4\u20136; 10:26\u201329; 2 Pet 2:20\u201322; Matt 24:13; 1 Cor 9:27; Col 1:23). These passages have been a major point of controversy between Reformed and Arminian theology. The Reformed tradition maintains the perseverance of the saints (WCF 17.1\u20132) while taking these warnings with full seriousness as genuine means by which God preserves His elect. Calvin argues that Hebrews 6 describes those who have experienced the common operations of the Spirit - temporary faith, external enlightenment, and partial reformation - without possessing true saving grace. They taste the heavenly gift but are not united to Christ by the Spirit in regenerating power. Turretin and Owen devote extensive argumentation to reconciling the warning passages with perseverance, distinguishing between: (1) true believers who are warned in order to stir diligence and prevent complacency (the warnings functioning as means of perseverance); (2) temporary professors who fall away, proving they were never truly of the elect (1 John 2:19; Matt 7:21\u201323); and (3) the hypothetical or rhetorical nature of some warnings (Heb 6:9 - "though we speak in this way, yet in your case, beloved, we feel sure of better things"). Berkhof treats the warnings as evidence of the covenantal seriousness of the Christian life: they are real exhortations addressed to the visible church, which is always a mixed body. Berkhof classifies the warnings under the doctrine of perseverance and emphasizes that assurance is not presumption - true faith manifests itself in persevering obedience (WCF 17.3; 18.3). The warnings serve the elect by awakening holy fear, spurring self-examination, driving believers to Christ, and functioning as the divinely appointed means through which God secures the perseverance He has decreed (Phil 2:12\u201313). They do not teach that true regenerate believers can lose their salvation but rather that the path to glory runs through genuine faith and its fruits.',k:['warning passages','apostasy','Heb 6:4','Heb 10:26','perseverance','temporary faith','common operations','means','diligence','1 John 2:19','visible church','self-examination','holy fear','mixed body'],cl:['perseverance','assurance','church-discipline'],ct:'eschatology'},
{id:'cosmic-redemption',n:'The Cosmic Scope of Redemption',d:'Eschatology in Reformed theology is not merely about the soul\'s destiny but about the redemption of the entire created order. Creation itself, subjected to futility by God in hope, groans together with the children of God as it awaits liberation from its bondage to corruption (Rom 8:19\u201322). The scope of Christ\'s redemptive work is nothing less than cosmic: He is reconciling all things to Himself, whether on earth or in heaven, making peace by the blood of His cross (Col 1:20). Bavinck insists that grace restores and perfects nature rather than destroying it \u2013 the new creation is not a replacement of the old but its radical renewal and glorification. Kuyper\'s famous dictum that there is not a square inch over which Christ does not say \"Mine\" finds its eschatological fulfillment in the new heavens and new earth (2 Pet 3:13; Rev 21:1\u20135). Vos holds that the eschatological consummation is the goal toward which creation was oriented from the beginning: protology is incomplete without eschatology. The creation-to-consummation axis is the backbone of this cosmic scope: creation \u2192 covenant of works \u2192 fall \u2192 covenant of grace \u2192 Christ \u2192 new creation is not a circle back to Eden but a forward movement to Eden glorified. The cultural mandate (Gen 1:28) finds its eternal fulfillment, not its annihilation, in the glorified state. Against Gnostic world-denial and against Enlightenment utopianism alike, Reformed eschatology affirms that God will make all things new (Rev 21:5) \u2013 not all new things \u2013 preserving the identity while transforming the quality of the created order.',k:['cosmic redemption','Rom 8:19','Col 1:20','creation groaning','new creation','nature and grace','protology','cultural mandate','renewal','glorification','all things new'],cl:['creation','new-creation','creation-to-consummation'],ct:'eschatology'},
{id:'beatific-vision',n:'The Beatific Vision',d:'The glorified saints will see God face to face (1 Cor 13:12; 1 John 3:2; Rev 22:4; Matt 5:8) \u2013 not with bodily eyes perceiving the divine essence (for God is spirit, John 4:24) but with the intellect glorified and elevated to behold the triune God as He is, without the mediation of earthly types and shadows. This beatific vision is the highest blessedness of the creature and the ultimate telos of human existence: the chief end of man is to glorify God and enjoy Him forever (WSC Q1), and this enjoyment reaches its perfection in the immediate, face-to-face knowledge of God in glory. Turretin discusses whether the blessed see the divine essence itself and concludes that they know God immediately (without creaturely media) yet never comprehensively \u2013 God remains incomprehensible even in glory, and the saints will grow in knowledge forever without ever exhausting the infinite depths of the divine being. Bavinck treats the beatific vision as an ever-deepening, ever-expanding knowledge and enjoyment of God \u2013 an eternal progression into the inexhaustible riches of the triune life. Calvin speaks of it with remarkable restraint and reverence. Jonathan Edwards further developed this doctrine, teaching that the saints will be progressively drawn into ever-greater knowledge, love, and joy in God throughout eternity \u2013 an infinite journey into the infinite God.',k:['beatific vision','face to face','1 Cor 13:12','1 John 3:2','Rev 22:4','Matt 5:8','immediate knowledge','incomprehensibility','eternal progression','glory','WSC Q1','enjoyment','telos'],cl:['divine-incomprehensibility','divine-blessedness','glorification','new-creation','will-glory'],ct:'eschatology'},
{id:'eternal-state',n:'The Eternal State & Life Everlasting',d:'Eternal life is not merely endless duration but a quality of existence \u2013 knowing the only true God and Jesus Christ whom He has sent (John 17:3; WCF 33.2). The eternal state for the righteous includes: the perfected communion of the saints with one another and with the triune God (Rev 21:3; 1 Thess 4:17); the absence of all sin, suffering, death, and the curse (Rev 21:4; 22:3); the glorified body conformed to Christ\'s resurrection body (Phil 3:21; 1 Cor 15:42\u201349); the fullness of joy and pleasures forevermore (Ps 16:11); the eternal Sabbath rest (Heb 4:9\u201311); and the unending worship of God and the Lamb (Rev 5:13; 7:9\u201317; 22:3\u20135). Bavinck insists that the eternal state is not static repose but dynamic, active life \u2013 glorified humanity will serve God (Rev 22:3), reign with Christ (Rev 22:5), and continue to exercise the renewed cultural mandate. Turretin emphasizes that the blessedness of heaven consists supremely in the enjoyment of God Himself.',k:['eternal state','life everlasting','John 17:3','Rev 21:3','Sabbath rest','Heb 4:9','glorified body','worship','joy','Ps 16:11','communion','WLC Q86','Rev 22:3','active life','dynamic','cultural mandate','reign'],ct:'eschatology'},
{id:'consummation-covenant',n:'The Consummation of the Covenant',d:'The entire covenant of grace reaches its telos in the eschatological consummation. The covenant promise \u2013 \"I will be your God, and you shall be My people\" (Gen 17:7; Jer 31:33; Rev 21:3) \u2013 is the golden thread running from Genesis to Revelation, and it finds its ultimate fulfillment when God dwells with His people in the new creation without any barrier of sin, death, or mediation. Bavinck treats the consummation as the completion of the covenant: everything the covenant of grace promised is fully realized. Vos holds that eschatology is not an appendix to covenant theology but its crown: the covenant was always oriented toward a final, permanent, glorified state. The <i>pactum salutis</i> finds its goal when the Father receives back the people given to the Son (John 17:24), the Son presents the church without spot or wrinkle (Eph 5:27), and the Spirit\'s sealing work reaches its terminus in final glorification (Eph 1:13\u201314; 4:30). The covenant of works, broken by Adam, is fulfilled by the Last Adam (1 Cor 15:45\u201349), and the eschatological state is what Adam would have attained had he passed the probation.',k:['consummation','covenant','I will be your God','Rev 21:3','Gen 17:7','telos','<i>pactum salutis</i>','covenant of works','Last Adam','Eph 5:27','glorification','fulfillment','golden thread'],cl:['covenant-grace','new-covenant','new-creation','marriage-supper'],ct:'eschatology'},
{id:'signs-times',n:'The Signs of the Times & Eschatological Ethics',d:'Christ taught His disciples to discern the signs of the times (Matt 16:3; Luke 12:56) while maintaining watchfulness and readiness for His return at an unknown hour (Matt 24:36,42\u201344; 25:13; 1 Thess 5:1\u201311). Bavinck identifies several signs as characterizing the entire inter-advent period with varying intensity: the proclamation of the gospel to all nations (Matt 24:14); the ongoing tribulation and persecution of the church (John 16:33; 2 Tim 3:12); the rise of false prophets and antichrists (Matt 24:11,24; 1 John 2:18); apostasy and lawlessness (2 Thess 2:3; 1 Tim 4:1); and the conversion of Israel (Rom 11:25\u201332). The eschatological tension shapes Christian ethics: because this world in its present form is passing away (1 Cor 7:31; 1 John 2:17), believers are to live as sojourners (1 Pet 2:11), set their minds on things above (Col 3:1\u20132), and practice holy living in light of the coming Day (2 Pet 3:11\u201314; Titus 2:11\u201314). Calvin devotes two chapters to meditation on the future life and its effects on present conduct. Bavinck treats the signs of the times as pastoral instruments: they comfort the suffering church and summon believers to vigilance, prayer, and faithful stewardship.',k:['signs of the times','Matt 24','watchfulness','readiness','inter-advent','gospel proclamation','persecution','false prophets','apostasy','conversion of Israel','Rom 11','eschatological ethics','2 Pet 3:11','sojourners','holy living','Titus 2:11','vigilance','stewardship'],ct:'eschatology'},
{id:'resurrection-eschatological-event',n:'Christ\'s Resurrection as Eschatological Event',d:'The resurrection of Jesus Christ is not merely a proof of His deity or a guarantee of future resurrection but is itself the decisive eschatological event \u2013 the irruption of the age to come into the midst of this present age. Vos first articulated this insight programmatically, and Richard Gaffin develops it with full systematic rigor : Christ\'s resurrection is the \"firstfruits\" (1 Cor 15:20,23) of the general resurrection, making it not only chronologically first but organically connected to the resurrection of all believers. Paul\'s soteriology is fundamentally resurrection-shaped: justification is \"through the resurrection\" (Rom 4:25); union with Christ means union with the risen Christ (Rom 6:4\u20135); the Spirit is the \"Spirit of Him who raised Jesus from the dead\" (Rom 8:11). Gaffin holds that this makes eschatology constitutive of soteriology: the application of redemption is, at its core, the sharing of the believer in Christ\'s eschatological resurrection life by the Spirit. Christ\'s ascension and heavenly session extend this eschatological reality: believers are already seated with Him in the heavenly places (Eph 2:6), exercising an anticipatory participation in the powers of the age to come (Heb 6:5). PNEUMATOLOGICAL COROLLARY: The resurrection is inseparable from Pentecost in the <i>historia salutis</i>. Gaffin holds that 1 Cor 15:45 (\"the last Adam became the life-giving Spirit\") is Paul\'s one-sentence commentary on the connection between Christ\'s resurrection-exaltation and the outpouring of the Spirit: the resurrected Christ communicates His eschatological life to His people by and as the Spirit. Pentecost is thus the applicatory counterpart of the resurrection \u2013 both are once-for-all, unrepeatable, constitutive events in the <i>historia salutis</i>. The Spirit poured out at Pentecost is the Spirit of the resurrected Christ, the <i>arrabon</i> (down payment) of the eschatological inheritance (Eph 1:13\u201314), and every soteric experience of the believer is a participation in Christ\'s resurrection life through the Spirit.',k:['resurrection','eschatological event','firstfruits','1 Cor 15:20','age to come','Rom 4:25','union with Christ','Spirit','Rom 8:11','soteriology','ascension','session','Eph 2:6','Heb 6:5','already','ontological','biblical theology','harvest','Pentecost','1 Cor 15:45','life-giving Spirit','<i>arrabon</i>','<i>historia salutis</i>'],cl:['states-christ','spirit-pentecost','glorification','historia-ordo-relationship'],ct:'eschatology'},
{id:'marriage-supper',n:'The Marriage Supper of the Lamb',d:'Blessed are those who are invited to the marriage supper of the Lamb (Rev 19:9). Scripture portrays the consummation as a wedding feast \u2013 the culmination of the nuptial imagery that runs throughout the canon: God as husband of His people (Isa 54:5; Hos 2:16\u201320), Christ as the Bridegroom (Matt 25:1\u201313; John 3:29; Eph 5:25\u201332), and the church as the Bride adorned for her husband (Rev 19:7\u20138; 21:2,9). This nuptial eschatology gives the consummation its most intimate and personal character: the end of all things is not an abstract state but a covenant relationship brought to perfection \u2013 the permanent, unbreakable, joyful union of Christ with His redeemed people. The Lord\'s Supper is the foretaste and pledge of this eschatological feast (Matt 26:29; 1 Cor 11:26). Calvin and Bavinck both emphasize the personal, relational character of eschatological blessedness. The parable of the ten virgins (Matt 25:1\u201313) underscores the necessity of preparedness and the finality of the closing of the door.',k:['marriage supper','Lamb','Rev 19:9','Bridegroom','Bride','nuptial','Eph 5:25','Rev 21:2','Lord\'s Supper','eschatological feast','Matt 26:29','communion','preparedness','Matt 25','ecclesiology','betrothal','consummation'],ct:'eschatology'},
]},

{id:'revelation',n:'Revelation',ct:'prolegomena',c:'#70a0d0',r:1.2,o:13.5,
d:'God\'s sovereign self-disclosure through which He makes Himself known. General revelation through creation, conscience, and providence (Ps 19:1–6; Rom 1:19–20; WCF 1.1). Special revelation through word and deed - theophanies, prophecy, miracles, supremely the incarnation (Heb 1:1–2; John 1:14). Scripture is the permanent, sufficient form of special revelation for the church age (WCF 1.1). Bavinck and Van Til insist on the organic unity of general and special revelation: they are not two independent sources of knowledge but two inseparable aspects of the one self-revelation of the triune God. Even Adam in the pre-fall state received both simultaneously : God spoke to him (special revelation) in the garden He had made (general revelation) : and the two were designed to function together as an integrated whole. General revelation provides the theater in which special revelation is heard, and special revelation provides the interpretive framework in which general revelation is rightly understood. Any approach that treats natural theology as an autonomous, pre-scriptural enterprise : building a foundation of theistic knowledge by unaided reason before turning to Scripture : severs this organic unity and operates on the assumption of creaturely intellectual autonomy that the Reformed doctrine of total depravity and the noetic effects of sin categorically deny (1 Cor 2:14; Rom 1:18; WCF 6.2–4; 9.3).',
k:['revelation','general','special','creation','conscience','theophany','prophecy','incarnation','self-disclosure'],
cl:['prolegomena','scripture','god','christ','creation','gen-revelation','spec-revelation','natural-theology','knowledge-god'],
s:[
{id:'gen-revelation',n:'General Revelation',d:'God\'s self-manifestation through creation, conscience, and the course of history (Rom 1:19–20; Ps 19:1–4; Acts 14:17; 17:26–28; WCF 1.1). Reveals God\'s eternal power, divine nature, goodness, wisdom, and moral demands (Rom 1:20; 2:14–15). Renders all without excuse (Rom 1:20). Sufficient to condemn but insufficient to save : it does not communicate the gospel or the way of redemption (WCF 1.1). Critically, general revelation is not a neutral datum that the unregenerate mind correctly interprets: in the fallen state, the knowledge of God through nature is universally and culpably suppressed in unrighteousness (Rom 1:18). The sinner does not merely fail to draw correct inferences from nature; he actively holds down the truth that nature presses upon him at every point. General revelation, therefore, cannot serve as an autonomous foundation for a natural theology constructed by unregenerate reason apart from Scripture and regeneration. It functions organically with special revelation : the two are inseparable aspects of God\'s one self-revelation, designed to be received together and rightly interpreted only through the lens of Scripture and the illumination of the Holy Spirit.',k:['general revelation','creation','conscience','without excuse','suppression','organic unity','Rom 1:18','Rom 1:19'],cl:['natural-theology','creation','conscience','sin'],ct:'prolegomena'},
{id:'spec-revelation',n:'Special Revelation',d:'God\'s specific, redemptive self-disclosure in word and deed (Heb 1:1–2; WCF 1.1). Progressive - from shadow to substance, from promise to fulfillment. The former ways (prophecy, dreams, theophanies) ceased with the completion of the canon. It reached its zenith in the incarnation of the Son (John 1:14,18) and its permanent inscripturated form in the sixty-six books of Scripture (WCF 1.1–2). Special revelation does not replace general revelation but interprets, completes, and redeems the knowledge of God that creation already declares. The two function in organic unity: general revelation provides the cosmological context within which redemptive history unfolds, and special revelation provides the soteriological content without which the natural knowledge of God leaves sinners without excuse but without hope. In the post-fall world, special revelation is \"most necessary\" (WCF 1.1) precisely because sin has rendered the suppressed knowledge of general revelation insufficient for salvation : not because creation reveals a different God, but because the same God who reveals Himself in nature must also reveal the way of reconciliation through the blood of His Son.',k:['special revelation','redemptive','progressive','fulfillment','Christ','organic unity','general revelation','WCF 1.1','necessity','incarnation'],cl:['scripture','christ','spirit-scripture'],ct:'prolegomena'},
]},

{id:'theology-psalter',n:'The Theology of the Psalter',c:'#d4a874',r:1.15,o:15.5,
cl:['scripture','worship','christian-life','salvation','christ','holy-spirit','eschatology','lament-faithful-response'],
d:'The Psalter is not merely a collection of devotional poems but a carefully structured canonical book of theology \u2013 the church\'s divinely inspired prayer book, hymnal, and school of piety. Calvin calls the Psalms \"an anatomy of all the parts of the soul\" , recognizing that they provide the church with an authorized vocabulary for every dimension of the spiritual life: praise, lament, confession, thanksgiving, wisdom, royal hope, and eschatological longing. The Psalter\'s five-book structure (Pss 1\u201341; 42\u201372; 73\u201389; 90\u2013106; 107\u2013150) mirrors the Pentateuch and gives the collection a narrative-theological shape. Psalm 1 (the blessed man who meditates on Torah) and Psalm 2 (the anointed King whom God installs on Zion) together form the hermeneutical gateway to the entire Psalter: the righteous man and the messianic King are ultimately one \u2013 Christ, who perfectly fulfills both. The Psalms are Christ\'s own prayer book: He prayed them (Matt 27:46 = Ps 22:1; Luke 23:46 = Ps 31:5), the NT authors cite them as messianic prophecy (Acts 2:25\u201328 = Ps 16; Acts 4:25\u201326 = Ps 2; Heb 1:8\u20139 = Ps 45:6\u20137), and the church fathers argued that Christ prays the Psalms representatively as the Head of His body \u2013 sometimes in His own voice, sometimes in the voice of His members. Vos holds this Christological reading of the Psalter with precision: the Psalms witness to Christ through direct prediction (Ps 2; 110), through typological patterns (David as type of the greater David), and through the thematic trajectory of kingship, priesthood, and suffering that finds its climax in the incarnate Son. The Psalter\'s theological contributions include: the theology of creation and providence (Ps 8; 19; 33; 104; 148), the theology of the law as delight (Ps 1; 19; 119), the theology of the covenant (Ps 89; 105; 132), the theology of the temple and divine presence (Ps 24; 42\u201343; 46; 48; 84; 122), the theology of suffering and lament (Ps 22; 42\u201343; 69; 88), the theology of kingship and messianic hope (Ps 2; 45; 72; 110), and the theology of praise as the telos of creation (Ps 145\u2013150). The Reformed tradition has always placed the Psalter at the center of worship \u2013 Calvin introduced metrical psalmody in Geneva, and the singing of psalms has been a defining mark of Reformed piety.',k:['Psalter','Psalms','theology','anatomy of the soul','prayer book','five books','Ps 1','Ps 2','Christ','messianic','typology','David','kingship','lament','praise','creation','covenant','temple','law','delight','worship','Geneva','canonical','hermeneutical gateway'],ct:'piety'},
{id:'wisdom-theology',n:'Wisdom Theology & the Fear of the Lord',c:'#70a0d0',r:1.1,o:16,
cl:['prolegomena','scripture','creation','law','christ','christian-life'],
d:'The fear of the LORD is the beginning of knowledge (Prov 1:7); The fear of the LORD is the beginning of wisdom (Prov 9:10; Ps 111:10; Job 28:28). The wisdom literature of the Old Testament (Proverbs, Job, Ecclesiastes, and the wisdom psalms) constitutes a distinct but fully integrated voice within canonical theology \u2013 not mere practical advice or secular philosophy but revealed truth about the moral structure of God\'s created order and the proper posture of the creature before the Creator. Proverbs presents the fear of the LORD as the epistemological foundation of all genuine knowledge (1:7) \u2013 a claim that resonates with Van Til\'s presuppositionalism: wisdom is not discovered by autonomous reason operating independently of God but is received in covenantal submission to the self-revealing Creator. Personified Wisdom in Proverbs 8 \u2013 present with God at creation, rejoicing before Him, delighting in the children of man \u2013 is typologically and canonically connected to Christ, who is the wisdom of God (1 Cor 1:24,30; Col 2:3). Job addresses the theodicy question with unsurpassed depth: not by explaining suffering but by revealing the incomprehensible majesty and wisdom of God (Job 38\u201342), before whom the creature can only respond in humble trust (Job 42:1\u20136). Job demonstrates that the fear of the LORD is the only posture adequate to the mystery of suffering \u2013 not intellectual resolution but covenantal trust in the God whose ways are beyond finding out (Rom 11:33). Ecclesiastes presses the question of meaning under the sun and arrives at the same conclusion: Fear God and keep His commandments, for this is the whole duty of man (Eccl 12:13). The wisdom tradition contributes decisively to Reformed anthropology (the human being as creature, not autonomous), to ethics (the moral order is creational, not conventional), and to prolegomena (true knowledge begins with the fear of God, not with methodological doubt).',k:['wisdom','Proverbs','Job','Ecclesiastes','fear of the LORD','Prov 1:7','Prov 9:10','beginning of knowledge','epistemological','presuppositional','Wisdom personified','Prov 8','Christ','1 Cor 1:24','Col 2:3','theodicy','Job 38','incomprehensibility','Eccl 12:13','moral order','creational','anthropology','ethics','prolegomena','canonical theology'],ct:'prolegomena'},
{id:'prophetic-covenant-lawsuit',n:'The Prophetic Covenant Lawsuit (Rîb)',c:'#d8907c',r:1.1,o:16.5,
cl:['covenant-grace','law','sin','eschatology','covenant-theology','christ','biblical-theology'],
d:'The Old Testament prophets prosecute Israel\'s unfaithfulness through a distinctive literary and theological form: the covenant lawsuit (Hebrew rîb), in which God summons heaven and earth as witnesses, indicts His people for covenant violation, and announces the sanctions (curses) stipulated in the covenant (Deut 32:1; Isa 1:2\u20134; Mic 6:1\u20138; Hos 4:1\u20133; Jer 2:4\u201313). This form is the Old Testament\'s own mode of polemical theology \u2013 not a human prosecution but God Himself bringing charges against His covenant people through His authorized ambassadors, the prophets. The rîb pattern reveals several architectonically significant theological realities. First, it demonstrates that Israel\'s relationship with God is covenantal, not merely religious: the prophets do not appeal to general moral principles but to the specific obligations undertaken at Sinai and the specific blessings and curses stipulated in the covenant (Lev 26; Deut 28). Second, it shows that the covenant structure of Deuteronomy (preamble, historical prologue, stipulations, sanctions, succession) governs the prophetic interpretation of Israel\'s history \u2013 the prophets are covenant enforcement officers, not freelance social critics. Third, the rîb is fundamentally Christological: Christ is the ultimate Prophet who brings God\'s definitive word of judgment and mercy (Heb 1:1\u20132), and He is also the covenant Mediator who bears the covenant curses in His own body (Gal 3:13; Isa 53). Micah 6:1\u20138 is paradigmatic: God calls the mountains as witnesses, recounts His saving acts, indicts Israel\'s ingratitude, and then declares what the LORD requires \u2013 to do justice, to love mercy, and to walk humbly with your God (Mic 6:8). The rîb pattern enriches the tool\'s covenant theology locus by demonstrating the OT\'s own form of covenantal polemics.',k:['prophetic covenant lawsuit','rib','rîb','Isa 1:2','Mic 6:1','Hos 4:1','Jer 2:4','Deut 32','covenant enforcement','sanctions','curses','Sinai','Deuteronomy','Christological','Heb 1:1','Gal 3:13','justice','mercy','humility','covenant theology','polemical theology','prophets','witnesses','indictment'],ct:'soteriology'},
{id:'temple-theology',n:'Temple Theology from Eden to New Creation',c:'#60b060',r:1.15,o:17,
cl:['creation','church','eschatology','christ','worship','holy-spirit','biblical-theology','covenant-grace'],
d:'G.K. Beale has demonstrated that the temple theme constitutes one of the most architectonically significant trajectories in all of Scripture \u2013 a golden thread running from Eden to the New Jerusalem that illuminates the creation-to-consummation axis at every point. (1) EDEN AS PROTO-TEMPLE: The Garden of Eden was not merely a garden but a sanctuary \u2013 the place of God\'s special presence with man. The eastward orientation (Gen 2:8; cf. Ezek 47:1), the cherubim guardians (Gen 3:24; cf. Exod 25:18\u201320; 1 Kgs 6:23\u201328), the gold and precious stones (Gen 2:11\u201312; cf. Exod 25:7; 28:9\u201320), and Adam\'s priestly vocation to \"tend and keep\" the garden (Gen 2:15 \u2013 the same Hebrew terms \u05E2\u05B8\u05D1\u05B7\u05D3 and \u05E9\u05C1\u05B8\u05DE\u05B7\u05E8 used for Levitical temple service, Num 3:7\u20138) all identify Eden as the original temple. (2) TABERNACLE AND TEMPLE AS EDEN RECAPITULATED: The tabernacle and Solomonic temple recapitulate Eden\'s sanctuary pattern in expanded form: the Holy of Holies represents God\'s immediate presence (the garden), the Holy Place represents the broader garden-land, and the outer court represents the world. The floral decorations, lampstands (representing the tree of life), and curtain imagery (representing the boundary between God\'s special presence and the wider world) all echo Eden. (3) PROPHETIC EXPANSION: The prophets envision the temple expanding to fill the whole earth (Isa 6:3 \u2013 the whole earth is full of His glory; Hab 2:14; Ezek 47:1\u201312 \u2013 the river flowing from the temple that gives life wherever it goes; Isa 11:9; 54:2\u20133). (4) CHRIST AS THE TRUE TEMPLE: Jesus identified Himself as the temple (John 2:19\u201321), and in Him the fullness of deity dwells bodily (Col 2:9). He is the place where God and man meet \u2013 the antitype to which all previous temples pointed. (5) THE CHURCH AS TEMPLE: The church is the temple of the Holy Spirit (1 Cor 3:16; Eph 2:19\u201322; 1 Pet 2:4\u20135), built of living stones on the foundation of the apostles and prophets with Christ as the cornerstone. (6) THE NEW <i>CREATIO</i>N AS COSMIC TEMPLE: The consummation is the moment when God\'s temple presence fills the entire renewed cosmos without mediation: \"I saw no temple in the city, for its temple is the Lord God the Almighty and the Lamb\" (Rev 21:22). The temple trajectory thus embodies the creation-to-consummation axis in spatial terms: God\'s presence, originally localized in Eden, progressively expands through tabernacle, temple, incarnation, and church until it fills all things in the new creation.',k:['temple','Eden','proto-temple','Gen 2:15','sanctuary','tabernacle','Solomon','Holy of Holies','prophetic expansion','Isa 6:3','Hab 2:14','Ezek 47','Christ as temple','John 2:19','Col 2:9','church as temple','1 Cor 3:16','Eph 2:19','1 Pet 2:4','new creation','Rev 21:22','cosmic temple','creation-to-consummation','cherubim','priestly vocation','living stones','golden thread'],ct:'anthropology'},
{id:'christ-old-testament',n:'Christ in the Old Testament',c:'#d89848',r:1.2,o:17.5,
cl:['christ','scripture','covenant-grace','salvation','interpretation','temple-theology','wisdom-theology','biblical-theology','covenant-theology','eschatology'],
d:'You search the Scriptures because you think that in them you have eternal life; and it is they that bear witness about Me (John 5:39; Luke 24:27,44\u201345; 1 Pet 1:10\u201312). The Old Testament witnesses to Christ not as scattered proof-texts appended after the fact but through a rich, multidimensional, divinely designed network of witness that includes: (1) DIRECT MESSIANIC PROPHECY: specific predictions of the coming Messiah \u2013 the seed of the woman (Gen 3:15), the seed of Abraham (Gen 12:3; 22:18; Gal 3:16), the scepter from Judah (Gen 49:10), the prophet like Moses (Deut 18:15\u201318; Acts 3:22), the suffering Servant (Isa 52:13\u201353:12), the Son of David (2 Sam 7:12\u201316; Isa 9:6\u20137; 11:1\u201310), the pierced one (Zech 12:10; 13:7), and the Son of Man who receives eternal dominion (Dan 7:13\u201314). (2) TYPOLOGY: divinely intended patterns by which earlier persons, events, and institutions prefigure and anticipate their escalated fulfillment in Christ and the new covenant \u2013 Adam as type of the one who was to come (Rom 5:14), the Passover lamb (1 Cor 5:7; John 1:29), the sacrificial system (Heb 9\u201310), the priesthood of Melchizedek (Heb 7), Moses the mediator (Heb 3:1\u20136), David the king (Acts 2:25\u201336), the temple (John 2:19\u201321), the exodus (1 Cor 10:1\u201311). Beale demonstrates that typological connections operate simultaneously along Christological, ecclesiological, and consummation axes. (3) THEMATIC TRAJECTORIES: major themes that find their climactic realization in Christ \u2013 kingship, priesthood, prophecy, covenant, temple, land, exile and return, wisdom, shepherd, bridegroom. Clowney\'s hermeneutical method (\"the Triangle\") traces these trajectories from their OT origin through their theological significance to their fulfillment in Christ. (4) THE CHRISTOLOGICAL SHAPE OF THE CANON: the OT as a whole is structured toward Christ \u2013 it creates expectations, establishes patterns, and opens trajectories that only Christ can fulfill. The Law establishes the covenant framework He fulfills (Matt 5:17); the Prophets announce the salvation He accomplishes; the Writings (especially the Psalms) provide the prayer language He prays and the wisdom He embodies. This is not allegorical eisegesis but the organic extension of grammatical-historical exegesis when the canonical context and the divine Author\'s intention are taken seriously (Luke 24:27,44).',k:['Christ in the Old Testament','John 5:39','Luke 24:27','messianic prophecy','typology','Rom 5:14','Heb 9','hermeneutical triangle','thematic trajectories','kingship','priesthood','temple','covenant','Gen 3:15','Isa 53','Dan 7:13','canonical','hermeneutics','fulfillment','1 Pet 1:10','Christological','ecclesiological','consummation'],ct:'christology'},
{id:'polemic-rome',n:'Against Rome: The Reformed-Roman Controversy',ct:'polemics',c:'#cc6655',r:1.3,o:15.5,
d:'The Reformation was born in the conviction that the Church of Rome had corrupted the gospel at its most vital points. Calvin devotes enormous energy throughout all four books of the Institutes to refuting Roman doctrine, and the entire Institutes of Elenctic Theology is structured as a question-by-question engagement with Roman Catholic positions alongside Socinian and Arminian errors. Bavinck engages Rome extensively in RD volumes 3\u20134, and Calvin consistently identifies Roman positions as foils. The Reformed-Roman controversy is not peripheral but constitutive of Reformed identity: the five solas emerged precisely as corrections to Roman teaching. This polemical dimension is essential to understanding the shape and urgency of Reformed dogmatics.',
k:['Rome','Roman Catholic','papacy','polemic','Reformation','solas','Trent','controversy','elenctic'],
cl:['salvation','scripture','sacraments','church','christ','justification','means-grace'],
s:[
{id:'polemic-justification',n:'Against Rome on Justification',d:'The material principle of the Reformation. Against Rome\'s doctrine that justification is a process of infused righteousness making the sinner inherently just (Council of Trent, Session 6, 1547), the Reformed tradition teaches that justification is a single, complete, forensic act of God declaring the sinner righteous solely on the basis of Christ\'s imputed righteousness received by faith alone (Rom 3:24\u201328; 4:5\u20138; 5:1; WCF 11.1; Gal 2:16). Turretin devotes ten questions to refuting the Roman doctrine of justification, arguing that: (1) infused righteousness confuses justification with sanctification; (2) it renders justification uncertain, since inherent righteousness is always imperfect; (3) it denies the sufficiency of Christ\'s righteousness; (4) it reintroduces human merit as a ground of acceptance with God. The Reformed tradition treats this as the "main hinge on which religion turns" (3.11.1). Turretin demonstrates that Rome\'s position logically requires purgatory, indulgences, and the treasury of merit. The Canons and Decrees of Trent anathematized <i>sola fide</i> (Session 6, Canon 9) - a judgment the Reformed tradition regards as a rejection of the gospel itself.',k:['justification','infused righteousness','imputed righteousness','Trent','<i>sola fide</i>','forensic','merit','purgatory','hinge','Session 6','anathema'],cl:['justification','active-obedience','faith-repentance'],ct:'polemics'},
{id:'polemic-scripture-rome',n:'Against Rome on Scripture & Tradition',d:'The formal principle of the Reformation. Against Rome\'s doctrine that Scripture and unwritten apostolic tradition are co-equal sources of revelation, and that the Magisterium is the authoritative interpreter of both (Trent, Session 4, 1546; Vatican I, Dei Filius, 1870; Vatican II, Dei Verbum, 1965), the Reformed tradition teaches <i>sola Scriptura</i>: Scripture alone is the <i>norma normans</i>, the supreme judge of all controversies (WCF 1.10). Calvin argues that the church does not confer authority on Scripture but recognizes the authority Scripture possesses intrinsically as God\'s Word. Turretin systematically refutes the Roman doctrine of tradition, the claim of papal infallibility, and the argument that the church preceded Scripture and therefore has authority over it. Bavinck traces the historical development of Rome\'s tradition doctrine and demonstrates its incompatibility with the sufficiency and perspicuity of Scripture. The Reformed position does not reject all tradition but subordinates every tradition to the final authority of Scripture: the confessions are <i>norma normata</i> (normed norms), never <i>norma normans</i>.',k:['<i>sola Scriptura</i>','tradition','Magisterium','authority','Trent Session 4','papal infallibility','sufficiency','perspicuity','<i>norma normans</i>','church','recognition','subordinate'],cl:['authority-scripture','sufficiency','confessions-standards'],ct:'polemics'},
{id:'polemic-sacraments-rome',n:'Against Rome on Sacraments & the Mass',d:'Rome teaches seven sacraments that confer grace <i>ex opere operato</i> (by the work performed) to those who do not place an obstacle (Trent, Session 7, 1547). The Reformed tradition teaches two sacraments only (Baptism and Lord\'s Supper), effective not by the act itself but by the Spirit working through them in those who receive by faith (WCF 27.3\u20134). The Roman Mass is rejected as a propitiatory sacrifice: calls it an "unbearable blasphemy and affront to Christ" because it implies that Christ\'s once-for-all sacrifice was insufficient (Heb 7:27; 9:12,25\u201328; 10:10\u201314,18). Turretin refutes transubstantiation as philosophically absurd and biblically unfounded, and rejects the withholding of the cup from the laity. The WCF (29.2) states that "the popish sacrifice of the mass is most abominably injurious to Christ\'s one only sacrifice." Bavinck traces how Roman sacramental theology developed into a sacerdotal system that mediates between the believer and Christ, effectively replacing the Spirit\'s work with priestly power.',k:['sacraments','Mass','<i>ex opere operato</i>','transubstantiation','seven sacraments','two sacraments','sacrifice','Heb 9:12','propitiatory','cup','priesthood','WCF 29.2','sacerdotal'],cl:['baptism','lords-supper','sacrament-definition'],ct:'polemics'},
{id:'polemic-papacy',n:'Against Rome on Papal Authority & Marian Dogmas',d:'The Reformed tradition rejects the claims of papal supremacy, papal infallibility (Vatican I, Pastor Aeternus, 1870), and the doctrine that the Pope is the vicar of Christ on earth. Turretin demonstrates historically that the early church knew no papal monarchy and that the rise of papal power represents a corruption of the church\'s government. The WCF (25.6) identifies the Pope as the Antichrist. Calvin holds that Christ alone is the Head of the church (Eph 1:22; Col 1:18) and that the papal claim usurps the sole headship of Christ and the sole mediatorship of Christ (1 Tim 2:5). The Reformed tradition also rejects Marian dogmas developed by Rome: the Immaculate Conception (Pius IX, Ineffabilis Deus, 1854), the Assumption (Pius XII, Munificentissimus Deus, 1950), and the title "co-redemptrix" or "mediatrix of all graces" as having no scriptural warrant and as derogating from the sole sufficiency of Christ\'s mediation. Bavinck argues that these Marian developments represent precisely the kind of doctrinal accretion that <i>sola Scriptura</i> was formulated to prevent.',k:['papacy','papal infallibility','vicar','headship','Antichrist','WCF 25.6','Marian dogmas','Immaculate Conception','Assumption','co-redemptrix','sole mediator','1 Tim 2:5','<i>sola Scriptura</i>'],ct:'polemics'},
]},

{id:'polemic-socinian',n:'Against the Socinians: Defending Orthodoxy',ct:'polemics',c:'#cc6655',r:1.2,o:16,
d:'Socinianism (named after Faustus Socinus, 1539\u20131604) represents the most radical theological rationalism within Protestantism, denying virtually every fundamental doctrine of the Christian faith. Turretin\'s Institutes engages Socinian positions on nearly every doctrinal point, treating them as the most dangerous internal threat to Protestant orthodoxy. Bavinck engages Socinian rationalism throughout RD 2\u20134, and Calvin anticipates Socinian arguments in his treatment of the Trinity and the atonement. The Socinian challenge forced Reformed orthodoxy to articulate its commitments with greater precision and philosophical rigor, making the anti-Socinian polemic integral to the development of Reformed dogmatics.',
k:['Socinianism','Socinus','rationalism','heresy','orthodoxy','polemic','elenctic','denial','fundamental doctrines'],
cl:['trinity','christ','sin','salvation','god','scripture'],
s:[
{id:'polemic-socinian-trinity',n:'Against the Socinians on the Trinity & Deity of Christ',d:'The Socinians denied the doctrine of the Trinity entirely, teaching that God is one Person (the Father alone), that the Son is a created being exalted to divine dignity after His resurrection, and that the Holy Spirit is merely the power or influence of God - not a distinct divine Person. Turretin devotes nine questions to defending the Trinity and the deity of Christ against Socinian objections, arguing from John 1:1\u20133,14,18; Rom 9:5 (\"Christ, who is God over all, blessed forever\" — one of the most important Pauline affirmations of Christ\'s full deity); Col 1:15\u201317; Phil 2:5\u20138; Heb 1:1\u201312; and the Trinitarian baptismal formula (Matt 28:19). Calvin defends eternal generation and the full deity of the Son against those who would reduce Him to a creature. Owen shows that the denial of Christ\'s deity destroys the entire structure of salvation: if Christ is not God, His sacrifice cannot bear infinite value, His obedience cannot merit eternal life, and His intercession cannot secure perseverance. The Socinian position is the logical antecedent of modern Unitarianism, liberal Protestantism, and every Christological reduction.',k:['Trinity','deity of Christ','Socinian','Unitarianism','John 1:1','Rom 9:5','Col 1:15','Phil 2:5','eternal generation','divine Person','Holy Spirit','infinite value','liberal'],cl:['trinity','eternal-generation','spirit-deity'],ct:'polemics'},
{id:'polemic-socinian-atonement',n:'Against the Socinians on the Atonement',d:'The Socinians denied penal substitutionary atonement entirely, arguing that: (1) God can forgive sin by mere fiat without any satisfaction; (2) justice is not a necessary attribute of God but a free exercise of His will; (3) the idea of transferring guilt or punishment to an innocent party is inherently unjust; (4) Christ\'s death was merely a moral example, not a satisfaction for sin. The entire Reformed orthodox tradition responded that: (1) retributive justice is a necessary perfection of the divine nature, not an arbitrary choice (Exod 34:7; Nah 1:3; Rom 3:25\u201326); (2) the transfer of punishment is just because Christ voluntarily assumed the role of covenant surety for His people (Heb 7:22; Isa 53:4\u20136; 2 Cor 5:21); (3) the moral exemplar theory renders Christ\'s death meaningless as a saving act and evacuates the gospel of its power; (4) Scripture unequivocally teaches satisfaction: Christ bore our sins, was made a curse for us, propitiated divine wrath, and redeemed us by His blood (1 Pet 2:24; Gal 3:13; Rom 3:25; Eph 1:7). The Reformed orthodox tradition traces how the Socinian rejection of satisfaction leads inevitably to the denial of original sin, the deity of Christ, and the necessity of grace - leaving only a moralistic religion of human effort.',k:['atonement','penal substitution','satisfaction','Socinian','moral example','retributive justice','necessary attribute','surety','propitiation','2 Cor 5:21','1 Pet 2:24','Gal 3:13','original sin','moralism'],cl:['passive-obedience','definite-atonement','necessity-mediator'],ct:'polemics'},
{id:'polemic-socinian-sin',n:'Against the Socinians on Original Sin & Human Nature',d:'The Socinians denied original sin, teaching that Adam\'s fall affected only himself, that human beings are born morally neutral, and that sin consists only in voluntary acts of individual transgression. Turretin refutes this position from Rom 5:12\u201319 (in Adam all sinned), Ps 51:5 (conceived in iniquity), Eph 2:3 (by nature children of wrath), and Gen 6:5 (every intention of the heart only evil continually). Bavinck treats the Socinian denial of original sin as a denial of the entire need for redemption: if humans are not born guilty and corrupted, there is no need for a Savior, no need for regeneration, and no ground for the covenant of grace. Bavinck shows that the denial of original sin leads to Pelagianism, which was condemned at the Council of Carthage (418) and the Council of Orange (529) and which every branch of the Western church has repudiated. The Socinian anthropology is the theological root of Enlightenment optimism about human nature and of every theology that locates salvation in human moral effort rather than sovereign divine grace.',k:['original sin','Socinian','Pelagianism','Adam','Rom 5:12','Ps 51:5','Eph 2:3','corruption','guilt','imputation','neutral','voluntary','Enlightenment','moral effort','regeneration'],cl:['original-sin','total-depravity','federal-headship'],ct:'polemics'},
]},

{id:'polemic-arminian',n:'Against the Arminians: The Five Points & the Canons of Dort',ct:'polemics',c:'#cc6655',r:1.35,o:16.5,
d:'The Arminian Remonstrance (1610) challenged the Reformed consensus on predestination, the extent of the atonement, the nature of grace, and the perseverance of the saints. The Synod of Dort (1618\u20131619) responded with the Canons of Dort, which have become definitive for the Reformed tradition\'s articulation of the doctrines of grace. Calvin\'s entire soteriology stands against Arminianism avant la lettre; The Reformed elenctic tradition engages the Arminians (termed "Remonstrants") extensively; Bavinck addresses Arminian positions in RD volumes 2\u20134; and Berkhof consistently identifies Arminian alternatives in each soteriological section. The five points (often summarized as TULIP) are not independent doctrines but an organic system: each entails the others, and the denial of any one point logically undermines the rest.',
k:['Arminianism','Remonstrance','Dort','TULIP','five points','Calvinism','sovereignty','grace','election','atonement','perseverance','Canons','Synod','Remonstrants'],
cl:['decree','christ','salvation','sin','holy-spirit','covenant-grace','election','definite-atonement','perseverance'],
s:[
{id:'polemic-total-depravity',n:'Against Arminianism: Total Depravity vs. Partial Depravity',d:'The Arminians taught that the fall left humanity weakened but not wholly unable, and that prevenient grace (a universal, non-irresistible grace) restores sufficient ability for the sinner to cooperate with God in conversion. Against this, the Canons of Dort (III/IV.1\u20135) affirm total depravity: all people are conceived in sin, by nature children of wrath, incapable of any saving good, inclined to all evil, and dead in trespasses (Eph 2:1\u20133; Rom 8:7\u20138; John 6:44; WCF 6.2\u20134; 9.3). Turretin argues that the Arminian concept of prevenient grace is a sophistical device that formally affirms grace while effectively restoring synergism - the sinner\'s act of will becomes the decisive factor in salvation. The Reformed tradition shows that Arminian anthropology cannot account for the biblical testimony to spiritual death (Eph 2:1,5), the inability of the natural man (1 Cor 2:14), or the necessity of new birth as a sovereign divine act (John 3:3\u20138). The Arminian position is functionally semi-Pelagian: it makes human will the ultimate differentiating factor between the saved and the lost.',k:['total depravity','partial depravity','prevenient grace','synergism','Arminian','Dort III/IV','dead in sin','inability','semi-Pelagian','Eph 2:1','1 Cor 2:14','John 3:3','WCF 9.3'],cl:['total-depravity','will-sin','calling-regen'],ct:'polemics'},
{id:'polemic-unconditional-election',n:'Against Arminianism: Unconditional vs. Conditional Election',d:'The Arminians (Article I of the Remonstrance, 1610) taught that God\'s election is conditioned upon foreseen faith - God looked ahead in time, saw who would believe, and elected them on that basis. Against this, the Canons of Dort (I.7\u20139) affirm unconditional election: God chose His people in Christ before the foundation of the world not on the basis of foreseen faith, merit, or any condition in the creature, but solely according to the good pleasure of His will (Eph 1:4\u20136; Rom 9:11\u201316; 2 Tim 1:9; WCF 3.5). Turretin demonstrates that election conditioned on foreseen faith is logically incoherent: if faith itself is a gift of God (Eph 2:8; Phil 1:29; Acts 13:48), then foreseen faith is simply foreseen gift, and election remains unconditional. Bavinck argues that conditional election makes God dependent on the creature\'s decision, overthrows the gratuity of grace, and gives sinners ground for boasting. The Reformed tradition traces the Arminian position to its roots in Pelagian and semi-Pelagian anthropology and demonstrates that it inverts the biblical order: Scripture teaches that we love because He first loved us (1 John 4:19), that we are chosen to be holy (Eph 1:4), not because we would be holy.',k:['unconditional election','conditional election','foreseen faith','Arminian','Dort I','Remonstrance','Eph 1:4','Rom 9:11','2 Tim 1:9','faith as gift','good pleasure','sovereign','gratuity'],cl:['election','reprobation'],ct:'polemics'},
{id:'polemic-definite-atonement',n:'Against Arminianism: Definite vs. Universal Atonement',d:'The Arminians (Article II of the Remonstrance) taught that Christ died for each and every person without exception, making salvation possible for all but certain for none - its efficacy dependent on the individual\'s act of faith. Against this, the Canons of Dort (II.8) affirm that Christ\'s death was intended by the Father and accomplished by the Son to effectually redeem all those given to Him in the eternal covenant (John 6:37\u201339; 10:11,15,26; 17:9; Eph 5:25; WCF 3.6; 8.5; 8.8). The atonement is sufficient for all (its infinite value could save every person) but efficient for the elect alone (it was designed and applied to secure their salvation with certainty). Owen argues that universal atonement, combined with the Arminian denial of irresistible grace, results in a hypothetical salvation that saves no one with certainty - the cross becomes merely a platform of possibility, not an accomplishment of redemption. Calvin consistently teaches that Christ laid down His life for His sheep (John 10:15), purchased His church with His own blood (Acts 20:28), and gave Himself for her (Eph 5:25). Turretin demonstrates that the Arminian position fragments the Trinity: the Father elects universally, the Son dies universally, but the Spirit applies only to some - an incoherent economy in which the Trinitarian Persons work at cross-purposes.',k:['definite atonement','universal atonement','particular redemption','sufficient efficient','Dort II','John 10:15','Eph 5:25','Acts 20:28','Trinitarian coherence','design','certainty','accomplishment','hypothetical'],cl:['definite-atonement','passive-obedience'],ct:'polemics'},
{id:'polemic-irresistible-grace',n:'Against Arminianism: Irresistible vs. Resistible Grace',d:'The Arminians (Articles III\u2013IV of the Remonstrance) taught that the grace of the Spirit in calling and regeneration can be resisted and rendered ineffectual by the human will - God does His part, but the decisive factor is the sinner\'s free consent. Against this, the Canons of Dort (III/IV.11\u201312) affirm that the Spirit\'s work in regeneration is irresistible (efficacious, invincible): God sovereignly, powerfully, and infallibly renews the will, enlightens the mind, and opens the heart so that the elect certainly and freely come to Christ (John 6:37,44,65; Acts 16:14; Ezek 36:26\u201327; Phil 2:13; WCF 10.1\u20132). Turretin distinguishes between external calling (which may be resisted, Matt 23:37; Acts 7:51) and internal effectual calling (which infallibly produces faith and repentance). The Arminian confusion of these two callings is a fundamental category error. Bavinck insists that the Spirit does not merely assist the will but creates a new will: the dead are raised, the blind see, the stone heart becomes flesh (Eph 2:5; 2 Cor 4:6; Ezek 36:26). Owen argues that resistible grace cannot account for the regeneration of the spiritually dead - you cannot assist the dead, you must raise them.',k:['irresistible grace','resistible grace','effectual calling','Arminian','Dort III/IV','John 6:37','Ezek 36:26','Phil 2:13','WCF 10.1','external calling','internal calling','regeneration','sovereign','dead raised','monergism','synergism'],cl:['calling-regen','spirit-regeneration','will-grace'],ct:'polemics'},
{id:'polemic-perseverance-dort',n:'Against Arminianism: Perseverance vs. Falling Away',d:'The Arminians (Article V of the Remonstrance) taught that true believers can totally and finally fall from grace and be eternally lost - a position that logically follows from conditional election, universal atonement, and resistible grace. Against this, the Canons of Dort (V.3\u20138) affirm that God preserves His elect so that they cannot totally or finally fall from the state of grace but shall certainly persevere to the end (John 10:28\u201329; Rom 8:28\u201339; Phil 1:6; 1 Pet 1:5; WCF 17.1\u20132). The grounds of perseverance are: the immutability of the decree of election, the abiding merit of Christ\'s satisfaction, the continual intercession of Christ, the indwelling of the Spirit, and the nature of the covenant of grace (WCF 17.2). Turretin demonstrates that if a true believer can fall away, then election is mutable (contradicting Rom 11:29), Christ\'s intercession is ineffectual (contradicting Heb 7:25), the Spirit\'s sealing is reversible (contradicting Eph 4:30), and the covenant of grace can fail (contradicting Jer 32:40). The Reformed tradition grounds perseverance in the unchangeable will of God and the efficacy of Christ\'s death. Bavinck argues that the denial of perseverance destroys all assurance, evacuates the comfort of the gospel, and reduces the Christian life to perpetual uncertainty. Berkhof\'s systematic theology systematically refutes the Arminian proof-texts and demonstrates that the warning passages (Heb 6; 10) do not teach that the regenerate can lose salvation but function as means by which God preserves the elect in faith.',k:['perseverance','falling away','Arminian','Dort V','John 10:28','Rom 8:28','Phil 1:6','1 Pet 1:5','WCF 17','immutability','intercession','sealing','covenant','assurance','certainty','warning passages','Heb 6'],cl:['perseverance','assurance','election'],ct:'polemics'},
]},

{id:'christian-life',n:'The Christian Life: Piety, Prayer & Devotion',ct:'piety',c:'#d4a874',r:1.4,o:15,
d:'Reformed theology is not merely a system of propositions to be believed but a life to be lived before the face of God (<i>coram Deo</i>). Calvin opens the Institutes declaring that true wisdom consists in the knowledge of God and the knowledge of ourselves (1.1.1), and this knowledge is not speculative but transformative \u2013 it produces piety (pietas), which The Reformed tradition holds as "that reverence joined with love of God which the knowledge of His benefits induces" . The Westminster Standards embed piety throughout: the Shorter Catechism opens with the chief end of man (glorifying God and enjoying Him forever, WSC Q1), and the Larger Catechism devotes extensive treatment to prayer, the means of grace, and the duties of the Christian life. Bavinck holds that dogmatics must serve the church\'s worship and the believer\'s devotion: theology that does not lead to doxology has lost its way . Sinclair Ferguson and Joel Beeke demonstrate that Reformed orthodoxy, far from being cold intellectualism, produces the warmest piety because it grounds every comfort in the sovereign grace of God. Vos holds that the piety of the believer is not a separate compartment from doctrinal knowledge but its proper fruit: biblical theology is itself \\\"a labor of worship,\\\" and the believer who rightly understands the redemptive-historical unfolding of God\'s purpose cannot help but respond in adoration, because every doctrine is a facet of Christ\'s person and work, not an abstract proposition to be merely catalogued. The Christian life encompasses prayer (private, family, and corporate), meditation on Scripture, Sabbath observance, the singing of God\'s praise, participation in the sacraments, the practice of self-examination, the mortification of sin, the cultivation of the graces, and the pursuit of holiness in all of life\'s callings.',
k:['Christian life','piety','pietas','<i>coram Deo</i>','WSC Q1','prayer','devotion','doxology','means of grace','holiness','self-examination','mortification','graces','callings','labor of worship','Christological piety'],
cl:['worship','means-grace','salvation','good-works','law','chief-end','piety-knowledge','sanctification','holy-spirit','church','prayer-theology'],
s:[
{id:'chief-end',n:'The Chief End of Man (WSC Q1)',d:'Man\'s chief end is to glorify God and to enjoy Him forever (WSC Q1). This opening question of the Shorter Catechism is not merely introductory but architectonic: it establishes that the entire system of doctrine exists to bring creatures into the right relationship with God \u2013 one of reverent adoration (glorifying) and deep personal delight (enjoying). Glorifying and enjoying are not two separate ends but one integrated telos: we glorify God precisely in enjoying Him, and we enjoy God most fully when we glorify Him most wholeheartedly. Jonathan Edwards has developed this with great depth: God is most glorified in us when we are most satisfied in Him. The catechetical genius of this question is its simplicity and profundity: it can be taught to the youngest child and will occupy the deepest theologian for eternity. It connects directly to the beatific vision (the eternal enjoyment of God), to the doctrine of God (He is the <i>summum bonum</i>, the highest good), to soteriology (salvation\'s goal is not merely escape from punishment but restoration to fellowship with God), and to eschatology (the consummation is the fullness of this enjoyment). Bavinck begins his treatment of the last things with glory as the final aim. Bavinck\'s entire theological project is oriented by this conviction: we exist for God, not God for us.',k:['chief end','WSC Q1','glorify','enjoy','<i>summum bonum</i>','telos','catechesis','beatific vision','doxology','worship','delight'],cl:['divine-blessedness','glorification','worship'],ct:'piety'},
{id:'piety-knowledge',n:'Piety & the Knowledge of God',d:'For the Reformed tradition, piety (pietas) is the proper posture of the creature before the Creator: "I call \'piety\' that reverence joined with love of God which the knowledge of His benefits induces" . True theology produces piety, and true piety requires theology. Against both dead orthodoxy (which knows doctrine but lacks devotion) and enthusiastic pietism (which cultivates feelings without doctrinal substance), Calvin holds that sound doctrine and warm piety are inseparable. Knowledge of God is not an end in itself but the means to worship, trust, and obedience. The Reformed tradition holds that dogmatics is a "spiritual science" that can only be practiced rightly by those who know God personally through faith . The Puritans exemplified this integration supremely: Owen\'s and other Puritan theological treatises conclude with pastoral application; Bunyan\'s allegories are theological education in devotional form; the Westminster Directory for Public Worship structures corporate piety around the Word. The Reformed tradition holds that the grand purpose of Christian doctrine is not speculation but life 2013 a conviction expressed across its dogmatic literature from the Puritans to the Princeton theologians. The theologian who does not pray cannot rightly theologize, and the Christian who does not study cannot rightly pray.',k:['piety','pietas','knowledge of God','dead orthodoxy','pietism','Puritans','Bunyan','devotion','prayer','worship','spiritual science','doctrine and life'],ct:'piety'},
{id:'prayer-theology',n:'The Theology & Practice of Prayer',d:'Prayer is the chief exercise of faith and a divinely appointed means through which God bestows His blessings (WCF 21.3\u20134; Jas 5:16; 1 John 5:14\u201315). Calvin devotes the longest chapter of the Institutes (3.20) to prayer, treating it as the practical outworking of the entire doctrine of God\'s sovereignty and grace: because God is sovereign, prayer is effectual; because He is gracious, prayer is invited; because He is faithful, prayer is answered. Prayer is Trinitarian: offered to the Father, in the name of the Son (our Mediator and Advocate, John 16:23\u201324; 1 Tim 2:5; Heb 7:25), by the help of the Holy Spirit who intercedes for us with groanings too deep for words (Rom 8:26\u201327). The WCF (21.3\u20134) requires prayer to be offered with understanding, reverence, humility, fervency, faith, love, and perseverance, confessing sins, giving thanks, and making supplication for all things agreeable to God\'s will. The Lord\'s Prayer is the special rule of direction (WLC Q186\u2013196; WSC Q99\u2013107). Private prayer (Matt 6:6), family worship (Deut 6:6\u20137; Josh 24:15), and corporate prayer in the assembly (Acts 2:42; 1 Tim 2:1\u20134) are all required. The Puritans produced an extraordinary literature on prayer: Bunyan\'s I Will Pray with the Spirit, Henry\'s A Method for Prayer, and the rich tradition of collected prayers in the Reformed liturgical heritage. Prayer is not a technique but communion \u2013 the believing soul speaking with the living God.',k:['prayer','Reformed piety','chief exercise','faith','sovereignty','Trinitarian','Father','Son','Spirit','Rom 8:26','WCF 21.3','Lord\'s Prayer','WLC Q186','private','family','corporate','Puritans','Bunyan','Henry','communion','means of grace','intercession','perseverance'],cl:['spirit-prayer','intercession-christ','trinitarian-prayer','adoption','means-grace'],ct:'piety'},
{id:'family-worship',n:'Family Worship & Household Piety',d:'The Reformed tradition places extraordinary emphasis on the household as a sphere of covenant nurture and worship. The Directory for Family Worship (adopted by the Church of Scotland, 1647) requires heads of families to lead daily worship including the reading and exposition of Scripture, prayer, and the singing of psalms. This is grounded in the covenant promise to believers and their children (Gen 17:7; Acts 2:39; WCF 28.4) and the direct commands of Scripture: "You shall teach them diligently to your children, and shall talk of them when you sit in your house, and when you walk by the way" (Deut 6:7; Eph 6:4). The family is a little church (ecclesiola) in which parents are the first pastors of their children\'s souls. Catechetical instruction belongs centrally to the household: the Shorter and Larger Catechisms were designed to be memorized and discussed in family settings. The Puritans cultivated this vision with extraordinary intentionality: Cotton Mather, Richard Baxter (The Reformed Pastor), and Matthew Henry all wrote on household piety. Family worship typically includes: the reading of a portion of Scripture with brief exposition, prayer (including prayers by all family members as ability allows), and singing. It is not a burden but a privilege \u2013 the means by which God transmits faith across generations and forms the habits of piety in the young.',k:['family worship','household','Directory for Family Worship','Deut 6:7','Eph 6:4','covenant children','catechism','ecclesiola','Puritans','Baxter','Henry','Mather','singing','prayer','Scripture reading','generations','covenant nurture','Acts 2:39'],cl:['covenant-grace','baptism','catechetical-instruction'],ct:'piety'},
{id:'catechetical-instruction',n:'Catechetical Instruction',d:'The Reformed tradition has always regarded the catechetical instruction of the young and of new believers as one of the church\'s most essential duties. The Westminster Shorter Catechism (107 questions) was designed for children and the less advanced; the Larger Catechism (196 questions) for those more proficient; and the Heidelberg Catechism (129 questions) was arranged for weekly preaching through its 52 Lord\'s Days. Calvin himself composed a catechism for the church in Geneva (1542) and insisted that catechesis is not optional but necessary for the formation of a godly church. The structure of catechetical instruction \u2013 question and answer, memorization, and regular review \u2013 forms the mind, shapes the affections, and creates a common theological vocabulary among God\'s people. G.I. Williamson\'s commentary on the Westminster Confession, Geerhardus Vos\'s Grace and Glory, and Thomas Vincent\'s The Shorter Catechism Explained and Proved from Scripture are examples of the tradition\'s investment in accessible theological education. Catechesis bridges systematic theology and pastoral care: it takes the great doctrines of the faith and places them on the lips and in the hearts of ordinary believers \u2013 children, new converts, and lifelong Christians alike. The recovery of catechetical practice is among the most urgent needs of the contemporary Reformed church.',k:['catechesis','catechism','Westminster Shorter','Westminster Larger','Heidelberg','question and answer','memorization','instruction','Vincent','formation','accessible','children','affections','vocabulary','pastoral care'],cl:['confessions-standards','church','scripture'],ct:'piety'},
{id:'meditation-scripture',n:'Meditation on Scripture & Spiritual Disciplines',d:'Blessed is the man whose delight is in the law of the LORD, and on His law he meditates day and night (Ps 1:2; Josh 1:8; Ps 119:97,148). Reformed meditation is not the emptying of the mind (as in Eastern religions) or the use of the imagination to manufacture spiritual experiences (as in some Ignatian traditions) but the active, deliberate, prayerful reflection on the truths of Scripture with the aim of understanding them, applying them to the heart, and responding in faith, repentance, praise, and obedience. The Puritans developed meditation as a spiritual discipline with great sophistication: Edmund Calamy, Thomas Watson, and especially Thomas Manton wrote extensively on the art of meditation. Watson ("The Christian\'s Daily Walk") defined meditation as "a holy exercise of the mind whereby we bring the truths of God to remembrance and do seriously ponder upon them and apply them to ourselves." The Westminster Directory for Public Worship commends private meditation alongside reading, prayer, and self-examination. Meditation connects the Word read and preached to the heart and life \u2013 it is the bridge between doctrine and devotion, between the objective truth of Scripture and the subjective experience of the believer. Calvin treats meditation on the future life, the bearing of the cross, and the right use of the present life as practical exercises flowing from justification and sanctification.',k:['meditation','Ps 1:2','Ps 119','Josh 1:8','Puritans','Watson','Manton','Calamy','reflection','application','heart','spiritual disciplines','self-examination','devotion','doctrine','Word','cross','future life'],ct:'piety'},
{id:'singing-praise',n:'The Singing of God\'s Praise',d:'Speaking to one another in psalms and hymns and spiritual songs, singing and making melody to the Lord with your heart (Eph 5:19; Col 3:16; Ps 95:1\u20132; 100:1\u20132). The singing of God\'s praise is a divinely appointed element of worship (WCF 21.5) and an essential means of grace that edifies the church and glorifies God. The Reformed tradition has a rich heritage of congregational singing rooted in the Reformation\'s recovery of corporate worship in the vernacular. Calvin introduced metrical psalmody in Geneva, and the singing of psalms became a defining mark of Reformed worship. The question of exclusive psalmody (singing only the inspired Psalter in worship) versus the inclusion of hymns and other songs has been a significant intra-Reformed debate. Exclusive psalmody advocates (the Scottish Covenanters, the RPCNA, and many in the Free Church tradition) argue that since only God can appoint the content of worship (RPW), and since He has provided an inspired songbook, human compositions should not be substituted. Others in the Reformed tradition (including the OPC and PCA) permit hymns that are faithful to Scripture alongside the Psalms. Both sides agree that the Psalter is the church\'s primary songbook and that worship singing must be doctrinally rich, God-centered, and congregationally accessible. The pastoral importance of singing cannot be overstated: Luther recognized that the devil fears a singing church, and the Reformed tradition has always recognized that what the church sings, the church believes \u2013 the hymnal is a catechism set to music.',k:['singing','psalms','hymns','Eph 5:19','Col 3:16','worship','metrical psalmody','exclusive psalmody','RPW','WCF 21.5','Covenanters','congregational','catechism','praise','edification','means of grace','vernacular'],ct:'piety'},
{id:'theology-suffering',n:'The Theology of Suffering & Affliction',d:'For it has been granted to you that for the sake of Christ you should not only believe in Him but also suffer for His sake (Phil 1:29; Rom 8:17\u201318; 2 Cor 4:7\u201318; 1 Pet 4:12\u201319). Reformed theology does not treat suffering as an anomaly in the Christian life but as a normative, divinely appointed means of sanctification and conformity to Christ. The Westminster Confession addresses this under providence: God \"most wisely and powerfully boundeth, and otherwise ordereth and governeth\" even afflictions for His people\'s good (WCF 5.5), and His fatherly chastisement is distinguished from judicial punishment \u2013 believers suffer not under the wrath of a Judge but under the discipline of a Father (Heb 12:5\u201311; WCF 11.5). Murray holds that sanctification involves genuine mortification that is experientially painful \u2013 not merely intellectual adjustment but the crucifixion of the old man, which includes suffering, loss, and the bearing of the cross (Rom 8:13; Gal 5:24; Col 3:5). Calvin devotes Institutes 3.8 entirely to \"Bearing the Cross\" as a dimension of the Christian life, arguing that affliction strips away self-sufficiency, teaches dependence on God, tests the genuineness of faith, and conforms the believer to the image of Christ who Himself learned obedience through what He suffered (Heb 5:8). Owen treats suffering as a primary instrument of mortification. Rutherford\'s Letters, written from imprisonment and exile, exemplify the pastoral theology of suffering at its finest: \"Grace grows best in winter.\" The eschatological framework is essential: present sufferings are not worth comparing with the glory that is to be revealed (Rom 8:18), and affliction is producing an eternal weight of glory beyond all comparison (2 Cor 4:17). Suffering in the already/not-yet is the necessary consequence of living at the overlap of the ages \u2013 the decisive victory has been won, but the consummation has not yet arrived (Rom 8:22\u201325). Duguid\'s treatment of flawed Old Testament saints demonstrates that God\'s purposes are often accomplished precisely through human weakness, failure, and suffering \u2013 not despite them.',k:['suffering','affliction','Rom 8:17','2 Cor 4:7','1 Pet 4:12','Phil 1:29','WCF 5.5','fatherly chastisement','Heb 12:5','mortification','bearing the cross','Rutherford','already not yet','eschatological','Rom 8:18','2 Cor 4:17','Duguid','weakness','sanctification','conformity to Christ'],cl:['providence','perseverance','sanctification','lament-faithful-response'],ct:'piety'},
{id:'spiritual-desertion',n:'Spiritual Desertion & the Dark Night',d:'True believers may have the assurance of their salvation divers ways shaken, diminished, and intermitted, as by negligence in preserving of it, by falling into some special sin which woundeth the conscience, by some sudden or vehement temptation, by God\'s withdrawing the light of His countenance, and suffering even such as fear Him to walk in darkness and to have no light (WCF 18.4; Ps 22:1\u20132; Ps 88; Isa 50:10; Song 3:1\u20134; 5:6). The experience of spiritual desertion \u2013 what the Puritans called the \"hidings of God\'s face\" and the mystical tradition the \"dark night of the soul\" \u2013 is a theologically normative experience addressed extensively in the Reformed pastoral tradition. The Puritan tradition addresses this with particular pastoral sensitivity: the believer who experiences the withdrawal of felt assurance is not necessarily in sin but may be undergoing a divinely appointed trial designed to deepen faith, expose idolatrous attachments to spiritual feelings rather than to Christ Himself, and produce a purer trust that rests on the objective promises of God rather than on subjective experience. The Puritan tradition argues that God sometimes withdraws sensible consolation precisely to teach the soul to distinguish between Christ and the comforts of Christ \u2013 to love the Giver above His gifts. Owen discusses spiritual desertion in his works on communion with God and the mortification of sin, treating it as a fatherly discipline that humbles the soul and increases longing for God. Psalm 88 is theologically significant as the only psalm that ends without resolution \u2013 the inspired canon itself contains a prayer of unrelieved darkness, indicating that such experience is not spiritually deficient but part of the normative range of covenant life. The remedy for spiritual desertion is not introspective analysis of feelings but the objective means of grace: the Word, the sacraments, prayer, and the communion of saints (WCF 18.4; Isa 50:10 \u2013 \"let him trust in the name of the LORD and rely on his God\"). The eschatological framework provides ultimate comfort: the present darkness is temporary, and the light of God\'s countenance will shine fully and eternally in the consummation (Rev 21:23; 22:5; 1 Cor 13:12).',k:['spiritual desertion','dark night','WCF 18.4','Ps 22','Ps 88','Isa 50:10','hidings','God withdrawing','communion','assurance','objective means','trial','fatherly discipline','feelings','Christ above comforts','Puritans','pastoral','Song 5:6'],cl:['assurance','perseverance','spirit-indwelling','providence'],ct:'piety'},
{id:'lament-faithful-response',n:'Lament as Faithful Response',d:'My God, my God, why have you forsaken me? (Ps 22:1; Matt 27:46). The Psalms of lament \u2013 which constitute roughly one-third of the Psalter \u2013 are not expressions of spiritual failure or faithlessness but are the divinely inspired and normative vocabulary for the believer\'s address to God in suffering, confusion, and grief (Ps 3; 6; 13; 22; 42\u201343; 44; 69; 74; 79; 80; 88; 102; 137). Lament is theologically significant for several reasons. First, it is faith speaking: the lamenting psalmist brings his complaint to God precisely because he trusts that God is sovereign, that He hears prayer, and that He is able to deliver (Ps 13:5\u20136; 22:3\u20135; 42:5). Lament presupposes the covenant relationship \u2013 only one who knows God as covenant Lord can cry \"How long, O LORD?\" (Ps 13:1). Second, lament is honest speech: the Reformed tradition, unlike some forms of pietism, does not require artificial cheerfulness in the face of suffering. The Psalms model a piety that brings the whole range of human experience \u2013 including anger, confusion, grief, and felt abandonment \u2013 into the presence of God rather than suppressing it. Third, lament is Christological: Jesus Himself prayed Psalm 22 from the cross (Matt 27:46), making the church\'s lament a participation in the sufferings of Christ (Col 1:24; Phil 3:10). The Psalter functions as Christ\'s own prayer book \u2013 He prays the Psalms representatively as the Head of His body (the church fathers). Calvin calls the Psalms \"an anatomy of all the parts of the soul\" and used them as the primary hymnal of Geneva precisely because they give the church a divinely authorized vocabulary for every spiritual condition, including darkness and desolation. A piety that lacks the vocabulary of lament is a truncated piety \u2013 it cannot address the full range of human experience under the cross, and it implicitly suggests that suffering believers have no authorized way to bring their pain to God. The eschatological framework transforms lament: it is penultimate, not ultimate. The Psalms of lament characteristically move from complaint to confidence (Ps 22:22\u201331), anticipating the eschatological reversal when God will wipe away every tear (Rev 21:4).',k:['lament','Psalms','Ps 22','Ps 88','Ps 13','Ps 42','faithful response','covenant','honest speech','Christological','Matt 27:46','anatomy of the soul','suffering','grief','anger','piety','vocabulary','normative','eschatological','Rev 21:4','one-third of Psalter','prayer book','cross'],cl:['theology-psalter','theology-suffering','prayer-theology'],ct:'piety'},
]},
{id:'polemic-modern',n:'Against Modern Errors: From the Enlightenment to the Present',ct:'polemics',c:'#cc6655',r:1.25,o:17,
d:'The post-Reformation period has seen the rise of theological movements that, while often using the vocabulary of Christianity, fundamentally subvert its substance. The Reformed tradition has always been elenctic (polemical) as well as didactic: Turretin structured his entire Institutes around the refutation of errors, and this engagement with falsehood is essential to the defense of truth. Charles Hodge engaged the pantheism and idealism of his era; Warfield and Bavinck defended the faith against the rising tide of Enlightenment criticism and liberal theology; Bavinck interacted extensively with Kant, Schleiermacher, and Ritschl; Machen drew the definitive line between Christianity and liberalism. The tradition did not stop fighting there: the New Perspective on Paul, progressive Christianity, the social gospel, Darwinian naturalism, and Kantian moralism all represent ongoing challenges that require confessional engagement. The modern errors share a common root: the elevation of autonomous human reason, experience, or culture over the self-attesting authority of God\'s Word. Whether in the form of 18th-century rationalism, 19th-century liberalism, 20th-century neo-orthodoxy, or 21st-century progressivism, the fundamental issue remains the same: will the creature submit to the Creator\'s self-revelation, or will the creature sit in judgment upon it? The Reformed tradition is a living, ongoing conversation \u2013 each generation must take up the elenctic task afresh against the errors of its own day.',
k:['modern errors','liberalism','naturalism','neo-orthodoxy','Enlightenment','elenctic','autonomous reason','rationalism','secularism','authority','Word of God','progressive Christianity','New Perspective','Kantian','Darwinian','social gospel'],
cl:['scripture','prolegomena','god','christ','salvation'],
s:[
{id:'polemic-liberalism',n:'Against Enlightenment Liberalism',d:'Classical theological liberalism, emerging from the Enlightenment through Schleiermacher, Ritschl, Harnack, and the broader trajectory of 19th-century Protestant thought, represents the most comprehensive assault on historic Christianity from within the church. Schleiermacher redefined theology as reflection on the feeling of absolute dependence, relocating the source of theology from divine revelation to human religious experience. Ritschl reduced Christianity to moral values and the Kingdom of God to an ethical program. Harnack\'s What is Christianity? (1900) distilled the gospel to the fatherhood of God, the brotherhood of man, and the infinite value of the human soul \u2013 stripping away everything distinctly Christian. Against this, the Reformed tradition has responded with devastating force. Machen argued that liberalism is not a variant of Christianity but a different religion entirely, one that denies the authority of Scripture, the deity of Christ, the substitutionary atonement, the supernatural, and the reality of sin. Warfield\'s critical reviews demolished the philosophical foundations of liberalism with surgical precision. Bavinck engages Schleiermacher and Ritschl at length, arguing that any theology built on religious experience rather than divine revelation collapses into subjectivism. Warfield\'s Popular Lectures addressed the apologetic challenge of his generation. Van Til later demonstrated that liberalism\'s epistemological foundation \u2013 autonomous human reason \u2013 cannot account for the preconditions of intelligibility and is ultimately self-defeating.',k:['liberalism','Schleiermacher','Ritschl','Harnack','Enlightenment','religious experience','subjectivism','autonomous reason','authority','deity of Christ','atonement','supernatural','different religion'],ct:'polemics'},
{id:'polemic-higher-criticism',n:'Against Higher Criticism',d:'The rise of historical-critical methodology in the 18th and 19th centuries \u2013 associated with Astruc, Eichhorn, Wellhausen (the Documentary Hypothesis / JEDP), and later Gunkel (form criticism), Bultmann (demythologization), and the tradition critics \u2013 challenged the Mosaic authorship of the Pentateuch, the unity and historicity of Isaiah, the early dating of Daniel, and the reliability of the Gospels as historical testimony. The Reformed response has been vigorous and multi-faceted. Warfield\'s essays on inspiration and criticism (collected in Revelation and Inspiration and The Inspiration and Authority of the Bible) provided the classic defense of biblical inerrancy against the critical consensus. Green (William Henry) at Princeton answered Wellhausen point by point. The Reformed orthodox tradition engages the critical methods at length, arguing that they rest on naturalistic presuppositions incompatible with a doctrine of divine inspiration. The fundamental error of higher criticism is methodological: it approaches Scripture as a merely human document, applying to it the same critical tools used for any ancient text, while denying a priori the possibility of supernatural revelation, predictive prophecy, and divine authorship. Van Til identifies this as the consistent outworking of autonomy: the human critic sets himself above the Word and determines what God may or may not have said. The Reformed response does not reject literary and historical analysis per se but insists that such analysis must operate within the framework of faith in Scripture\'s divine origin and authority (WCF 1.4\u20135).',k:['higher criticism','Wellhausen','JEDP','Documentary Hypothesis','form criticism','Bultmann','demythologization','Green','inerrancy','Mosaic authorship','naturalism','presuppositions','inspiration','Princeton','WCF 1.4','divine authorship','autonomy'],cl:['inerrancy','inspiration','authority-scripture'],ct:'polemics'},
{id:'polemic-naturalism',n:'Against Naturalism & Secularism',d:'Philosophical naturalism \u2013 the worldview that nature is all there is, that there is no supernatural reality, no God, no soul, and no transcendent moral order \u2013 is the dominant intellectual framework of the modern West. It manifests in scientific materialism (Dawkins, Dennett, Harris), secular humanism, and the practical atheism of contemporary culture. Against naturalism, the Reformed tradition offers a comprehensive antithesis. Van Til demonstrates that naturalism is parasitic on the Christian worldview: it relies on the intelligibility of the universe, the reliability of human reason, and the objectivity of moral norms \u2013 none of which can be accounted for on naturalistic presuppositions. The transcendental argument (TAG) demonstrates that the preconditions of logic, science, and morality presuppose the triune God of Scripture. Bavinck shows that naturalism cannot explain the origin of the cosmos, the existence of consciousness, the reality of moral obligation, or the universal religious impulse (<i>sensus divinitatis</i>, Rom 1:19\u201321). Kuyper\'s engagement with modernism was cultural as well as philosophical: he argued that secularism is not a neutral stance but an alternative faith commitment with its own dogmas, rituals, and teleology. The WCF (21.1) grounds worship in the knowledge of God available through nature and Scripture, implicitly rejecting the naturalistic denial of divine reality. The pastoral challenge of naturalism lies in its pervasive cultural influence: believers must be equipped to recognize and resist the practical materialism that shapes education, media, and public discourse.',k:['naturalism','secularism','materialism','atheism','TAG','transcendental argument','<i>sensus divinitatis</i>','Rom 1:19','presuppositions','consciousness','moral obligation','antithesis','intelligibility','Dawkins','practical atheism','culture','education'],ct:'polemics'},
{id:'polemic-neoorthodoxy',n:'Against Neo-Orthodoxy ',d:'Karl Barth\'s neo-orthodox theology (also called dialectical or crisis theology) emerged as a reaction against 19th-century liberalism, and in many respects it recovered themes \u2013 the sovereignty of God, the centrality of Christ, the sinfulness of man, the priority of revelation \u2013 that liberalism had abandoned. For this reason, some have mistakenly regarded Barth as a friend of Reformed orthodoxy. The Reformed tradition, however, has identified fundamental departures. Van Til provides the most thorough Reformed critique: (1) Barth\'s doctrine of revelation denies propositional revelation and the identity of Scripture with the Word of God \u2013 for Barth, Scripture "becomes" the Word of God in the event of encounter, but is not itself the inspired, inerrant Word (against WCF 1.2\u20135). (2) Barth\'s rejection of natural theology and the analogia entis, while superficially aligned with presuppositionalism, rests on a different foundation: for Van Til, natural revelation is real but suppressed; for Barth, it is essentially denied. (3) Barth\'s Christological universalism tends toward universal salvation (though Barth himself refused to affirm it explicitly), undermining the doctrines of election, reprobation, and definite atonement. (4) Barth\'s rejection of the covenant of works, the <i>pactum salutis</i>, and the traditional Reformed <i>ordo salutis</i> fragments the covenantal architecture of Reformed dogmatics. (5) His actualistic ontology (in which God\'s being is always in act and decision) threatens the classical doctrines of divine simplicity, immutability, and the eternal decree. Berkouwer initially engaged Barth sympathetically but later acknowledged significant departures. The Reformed assessment: Barth recovered important emphases but did so on a foundation incompatible with confessional Reformed theology.',k:['neo-orthodoxy','dialectical theology','revelation','propositional','Scripture','encounter','natural theology','universalism','covenant of works','<i>pactum salutis</i>','actualism','simplicity','immutability','decree','WCF 1.2','Berkouwer','Reformed critique','crisis theology'],ct:'polemics'},
{id:'polemic-open-theism',n:'Against Open Theism & Process Theology',d:'Open theism (Pinnock, Sanders, Boyd, Hasker) teaches that God does not exhaustively foreknow the future free actions of creatures \u2013 the future is genuinely "open" even to God, who takes risks and adjusts His plans in response to creaturely decisions. Process theology (Whitehead, Hartshorne, Cobb) goes further, denying divine omnipotence, immutability, and aseity, and reconceiving God as a dipolar being who is affected by and grows with the world. Both represent radical departures from classical Christian theism and are incompatible with the Reformed confession at every point. Against open theism, the WCF (2.2) affirms that God\'s knowledge is "infinite, infallible, and independent upon the creature"; His decree encompasses "whatsoever comes to pass" (WCF 3.1); and He works "all things according to the counsel of His own will" (Eph 1:11). Turretin\'s treatment of divine knowledge and Bavinck\'s doctrine of God thoroughly refute the notion that God\'s knowledge is in any way dependent on creaturely action. Ware (God\'s Lesser Glory) and Frame provides a contemporary Reformed response. Open theism fails exegetically (Isa 46:9\u201310; Ps 139:16; Acts 2:23; 4:27\u201328), theologically (it undermines providence, prophecy, and the comfort of the gospel), and philosophically (an ignorant God cannot ground the intelligibility of the world or the reliability of His promises). Process theology\'s denial of <i>creatio ex nihilo</i>, divine simplicity, and transcendence places it outside the bounds of Christian theism entirely.',k:['open theism','process theology','Pinnock','Boyd','Sanders','Whitehead','foreknowledge','omniscience','immutability','decree','WCF 2.2','WCF 3.1','Eph 1:11','Isa 46:10','Ware','sovereignty','providence','classical theism','dipolar','risk'],cl:['divine-knowledge','immutability','decree'],ct:'polemics'},
{id:'polemic-kantianism',n:'Against Kantian Moralism & the Autonomy of Reason',d:'Immanuel Kant\u2019s critical philosophy represents perhaps the most consequential single challenge to Reformed orthodoxy from the Enlightenment, because its effects are not confined to one doctrine but pervade the entire theological enterprise. Kant\u2019s first Critique (Critique of Pure Reason, 1781) denied the possibility of speculative knowledge of God, the soul, or freedom \u2013 confining theoretical reason to the phenomenal realm and rendering the classical theistic proofs (cosmological, teleological, ontological) invalid as demonstrations of God\u2019s existence. His second Critique (Critique of Practical Reason, 1788) relocated religion entirely within the sphere of morality: God becomes a postulate of practical reason necessary to ground the moral law, not the self-revealing Creator who speaks in Scripture. His Religion within the Limits of Reason Alone (1793) explicitly subordinated revelation to the moral tribunal of autonomous reason \u2013 whatever in Scripture cannot be justified on purely moral grounds is to be set aside. The downstream effects are incalculable. Schleiermacher accepted Kant\u2019s demolition of natural theology and relocated theology in religious feeling. Ritschl accepted Kant\u2019s moralism and reduced Christianity to ethical values. The entire liberal tradition from Harnack to the present presupposes the Kantian settlement: theology cannot make cognitive claims about transcendent reality but can only express moral or experiential truths. Against this, the Reformed tradition has responded on multiple fronts. Bavinck engages Kant directly, arguing that the critical philosophy rests on an arbitrary restriction of knowledge that is itself undemonstrated and self-defeating \u2013 Kant\u2019s claim that we cannot know things-in-themselves is itself a claim about things-in-themselves. Van Til\u2019s presuppositional critique goes deeper: Kant\u2019s autonomous reason cannot account for the preconditions of intelligibility (the laws of logic, the uniformity of nature, the objectivity of moral norms) that it presupposes. The God of Scripture is not a postulate of practical reason but the self-sufficient, self-revealing triune God who is the necessary ground of all knowledge, morality, and experience. The WCF (1.1\u20136; 21.1) presupposes that God has revealed Himself both in nature and in Scripture, and that this revelation yields genuine knowledge \u2013 not mere moral postulation. Bavinck\u2019s theological epistemology and Turretin\u2019s systematic method both presuppose the cognitive accessibility of divine truth against Kant\u2019s restrictions. The pastoral danger of Kantianism is its pervasive cultural influence: modern people instinctively assume that religious claims are matters of private moral feeling rather than public cognitive truth, and this assumption must be identified and challenged from the pulpit and the classroom.',k:['Kant','Kantianism','moralism','autonomy','Critique of Pure Reason','practical reason','postulate','Enlightenment','Schleiermacher','Ritschl','presuppositions','phenomenal','noumenal','natural theology','moral law','WCF 1.1','cognitive','self-defeating','liberal tradition','autonomous reason'],ct:'polemics'},
{id:'polemic-darwinism',n:'Against Darwinian Naturalism & Evolutionary Theology',d:'Charles Darwin\u2019s Origin of Species (1859) and The Descent of Man (1871) posed a challenge to Christianity that extends far beyond the question of biological origins. Darwinian naturalism, as a worldview, denies the special creation of man in the image of God (Gen 1:26\u201327), the historical Adam and the historical fall (Gen 2\u20133; Rom 5:12\u201319), and the teleological design of creation (Ps 19:1; Rom 1:20). When evolutionary theory is imported into theology, the results are devastating: Adam becomes a myth or a symbol for the human race collectively; the fall is reinterpreted as an upward struggle from animal instincts to moral consciousness; original sin is reduced to evolutionary baggage; and the entire covenantal architecture of federal theology \u2013 the covenant of works with Adam as federal head, the covenant of grace with Christ as the second Adam \u2013 collapses. The Reformed tradition has engaged this challenge vigorously. Warfield, though personally open to a carefully qualified theistic evolution, insisted on the historicity of Adam and the fall as non-negotiable. Bavinck defends the special creation of man against evolutionary anthropology, arguing that the image of God is not an emergent property of natural processes but a divinely bestowed endowment. Hodge\'s What is Darwinism? (1874) identified the core issue: Darwinism as a system denies design, and the denial of design is atheism. More recently, the OPC and PCA have both affirmed the historicity of Adam in response to proposals by Enns, Lamoureux, and others who seek to accommodate evolutionary science within evangelical theology. The WCF (4.1\u20132) teaches that God created all things of nothing in the space of six days, and all very good, and made man male and female with reasonable and immortal souls (Gen 1\u20132). The Confession\u2019s affirmation of special creation, the historical Adam, and the covenant of works (WCF 7.2) stand as non-negotiable doctrinal commitments that cannot be reconciled with a fully naturalistic evolutionary account. The theological stakes are clear: without a historical Adam there is no historical fall, without a historical fall there is no need for a historical redeemer, and the entire fabric of federal theology unravels.',k:['Darwinism','evolution','naturalism','Adam','historical fall','image of God','Gen 1:26','Rom 5:12','federal theology','covenant of works','second Adam','Enns','OPC','PCA','special creation','WCF 4.1','design','atheism','theistic evolution','<i>imago Dei</i>','original sin','covenantal architecture'],ct:'polemics'},
{id:'polemic-npp',n:'Against the New Perspective on Paul',d:'The New Perspective on Paul (NPP), associated with E.P. Sanders (Paul and Palestinian Judaism, 1977), James D.G. Dunn, and most prominently N.T. Wright, challenges the Reformation\u2019s reading of Paul at its most fundamental level. Sanders argued that Second Temple Judaism was not a religion of legalistic works-righteousness (as the Reformers supposedly assumed) but of \u201ccovenantal nomism\u201d \u2013 one enters the covenant by grace and stays in by obedience to Torah. On this reading, the \u201cworks of the law\u201d against which Paul polemicizes are not meritorious human efforts to earn salvation but ethnic boundary markers (circumcision, food laws, Sabbath) that separated Jew from Gentile. Justification, accordingly, is not a soteriological verdict concerning how an individual sinner is declared righteous before God, but an ecclesiological declaration of who belongs to the covenant community. Wright has argued that the \u201crighteousness of God\u201d (<i>dikaiosyne</i> theou) is God\u2019s covenant faithfulness, not an alien righteousness imputed to the believer, and that justification is God\u2019s declaration that someone is already a member of the covenant family on the basis of faith. The Reformed response has been vigorous and multifaceted. Guy Prentiss Waters (Justification and the New Perspectives on Paul, 2004) provides a comprehensive critique, demonstrating that: (1) the NPP caricatures the Reformers, who knew perfectly well that Judaism was covenantal and who never reduced the Jewish error to crude Pelagianism; (2) the exegetical evidence supports the traditional reading of \u201cworks of the law\u201d as including all human obedience offered as a ground of acceptance with God (Rom 3:20,28; Gal 2:16; 3:10\u201312); (3) the imputation of Christ\u2019s righteousness is clearly taught in Rom 4:3\u20138; 5:17\u201319; 2 Cor 5:21; Phil 3:9; (4) justification in Paul is both forensic and soteriological, not merely ecclesiological. J.V. Fesko defends the traditional ordo against Wright\u2019s reconfiguration. Gaffin argues that the NPP\u2019s reduction of justification to covenant membership effectively evacuates the cross of its propitiatory significance. The PCA (2007) and OPC study committees have addressed the NPP, affirming the confessional doctrine of imputation and the forensic character of justification. The WCF (11.1) states that those whom God effectually calls He also freely justifies, \u201cnot by infusing righteousness into them, but by pardoning their sins, and by accounting and accepting their persons as righteous; not for anything wrought in them, or done by them, but for Christ\u2019s sake alone; not by imputing faith itself, the act of believing, or any other evangelical obedience to them, as their righteousness; but by imputing the obedience and satisfaction of Christ unto them.\u201d This formulation directly forecloses the NPP\u2019s reconfiguration.',k:['New Perspective on Paul','NPP','Sanders','Wright','Dunn','covenantal nomism','works of the law','boundary markers','justification','imputation','forensic','ecclesiological','soteriological','covenant faithfulness','Waters','PCA','OPC','WCF 11.1','Rom 3:20','Rom 4:3','2 Cor 5:21','Phil 3:9','Reformation','<i>sola fide</i>','righteousness of God','propitiatory','cross'],cl:['justification','justification-intra','faith-repentance'],ct:'polemics'},
{id:'polemic-progressive',n:'Against Progressive Christianity',d:'Progressive Christianity is less a coherent theological system than a cultural mood and trajectory within professing Christendom, but its tenets are identifiable and its departure from confessional orthodoxy is radical. Drawing on 19th-century liberalism, post-Enlightenment biblical criticism, postmodern epistemology, and contemporary social justice movements, progressive Christianity characteristically: (1) denies or radically reinterprets the inerrancy, sufficiency, and authority of Scripture, treating the Bible as a culturally conditioned, fallible human document that must be read through the lens of contemporary moral sensibilities; (2) denies or redefines penal substitutionary atonement as \u201cdivine child abuse\u201d (following Weaver, Chalke, and others), replacing it with various non-penal atonement models (moral influence, Christus Victor stripped of its satisfaction dimension, or participatory theories); (3) redefines sin away from transgression of the divine law and original corruption toward systemic social categories (racism, patriarchy, heteronormativity), such that salvation becomes liberation from social oppression rather than reconciliation with God through Christ\u2019s blood; (4) embraces theological inclusivism or universalism, denying the exclusivity of Christ as the only way of salvation (John 14:6; Acts 4:12) and the reality of eternal conscious punishment; (5) revises Christian sexual ethics, affirming same-sex marriage and gender fluidity in contradiction to the created order (Gen 1:27; 2:24; Matt 19:4\u20136; Rom 1:26\u201327; 1 Cor 6:9\u201311; WCF 24.1). From a confessional Reformed standpoint, progressive Christianity is not a reform of Christianity but a repetition of the liberal project identified by Machen \u2013 a fundamentally different religion wearing Christian vestments. Its hermeneutic of suspicion toward Scripture inverts the Reformed principle of <i>sola Scriptura</i> (WCF 1.10). Its denial of penal substitution guts the gospel of its saving power (Rom 3:25; Gal 3:13; 1 Pet 2:24; WCF 8.5; 11.3). Its redefinition of sin along sociological rather than theological lines loses the individual sinner\u2019s standing <i>coram Deo</i> and the necessity of personal regeneration (John 3:3; Ezek 36:26; WCF 6; 9.3; 13). Its universalism contradicts the clear teaching of Scripture on election, reprobation, and the narrow way (Matt 7:13\u201314; John 3:36; WCF 3.3\u20134; 10.4). The pastoral urgency is acute: progressive Christianity is the dominant theological voice in many mainline denominations and is increasingly influential in evangelical and nominally Reformed circles. Every generation must hear Machen\u2019s verdict afresh: what is offered is not Christianity at all.',k:['progressive Christianity','liberalism','postmodern','inerrancy','penal substitution','divine child abuse','inclusivism','universalism','sexual ethics','same-sex','gender','<i>sola Scriptura</i>','WCF 1.10','WCF 24.1','Rom 1:26','John 14:6','Acts 4:12','atonement','sin','systemic','social justice','hermeneutic of suspicion','mainline','evangelical','regeneration','<i>coram Deo</i>','narrow way'],ct:'polemics'},
{id:'polemic-social-gospel',n:'Against the Social Gospel & Moral Therapeutic Deism',d:'The Social Gospel movement, associated with Walter Rauschenbusch (A Theology for the Social Gospel, 1917) and Washington Gladden, represents the systematic reduction of Christianity to a program of social reform. Rauschenbusch explicitly redefined sin as social rather than individual, the kingdom of God as a this-worldly social order rather than the eschatological reign of Christ, salvation as the Christianization of the social order rather than the reconciliation of sinners to God through the blood of Christ, and the atonement as the tragedy of a good man destroyed by systemic evil rather than the penal substitutionary satisfaction of divine justice. The Social Gospel does not merely add a social dimension to the gospel (which the Reformed tradition affirms through the doctrines of vocation, common grace, and the cultural mandate) \u2013 it replaces the gospel with social activism. Machen identified this precisely: the liberal social program is not an application of Christianity but a substitute for it. Kuyper\u2019s theology of common grace and the cultural mandate provides the genuinely Reformed alternative: Christians engage culture and pursue justice not because the kingdom is a social program but because Christ is Lord over all of life, and they do so while maintaining the absolute priority of the gospel of individual redemption through Christ (Rom 1:16; 1 Cor 15:3\u20134). The contemporary descendant of the Social Gospel is Moral Therapeutic Deism (identified by Smith and Denton, Soul Searching, 2005): the operative religion of American culture, which teaches that God exists, wants people to be nice, the central goal of life is happiness, God does not need to be involved except when there is a problem, and good people go to heaven. MTD is not the Christian faith; it is the natural religion of fallen man dressed in therapeutic language. Against MTD, the WCF teaches the total depravity of human nature (6.2\u20134), the inability of the sinner to contribute anything to salvation (9.3), the necessity of effectual calling and regeneration (10.1\u20132), and the exclusive mediation of Christ (8.1; 1 Tim 2:5). The Reformed tradition insists that Christianity is not therapy for self-actualization but the sovereign God\u2019s rescue of hell-deserving sinners through the substitutionary death of His Son \u2013 and that any theology which loses this center has lost Christianity itself.',k:['Social Gospel','Rauschenbusch','Gladden','Moral Therapeutic Deism','MTD','Smith','Denton','cultural mandate','common grace','vocation','kingdom of God','social reform','sin','salvation','atonement','systemic','individual redemption','Rom 1:16','1 Cor 15:3','WCF 6.2','WCF 9.3','WCF 10.1','total depravity','effectual calling','therapy','self-actualization','substitute','gospel'],ct:'polemics'},
]},
{id:'intra-reformed',n:'Intra-Reformed Debates: Live Controversies',ct:'polemics',c:'#cc6655',r:1.2,o:17.5,
d:'A living theological tradition does not only engage external opponents but also conducts vigorous internal debate on matters where confessional fidelity is affirmed but the precise implications of that confession are disputed. The Reformed tradition has always distinguished between fundamentals of the faith (on which unity is required) and secondary or tertiary questions (on which charitable disagreement among the orthodox is permissible). Several debates within the Reformed family remain live and consequential: the nature of merit in the covenant of works, the question of Mosaic covenant republication, the Shepherd/Federal Vision controversy over justification, and the Clark/Van Til epistemological dispute (treated under Prolegomena). These debates are not signs of weakness but of vitality \u2013 a tradition that does not wrestle with its own inheritance is a tradition that has ceased to think. Turretin himself engaged extensively with intra-Protestant disagreements (e.g., with the Amyraldians within the Reformed camp). The key pastoral concern is that these debates be conducted with charity, precision, and a shared commitment to the authority of Scripture and the Reformed confessions.',
k:['intra-Reformed','debates','controversies','merit','republication','Federal Vision','Shepherd','charity','confessional','fundamentals','secondary','Amyraldians','vitality'],
cl:['covenant-works','covenant-grace','salvation','prolegomena','law','justification','covenant-theology'],
s:[
{id:'republication-debate',n:'The Mosaic Covenant Republication Debate',d:'One of the most significant contemporary intra-Reformed controversies concerns whether the Mosaic covenant involved a republication of the covenant of works. The "republication" position (defended in various forms by the Reformed tradition, Karlberg, Ferry, Estelle, and the contributors to The Law Is Not of Faith) argues that the Mosaic economy, at the level of Israel\'s national/typological existence in the land, operated on a works principle: Israel\'s retention of the land was conditioned on their obedience to the law (Lev 18:5; Deut 28), functioning as a typological recapitulation of the covenant of works with Adam. This does not deny that individual Israelites were saved by grace through faith (the substance of the covenant of grace), but it holds that the Mosaic administration contained a superimposed, typological works principle at the national level. Critics have raised concerns that: (1) this introduces a meritorious principle within the covenant of grace, potentially undermining the gratuity of the Mosaic administration; (2) WCF 7.5\u20136 and 19.1\u20132 treat the Mosaic covenant as an administration of the covenant of grace, not a separate works arrangement; (3) the language of "merit" applied even typologically risks confusion about the nature of the obedience required of Israel. The OPC study committee report (2016) acknowledged legitimate forms of the republication thesis while rejecting versions that posit genuine merit in fallen sinners\' obedience. The debate touches the deepest questions of covenant theology: the relationship between law and gospel, the nature of the Mosaic economy, and the typological significance of Israel\'s tenure in the land.',k:['republication','Mosaic covenant','covenant of works','Estelle','Law Is Not of Faith','works principle','typological','Lev 18:5','Deut 28','OPC','merit','covenant of grace','WCF 7.5','law and gospel','national','land','Waters','VanDrunen'],cl:['mosaic-covenant','covenant-works','merit-covenant-works','law'],ct:'polemics'},
{id:'merit-covenant-works',n:'Merit & the Covenant of Works',d:'Was Adam\'s obedience in the covenant of works meritorious, and if so, in what sense? This question has generated significant intra-Reformed discussion. The classic position affirms that Adam\'s obedience, had it been rendered perfectly, would have merited eternal life \u2013 not on the basis of strict commutative justice (since the creature can never place God in his debt by nature, Luke 17:10), but on the basis of pactum (covenantal arrangement). God freely condescended to establish a covenant in which He promised eternal life for obedience (WCF 7.1; 19.1): this is sometimes called "pactual merit" or "covenanted merit." Others, following Murray and some Westminster Seminary (California) theologians, have questioned the language of merit altogether, arguing that even in the covenant of works the reward is gracious \u2013 God was under no obligation to make any promise at all, and Adam\'s obedience could never constitute a claim on God. The Reformed scholastic tradition uses the language of "simple justice" \u2013 once God established the covenant, the reward was a matter of justice, not grace, within that covenantal framework. The debate matters for Christology: if Adam could not have merited in any sense, can we speak of Christ meriting on behalf of the elect? The WCF itself uses the language of "merit" for Christ\'s work (WCF 11.1,3; 16.5) and implies a works arrangement with Adam (WCF 7.2; 19.1). The question is how to relate divine condescension, covenantal arrangement, and the language of earning or deserving.',k:['merit','covenant of works','pactual merit','covenanted merit','simple justice','condescension','WCF 7.1','WCF 19.1','Luke 17:10','Adam','obedience','Christology','reward','grace','justice','earn','claim'],cl:['active-obedience','works-merit','covenant-works','probation'],ct:'polemics'},
{id:'shepherd-fv',n:'The Shepherd Controversy & Federal Vision',d:'Norman Shepherd, professor at Westminster Theological Seminary from 1963 to 1982, provoked one of the most consequential intra-Reformed debates of the 20th century by arguing that justification is by "a living, active, and obedient faith" and that faithfulness (including works of obedience) functions as an instrument \u2013 not merely a fruit \u2013 of justification. Critics charged that this conflated justification and sanctification and reintroduced works into the ground of justification (against WCF 11.1; Rom 3:28; 4:5). Shepherd was eventually dismissed from Westminster in 1982, but the theological issues resurfaced in the Federal Vision (FV) movement of the early 2000s (associated with Lusk, Wilson, Wilkins, Barach, Jordan, Horne, Schlissel). Key FV tenets include: (1) baptismal efficacy that grants real but losable union with Christ; (2) a rejection of the visible/invisible church distinction in favor of "covenant objectivity"; (3) a redefinition of election as covenantal and potentially reversible; (4) the inclusion of faithfulness and obedience within the instrument of justification; (5) a denial or reinterpretation of the covenant of works and the imputation of Christ\'s active obedience. The PCA (2007), OPC (2006), RCUS, URC, and other Reformed bodies officially rejected the FV as contrary to the Westminster Standards and the Three Forms of Unity. Guy Prentiss Waters\' The Federal Vision and Covenant Theology and R. Scott the opposing position\'s collection Covenant, Justification, and Pastoral Ministry provide the most thorough Reformed critiques. The debate is ultimately about whether the Reformation\'s <i>sola fide</i> \u2013 justification by faith alone, apart from works of the law \u2013 will be maintained or subtly eroded from within the Reformed camp.',k:['Shepherd','Federal Vision','FV','justification','<i>sola fide</i>','faith alone','works','obedience','WCF 11.1','baptism','covenant objectivity','visible invisible','active obedience','imputation','PCA','OPC','Waters','Lusk','Wilson','Wilkins','Westminster','Reformation','erosion','instrument','fruit'],cl:['justification','federal-union-christ','baptism','perseverance'],ct:'polemics'},
{id:'justification-intra',n:'Justification: Contemporary Reformed Refinements',d:'The doctrine of justification by faith alone remains the articulus stantis et cadentis ecclesiae (the article by which the church stands or falls), yet several questions continue to be refined within the Reformed tradition. (1) The imputation of Christ\'s active obedience: the Westminster Standards clearly teach that Christ\'s "obedience and satisfaction" are imputed to believers (WCF 11.1), and the mainstream Reformed tradition affirms that this includes both His active obedience (life-long law-keeping) and His passive obedience (suffering the penalty). Some within the Reformed camp (Piscator historically, and a minority today) have questioned whether active obedience is imputed, or only passive obedience. The mainstream Reformed tradition, including theologians such as Robert Reymond, defends active obedience imputation at length. (2) The New Perspective on Paul (Wright, Dunn, Sanders): while largely an external challenge, the NPP has influenced some within Reformed circles. Its redefinition of justification as ecclesiological declaration (who belongs to the covenant people) rather than soteriological verdict (how a sinner is right with God) has been critiqued by Gaffin, Waters (Justification and the New Perspectives on Paul), Fesko, and the GA study committees of the PCA and OPC. (3) The relationship between justification and union with Christ: following Calvin, Gaffin and others have argued that justification and sanctification are twin benefits of union with Christ, received simultaneously, neither logically prior to the other. This "union with Christ" model has been debated in relation to the traditional <i>ordo salutis</i> structure. (4) The final judgment and works: how does the Reformed tradition affirm that believers will be judged according to their works (2 Cor 5:10; Matt 25:31\u201346) while maintaining <i>sola fide</i>? The consensus is that works are the evidence, not the ground, of justification \u2013 they demonstrate the reality of faith without contributing to its acceptance before God (WCF 16.2,5; Jas 2:17\u201326).',k:['justification','active obedience','passive obedience','imputation','Piscator','New Perspective','Wright','Dunn','Sanders','Waters','union with Christ','<i>ordo salutis</i>','final judgment','works','evidence','<i>sola fide</i>','WCF 11.1','WCF 16.2','PCA','OPC'],cl:['justification','polemic-npp','faith-repentance'],ct:'polemics'},
]},
{id:'biblical-theology',n:'Biblical Theology: Redemptive-Historical Themes',ct:'biblical_theology',c:'#7db88a',r:1.4,o:16,
d:'A dedicated category for biblical-theological content that embodies the BT-ST integration advocated in the prolegomena. Biblical theology traces the unfolding drama of God\'s progressive self-revelation through the history of redemption, attending to the organic development of themes across the canon. Vos treats biblical theology as an <i>organon</i> of systematic theology; Clowney provides its practical integration; Gaffin holds that systematic theology must be continually informed and corrected by redemptive-historical exegesis. The themes gathered here \u2013 the kingdom of God, exile and return, the typology of Adam, and others \u2013 are not alternative organizing frameworks competing with the systematic loci but complementary perspectives that illuminate the same divine truth from within the narrative texture of Scripture itself. Each theme has connections to multiple systematic loci, demonstrating the organic unity of biblical revelation.',
k:['biblical theology','redemptive-historical','progressive revelation','themes','canon','organic','narrative','typology','kingdom','exile','Adam','creation','consummation'],
cl:['christ','creation','eschatology','covenant-grace','covenant-theology','salvation','church','prolegomena','scripture','covenant-works','law','temple-theology','kingdom-of-god'],
s:[
{id:'kingdom-of-god',n:'The Kingdom of God',d:'The kingdom of God is a central biblical-theological theme surprisingly pervasive across both testaments, connecting Christology, eschatology, ecclesiology, and ethics. The Reformed tradition holds that the kingdom is a foundational biblical-theological theme: the kingdom is God\'s dynamic, sovereign, redemptive reign, manifested progressively in history and consummated at the eschaton. The already-not yet structure is architectonically significant: in Christ\'s first advent, the kingdom has been inaugurated \u2013 the powers of the age to come have broken into the present evil age (Matt 12:28; Luke 11:20; 17:20\u201321) \u2013 but it awaits consummation at His return, when every knee shall bow and every tongue confess (Phil 2:10\u201311; Rev 11:15). The kingdom parables (Matt 13) describe this inter-advent tension: the kingdom grows like a mustard seed, operates like leaven, and coexists with evil until the harvest. The kingdom connects to: Christology (Christ is the King who inaugurates and consummates the kingdom, Ps 2:6; Dan 7:13\u201314; Matt 28:18); ecclesiology (the church is the community of the kingdom, the first-fruits of the new creation, Matt 16:18\u201319; Col 1:13); eschatology (the consummation is the full arrival of the kingdom, Rev 21\u201322); and ethics (kingdom citizens live by kingdom ethics in the Sermon on the Mount, Matt 5\u20137). Vos remains the indispensable source for the Reformed understanding of the kingdom.',k:['kingdom of God','already-not yet','inaugurated','consummation','reign','Matt 12:28','Ps 2:6','Dan 7:13','Matt 13','parables','mustard seed','ecclesiology','eschatology','ethics','Sermon on the Mount','Christ','King','new creation','Rev 11:15','Phil 2:10'],cl:['davidic-covenant','christ','eschatology','church','amillennialism','two-age-model'],ct:'biblical_theology'},
{id:'exile-return-motif',n:'The Exile and Return Motif',d:'The exile-and-return pattern is one of the most pervasive redemptive-historical motifs in Scripture, connecting hamartiology (judgment for covenant-breaking), eschatology (restoration and new creation), Christology (Christ as the true return from exile), and ecclesiology (the church as the eschatological restoration community). Adam\'s expulsion from Eden is the primal exile (Gen 3:22\u201324); Israel\'s Babylonian exile (2 Kgs 25; Jer 25:11\u201312; Dan 9:2) recapitulates and intensifies the Adamic pattern. The prophets promise a new exodus and return that will surpass the original \u2013 a return involving the forgiveness of sins, the gift of the Spirit, the rebuilding of the temple, and the restoration of the Davidic kingdom (Isa 40\u201355; Jer 31:31\u201334; Ezek 36\u201337; Zech 8\u201314). Yet the post-exilic community recognized that the prophetic promises remained unfulfilled: the glory had not returned to the temple (Hag 2:3\u20139), the Davidic king had not appeared, and Israel remained under foreign domination. The NT announces that in Christ, the true and final return from exile has begun: He is the new Israel who passes through the wilderness without sinning (Matt 4:1\u201311), the Servant who bears the exile-judgment of His people (Isa 53; cf. Matt 8:17), the temple destroyed and raised in three days (John 2:19\u201321), and the Davidic King who inaugurates the restored kingdom (Luke 1:32\u201333,68\u201375; Acts 2:30\u201336). The church is the restoration community \u2013 the eschatological Israel that has been gathered from exile by the preaching of the gospel to all nations (Acts 15:14\u201318; Gal 6:16; 1 Pet 1:1 \u2013 \"elect exiles\"). The new creation is the final, irreversible return \u2013 Eden restored and glorified (Rev 21\u201322).',k:['exile','return','motif','Adam','Eden','Babylon','new exodus','Isa 40','Jer 31','Ezek 36','restoration','temple','Davidic','Christ','new Israel','Matt 4','Isa 53','John 2:19','church','eschatological','1 Pet 1:1','elect exiles','new creation','Rev 21','judgment','forgiveness','Spirit'],cl:['prophetic-covenant-lawsuit','covenant-grace','sin','new-creation'],ct:'biblical_theology'},
{id:'typology-of-adam',n:'The Typology of Adam',d:'The typological relationship between Adam and Christ (Rom 5:14 \u2013 Adam \"was a type of the one who was to come\"; 1 Cor 15:21\u201322,45\u201349) constitutes the architectonic structure of redemptive history. Adam is the first federal head who, by his one act of disobedience, brought sin, condemnation, and death to all his posterity (Rom 5:12\u201319). Christ is the Last Adam (1 Cor 15:45), the second federal head who, by His one act of righteousness (His obedience unto death), brings justification and life to all who are in Him (Rom 5:18\u201319). This Adam-Christ typology is not merely an illustrative analogy but the God-designed structural principle of the entire <i>historia salutis</i>. The parallels and escalations include: (1) Both are federal heads \u2013 representatives whose actions determine the destiny of their posterity (Rom 5:12\u201319; 1 Cor 15:21\u201322). (2) Both face probation \u2013 Adam in the garden, Christ in the wilderness and throughout His earthly ministry (Matt 4:1\u201311; Heb 4:15). (3) Where Adam failed, Christ succeeded \u2013 Christ is the obedient Son who fulfills the covenant of works by His active obedience (Rom 5:19; Phil 2:8). (4) The escalation from Adam to Christ is not merely restorative but consummative: the first Adam was from the earth (psychikos, 1 Cor 15:47); the Last Adam is from heaven and is life-giving Spirit (pneumatikos, 1 Cor 15:45\u201349). The eschatological state secured by Christ surpasses the original Edenic state \u2013 it is not merely innocence restored but glory achieved, not merely <i>posse non peccare</i> but <i>non posse peccare</i>. Vos, Gaffin, and Beale have demonstrated that this typological structure underlies the entire biblical narrative from creation to consummation.',k:['typology of Adam','Adam','Christ','Last Adam','first Adam','federal head','Rom 5:14','Rom 5:12','1 Cor 15:21','1 Cor 15:45','type','antitype','probation','obedience','disobedience','Matt 4','Heb 4:15','escalation','psychikos','pneumatikos','life-giving Spirit','<i>posse non peccare</i>','<i>non posse peccare</i>','architectonic','<i>historia salutis</i>','covenant of works','consummation'],cl:['federal-headship','active-obedience','creation-to-consummation','covenant-works'],ct:'biblical_theology'}
]},

];

// ═══════════════════════════════════════════
// §3 - STUDY PATHS
// ═══════════════════════════════════════════
const STUDY_PATHS = {
 knowledge: { name:'The Knowledge of God', description:'From theological foundations through revelation to Scripture', ids:['prolegomena','archetypal-ectypal','bt-st-method','confessions-standards','revelation','gen-revelation','spec-revelation','scripture','inerrancy','knowledge-god','faith-reason','natural-theology'] },
 decree: { name:'From Decree to Redemption', description:'The eternal plan unfolding in covenant and history', ids:['decree','election','pactum','covenant-grace','covenant-unity','christ','active-obedience','passive-obedience'] },
 ordo: { name:'The Order of Salvation', description:'Union with Christ as the controlling soteriological reality \u2013 all benefits (justification, sanctification, adoption, glorification) flow simultaneously from incorporation into the resurrected Christ by the Spirit through faith (Murray/Gaffin\'s mature framework)', ids:['federal-union-christ','mystical-union-christ','historia-ordo-relationship','calling-regen','faith-repentance','justification','adoption','sanctification','perseverance','assurance','glorification'] },
 covenant: { name:'Covenant Theology', description:'The covenantal architecture of all redemption', ids:['covenant-condescension','pactum','covenant-works','federal-headship','sin','covenant-grace','mosaic-covenant','old-new-testament','covenant-signs'] },
 arc: { name:'Creation to New Creation', description:'The full arc of redemptive history \u2013 the irreversible forward movement from creation through covenant, fall, and redemption to consummation', ids:['creation','creation-to-consummation','providence','humanity','covenant-works','sin','the-fall','covenant-grace','christ','salvation','glorification','eschatology','cosmic-redemption','beatific-vision','consummation-covenant','new-creation'] },
 piety: { name:'The Life of Piety', description:'Prayer, worship, suffering, lament, catechesis, and the formation of the believer', ids:['christian-life','chief-end','piety-knowledge','prayer-theology','trinitarian-prayer','family-worship','catechetical-instruction','meditation-scripture','singing-praise','theology-psalter','theology-suffering','spiritual-desertion','lament-faithful-response'] },
 modern_defense: { name:'Against Modern Errors', description:'The Reformed response to liberalism, criticism, naturalism, neo-orthodoxy, and contemporary departures from confessional orthodoxy', ids:['polemic-modern','polemic-liberalism','polemic-higher-criticism','polemic-naturalism','polemic-neoorthodoxy','polemic-open-theism','polemic-kantianism','polemic-darwinism','polemic-npp','polemic-progressive','polemic-social-gospel'] },
 center: { name:'The Christological Center', description:'The person and work of Christ as Mediator', ids:['necessity-mediator','incarnation','two-natures','threefold-office','active-obedience','passive-obedience','definite-atonement','states-christ','intercession-christ'] },
 trinity_path: { name:'The Triune God', description:'The being and persons of the one true God', ids:['god','simplicity','aseity','divine-knowledge','divine-veracity','divine-goodness','divine-love','divine-grace','divine-holiness','divine-righteousness','divine-incomprehensibility','divine-blessedness','trinity','eternal-generation','procession-spirit','trinitarian-relations'] },
 church_path: { name:'The Church & Her Ordinances', description:'Ecclesiology from marks to means of grace and mission', ids:['church','visible-invisible','marks-church','church-government','church-officers','church-discipline','synods-councils','civil-magistrate','church-mission','election-evangelism','christs-kingship-nations','means-grace','preaching-word','sacraments','baptism','lords-supper','worship','sabbath-lords-day'] },
 liberty_path: { name:'Law, Liberty & Life', description:'From moral law to Christian freedom and good works', ids:['law','threefold-use','decalogue','decalogue-preface','decalogue-rules','first-table','second-table','natural-law','abrogation-law','law-gospel','christian-liberty','conscience-freedom','good-works','sanctification'] },
 will_path: { name:'The Human Will in Four States', description:'From innocence through fall to grace and glory', ids:['original-righteousness','will-innocence','the-fall','will-sin','total-depravity','calling-regen','will-grace','will-glory'] },
 magistrate_path: { name:'Church, State & Society', description:'Civil authority, marriage, oaths, and public order', ids:['church','church-government','church-officers','civil-magistrate','marriage-divorce','oaths-vows','christian-liberty','conscience-freedom'] },
 sacraments_path: { name:'The Sacraments in Full', description:'From definition through baptism to the table', ids:['sacrament-definition','covenant-signs','baptism','lords-supper','sacrament-word','fencing-table','means-grace','preaching-word'] },
 spirit_path: { name:'The Holy Spirit', description:'The Person and work of the Spirit across all theology', ids:['spirit-deity','spirit-creation','spirit-scripture','spirit-testimonium','spirit-illumination','spirit-regeneration','spirit-sanctification','spirit-common-ops','spirit-indwelling','spirit-gifts','cessation-gifts','spirit-fruit','spirit-prayer','trinitarian-prayer','spirit-church','spirit-pentecost'] },
 polemic_path: { name:'Defending the Faith: Reformed Polemics', description:'The elenctic dimension of Reformed dogmatics against Rome, Socinianism, Arminianism, and modern errors', ids:['polemic-rome','polemic-justification','polemic-scripture-rome','polemic-sacraments-rome','polemic-papacy','polemic-socinian','polemic-socinian-trinity','polemic-socinian-atonement','polemic-socinian-sin','polemic-arminian','polemic-total-depravity','polemic-unconditional-election','polemic-definite-atonement','polemic-irresistible-grace','polemic-perseverance-dort','polemic-modern','polemic-liberalism','polemic-higher-criticism','polemic-naturalism','polemic-neoorthodoxy','polemic-open-theism','polemic-kantianism','polemic-darwinism','polemic-npp','polemic-progressive','polemic-social-gospel','intra-reformed','republication-debate','shepherd-fv'] },
 eschatology_path: { name:'The Last Things', description:'From death through the millennium to the new creation', ids:['eschatology','death-intermediate','amillennialism','antichrist','warning-passages','return-christ','resurrection-body','final-judgment','new-creation','hell-eternity'] },
 attributes_path: { name:'The Divine Perfections', description:'The attributes of the one true God in their fullness', ids:['god','simplicity','aseity','immutability','divine-infinity','omnipotence','divine-knowledge','divine-will','divine-veracity','divine-goodness','divine-love','divine-grace','divine-holiness','divine-righteousness','divine-incomprehensibility','divine-blessedness','communicable','incommunicable','names-god'] },
 protology_eschatology: { name:'From Garden to Glory: The Protology-Eschatology Axis', description:'The architectonic principle: creation oriented toward consummation \u2013 tracing the irreversible forward movement from Eden to Eden glorified through covenant, fall, redemption, and new creation', ids:['creation','creation-to-consummation','six-days','cultural-mandate','covenant-works','probation','humanity','original-righteousness','the-fall','sin','covenant-grace','christ','active-obedience','resurrection-eschatological-event','eschatology','two-age-model','cosmic-redemption','return-christ','resurrection-body','consummation-covenant','new-creation'] },
 creation_consummation: { name:'Creation-to-Consummation: The Bavincian Backbone', description:'The organic structural principle that creation was from the beginning oriented toward eschatological glory \u2013 not a circle back to Eden but forward to Eden consummated. Traces the full trajectory through every major locus.', ids:['creation','creation-to-consummation','covenant-works','probation','the-fall','covenant-grace','pactum','christ','active-obedience','passive-obedience','federal-union-christ','mystical-union-christ','salvation','glorification','resurrection-eschatological-event','cosmic-redemption','consummation-covenant','beatific-vision','eternal-state','new-creation'] },
 pactum_path: { name:'The Covenant of Redemption', description:'The eternal intra-Trinitarian covenant grounding all of salvation', ids:['trinity','pactum','pactum-father','pactum-son','pactum-spirit','pactum-biblical-basis','pactum-historical-development','covenant-works','covenant-grace','covenant-surety'] },
 ot_theology: { name:'The Old Testament\'s Theological Voice', description:'The OT as a theological voice in its own right \u2013 Psalter, wisdom, temple, prophetic lawsuit, and Christ in the Old Testament', ids:['theology-psalter','wisdom-theology','prophetic-covenant-lawsuit','temple-theology','christ-old-testament','creation-to-consummation','interpretation'] },
 mission_path: { name:'The Church\'s Mission to the Nations', description:'The Great Commission, election and evangelism, and Christ\'s kingship over the nations', ids:['church','church-mission','election-evangelism','christs-kingship-nations','marrow-controversy','presuppositional-apologetics'] },
 christian_liberty_path: { name:'Christian Liberty & the Lordship of Conscience', description:'God alone is Lord of the conscience \u2013 from soteriology through political theology', ids:['justification','christian-liberty','liberty-conscience-wcf20-1-2','liberty-not-license','liberty-vs-authority','liberty-historical','conscience-freedom','civil-magistrate'] },
};

// ═══════════════════════════════════════════
// §3a - FLYTHROUGH PATHS
// Comprehensive doctrinal flythroughs covering every
// major locus and vital connecting arc of systematic
// theology, as required for proper theological
// understanding and formation.
// ═══════════════════════════════════════════
const FLYTHROUGH_PATHS = [
 { key:'full_system', name:'The Whole Counsel of God', desc:'The complete system of doctrine from the foundations of theology through every locus to the consummation', color:'#e0c050',
 ids:['prolegomena','scripture','god','trinity','decree','pactum','creation','creation-to-consummation','providence','humanity','covenant-works','sin','free-will','christ','covenant-grace','holy-spirit','salvation','good-works','law','christian-liberty','church','sacraments','means-grace','worship','christian-life','prayer-theology','eschatology','cosmic-redemption','beatific-vision','new-creation'] },
 { key:'prolegomena', name:'Theological Foundations', desc:'How do we know God? The principia of theology : revelation, Scripture, faith and reason, and theological method', color:'#78b0e0',
 ids:['prolegomena','knowledge-god','faith-reason','natural-theology','archetypal-ectypal','revelation','gen-revelation','spec-revelation','scripture','inerrancy','bt-st-method','confessions-standards','presuppositional-apologetics'] },
 { key:'theology_proper', name:'The Being & Attributes of God', desc:'The one true God in His perfections : simplicity, aseity, infinity, and all His glorious attributes', color:'#e8cc55',
 ids:['god','simplicity','aseity','immutability','divine-infinity','omnipotence','divine-knowledge','divine-will','divine-veracity','divine-goodness','divine-love','divine-grace','divine-holiness','divine-righteousness','divine-incomprehensibility','divine-blessedness'] },
 { key:'trinity', name:'The Holy Trinity', desc:'The eternal triune life of Father, Son, and Holy Spirit : one God in three persons', color:'#e8cc55',
 ids:['trinity','eternal-generation','procession-spirit','trinitarian-relations','pactum'] },
 { key:'decree_election', name:'The Eternal Decree & Election', desc:'God\'s all-encompassing plan from eternity : predestination, election, and the <i>pactum salutis</i>', color:'#c8b468',
 ids:['decree','election','reprobation','pactum','covenant-condescension'] },
 { key:'creation_providence', name:'Creation & Providence', desc:'God as Creator and Sustainer : the world, humanity, the image of God, and the covenant of works', color:'#68c068',
 ids:['creation','creation-to-consummation','providence','humanity','original-righteousness','cultural-mandate','covenant-condescension','covenant-works','will-innocence'] },
 { key:'sin_fall', name:'Sin & the Fall', desc:'The entrance of sin, original corruption, total depravity, and the bondage of the will', color:'#e07070',
 ids:['the-fall','sin','original-sin','total-depravity','free-will','will-sin','federal-headship','common-grace'] },
 { key:'christology', name:'The Person & Work of Christ', desc:'The Mediator : His incarnation, natures, offices, obedience, atonement, and states', color:'#d89848',
 ids:['necessity-mediator','incarnation','two-natures','threefold-office','covenant-surety','active-obedience','passive-obedience','definite-atonement','states-christ','intercession-christ'] },
 { key:'covenant_theology', name:'Covenant Theology', desc:'The covenantal architecture of redemption : from the covenant of works through the covenant of grace', color:'#d8907c',
 ids:['covenant-condescension','pactum','covenant-works','federal-headship','sin','covenant-grace','mosaic-covenant','old-new-testament','covenant-signs','covenant-unity'] },
 { key:'pneumatology', name:'The Holy Spirit', desc:'The person and work of the Spirit : from creation and inspiration through regeneration to indwelling', color:'#a0d8c0',
 ids:['holy-spirit','spirit-deity','spirit-creation','spirit-scripture','spirit-testimonium','spirit-illumination','spirit-regeneration','spirit-sanctification','spirit-common-ops','spirit-indwelling','spirit-gifts','spirit-fruit','spirit-prayer','spirit-church'] },
 { key:'ordo_salutis', name:'The Application of Redemption', desc:'The <i>ordo salutis</i> : effectual calling, union with Christ as the controlling reality, justification, sanctification, and glorification', color:'#a0d8c0',
 ids:['covenant-grace','federal-union-christ','mystical-union-christ','historia-ordo-relationship','calling-regen','faith-repentance','justification','adoption','sanctification','perseverance','assurance','glorification'] },
 { key:'will_four_states', name:'The Human Will in Four States', desc:'From innocence through the fall to grace and glory : the freedom and bondage of the will', color:'#c88070',
 ids:['original-righteousness','will-innocence','the-fall','will-sin','total-depravity','calling-regen','will-grace','will-glory'] },
 { key:'law_ethics', name:'The Law of God & Christian Life', desc:'The moral law, its threefold use, the Decalogue, Christian liberty, and good works', color:'#c8b468',
 ids:['law','threefold-use','decalogue','decalogue-preface','decalogue-rules','first-table','second-table','natural-law','abrogation-law','law-gospel','christian-liberty','conscience-freedom','good-works','sanctification'] },
 { key:'ecclesiology', name:'The Church & Her Ordinances', desc:'The gathered people of God : marks, government, officers, discipline, worship, and the means of grace', color:'#c090e0',
 ids:['church','visible-invisible','marks-church','church-government','church-officers','church-discipline','synods-councils','civil-magistrate','church-mission','election-evangelism','christs-kingship-nations','means-grace','preaching-word','sacraments','baptism','lords-supper','worship','regulative-principle','sabbath-lords-day'] },
 { key:'sacraments', name:'The Sacraments', desc:'From definition and covenant signs through baptism to the Lord\'s Supper', color:'#c090e0',
 ids:['sacrament-definition','covenant-signs','baptism','lords-supper','sacrament-word','fencing-table','means-grace','preaching-word'] },
 { key:'eschatology', name:'The Last Things', desc:'Death, the intermediate state, the return of Christ, resurrection, judgment, the beatific vision, and the new creation', color:'#58c0c0',
 ids:['eschatology','two-age-model','resurrection-eschatological-event','death-intermediate','return-christ','signs-times','resurrection-body','amillennialism','final-judgment','hell-eternity','beatific-vision','eternal-state','cosmic-redemption','marriage-supper','consummation-covenant','new-creation'] },
 { key:'redemptive_arc', name:'Creation to New Creation', desc:'The full arc of redemptive history from creation through fall and redemption to consummation \u2013 the irreversible forward movement from Garden to Glory', color:'#d89848',
 ids:['creation','creation-to-consummation','providence','humanity','covenant-works','the-fall','sin','covenant-grace','christ','salvation','eschatology','cosmic-redemption','consummation-covenant','new-creation'] },
 { key:'christological_center', name:'The Christological Center', desc:'Christ as the heart of all theology : the necessity, person, work, and ongoing ministry of the Mediator', color:'#d89848',
 ids:['necessity-mediator','incarnation','two-natures','threefold-office','active-obedience','passive-obedience','definite-atonement','states-christ','intercession-christ'] },
 { key:'reformed_polemics', name:'Defending the Faith', desc:'The elenctic dimension : Reformed polemics against Rome, Socinianism, Arminianism, and modern errors', color:'#e07070',
 ids:['polemic-rome','polemic-justification','polemic-scripture-rome','polemic-sacraments-rome','polemic-papacy','polemic-socinian','polemic-socinian-trinity','polemic-socinian-atonement','polemic-socinian-sin','polemic-arminian','polemic-total-depravity','polemic-unconditional-election','polemic-definite-atonement','polemic-irresistible-grace','polemic-perseverance-dort','polemic-modern','polemic-liberalism','polemic-higher-criticism','polemic-naturalism','polemic-neoorthodoxy','polemic-open-theism','polemic-kantianism','polemic-darwinism','polemic-npp','polemic-progressive','polemic-social-gospel','intra-reformed','republication-debate','shepherd-fv'] },
 { key:'divine_perfections', name:'The Divine Perfections', desc:'A deep exploration of every attribute of the one true God', color:'#e8cc55',
 ids:['god','simplicity','aseity','immutability','divine-infinity','omnipotence','divine-knowledge','divine-will','divine-veracity','divine-goodness','divine-love','divine-grace','divine-holiness','divine-righteousness','divine-incomprehensibility','divine-blessedness','communicable','incommunicable','names-god'] },
 { key:'pactum_salutis', name:'The Covenant of Redemption', desc:'The eternal intra-Trinitarian covenant \u2013 the architectonic foundation of all covenant theology', color:'#dcc050',
 ids:['trinity','pactum','pactum-father','pactum-son','pactum-spirit','pactum-biblical-basis','pactum-historical-development','covenant-works','covenant-grace','covenant-surety'] },
 { key:'christian_liberty', name:'Christian Liberty & Conscience', desc:'God alone is Lord of the conscience \u2013 WCF 20 and its world-historical significance', color:'#c8b468',
 ids:['christian-liberty','liberty-conscience-wcf20-1-2','liberty-not-license','liberty-vs-authority','liberty-historical','conscience-freedom','civil-magistrate'] },
 { key:'protology_eschatology', name:'From Garden to Glory', desc:'The protology-eschatology axis \u2013 creation oriented toward its eschatological consummation, tracing the irreversible forward movement through covenant, fall, redemption, and new creation', color:'#58c0c0',
 ids:['creation','creation-to-consummation','six-days','cultural-mandate','covenant-works','probation','humanity','original-righteousness','the-fall','sin','covenant-grace','christ','active-obedience','resurrection-eschatological-event','eschatology','two-age-model','cosmic-redemption','return-christ','resurrection-body','beatific-vision','eternal-state','consummation-covenant','marriage-supper','new-creation'] },
 { key:'piety_devotion', name:'Piety, Prayer & the Christian Life', desc:'The formation of the believer \u2013 from the chief end of man through prayer, family worship, catechesis, and the singing of praise', color:'#d4a874',
 ids:['christian-life','chief-end','piety-knowledge','prayer-theology','trinitarian-prayer','family-worship','catechetical-instruction','meditation-scripture','singing-praise','theology-psalter','theology-suffering','spiritual-desertion','lament-faithful-response','worship','regulative-principle','sabbath-lords-day','means-grace','preaching-word','prayer-means','lords-prayer'] },
 { key:'modern_polemics', name:'Defending Against Modern Errors', desc:'The Reformed response to Enlightenment liberalism, higher criticism, naturalism, neo-orthodoxy, open theism, and contemporary departures from confessional orthodoxy', color:'#cc6655',
 ids:['polemic-modern','polemic-liberalism','polemic-higher-criticism','polemic-naturalism','polemic-neoorthodoxy','polemic-open-theism','polemic-kantianism','polemic-darwinism','polemic-npp','polemic-progressive','polemic-social-gospel','presuppositional-apologetics','inerrancy','authority-scripture'] },
 { key:'intra_reformed', name:'Intra-Reformed Debates', desc:'Live controversies within the Reformed family \u2013 republication, merit, Federal Vision, and justification refinements', color:'#cc6655',
 ids:['intra-reformed','republication-debate','merit-covenant-works','shepherd-fv','justification-intra','vantil-clark-controversy','covenant-works','mosaic-covenant','justification','law-gospel'] },
];

// ═══════════════════════════════════════════
// §3c - STUDY TIMESTAMPS (Improvement #22)
// Tracks WHEN nodes were reviewed for pulsation states.
// ═══════════════════════════════════════════
const STUDY_TS_KEY = 'stcosmos_study_timestamps';
let studyTimestamps = new Map(); // nodeId → timestamp (ms)
const REVIEW_THRESHOLD_MS = 7 * 24 * 60 * 60 * 1000; // 7 days

function loadStudyTimestamps() {
 try {
 const saved = localStorage.getItem(STUDY_TS_KEY);
 if (saved) {
 const arr = JSON.parse(saved);
 studyTimestamps = new Map(arr);
 }
 } catch(e) { /* ignore */ }
}
function saveStudyTimestamps() {
 try { localStorage.setItem(STUDY_TS_KEY, JSON.stringify([...studyTimestamps])); } catch(e) { /* ignore */ }
}
function getNodeLearningState(nodeId) {
 const ts = studyTimestamps.get(nodeId);
 if (!ts) return 'unstudied';
 const age = Date.now() - ts;
 if (age > REVIEW_THRESHOLD_MS) return 'review-due';
 return 'connected'; // recently studied
}

// ═══════════════════════════════════════════
// §4 - DATA INDEX (build flat lookup maps)
// ═══════════════════════════════════════════
const nodeIndex = new Map(); // id → { ...data, type, parentId }
const allNodeIds = [];

const nameToIdIndex = new Map(); // name → id (reverse index for O(1) lookups)

function buildDataIndex() {
 LOCI.forEach(locus => {
 nodeIndex.set(locus.id, { ...locus, type: 'locus', parentId: null });
 allNodeIds.push(locus.id);
 nameToIdIndex.set(locus.n, locus.id);
 // Also index the plain-text version for aria-label reverse lookups
 const plainName = stripHtml(locus.n);
 if (plainName !== locus.n) nameToIdIndex.set(plainName, locus.id);
 if (locus.s) {
 locus.s.forEach(sub => {
 nodeIndex.set(sub.id, { ...sub, type: 'sub', parentId: locus.id, c: locus.c });
 allNodeIds.push(sub.id);
 nameToIdIndex.set(sub.n, sub.id);
 const plainSubName = stripHtml(sub.n);
 if (plainSubName !== sub.n) nameToIdIndex.set(plainSubName, sub.id);
 });
 }
 });
}

// ═══════════════════════════════════════════
// §4b - IMPLICIT RELATED TOPICS ENGINE
// Computes connections the author didn't explicitly encode
// via keyword overlap, shared scripture refs, and category proximity.
// ═══════════════════════════════════════════
const relatedTopicsCache = new Map(); // id → [{ id, score, reasons[] }]

function buildRelatedTopicsIndex() {
 // ── INVERTED INDEX approach: O(n*k) instead of O(n²) ──
 // Build inverted maps: keyword → Set<id>, scriptureRef → Set<id>
 // Then for each node, gather candidates from its keywords/refs
 const scriptureToIds = new Map(); // normalizedRef → Set<id>
 const keywordToIds = new Map(); // keyword → Set<id>
 const scriptureMap = new Map(); // id → Set<normalizedRef>
 const keywordMap = new Map(); // id → Set<keyword>

 nodeIndex.forEach((data, id) => {
 // Extract and normalize scripture references
 const refs = extractScriptureRefs(data.d || '');
 const normalizedRefs = new Set();
 refs.forEach(ref => {
 const m = ref.match(/^(\d?\s*[A-Za-z]+\.?)\s*(\d+)/);
 if (m) {
 const norm = (m[1].trim() + ' ' + m[2]).toLowerCase().replace(/\./g, '');
 normalizedRefs.add(norm);
 if (!scriptureToIds.has(norm)) scriptureToIds.set(norm, new Set());
 scriptureToIds.get(norm).add(id);
 }
 });
 scriptureMap.set(id, normalizedRefs);

 // Build keyword set
 const kws = new Set();
 (data.k || []).forEach(k => {
 const kl = k.toLowerCase();
 kws.add(kl);
 if (!keywordToIds.has(kl)) keywordToIds.set(kl, new Set());
 keywordToIds.get(kl).add(id);
 });
 keywordMap.set(id, kws);
 });

 // For each node, gather candidates via inverted index
 nodeIndex.forEach((dataA, idA) => {
 const explicitCl = new Set(dataA.cl || []);
 const parentA = dataA.parentId;
 const childrenA = new Set();
 if (dataA.s) dataA.s.forEach(sub => childrenA.add(sub.id));

 // Candidate scoring map: idB → { score, reasons }
 const candidateMap = new Map();

 const kwA = keywordMap.get(idA);
 const refsA = scriptureMap.get(idA);

 // Gather candidates from keyword overlap
 if (kwA) {
 kwA.forEach(k => {
 const ids = keywordToIds.get(k);
 if (!ids) return;
 ids.forEach(idB => {
 if (idB === idA) return;
 if (!candidateMap.has(idB)) candidateMap.set(idB, { score: 0, kwOverlap: 0, refOverlap: 0, reasons: [] });
 candidateMap.get(idB).kwOverlap++;
 });
 });
 }

 // Gather candidates from scripture overlap
 if (refsA) {
 refsA.forEach(r => {
 const ids = scriptureToIds.get(r);
 if (!ids) return;
 ids.forEach(idB => {
 if (idB === idA) return;
 if (!candidateMap.has(idB)) candidateMap.set(idB, { score: 0, kwOverlap: 0, refOverlap: 0, reasons: [] });
 candidateMap.get(idB).refOverlap++;
 });
 });
 }

 // Score candidates
 const results = [];
 candidateMap.forEach((cand, idB) => {
 const dataB = nodeIndex.get(idB);
 if (!dataB) return;
 // Skip explicit cross-refs, parent/child, siblings
 if (explicitCl.has(idB)) return;
 if (dataB.parentId === idA || parentA === idB) return;
 if (dataA.parentId && dataA.parentId === dataB.parentId) return;

 let score = 0;
 const reasons = [];

 if (cand.kwOverlap >= 2) {
 score += cand.kwOverlap * 12;
 reasons.push(cand.kwOverlap + ' shared keywords');
 } else if (cand.kwOverlap === 1) {
 score += 5;
 }

 if (cand.refOverlap >= 2) {
 score += cand.refOverlap * 8;
 reasons.push(cand.refOverlap + ' shared scriptures');
 } else if (cand.refOverlap === 1) {
 score += 3;
 }

 if (dataA.ct === dataB.ct) {
 score += 4;
 if (reasons.length > 0) reasons.push('same category');
 }

 // Description keyword co-occurrence (only for already-scored candidates)
 if (score > 0 && dataA.d && dataB.d) {
 const descB = dataB.d.toLowerCase();
 let descHits = 0;
 if (kwA) {
 kwA.forEach(k => {
 if (k.length > 4 && descB.includes(k)) descHits++;
 });
 }
 if (descHits >= 2) score += descHits * 2;
 }

 if (score >= 15 && reasons.length > 0) {
 results.push({ id: idB, score, reasons });
 }
 });

 results.sort((a, b) => b.score - a.score);
 relatedTopicsCache.set(idA, results.slice(0, 5));
 });
}

// ═══════════════════════════════════════════
// §5 - PROGRESS TRACKER (localStorage)
// ═══════════════════════════════════════════
const STORAGE_KEY = 'sysTheology_studied';
let studiedNodes = new Set();

function loadProgress() {
 try {
 const saved = localStorage.getItem(STORAGE_KEY);
 if (saved) studiedNodes = new Set(JSON.parse(saved));
 } catch(e) { /* ignore */ }
 loadStudyTimestamps();
 // Backfill timestamps for nodes that were reviewed before timestamps existed
 studiedNodes.forEach(id => {
 if (!studyTimestamps.has(id)) studyTimestamps.set(id, Date.now() - REVIEW_THRESHOLD_MS - 1);
 });
 if (studyTimestamps.size > 0) saveStudyTimestamps();
}
function saveProgress() {
 try { localStorage.setItem(STORAGE_KEY, JSON.stringify([...studiedNodes])); } catch(e) { /* ignore */ }
}
function resetProgress() {
 if (!confirm('Reset all review progress to 0?')) return;
 studiedNodes.clear();
 studyTimestamps.clear();
 saveProgress();
 saveStudyTimestamps();
 updateProgressBadge();
 pulseProgressBadge();
 // Update panel toggle if open
 const toggle = document.getElementById('panel-study-toggle');
 if (toggle) {
 toggle.classList.remove('studied');
 toggle.setAttribute('aria-pressed', 'false');
 toggle.innerHTML = '<span class="check-icon" aria-hidden="true">\u2610</span> Mark as reviewed';
 }
 ActiveEngine.markDirty();
}
function toggleStudied(nodeId) {
 if (studiedNodes.has(nodeId)) {
 studiedNodes.delete(nodeId);
 studyTimestamps.delete(nodeId);
 } else {
 studiedNodes.add(nodeId);
 studyTimestamps.set(nodeId, Date.now());
 }
 saveProgress();
 saveStudyTimestamps();
 updateProgressBadge();
 _updatePulsationFlag();
 ActiveEngine.markDirty();
}

/** Recalculate whether any nodes need pulsating animation */
function _updatePulsationFlag() {
 if (!threeInitialized) return;
 let hasReview = false;
 for (const id of studiedNodes) {
 if (getNodeLearningState(id) === 'review-due') { hasReview = true; break; }
 }
 ThreeEngine._hasReviewDueNodes = hasReview;
}

/**
 * Micro-interaction for the review toggle.
 * Animates the button in-place: checkmark morph, confetti burst, glow pulse.
 * Updates connection list reviewed badges and graph node without re-rendering the panel.
 */
function animateStudiedToggle(btn, nodeId, isNowStudied) {
 // ── 1. Update button content in-place ──
 btn.classList.remove('studying-in', 'studying-out');
 // Force reflow so re-adding the class re-triggers animation
 void btn.offsetWidth;

 const animClass = isNowStudied ? 'studying-in' : 'studying-out';
 btn.classList.add(animClass);
 btn.className = 'panel-study-toggle ' + animClass + (isNowStudied ? ' studied' : '');
 btn.setAttribute('aria-pressed', isNowStudied ? 'true' : 'false');
 btn.innerHTML = isNowStudied
 ? '<span class="check-icon" aria-hidden="true">✓</span> Reviewed'
 : '<span class="check-icon" aria-hidden="true">☐</span> Mark as reviewed';

 // Clean up animation class after it finishes
 setTimeout(() => btn.classList.remove(animClass), 750);

 // ── 2. Confetti particles (only on marking reviewed) ──
 if (isNowStudied) {
 spawnConfetti(btn);
 }

 // ── 3. Update connection list studied badges in-place ──
 updateConnectionStudiedBadges();

 // ── 4. Pulse the progress badge ──
 pulseProgressBadge();
}

/** Spawn confetti particles bursting from the button */
function spawnConfetti(btn) {
 // ── Skip confetti on low-end devices for performance ──
 if (!DeviceCapabilities.quality.enableConfetti) return;
 const colors = ['var(--gold)', 'var(--gold-dim)', '#f0d878', '#d4b44c', '#c8a840', '#e8d070'];
 const count = DeviceCapabilities.isMobile ? 6 : 10; // fewer particles on mobile
 const rect = btn.getBoundingClientRect();
 const panelInner = btn.closest('.panel-inner') || btn.parentElement;
 const parentRect = panelInner.getBoundingClientRect();

 for (let i = 0; i < count; i++) {
 const particle = document.createElement('div');
 particle.className = 'studied-confetti';

 // Position at center of button relative to panel-inner
 const cx = (rect.left + rect.width / 2) - parentRect.left;
 const cy = (rect.top + rect.height / 2) - parentRect.top;
 particle.style.left = cx + 'px';
 particle.style.top = cy + 'px';

 // Random burst direction
 const angle = (Math.PI * 2 * i / count) + (Math.random() - 0.5) * 0.6;
 const dist = 28 + Math.random() * 32;
 const dx = Math.cos(angle) * dist;
 const dy = Math.sin(angle) * dist - 12; // bias upward
 particle.style.setProperty('--confetti-end', `translate(${dx}px, ${dy}px)`);

 // Random size and shape
 const size = 3 + Math.random() * 3;
 particle.style.width = size + 'px';
 particle.style.height = size + 'px';
 particle.style.borderRadius = Math.random() > 0.5 ? '50%' : '1px';
 particle.style.background = colors[Math.floor(Math.random() * colors.length)];
 particle.style.animationDuration = (0.5 + Math.random() * 0.3) + 's';

 panelInner.style.position = 'relative';
 panelInner.appendChild(particle);

 // Remove after animation
 setTimeout(() => particle.remove(), 900);
 }
}

/** Update ✓ badges on connection items without rebuilding the list */
function updateConnectionStudiedBadges() {
 // Sub-topics list
 document.querySelectorAll('#subtopics-list .connection-item').forEach(item => {
 const label = item.getAttribute('aria-label') || '';
 const nodeName = label.replace(' (reviewed)', '');
 const badge = item.querySelector('.connection-studied');

 // O(1) lookup via reverse index
 const itemNodeId = nameToIdIndex.get(nodeName) || null;

 if (itemNodeId && studiedNodes.has(itemNodeId)) {
 item.setAttribute('aria-label', nodeName + ' (reviewed)');
 if (!badge) {
 const s = document.createElement('div');
 s.className = 'connection-studied';
 s.textContent = '✓';
 s.setAttribute('aria-hidden', 'true');
 item.appendChild(s);
 }
 } else {
 item.setAttribute('aria-label', nodeName);
 if (badge) badge.remove();
 }
 });

 // Cross-references list
 document.querySelectorAll('#crossrefs-list .connection-item').forEach(item => {
 const label = item.getAttribute('aria-label') || '';
 const nodeName = label.replace(', cross-reference', '').replace(' (reviewed)', '');
 const badge = item.querySelector('.connection-studied');

 const itemNodeId = nameToIdIndex.get(nodeName) || null;

 if (itemNodeId && studiedNodes.has(itemNodeId)) {
 item.setAttribute('aria-label', nodeName + ', cross-reference (reviewed)');
 if (!badge) {
 const s = document.createElement('div');
 s.className = 'connection-studied';
 s.textContent = '✓';
 s.setAttribute('aria-hidden', 'true');
 item.appendChild(s);
 }
 } else {
 item.setAttribute('aria-label', nodeName + ', cross-reference');
 if (badge) badge.remove();
 }
 });
}

/** Subtle pulse on the progress badge to confirm the count changed */
function pulseProgressBadge() {
 const badge = document.getElementById('progress-badge');
 if (!badge) return;
 badge.style.transition = 'transform 0.3s var(--ease-spring), color 0.3s';
 badge.style.transform = 'scale(1.15)';
 badge.style.color = 'var(--gold)';
 setTimeout(() => {
 badge.style.transform = 'scale(1)';
 badge.style.color = '';
 }, 350);
}
function updateProgressBadge() {
 const badge = document.getElementById('progress-badge');
 badge.textContent = `${studiedNodes.size} / ${allNodeIds.length} entries visited`;
}

// ═══════════════════════════════════════════
// §6 - SEARCH ENGINE
// ═══════════════════════════════════════════
function extractScriptureRefs(text) {
 const pattern = /(\d?\s?[A-Z][a-z]+\.?\s+\d+(?::\d+(?:[–-]\d+)?)?(?:,\s*\d+(?::\d+(?:[–-]\d+)?)?)*)/g;
 const allMatches = (text.match(pattern) || []).map(r => r.trim());
 // Filter out any confessional-looking refs that might slip through
 return allMatches.filter(r => !/^(?:WCF|WLC|WSC)\b/i.test(r));
}

// ── Confessional Standards Extraction ──
// Captures WCF, WLC, WSC references (e.g., "WCF 8.5", "WLC Q101", "WSC Q1")
// These are <i>norma normata</i> and must be displayed separately from Scripture (<i>norma normans</i>).
function extractConfessionalRefs(text) {
 const pattern = /\b((?:WCF|WLC|WSC)\s+Q?\d+(?:\.\d+)?(?:\s*[,–-]\s*Q?\d+(?:\.\d+)?)*)/g;
 const matches = [];
 let m;
 while ((m = pattern.exec(text)) !== null) {
 matches.push(m[1].trim());
 }
 // Deduplicate
 return [...new Set(matches)];
}

// Extract the first sentence for the summary view.
// Handles parenthetical scripture references like "(Gen 2:7; WCF 4.2)."
function extractFirstSentence(text) {
 if (!text) return '';
 // Match a period followed by a space (or end), but not inside parentheses
 // Strategy: walk character by character, track paren depth
 let depth = 0;
 for (let i = 0; i < text.length; i++) {
 if (text[i] === '(') depth++;
 else if (text[i] === ')') depth = Math.max(0, depth - 1);
 else if (text[i] === '.' && depth === 0) {
 // Check it's a sentence-ending period: followed by space, paren-close+space, or end
 const after = text[i + 1];
 if (!after || after === ' ' || after === '\n') {
 return text.substring(0, i + 1).trim();
 }
 }
 }
 // Fallback: if no clean sentence break, return first ~120 chars with ellipsis
 if (text.length > 140) {
 const cut = text.lastIndexOf(' ', 130);
 return text.substring(0, cut > 60 ? cut : 130) + '…';
 }
 return text;
}

function fuzzyMatch(query, text) {
 query = query.toLowerCase();
 text = text.toLowerCase();
 if (text.includes(query)) return 1.0;
 // Simple prefix match
 const words = text.split(/\s+/);
 for (const word of words) {
 if (word.startsWith(query)) return 0.8;
 }
 // Levenshtein for short queries
 if (query.length <= 12) {
 for (const word of words) {
 const dist = levenshtein(query, word.substring(0, query.length + 2));
 if (dist <= Math.max(1, Math.floor(query.length / 4))) return 0.6;
 }
 }
 return 0;
}

function levenshtein(a, b) {
 return levenshteinPooled(a, b);
}

function searchNodes(query) {
 if (!query || query.length < 2) return [];
 const q = query.toLowerCase().trim();
 const results = [];

 nodeIndex.forEach((data, id) => {
 let score = 0;
 const name = data.n || '';
 const desc = data.d || '';
 const keywords = (data.k || []).join(' ');

 // Title match (highest weight)
 const titleScore = fuzzyMatch(q, name);
 if (titleScore > 0) score += titleScore * 100;

 // Keyword match
 const kwScore = fuzzyMatch(q, keywords);
 if (kwScore > 0) score += kwScore * 40;

 // Description match
 if (desc.toLowerCase().includes(q)) score += 20;

 // Scripture reference match
 if (desc.toLowerCase().includes(q.replace(/\s+/g, ' '))) score += 15;

 // Boost loci over subtopics
 if (data.type === 'locus') score *= 1.3;

 if (score > 0) {
 results.push({ id, data, score });
 }
 });

 results.sort((a, b) => b.score - a.score);
 return results.slice(0, 12);
}

// ═══════════════════════════════════════════
// §6b - SPATIAL INDEX (Octree + Adjacency)
// Accelerates raycasting from O(n) to O(log n),
// connection lookups from O(e) to O(1),
// and enables frustum culling for 200+ nodes.
// ═══════════════════════════════════════════

/**
 * Octree - Loose octree for 3D spatial queries.
 *
 * Design choices:
 * - "Loose" factor of 1.5× so spheres that straddle boundaries aren't
 * duplicated across children - each node lives in exactly one octant.
 * - Max depth of 8 prevents degenerate subdivision on clustered data.
 * - Leaf capacity of 8 balances tree depth vs. brute-force at leaves.
 * - Statically built after layout (nodes don't move), so no rebalancing.
 *
 * Public API:
 * build(items) - items: [{ pos: Vector3, radius: number, id, mesh, ... }]
 * raycast(origin, dir, maxDist) → sorted [{item, dist}]
 * queryFrustum(frustum) → [item, ...] (items inside camera frustum)
 * querySphere(center, r) → [item, ...] (items within radius)
 */
class Octree {
 constructor() {
 this.root = null;
 this._resultPool = []; // reusable results array
 this._vec = null; // lazy - set once THREE is loaded
 }

 build(items) {
 if (!items.length) return;
 if (!this._vec) this._vec = new THREE.Vector3();

 // Compute tight AABB around all item bounding spheres
 let minX = Infinity, minY = Infinity, minZ = Infinity;
 let maxX = -Infinity, maxY = -Infinity, maxZ = -Infinity;
 for (let i = 0; i < items.length; i++) {
 const p = items[i].pos, r = items[i].radius || 0;
 if (p.x - r < minX) minX = p.x - r;
 if (p.y - r < minY) minY = p.y - r;
 if (p.z - r < minZ) minZ = p.z - r;
 if (p.x + r > maxX) maxX = p.x + r;
 if (p.y + r > maxY) maxY = p.y + r;
 if (p.z + r > maxZ) maxZ = p.z + r;
 }

 // Pad to cube (octree requires cubic bounds)
 const cx = (minX + maxX) / 2, cy = (minY + maxY) / 2, cz = (minZ + maxZ) / 2;
 const halfSize = Math.max(maxX - minX, maxY - minY, maxZ - minZ) / 2 + 1;

 this.root = this._createNode(cx, cy, cz, halfSize);
 for (let i = 0; i < items.length; i++) {
 this._insert(this.root, items[i], 0);
 }
 }

 _createNode(cx, cy, cz, half) {
 return { cx, cy, cz, half, items: [], children: null };
 }

 _insert(node, item, depth) {
 // If leaf and under capacity, or at max depth, store here
 if (!node.children && (node.items.length < 8 || depth >= 8)) {
 node.items.push(item);
 return;
 }
 // Subdivide if not already
 if (!node.children) {
 node.children = new Array(8);
 const h2 = node.half / 2;
 for (let i = 0; i < 8; i++) {
 node.children[i] = this._createNode(
 node.cx + ((i & 1) ? h2 : -h2),
 node.cy + ((i & 2) ? h2 : -h2),
 node.cz + ((i & 4) ? h2 : -h2),
 h2
 );
 }
 // Re-insert existing items
 const existing = node.items;
 node.items = [];
 for (let i = 0; i < existing.length; i++) {
 this._insert(node, existing[i], depth);
 }
 }
 // Find best-fit octant (by center position)
 const octant = this._octantFor(node, item.pos);
 this._insert(node.children[octant], item, depth + 1);
 }

 _octantFor(node, pos) {
 return (pos.x > node.cx ? 1 : 0)
 | (pos.y > node.cy ? 2 : 0)
 | (pos.z > node.cz ? 4 : 0);
 }

 /**
 * Raycast - find items whose bounding spheres intersect the ray.
 * Returns array of {item, dist} sorted by distance.
 * Uses ray-AABB slab test to prune entire octants.
 */
 raycast(origin, direction, maxDist = Infinity) {
 const results = this._resultPool;
 results.length = 0;
 if (!this.root) return results;

 // Precompute inverse direction for slab test
 const invDx = direction.x !== 0 ? 1 / direction.x : 1e12;
 const invDy = direction.y !== 0 ? 1 / direction.y : 1e12;
 const invDz = direction.z !== 0 ? 1 / direction.z : 1e12;

 this._raycastNode(this.root, origin, direction, invDx, invDy, invDz, maxDist, results);
 results.sort((a, b) => a.dist - b.dist);
 return results;
 }

 _raycastNode(node, origin, dir, invDx, invDy, invDz, maxDist, results) {
 // Ray-AABB slab intersection (with loose factor 1.5×)
 const looseHalf = node.half * 1.5;
 const t1x = (node.cx - looseHalf - origin.x) * invDx;
 const t2x = (node.cx + looseHalf - origin.x) * invDx;
 const t1y = (node.cy - looseHalf - origin.y) * invDy;
 const t2y = (node.cy + looseHalf - origin.y) * invDy;
 const t1z = (node.cz - looseHalf - origin.z) * invDz;
 const t2z = (node.cz + looseHalf - origin.z) * invDz;

 const tmin = Math.max(Math.min(t1x, t2x), Math.min(t1y, t2y), Math.min(t1z, t2z));
 const tmax = Math.min(Math.max(t1x, t2x), Math.max(t1y, t2y), Math.max(t1z, t2z));

 if (tmax < 0 || tmin > tmax || tmin > maxDist) return;

 // Test items at this node
 for (let i = 0; i < node.items.length; i++) {
 const item = node.items[i];
 // Minimum hit radius of 0.9 ensures small sub-topic nodes are hoverable/clickable
 const visualR = item.radius * item.mesh.scale.x;
 const hitR = Math.max(visualR, 0.9);
 const d = this._raySphereIntersect(origin, dir, item.pos, hitR);
 if (d >= 0 && d <= maxDist) {
 results.push({ item, dist: d });
 }
 }

 // Recurse children
 if (node.children) {
 for (let i = 0; i < 8; i++) {
 this._raycastNode(node.children[i], origin, dir, invDx, invDy, invDz, maxDist, results);
 }
 }
 }

 /**
 * Ray-sphere intersection. Returns distance or -1 if no hit.
 * Analytic solution - no allocations.
 */
 _raySphereIntersect(origin, dir, center, radius) {
 const ocX = origin.x - center.x;
 const ocY = origin.y - center.y;
 const ocZ = origin.z - center.z;
 const b = ocX * dir.x + ocY * dir.y + ocZ * dir.z;
 const c = ocX * ocX + ocY * ocY + ocZ * ocZ - radius * radius;
 const disc = b * b - c;
 if (disc < 0) return -1;
 const sqrtDisc = Math.sqrt(disc);
 const t0 = -b - sqrtDisc;
 const t1 = -b + sqrtDisc;
 if (t1 < 0) return -1;
 return t0 >= 0 ? t0 : t1;
 }

 /**
 * Frustum query - returns all items inside the camera frustum.
 * Used for culling node updates to only visible nodes.
 */
 queryFrustum(frustum) {
 const results = [];
 if (!this.root) return results;
 this._frustumNode(this.root, frustum, results);
 return results;
 }

 _frustumNode(node, frustum, results) {
 // Test AABB against frustum (conservative - uses loose bounds)
 const looseHalf = node.half * 1.5;
 const box = Octree._tmpBox;
 box.min.set(node.cx - looseHalf, node.cy - looseHalf, node.cz - looseHalf);
 box.max.set(node.cx + looseHalf, node.cy + looseHalf, node.cz + looseHalf);
 if (!frustum.intersectsBox(box)) return;

 for (let i = 0; i < node.items.length; i++) {
 const item = node.items[i];
 Octree._tmpSphere.center.copy(item.pos);
 Octree._tmpSphere.radius = item.radius * 2; // generous
 if (frustum.intersectsSphere(Octree._tmpSphere)) {
 results.push(item);
 }
 }

 if (node.children) {
 for (let i = 0; i < 8; i++) {
 this._frustumNode(node.children[i], frustum, results);
 }
 }
 }

 /**
 * Sphere query - all items within distance r of center.
 * Useful for proximity-based LOD or click tolerance.
 */
 querySphere(center, r) {
 const results = [];
 if (!this.root) return results;
 this._sphereNode(this.root, center, r, r * r, results);
 return results;
 }

 _sphereNode(node, center, r, r2, results) {
 // Quick reject: sphere vs AABB
 const looseHalf = node.half * 1.5;
 const dx = Math.max(0, Math.abs(center.x - node.cx) - looseHalf);
 const dy = Math.max(0, Math.abs(center.y - node.cy) - looseHalf);
 const dz = Math.max(0, Math.abs(center.z - node.cz) - looseHalf);
 if (dx * dx + dy * dy + dz * dz > r2) return;

 for (let i = 0; i < node.items.length; i++) {
 const item = node.items[i];
 const distSq = (center.x - item.pos.x) ** 2
 + (center.y - item.pos.y) ** 2
 + (center.z - item.pos.z) ** 2;
 if (distSq <= (r + item.radius) ** 2) {
 results.push(item);
 }
 }

 if (node.children) {
 for (let i = 0; i < 8; i++) {
 this._sphereNode(node.children[i], center, r, r2, results);
 }
 }
 }
}

// Shared temp objects (avoids per-call allocation)
Octree._tmpBox = null; // set after THREE loads
Octree._tmpSphere = null;

/**
 * EdgeAdjacency - O(1) neighbor lookups for edge highlighting.
 * Replaces linear scans of the edge array on every hover.
 *
 * adjacency.get(nodeId) → Set<nodeId> (all connected nodes)
 * edgesByNode.get(nodeId) → [edgeIndex] (indices into edge array)
 */
class EdgeAdjacency {
 constructor() {
 this.neighbors = new Map(); // nodeId → Set<nodeId>
 this.edgesByNode = new Map(); // nodeId → [edgeIdx]
 }

 build(edges) {
 this.neighbors.clear();
 this.edgesByNode.clear();

 for (let i = 0; i < edges.length; i++) {
 const e = edges[i];
 // neighbors
 if (!this.neighbors.has(e.from)) this.neighbors.set(e.from, new Set());
 if (!this.neighbors.has(e.to)) this.neighbors.set(e.to, new Set());
 this.neighbors.get(e.from).add(e.to);
 this.neighbors.get(e.to).add(e.from);
 // edge indices
 if (!this.edgesByNode.has(e.from)) this.edgesByNode.set(e.from, []);
 if (!this.edgesByNode.has(e.to)) this.edgesByNode.set(e.to, []);
 this.edgesByNode.get(e.from).push(i);
 this.edgesByNode.get(e.to).push(i);
 }
 }

 /** All nodes connected to nodeId (O(1) lookup) */
 getConnected(nodeId) {
 const set = this.neighbors.get(nodeId);
 if (!set) return _emptySet;
 return set;
 }

 /** Build the full "highlight set" for a node: itself + all neighbors */
 getHighlightSet(nodeId) {
 const result = new Set();
 result.add(nodeId);
 const nbrs = this.neighbors.get(nodeId);
 if (nbrs) nbrs.forEach(n => result.add(n));
 return result;
 }
}

// Shared empty set for missing lookups (used by EdgeAdjacency and Octree)
const _emptySet = Object.freeze(new Set());

// ═══════════════════════════════════════════
// §7 - 3D ENGINE (Three.js)
// Fixed layout, no auto-orbit, depth-fading,
// billboarded labels, proper click detection.
// Spatial indexing via Octree + EdgeAdjacency.
// ═══════════════════════════════════════════
const ThreeEngine = {
 scene: null, camera: null, renderer: null,
 container: null, width: 0, height: 0,
 nodes: [], edges: [], nodeMap: new Map(),
 meshToId: new Map(),
 raycaster: null, pointer: null,
 hoveredNodeId: null, selectedNodeId: null,
 filterCategory: null,
 isDragging: false, dragStart: {x:0,y:0}, dragDist: 0,
 _activePointerId: null, // Track which pointer owns the drag
 _lastPointer: null, // Track previous pointer position for delta calculation
 // Orbit state (with idle auto-rotation)
 spherical: { theta: Math.PI*0.35, phi: Math.PI*0.22, radius: 57 },
 targetSpherical: { theta: Math.PI*0.35, phi: Math.PI*0.22, radius: 57 },
 // Auto-rotation state
 _autoRotate: true,
 _autoRotateSpeed: 0.055, // radians per second
 _autoRotateResumeTimer: null,
 orbitTarget: null,
 targetOrbitTarget: null,
 lastPointerScreen: {x:0,y:0},
 pinchStartDist: 0, pinchStartR: 55,
 // Shared assets
 glowTex: null, sharedGeo: null, sharedSubGeo: null,
 edgeMesh: null, glowSprites: [],
 labelSprites: [],
 // ── Improvement #21: Arrow cone meshes for directed edges ──
 arrowMeshes: [], // { mesh, fromId, toId, edgeIdx }
 arrowGroup: null, // THREE.Group container
 sharedArrowGeo: null, // shared ConeGeometry
 // ── Improvement #23: Flythrough state ──
 flythrough: {
 active: false, paused: false,
 pathIds: [], currentIdx: 0, progress: 0,
 dwellTime: 5, transitionTime: 2.5,
 pathName: '', pathColor: '#e0c050',
 nodeSet: null, // Set of all path node IDs for muting
 focusId: null, // Currently focused node ID
 prevFocusId: null, // Previous focus (for transition edge animation)
 transitionEdgeAlpha: 0, // 0→1 during transitions for the connecting edge
 arrivalGlow: 0, // Bloom burst on node arrival
 },
 animFrame: null, time: 0, clock: null,
 // ── Visibility & dirty-state animation control ──
 _paused: false, // true when tab is hidden
 _dirty: true, // true when scene needs re-rendering
 _dirtyFrames: 0, // count down extra frames after last change (settle lerps)
 _settleFrames: DeviceCapabilities.quality.settleFrames,
 _lastFilterCategory: null,
 _lastSelectedNodeId: null,
 _lastHoveredNodeId: null,
 _lastFlythroughFocusId: null,
 // ── Spatial indexing ──
 octree: new Octree(),
 adjacency: new EdgeAdjacency(),
 _frustum: null, // THREE.Frustum - lazy init
 _frustumMatrix: null, // THREE.Matrix4 - lazy init
 _rayOrigin: null, // THREE.Vector3 - reusable
 _rayDir: null, // THREE.Vector3 - reusable
 _hoverConnsCache: null, // cached Set for current highlight
 _hoverConnsCacheId: null, // which nodeId the cache is for
 _hoverThrottleFrame: 0, // skip hover raycast on odd frames
 _hasReviewDueNodes: false, // true only when review-due pulsation is needed
 _projVec: null, // reusable Vector3 for projection (avoid clone())
 _lerpVec: null, // reusable Vector3 for lerp in flythrough
 // ── Living Cosmos: Neural pulse & spark state ──
 _edgeBaseColors: null, // Float32Array: sphere-gradient base RGB per vertex
 _edgeMidDist: null, // Float32Array: distance from origin per edge midpoint (for spatial phase)
 _edgeMidDistA: null, // Float32Array: distance from origin per edge vertex A
 _edgeMidDistB: null, // Float32Array: distance from origin per edge vertex B
 _pulseWaves: [], // [{radius, speed, intensity}] - radial wavefronts from Christ
 _lastPulseSpawn: 0,
 _sparks: [], // [{edgeIdx, intensity, decay}] - stochastic neural firings
 _sparkAccum: 0, // time accumulator for spark spawning

 init() {
 // ── r152+ Color Management ──
 // Enable proper sRGB color management for vibrant, accurate colors.
 // With r170, ColorManagement + SRGBColorSpace produces correct, vivid output.
 THREE.ColorManagement.enabled = true;

 // Deferred THREE.Vector3 initialization (safe - only called when THREE is confirmed available)
 if (!this.orbitTarget) this.orbitTarget = new THREE.Vector3(0,0,0);
 if (!this.targetOrbitTarget) this.targetOrbitTarget = new THREE.Vector3(0,0,0);

 this.container = document.getElementById('three-container');
 this.width = this.container.clientWidth;
 this.height = this.container.clientHeight;

 // Scene
 this.scene = new THREE.Scene();
 this.scene.fog = new THREE.FogExp2(0x000000, 0.004);

 // Camera
 this.camera = new THREE.PerspectiveCamera(50, this.width/this.height, 0.1, 500);
 this.updateCameraFromSpherical();

 // Renderer
 const q = DeviceCapabilities.quality;
 this.renderer = new THREE.WebGLRenderer({
 antialias: !DeviceCapabilities.isLowEnd,
 alpha: false,
 powerPreference: DeviceCapabilities.isMobile ? 'low-power' : 'high-performance',
 // ── Fail gracefully if WebGL2 not available ──
 failIfMajorPerformanceCaveat: false,
 });
 this.renderer.setSize(this.width, this.height);
 this.renderer.setPixelRatio(q.pixelRatio);
 this.renderer.setClearColor(0x000000, 1);
 // r152+ SRGBColorSpace for correct, vibrant color output
 this.renderer.outputColorSpace = THREE.SRGBColorSpace;
 this.renderer.toneMapping = THREE.NoToneMapping;
 this.container.appendChild(this.renderer.domElement);

 // Raycaster
 this.raycaster = new THREE.Raycaster();
 this.raycaster.params.Points = { threshold: 1.5 };
 this.pointer = new THREE.Vector2();

 // ── Spatial index temp objects ──
 Octree._tmpBox = new THREE.Box3();
 Octree._tmpSphere = new THREE.Sphere();
 this._frustum = new THREE.Frustum();
 this._frustumMatrix = new THREE.Matrix4();
 this._rayOrigin = new THREE.Vector3();
 this._rayDir = new THREE.Vector3();

 // Glow texture (shared, cached)
 this.glowTex = this.createGlowTexture();

 // Shared geometries (adaptive detail)
 const qGeo = DeviceCapabilities.quality;
 this.sharedGeo = new THREE.SphereGeometry(1, qGeo.sphereSegments[0], qGeo.sphereSegments[1]);
 this.sharedSubGeo = new THREE.SphereGeometry(1, qGeo.subSphereSegments[0], qGeo.subSphereSegments[1]);

 // Ambient + point lights - refined for cinematic warmth
 // Note: r155+ defaults PointLight decay to 2 (physically correct).
 // We set decay=1 to preserve the r128 visual appearance.
 this.scene.add(new THREE.AmbientLight(0x445566, 0.8));
 const keyLight = new THREE.PointLight(0xdcc15a, 1.0, 350, 1);
 keyLight.position.set(0, 35, 25);
 this.scene.add(keyLight);
 const fillLight = new THREE.PointLight(0x5588bb, 0.45, 350, 1);
 fillLight.position.set(-35, -10, -25);
 this.scene.add(fillLight);
 const rimLight = new THREE.PointLight(0x8855aa, 0.25, 280, 1);
 rimLight.position.set(25, -25, 35);
 this.scene.add(rimLight);
 // ── Pure Black Void Background ──
 this.scene.background = new THREE.Color(0x000000);

 this.buildGraph();
 // ── FIX: Regenerate label textures once web fonts are available ──
 // buildGraph creates labels with whatever font is loaded (likely Georgia fallback).
 // When Cormorant Garamond finishes loading, we re-render all labels with the correct font.
 this._scheduleFontRefresh();
 this.bindEvents();
 this.clock = new THREE.Clock();
 // ── Visibility-aware animation loop ──
 this._boundVisibility = () => this._onVisibilityChange();
 document.addEventListener('visibilitychange', this._boundVisibility);
 this.markDirty(); // kick off the first frame
 },

 createGlowTexture() {
 const c = document.createElement('canvas');
 c.width = 64; c.height = 64;
 const ctx = c.getContext('2d');
 const g = ctx.createRadialGradient(32, 32, 0, 32, 32, 32);
 g.addColorStop(0, 'rgba(255,255,255,0.7)');
 g.addColorStop(0.2, 'rgba(255,255,255,0.3)');
 g.addColorStop(0.5, 'rgba(255,255,255,0.08)');
 g.addColorStop(1, 'rgba(255,255,255,0)');
 ctx.fillStyle = g;
 ctx.fillRect(0, 0, 64, 64);
 return new THREE.CanvasTexture(c);
 },

 createLabelTexture(text, color) {
 // ── DPI-aware canvas for sharp text on Retina/HiDPI displays ──
 const dpr = Math.min(window.devicePixelRatio || 1, 2);
 const baseW = DeviceCapabilities.quality.labelCanvasWidth;
 const canvasW = Math.round(baseW * dpr);
 const canvasH = Math.round(canvasW / 8);
 const baseFontSize = Math.round(baseW / 18);
 const c = document.createElement('canvas');
 c.width = canvasW; c.height = canvasH;
 const ctx = c.getContext('2d');
 ctx.textAlign = 'center';
 ctx.textBaseline = 'middle';
 ctx.fillStyle = color || '#d8d4c8';
 ctx.globalAlpha = 1.0;
 // ── Strip HTML tags: canvas fillText renders them as literal characters ──
 let displayText = text.replace(/<[^>]*>/g, '');
 const cleanText = displayText;
 const maxLabelWidth = canvasW * 0.92;
 // ── Adaptive font sizing: try full size first, shrink if text is too long ──
 // This prevents aggressive truncation of long theological names
 let fontSize = Math.round(baseFontSize * dpr);
 const minFontSize = Math.round(fontSize * 0.6);
 // Use the best available font (Cormorant Garamond if loaded, else Georgia)
 const fontStack = 'Cormorant Garamond, Georgia, serif';
 ctx.font = fontSize + 'px ' + fontStack;
 // Step 1: Shrink font if needed to fit the full text
 while (ctx.measureText(displayText).width > maxLabelWidth && fontSize > minFontSize) {
 fontSize -= Math.round(dpr);
 ctx.font = fontSize + 'px ' + fontStack;
 }
 // Step 2: If still too long after shrinking, truncate at word boundaries
 if (ctx.measureText(displayText).width > maxLabelWidth) {
 const words = displayText.split(/\s+/);
 displayText = '';
 for (let i = 0; i < words.length; i++) {
 const candidate = displayText + (i > 0 ? ' ' : '') + words[i];
 if (ctx.measureText(candidate + '…').width > maxLabelWidth && i > 0) break;
 displayText = candidate;
 }
 if (displayText !== cleanText) displayText += '…';
 }
 ctx.fillText(displayText, canvasW / 2, canvasH / 2);
 const tex = new THREE.CanvasTexture(c);
 // ── Texture quality: sharp text at all viewing distances ──
 tex.colorSpace = THREE.SRGBColorSpace;
 if (this.renderer) {
 tex.anisotropy = Math.min(this.renderer.capabilities.getMaxAnisotropy(), 4);
 }
 tex.minFilter = THREE.LinearMipmapLinearFilter;
 tex.magFilter = THREE.LinearFilter;
 tex.generateMipmaps = true;
 return tex;
 },

 /** Schedule label texture regeneration when web fonts become available.
 * Labels are first created with whatever font the browser has (likely Georgia).
 * Once Cormorant Garamond loads, we re-render every label for crisp, correct typography. */
 _scheduleFontRefresh() {
 if (!document.fonts) return; // Font Loading API unavailable
 const targetFont = '400 16px "Cormorant Garamond"';
 // Check if already loaded
 try {
 if (document.fonts.check(targetFont)) {
 Log.log('[Labels] Cormorant Garamond already loaded. Labels are correct.');
 return;
 }
 } catch (e) { /* .check() can throw in some browsers */ }
 // Not loaded yet — wait for it, then refresh
 Log.log('[Labels] Waiting for Cormorant Garamond to load for label refresh...');
 let refreshed = false;
 const refresh = () => {
 if (refreshed) return; // prevent double-refresh
 refreshed = true;
 Log.log('[Labels] Font loaded — regenerating label textures.');
 this._refreshLabels();
 };
 document.fonts.ready.then(() => {
 document.fonts.load(targetFont).then(faces => {
 if (faces && faces.length > 0) refresh();
 else Log.log('[Labels] Cormorant Garamond unavailable — keeping fallback labels.');
 }).catch(() => {});
 });
 // Safety: don't wait forever
 setTimeout(() => {
 try {
 if (document.fonts.check(targetFont)) refresh();
 } catch (e) {}
 }, 4000);
 },

 /** Regenerate all label textures in-place (after font loads or quality change) */
 _refreshLabels() {
 for (let i = 0; i < this.labelSprites.length; i++) {
 const entry = this.labelSprites[i];
 const node = this.nodeMap.get(entry.nodeId);
 const data = nodeIndex.get(entry.nodeId);
 if (!node || !data || !entry.sprite) continue;
 // Dispose old texture to free GPU memory
 if (entry.sprite.material.map) {
 entry.sprite.material.map.dispose();
 }
 // Create fresh texture with the now-loaded font
 const newTex = this.createLabelTexture(data.n, data.c);
 entry.sprite.material.map = newTex;
 entry.sprite.material.needsUpdate = true;
 }
 this.markDirty();
 },

 buildGraph() {
 try {
 this._buildGraphInner();
 } catch (err) {
 Log.error('[ThreeEngine] buildGraph failed:', err);
 throw err; // re-throw so init()'s caller can handle it
 }
 },

 _buildGraphInner() {
 const lociCount = LOCI.length;
 let outerIdx = 0;

 // Layout: Christ at origin, loci on a hemisphere surface
 LOCI.forEach((locus) => {
 const isCenter = locus.o === 0;
 let px, py, pz;
 if (isCenter) {
 px = 0; py = 0; pz = 0;
 } else {
 // Fibonacci hemisphere distribution for even spacing
 const n = lociCount - 1;
 const golden = (1 + Math.sqrt(5)) / 2;
 const theta = 2 * Math.PI * outerIdx / golden;
 const phi = Math.acos(1 - (outerIdx + 0.5) / n);
 const r = 18 + locus.r * 4;
 px = r * Math.sin(phi) * Math.cos(theta);
 py = r * Math.cos(phi) * 0.75 + (locus.r - 1.3) * 2.5;
 pz = r * Math.sin(phi) * Math.sin(theta);
 outerIdx++;
 }

 // Parse color
 const col = new THREE.Color(locus.c);
 const nodeR = isCenter ? 2.2 : 0.5 + locus.r * 0.5;

 // Mesh (shared geometry, unique material for color)
 const mat = new THREE.MeshLambertMaterial({
 color: col, emissive: col, emissiveIntensity: 0.55,
 transparent: true, opacity: 1.0,
 });
 const mesh = new THREE.Mesh(this.sharedGeo, mat);
 mesh.scale.setScalar(nodeR);
 mesh.position.set(px, py, pz);
 this.scene.add(mesh);
 this.meshToId.set(mesh.uuid, locus.id);

 // Glow sprite (skip on low-end devices)
 let nodeSprite = null;
 let nodeSpriteMat = { opacity: 0 };
 if (DeviceCapabilities.quality.enableGlow) {
 const spriteMat = new THREE.SpriteMaterial({
 map: this.glowTex, color: col, transparent: true,
 opacity: 0.5, blending: THREE.AdditiveBlending, depthWrite: false
 });
 const sprite = new THREE.Sprite(spriteMat);
 sprite.scale.setScalar(nodeR * 5.8);
 sprite.position.copy(mesh.position);
 this.scene.add(sprite);

 nodeSprite = sprite;
 nodeSpriteMat = spriteMat;
 }

 // Label sprite (billboarded) - respect maxLabelSprites for low-end devices
 const labelCount = this.labelSprites.length;
 let label = null;
 if (labelCount < DeviceCapabilities.quality.maxLabelSprites) {
 const labelTex = this.createLabelTexture(locus.n, locus.c);
 const labelMat = new THREE.SpriteMaterial({ map: labelTex, transparent: true, opacity: 0.85, depthTest: true, depthWrite: false });
 label = new THREE.Sprite(labelMat);
 label.scale.set(12, 1.5, 1);
 label.position.set(px, py - nodeR - 1.5, pz);
 this.scene.add(label);
 this.labelSprites.push({ sprite: label, nodeId: locus.id });
 }

 const node3d = {
 id: locus.id, mesh, sprite: nodeSprite, label, mat, spriteMat: nodeSpriteMat,
 pos: new THREE.Vector3(px, py, pz),
 basePos: new THREE.Vector3(px, py, pz),
 radius: nodeR, color: locus.c, category: locus.ct,
 type: 'locus', parentId: null,
 targetOpacity: 1.0, targetGlow: 0.62, targetLabelOpacity: 0.85,
 };
 this.nodes.push(node3d);
 this.nodeMap.set(locus.id, node3d);

 // Sub-topics clustered near parent
 if (locus.s) {
 locus.s.forEach((sub, si) => {
 const subAngle = (si / locus.s.length) * Math.PI * 2;
 const subDist = nodeR + 2.5 + Math.random() * 1;
 const sx = px + Math.cos(subAngle) * subDist;
 const sy = py + Math.sin(subAngle * 0.4) * subDist * 0.3;
 const sz = pz + Math.sin(subAngle) * subDist;

 const subCol = new THREE.Color(locus.c);
 const subMat = new THREE.MeshLambertMaterial({
 color: subCol, emissive: subCol, emissiveIntensity: 0.5,
 transparent: true, opacity: 0.9,
 });
 const subMesh = new THREE.Mesh(this.sharedSubGeo, subMat);
 subMesh.scale.setScalar(0.37);
 subMesh.position.set(sx, sy, sz);
 this.scene.add(subMesh);
 this.meshToId.set(subMesh.uuid, sub.id);

 // Sub glow (smaller) - conditional on device capability
 let subGlow = null, subGlowMat;
 if (DeviceCapabilities.quality.enableGlow) {
 subGlowMat = new THREE.SpriteMaterial({
 map: this.glowTex, color: subCol, transparent: true,
 opacity: 0.2, blending: THREE.AdditiveBlending, depthWrite: false
 });
 subGlow = new THREE.Sprite(subGlowMat);
 subGlow.scale.setScalar(2.6);
 subGlow.position.copy(subMesh.position);
 this.scene.add(subGlow);
 } else {
 subGlowMat = { opacity: 0 };
 }

 const subNode = {
 id: sub.id, mesh: subMesh, sprite: subGlow, label: null, mat: subMat, spriteMat: subGlowMat,
 pos: new THREE.Vector3(sx, sy, sz),
 basePos: new THREE.Vector3(sx, sy, sz),
 radius: 0.37, color: locus.c, category: sub.ct || locus.ct,
 type: 'sub', parentId: locus.id,
 targetOpacity: 0.9, targetGlow: 0.35, targetLabelOpacity: 0,
 };
 this.nodes.push(subNode);
 this.nodeMap.set(sub.id, subNode);

 // Parent-child edge
 this.edges.push({ from: sub.id, to: locus.id, type: 'parent' });
 });
 }
 });

 // Build ALL edges as a single LineSegments geometry (batch)
 const edgeSet = [...this.edges];
 // Add cross-reference edges with typed relationships (O(1) dedup via Set)
 const edgeKeySet = new Set();
 edgeSet.forEach(e => edgeKeySet.add(e.from < e.to ? e.from + '|' + e.to : e.to + '|' + e.from));
 LOCI.forEach(locus => {
 if (locus.cl) {
 locus.cl.forEach(tid => {
 if (this.nodeMap.has(tid)) {
 const key = locus.id < tid ? locus.id + '|' + tid : tid + '|' + locus.id;
 if (!edgeKeySet.has(key)) {
 edgeKeySet.add(key);
 edgeSet.push({ from: locus.id, to: tid, type: 'cross' });
 }
 }
 });
 }
 // ── Subtopic cross-references: capillary connections ──
 // Process optional cl: arrays on subtopics, enabling fine-grained
 // cross-sphere edges between individual doctrinal nodes.
 if (locus.s) {
 locus.s.forEach(sub => {
 if (sub.cl) {
 sub.cl.forEach(tid => {
 if (this.nodeMap.has(tid)) {
 const key = sub.id < tid ? sub.id + '|' + tid : tid + '|' + sub.id;
 if (!edgeKeySet.has(key)) {
 edgeKeySet.add(key);
 edgeSet.push({ from: sub.id, to: tid, type: 'capillary' });
 }
 }
 });
 }
 });
 }
 });
 this.edges = edgeSet;

 const edgeVerts = [];
 const edgeColors = [];
 // ── Living Constellation: sphere-gradient edge coloring ──
 // Store base RGB of each edge vertex (source/target sphere colors)
 // for use in the per-frame contextual intensity system.
 const _edgeBase = []; // flat [r1,g1,b1, r2,g2,b2, ...] per edge
 const _hexRGB = (hex) => {
 const c = hex || '#dcc15a';
 return [parseInt(c.slice(1,3),16)/255, parseInt(c.slice(3,5),16)/255, parseInt(c.slice(5,7),16)/255];
 };
 edgeSet.forEach(e => {
 const a = this.nodeMap.get(e.from);
 const b = this.nodeMap.get(e.to);
 if (!a || !b) return;
 edgeVerts.push(a.pos.x, a.pos.y, a.pos.z, b.pos.x, b.pos.y, b.pos.z);
 // Sphere-gradient: each vertex takes its node's sphere color
 const cA = _hexRGB(a.color);
 const cB = _hexRGB(b.color);
 // Initial intensity by tier
 const m = e.type === 'parent' ? 0.09 : (e.type === 'capillary' ? 0.008 : 0.025);
 edgeColors.push(cA[0]*m, cA[1]*m, cA[2]*m, cB[0]*m, cB[1]*m, cB[2]*m);
 _edgeBase.push(cA[0], cA[1], cA[2], cB[0], cB[1], cB[2]);
 });
 this._edgeBaseColors = new Float32Array(_edgeBase);
 const edgeGeo = new THREE.BufferGeometry();
 edgeGeo.setAttribute('position', new THREE.Float32BufferAttribute(edgeVerts, 3));
 edgeGeo.setAttribute('color', new THREE.Float32BufferAttribute(edgeColors, 3));
 const edgeMat = new THREE.LineBasicMaterial({
 vertexColors: true, transparent: true, opacity: 1,
 depthWrite: false, blending: THREE.AdditiveBlending
 });
 this.edgeMesh = new THREE.LineSegments(edgeGeo, edgeMat);
 this.scene.add(this.edgeMesh);

 // ── Improvement #21: Directional arrow cones for typed edges ──
 if (!DeviceCapabilities.isLowEnd) {
 this.sharedArrowGeo = new THREE.ConeGeometry(0.18, 0.5, 6);
 this.sharedArrowGeo.rotateX(Math.PI / 2); // point along +Z
 this.arrowGroup = new THREE.Group();
 const _tmpDir = new THREE.Vector3();
 const _tmpUp = new THREE.Vector3(0, 1, 0);
 const _tmpFwd = new THREE.Vector3(0, 0, 1);
 edgeSet.forEach((e, ei) => {
 if (e.type === 'parent') return;
 const a = this.nodeMap.get(e.from);
 const b = this.nodeMap.get(e.to);
 if (!a || !b) return;
 const arrowMat = new THREE.MeshBasicMaterial({
 color: b.color || '#dcc15a', transparent: true, opacity: 0.0, depthWrite: false
 });
 const arrowMesh = new THREE.Mesh(this.sharedArrowGeo, arrowMat);
 const t = 0.82;
 arrowMesh.position.lerpVectors(a.pos, b.pos, t);
 _tmpDir.subVectors(b.pos, a.pos).normalize();
 arrowMesh.quaternion.setFromUnitVectors(_tmpFwd, _tmpDir);
 arrowMesh.scale.setScalar(0.9);
 this.arrowGroup.add(arrowMesh);
 this.arrowMeshes.push({
 mesh: arrowMesh, mat: arrowMat,
 fromId: e.from, toId: e.to, edgeIdx: ei
 });
 });
 this.scene.add(this.arrowGroup);
 }

 // ── Build spatial index ──
 // The octree accelerates raycast from O(n) to O(log n).
 // Items are the node3d objects which already have pos and radius.
 this.octree.build(this.nodes);
 this.adjacency.build(this.edges);
 // ── Precompute edge spatial data for neural pulse system ──
 const numEdges = this.edges.length;
 this._edgeMidDist = new Float32Array(numEdges);
 this._edgeMidDistA = new Float32Array(numEdges);
 this._edgeMidDistB = new Float32Array(numEdges);
 for (let i = 0; i < numEdges; i++) {
 const ea = this.nodeMap.get(this.edges[i].from);
 const eb = this.nodeMap.get(this.edges[i].to);
 if (ea && eb) {
 const mx = (ea.pos.x + eb.pos.x) * 0.5;
 const my = (ea.pos.y + eb.pos.y) * 0.5;
 const mz = (ea.pos.z + eb.pos.z) * 0.5;
 this._edgeMidDist[i] = Math.sqrt(mx*mx + my*my + mz*mz);
 this._edgeMidDistA[i] = Math.sqrt(ea.pos.x*ea.pos.x + ea.pos.y*ea.pos.y + ea.pos.z*ea.pos.z);
 this._edgeMidDistB[i] = Math.sqrt(eb.pos.x*eb.pos.x + eb.pos.y*eb.pos.y + eb.pos.z*eb.pos.z);
 }
 }
 Log.log(`[Spatial] Octree built for ${this.nodes.length} nodes, adjacency for ${this.edges.length} edges`);
 },

 updateCameraFromSpherical() {
 const s = this.spherical;
 this.camera.position.set(
 s.radius * Math.sin(s.phi) * Math.sin(s.theta) + this.orbitTarget.x,
 s.radius * Math.cos(s.phi) + this.orbitTarget.y,
 s.radius * Math.sin(s.phi) * Math.cos(s.theta) + this.orbitTarget.z
 );
 this.camera.lookAt(this.orbitTarget);
 },

 bindEvents() {
 const dom = this.renderer.domElement;

 // ── Unified pointer handling (works for mouse AND touch) ──
 dom.addEventListener('pointerdown', e => {
 // Prevent multi-touch pointer conflicts
 if (this._activePointerId !== null && this._activePointerId !== e.pointerId) return;
 this._activePointerId = e.pointerId;
 dom.setPointerCapture(e.pointerId);
 this.isDragging = true;
 this._autoRotate = false;
 this.dragStart = { x: e.clientX, y: e.clientY };
 this._lastPointer = { x: e.clientX, y: e.clientY };
 this.dragDist = 0;
 dom.style.cursor = 'grabbing';
 this.markDirty();
 });

 window.addEventListener('pointermove', e => {
 const rect = dom.getBoundingClientRect();
 this.lastPointerScreen = { x: e.clientX, y: e.clientY };
 this.pointer.x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
 this.pointer.y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
 this.markDirty(10); // wake for hover raycast

 if (this.isDragging && this._activePointerId === e.pointerId) {
 const dx = e.clientX - this.dragStart.x;
 const dy = e.clientY - this.dragStart.y;
 this.dragDist = Math.hypot(dx, dy);
 // ── Use calculated delta instead of movementX/Y (more reliable on touch) ──
 const movX = e.clientX - (this._lastPointer ? this._lastPointer.x : e.clientX);
 const movY = e.clientY - (this._lastPointer ? this._lastPointer.y : e.clientY);
 this._lastPointer = { x: e.clientX, y: e.clientY };
 // ── Adaptive orbit sensitivity: touch needs more responsiveness ──
 const sensitivity = DeviceCapabilities.hasTouch ? 0.008 : 0.005;
 this.targetSpherical.theta -= movX * sensitivity;
 this.targetSpherical.phi = Math.max(0.2, Math.min(Math.PI - 0.2,
 this.targetSpherical.phi + movY * sensitivity
 ));
 }
 });

 window.addEventListener('pointerup', (e) => {
 if (this._activePointerId === e.pointerId) {
 this.isDragging = false;
 this._activePointerId = null;
 this._lastPointer = null;
 this.renderer.domElement.style.cursor = 'grab';
 // Resume auto-rotation from current position after drag
 if (!this.selectedNodeId) {
 clearTimeout(this._autoRotateResumeTimer);
 this._autoRotateResumeTimer = setTimeout(() => {
 if (!this.selectedNodeId && !this.hoveredNodeId && !this.isDragging) {
 this._autoRotate = true;
 this.markDirty();
 }
 }, 3000);
 }
 this.markDirty();
 }
 });
 window.addEventListener('pointercancel', (e) => {
 if (this._activePointerId === e.pointerId) {
 this.isDragging = false;
 this._activePointerId = null;
 this._lastPointer = null;
 this.renderer.domElement.style.cursor = 'grab';
 }
 });

 dom.addEventListener('wheel', e => {
 e.preventDefault();
 this.targetSpherical.radius = Math.max(15, Math.min(120,
 this.targetSpherical.radius + e.deltaY * 0.04
 ));
 this.markDirty();
 }, { passive: false });

 dom.addEventListener('click', e => {
 if (this.dragDist > 5) return; // Was a drag, not a click
 // ── Octree-accelerated click raycast ──
 this.raycaster.setFromCamera(this.pointer, this.camera);
 const ray = this.raycaster.ray;
 const hits = this.octree.raycast(ray.origin, ray.direction, 500);
 if (hits.length) {
 // Only consider visible nodes (opacity > 0.1)
 for (let i = 0; i < hits.length; i++) {
 const node = hits[i].item;
 if (node.mat.opacity > 0.1) {
 openPanel(node.id);
 break;
 }
 }
 }
 });

 // ── Touch pinch zoom (two-finger only) ──
 let pinchStartDist = 0, pinchStartR = 55;
 dom.addEventListener('touchstart', e => {
 if (e.touches.length === 2) {
 pinchStartDist = Math.hypot(
 e.touches[0].clientX - e.touches[1].clientX,
 e.touches[0].clientY - e.touches[1].clientY
 );
 pinchStartR = this.spherical.radius;
 }
 this.markDirty();
 }, { passive: true });
 dom.addEventListener('touchmove', e => {
 if (e.touches.length === 2) {
 e.preventDefault();
 const d = Math.hypot(
 e.touches[0].clientX - e.touches[1].clientX,
 e.touches[0].clientY - e.touches[1].clientY
 );
 const scale = pinchStartDist / d;
 this.targetSpherical.radius = Math.max(15, Math.min(120, pinchStartR * scale));
 this.markDirty();
 }
 }, { passive: false });

 // ── ResizeObserver for container-level resizes (more reliable than window.resize) ──
 if (typeof ResizeObserver !== 'undefined') {
 this._resizeObserver = new ResizeObserver(rafDebounce(() => this.resize()));
 this._resizeObserver.observe(this.container);
 }
 // Fallback for older browsers
 window.addEventListener('resize', rafDebounce(() => this.resize()));
 },

 resize() {
 this.width = this.container.clientWidth;
 this.height = this.container.clientHeight;
 this.camera.aspect = this.width / this.height;
 this.camera.updateProjectionMatrix();
 this.renderer.setSize(this.width, this.height);
 
 this.markDirty();
 },

 focusNode(nodeId, zoom) {
 const node = this.nodeMap.get(nodeId);
 if (!node) return;
 this.targetOrbitTarget.copy(node.pos);
 if (zoom) this.targetSpherical.radius = Math.max(15, 55 / zoom);
 this.markDirty();
 },

 filterByCategory(cat) {
 this.filterCategory = cat;
 this.markDirty();
 },

 projectToScreen(pos) {
 if (!this._projVec) this._projVec = new THREE.Vector3();
 this._projVec.copy(pos).project(this.camera);
 return {
 x: (this._projVec.x * 0.5 + 0.5) * this.width,
 y: (-this._projVec.y * 0.5 + 0.5) * this.height,
 };
 },

 // ── Dirty-state & visibility management ──
 markDirty(extraFrames) {
 this._dirty = true;
 this._dirtyFrames = Math.max(this._dirtyFrames, extraFrames || this._settleFrames);
 // If paused (tab hidden), don't restart - animate() will resume on visibility change
 if (!this._paused && !this.animFrame) {
 this.animFrame = requestAnimationFrame(() => this.animate());
 }
 },

 _onVisibilityChange() {
 if (document.hidden) {
 this._paused = true;
 if (this.animFrame) {
 cancelAnimationFrame(this.animFrame);
 this.animFrame = null;
 }
 } else {
 this._paused = false;
 // Clamp clock delta on wake to prevent huge time jumps
 if (this.clock) this.clock.getDelta();
 this.markDirty();
 }
 },

 animate() {
 this.animFrame = null; // clear so markDirty() can re-schedule

 // ── Tab hidden: stop the loop entirely ──
 if (document.hidden || this._paused) return;

 try {
 this._animateFrame();
 } catch (err) {
 Log.error('[ThreeEngine] Runtime error in animate loop:', err);
 // Let ActiveEngine handle degradation (shows banner, disables 3D)
 if (!ActiveEngine._runtimeFailed) {
 ActiveEngine._handleRuntimeFailure(err);
 }
 return; // stop the loop
 }
 },

 /** Inner animation body - separated so try-catch is tight */
 _animateFrame() {
 const orbitSettled =
 Math.abs(this.targetSpherical.theta - this.spherical.theta) < 0.0001 &&
 Math.abs(this.targetSpherical.phi - this.spherical.phi) < 0.0001 &&
 Math.abs(this.targetSpherical.radius - this.spherical.radius) < 0.001 &&
 this.orbitTarget.distanceTo(this.targetOrbitTarget) < 0.001;

 const stateChanged =
 this._lastFilterCategory !== this.filterCategory ||
 this._lastSelectedNodeId !== this.selectedNodeId ||
 this._lastHoveredNodeId !== this.hoveredNodeId ||
 this._lastFlythroughFocusId !== (this.flythrough.active ? this.flythrough.focusId : null);

 if (stateChanged) {
 this._lastFilterCategory = this.filterCategory;
 this._lastSelectedNodeId = this.selectedNodeId;
 this._lastHoveredNodeId = this.hoveredNodeId;
 this._lastFlythroughFocusId = this.flythrough.active ? this.flythrough.focusId : null;
 this._dirtyFrames = this._settleFrames;
 }

 // Count down settle frames
 if (this._dirtyFrames > 0) this._dirtyFrames--;

 // If orbit is settled, no state change, and settle frames exhausted - stop looping
 // Exception: flythrough mode or nodes with pulsation need continuous updates
 const inFlythrough = this.flythrough.active;
 // Only keep looping for pulsation if there are review-due nodes (not all studied nodes)
 const hasPulsatingNodes = this._hasReviewDueNodes;
 const isAutoRotating = this._autoRotate && !this.isDragging && !this.hoveredNodeId && !this.selectedNodeId && !inFlythrough;
 if (orbitSettled && !stateChanged && this._dirtyFrames <= 0 && !this.isDragging && !inFlythrough && !hasPulsatingNodes && !isAutoRotating && !this._edgeMidDist) {
 this._dirty = false;
 return; // animation loop stops; markDirty() will restart it
 }
 // ── Use real delta time from Clock for frame-rate independence ──
 const dt = this.clock ? Math.min(this.clock.getDelta(), 0.05) : 0.016;
 this.time += dt;
 
 this._hoverThrottleFrame++;

 // ── Auto-rotation when idle ──
 if (this._autoRotate && !this.isDragging && !this.hoveredNodeId && !this.selectedNodeId && !this.flythrough.active) {
 this.targetSpherical.theta += this._autoRotateSpeed * dt;
 this.spherical.theta += this._autoRotateSpeed * dt;
 this._dirty = true;
 this._dirtyFrames = Math.max(this._dirtyFrames, 2);
 }

 // Smooth orbit interpolation (fast convergence)
 this.spherical.theta += (this.targetSpherical.theta - this.spherical.theta) * 0.12;
 this.spherical.phi += (this.targetSpherical.phi - this.spherical.phi) * 0.12;
 this.spherical.radius += (this.targetSpherical.radius - this.spherical.radius) * 0.12;
 this.orbitTarget.lerp(this.targetOrbitTarget, 0.09);
 this.updateCameraFromSpherical();

 // ── Hover detection via Octree (throttled adaptively per device) ──
 const hoverThrottle = DeviceCapabilities.quality.hoverThrottle;
 if (!this.isDragging && (this._hoverThrottleFrame % hoverThrottle) === 0) {
 this.raycaster.setFromCamera(this.pointer, this.camera);
 const ray = this.raycaster.ray;
 const hits = this.octree.raycast(ray.origin, ray.direction, 500);

 let newHover = null;
 // Find the nearest *visible* hit
 for (let i = 0; i < hits.length; i++) {
 const node = hits[i].item;
 if (node.mat.opacity > 0.1) {
 newHover = node.id;
 break;
 }
 }

 if (this.hoveredNodeId !== newHover) {
 this.hoveredNodeId = newHover;
 if (newHover) this._autoRotate = false;
 this._hoverConnsCache = null; // invalidate adjacency cache
 this._hoverConnsCacheId = null;
 const dom = this.renderer.domElement;
 dom.style.cursor = newHover ? 'pointer' : 'grab';
 if (newHover) {
 const node = this.nodeMap.get(newHover);
 if (node) {
 const sp = this.projectToScreen(node.pos);
 updateTooltip(newHover, sp);
 }
 } else {
 updateTooltip(null);
 // Resume auto-rotation if nothing selected
 if (!this.selectedNodeId) {
 clearTimeout(this._autoRotateResumeTimer);
 this._autoRotateResumeTimer = setTimeout(() => {
 if (!this.selectedNodeId && !this.hoveredNodeId && !this.isDragging) {
 this._autoRotate = true;
 this.markDirty();
 }
 }, 3000);
 }
 }
 } else if (newHover) {
 const node = this.nodeMap.get(newHover);
 if (node) {
 const sp = this.projectToScreen(node.pos);
 updateTooltip(newHover, sp);
 }
 }
 }

 // ── Connection highlight via EdgeAdjacency (O(1) lookup, cached) ──
 // During flythrough, the focused node acts as the highlight target
 const ftFocusId = this.flythrough.active ? this.flythrough.focusId : null;
 const highlightId3d = ftFocusId || this.hoveredNodeId || this.selectedNodeId;
 let hoverConns;
 if (highlightId3d) {
 // Cache the adjacency set - only rebuild when highlight target changes
 if (this._hoverConnsCacheId !== highlightId3d) {
 this._hoverConnsCache = this.adjacency.getHighlightSet(highlightId3d);
 this._hoverConnsCacheId = highlightId3d;
 }
 hoverConns = this._hoverConnsCache;
 } else {
 hoverConns = null;
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 }

 const pathIds = activePath ? activePath._idsSet : null;
 // Flythrough provides its own path-like set for keeping path nodes visible
 const ftNodeSet = (this.flythrough.active && this.flythrough.nodeSet) ? this.flythrough.nodeSet : null;

 // ── Frustum culling: compute camera frustum ──
 this._frustumMatrix.multiplyMatrices(
 this.camera.projectionMatrix, this.camera.matrixWorldInverse
 );
 this._frustum.setFromProjectionMatrix(this._frustumMatrix);

 // ── Update node visuals (with frustum awareness) ──
 const nodes = this.nodes;
 const nodesLen = nodes.length;
 for (let i = 0; i < nodesLen; i++) {
 const node = nodes[i];

 // Quick frustum check - skip opacity lerping for fully off-screen nodes
 // unless they're being filtered/highlighted (which needs to decay)
 const inFrustum = this._frustum.containsPoint(node.pos);

 // Early-out: if off-screen and already converged, skip entirely
 if (!inFrustum && !stateChanged) {
 const oD = Math.abs(node.mat.opacity - (node.type === 'locus' ? 1.0 : 0.9));
 if (oD < 0.01) continue;
 }

 let tO = node.type === 'locus' ? 1.0 : 0.9;
 let tG = node.type === 'locus' ? 0.62 : 0.35;
 let tL = node.type === 'locus' ? 0.85 : 0;

 // Category filter
 if (this.filterCategory) {
 const nd = nodeIndex.get(node.id);
 if (nd && nd.ct !== this.filterCategory) { tO = 0.04; tG = 0.02; tL = 0; }
 else { tG = 0.5; }
 }

 // Hover/selection (uses cached adjacency set)
 if (hoverConns) {
 if (hoverConns.has(node.id)) {
 tG = node.id === highlightId3d ? 0.85 : 0.6;
 tO = 1; tL = node.type === 'locus' ? 1 : 0;
 } else if (!this.filterCategory) {
 tO = 0.08; tG = 0.02; tL = 0.1;
 }
 }

 // Path
 if (pathIds) {
 if (pathIds.has(node.id)) {
 const isCurrent = activePath.ids[activePathIndex] === node.id;
 tG = isCurrent ? 0.85 : 0.45; tO = 1; tL = 0.9;
 } else { tO = 0.04; tG = 0.01; tL = 0; }
 }

 // Search
 if (searchHighlightIds) {
 if (searchHighlightIds.has(node.id)) { tG = 0.75; tO = 1; tL = 0.9; }
 else { tO = 0.04; tG = 0.01; tL = 0; }
 }

 // ── Flythrough highlighting ──
 // Path nodes stay visible, focused node glows brightly, everything else muted
 if (ftNodeSet) {
 if (ftNodeSet.has(node.id)) {
 const isFocused = node.id === this.flythrough.focusId;
 const isPrev = node.id === this.flythrough.prevFocusId;
 if (isFocused) {
 // Arrival bloom: burst of glow that decays
 const bloom = Math.max(0, this.flythrough.arrivalGlow);
 tG = 0.85 + bloom * 0.4;
 tO = 1; tL = 1;
 // Scale boost during arrival
 if (bloom > 0.1 && node.mesh) {
 const s = node.radius * (1 + bloom * 0.15);
 node.mesh.scale.setScalar(s);
 }
 } else if (isPrev) {
 tG = 0.4; tO = 0.85; tL = 0.6;
 } else {
 // Other path nodes: dim but present
 tG = 0.15; tO = 0.5; tL = 0.35;
 }
 } else {
 // Non-path nodes: deeply muted
 tO = 0.03; tG = 0.008; tL = 0;
 }
 }

 // Studied glow boost + Learning State Pulsation (Improvement #22)
 if (studiedNodes.has(node.id)) {
 const learnState = getNodeLearningState(node.id);
 if (learnState === 'review-due') {
 // Subtle amber pulsation for review-due nodes
 const pulse = 0.25 + 0.15 * Math.sin(this.time * 2.2 + node.pos.x * 0.5);
 tG = Math.max(tG, pulse);
 // Slightly modulate mesh emissive for visible pulse
 if (node.mat) node.mat.emissive.setHex(0xcc8833);
 } else if (learnState === 'connected') {
 // Slow, satisfied glow for recently studied
 const glow = 0.35 + 0.08 * Math.sin(this.time * 0.8 + node.pos.y * 0.3);
 tG = Math.max(tG, glow);
 if (node.mat) node.mat.emissive.set(node.color);
 } else {
 tG = Math.max(tG, 0.3);
 }
 }

 // Smooth lerp - skip for off-screen nodes that are already at target
 // (allows values to settle even when off-screen, but avoid work when stable)
 if (inFrustum || Math.abs(node.mat.opacity - tO) > 0.005) {
 node.mat.opacity += (tO - node.mat.opacity) * 0.15;
 }
 // ── Only lerp glow if sprites exist (skipped on low-end) ──
 if (node.sprite && (inFrustum || Math.abs(node.spriteMat.opacity - tG) > 0.005)) {
 node.spriteMat.opacity += (tG - node.spriteMat.opacity) * 0.15;
 }
 node.mat.emissiveIntensity += ((tG > 0.3 ? 0.8 : 0.45) - node.mat.emissiveIntensity) * 0.15;
 if (node.label) {
 if (inFrustum || Math.abs(node.label.material.opacity - tL) > 0.005) {
 node.label.material.opacity += (tL - node.label.material.opacity) * 0.15;
 }
 }
 }

 // ── Update edge colors: Living Cosmos neural pulse system ──
 // Sphere-gradient + three-tier + radial pulse waves + stochastic sparks
 // + spatial-phase breathing. Apple principle: feel it, never see it.
 // Every effect whispers below conscious attention; together they breathe.
 const edgeUpdateNeeded = stateChanged || this.flythrough.active || this._dirtyFrames > 0 || !!this._edgeMidDist;
 if (this.edgeMesh && edgeUpdateNeeded && this._edgeBaseColors && this._edgeMidDist) {
 const colors = this.edgeMesh.geometry.attributes.color;
 const base = this._edgeBaseColors;
 const edges = this.edges;
 const edgesLen = edges.length;
 const midDist = this._edgeMidDist;
 const distA = this._edgeMidDistA;
 const distB = this._edgeMidDistB;
 const ftFocus = this.flythrough.active ? this.flythrough.focusId : null;
 const ftPrev = this.flythrough.active ? this.flythrough.prevFocusId : null;
 const ftTransAlpha = this.flythrough.active ? this.flythrough.transitionEdgeAlpha : 0;
 const t = this.time;

 // ── Pulse wave: single clean heartbeat from Christ at origin ──
 if (t - this._lastPulseSpawn > 4.5) {
 this._lastPulseSpawn = t;
 this._pulseWaves.push({ radius: 0, speed: 7.0, intensity: 0.55, width: 3.5 });
 }
 const maxRadius = 55;
 for (let wi = this._pulseWaves.length - 1; wi >= 0; wi--) {
 const w = this._pulseWaves[wi];
 w.radius += w.speed * dt;
 w.intensity *= 0.992;
 if (w.radius > maxRadius || w.intensity < 0.01) {
 this._pulseWaves.splice(wi, 1);
 }
 }

 // ── Stochastic sparks: fireflies, not lightning ──
 this._sparkAccum += dt;
 const sparkRate = 0.28;
 while (this._sparkAccum > sparkRate) {
 this._sparkAccum -= sparkRate;
 const randIdx = (Math.random() * edgesLen) | 0;
 if (edges[randIdx] && edges[randIdx].type !== 'parent') {
 this._sparks.push({ idx: randIdx, intensity: 0.35 + Math.random() * 0.25, decay: 0.7 + Math.random() * 0.5 });
 }
 }
 for (let si = this._sparks.length - 1; si >= 0; si--) {
 this._sparks[si].intensity -= dt * this._sparks[si].decay;
 if (this._sparks[si].intensity <= 0) this._sparks.splice(si, 1);
 }
 const sparkMap = new Float32Array(edgesLen);
 for (let si = 0; si < this._sparks.length; si++) {
 const s = this._sparks[si];
 sparkMap[s.idx] = Math.max(sparkMap[s.idx], s.intensity);
 }

 // ── Precompute pulse contributions ──
 const pulseMid = new Float32Array(edgesLen);
 const pulseA = new Float32Array(edgesLen);
 const pulseB = new Float32Array(edgesLen);
 for (let wi = 0; wi < this._pulseWaves.length; wi++) {
 const w = this._pulseWaves[wi];
 const wr = w.radius;
 const ww = w.width;
 const wI = w.intensity;
 for (let ei = 0; ei < edgesLen; ei++) {
 const dM = Math.abs(midDist[ei] - wr);
 if (dM < ww * 2) {
 const g = Math.exp(-(dM * dM) / (ww * ww));
 pulseMid[ei] += wI * g;
 pulseA[ei] += wI * Math.exp(-((distA[ei] - wr) * (distA[ei] - wr)) / (ww * ww));
 pulseB[ei] += wI * Math.exp(-((distB[ei] - wr) * (distB[ei] - wr)) / (ww * ww));
 }
 }
 }

 // ── Breathing: gentle spatial-phase ripple ──
 const breatheFreq = 0.5;
 const breatheAmp = 0.14;
 const breathePhaseScale = 0.1;
 // ── Hard ceiling: no edge ever exceeds this intensity ──
 const maxIntensity = 0.14;
 const lerpSpeed = 0.08;

 for (let ei = 0; ei < edgesLen; ei++) {
 const e = edges[ei];
 let m = e.type === 'parent' ? 0.09 : (e.type === 'capillary' ? 0.008 : 0.025);
 let applyLiveCosmos = true;
 let mA = 1.0, mB = 1.0;

 if (highlightId3d) {
 applyLiveCosmos = false;
 if (e.from === highlightId3d || e.to === highlightId3d) {
 const na = this.nodeMap.get(e.from), nb = this.nodeMap.get(e.to);
 if (na && nb && na.mat.opacity > 0.05 && nb.mat.opacity > 0.05)
 m = e.type === 'parent' ? 0.50 : (e.type === 'capillary' ? 0.28 : 0.40);
 else m = 0.002;
 } else m = 0.002;
 }
 if (pathIds) {
 applyLiveCosmos = false;
 m = (pathIds.has(e.from) && pathIds.has(e.to))
 ? (e.type === 'parent' ? 0.40 : 0.30) : 0.002;
 }
 if (searchHighlightIds) {
 applyLiveCosmos = false;
 m = (searchHighlightIds.has(e.from) && searchHighlightIds.has(e.to))
 ? (e.type === 'parent' ? 0.35 : 0.25) : 0.002;
 }
 if (ftNodeSet) {
 applyLiveCosmos = false;
 if (ftNodeSet.has(e.from) && ftNodeSet.has(e.to)) {
 const isToFocus = (e.from === ftFocus || e.to === ftFocus);
 const isTransition = (
 (e.from === ftFocus && e.to === ftPrev) ||
 (e.to === ftFocus && e.from === ftPrev)
 );
 if (isTransition) m = 0.20 + ftTransAlpha * 0.45;
 else if (isToFocus) m = 0.50;
 else m = 0.06;
 } else m = 0.002;
 }
 if (this.filterCategory) {
 const aD = nodeIndex.get(e.from), bD = nodeIndex.get(e.to);
 if (!aD || !bD || aD.ct !== this.filterCategory || bD.ct !== this.filterCategory) {
 m = 0.002; applyLiveCosmos = false;
 }
 }

 if (applyLiveCosmos) {
 // Spatial-phase breathing
 const phase = midDist[ei] * breathePhaseScale;
 m *= (1.0 + Math.sin(t * breatheFreq - phase) * breatheAmp);
 // Pulse wave: gentle wash, tier-scaled
 const pw = pulseMid[ei];
 if (pw > 0.01) {
 m += pw * (e.type === 'parent' ? 0.06 : (e.type === 'capillary' ? 0.04 : 0.05));
 // Directional shimmer: barely perceptible
 const pA = pulseA[ei], pB = pulseB[ei];
 if (pA + pB > 0.02) {
 mA = 1.0 + pA * 0.12;
 mB = 1.0 + pB * 0.12;
 }
 }
 // Stochastic spark: firefly glow
 const spark = sparkMap[ei];
 if (spark > 0) {
 m += spark * (e.type === 'capillary' ? 0.06 : 0.08);
 }
 // Hard ceiling: never blow out
 if (m > maxIntensity) m = maxIntensity;
 }

 const bi = ei * 6;
 const tAr = base[bi]  * m * mA, tAg = base[bi+1] * m * mA, tAb = base[bi+2] * m * mA;
 const tBr = base[bi+3] * m * mB, tBg = base[bi+4] * m * mB, tBb = base[bi+5] * m * mB;
 colors.array[bi]  += (tAr - colors.array[bi])  * lerpSpeed;
 colors.array[bi+1] += (tAg - colors.array[bi+1]) * lerpSpeed;
 colors.array[bi+2] += (tAb - colors.array[bi+2]) * lerpSpeed;
 colors.array[bi+3] += (tBr - colors.array[bi+3]) * lerpSpeed;
 colors.array[bi+4] += (tBg - colors.array[bi+4]) * lerpSpeed;
 colors.array[bi+5] += (tBb - colors.array[bi+5]) * lerpSpeed;
 }
 colors.needsUpdate = true;
 }

 // ── Improvement #21: Update arrow cone visibility ──
 if (this.arrowMeshes.length > 0 && edgeUpdateNeeded) {
 for (let ai = 0; ai < this.arrowMeshes.length; ai++) {
 const arrow = this.arrowMeshes[ai];
 let targetAlpha = 0.0;
 if (highlightId3d) {
 if (arrow.fromId === highlightId3d || arrow.toId === highlightId3d) {
 targetAlpha = 0.7;
 }
 }
 if (pathIds && pathIds.has(arrow.fromId) && pathIds.has(arrow.toId)) {
 targetAlpha = 0.5;
 }
 // Flythrough: show arrows for edges to focused node
 if (ftNodeSet) {
 if (ftNodeSet.has(arrow.fromId) && ftNodeSet.has(arrow.toId)) {
 const isToFocus = (arrow.fromId === ftFocusId || arrow.toId === ftFocusId);
 targetAlpha = isToFocus ? 0.65 : 0.15;
 } else {
 targetAlpha = 0;
 }
 }
 arrow.mat.opacity += (targetAlpha - arrow.mat.opacity) * 0.15;
 }
 }

 // ── Improvement #23: Flythrough camera animation with cosmos correspondence ──
 if (this.flythrough.active && !this.flythrough.paused) {
 const ft = this.flythrough;
 ft.progress += dt;
 const totalPhaseTime = ft.dwellTime + ft.transitionTime;

 // Decay arrival glow
 if (ft.arrivalGlow > 0) ft.arrivalGlow -= dt * 1.5;

 if (ft.progress >= totalPhaseTime) {
 ft.progress = 0;
 ft.prevFocusId = ft.focusId;
 ft.currentIdx++;
 if (ft.currentIdx >= ft.pathIds.length) {
 this.stopFlythrough();
 } else {
 ft.focusId = ft.pathIds[ft.currentIdx];
 ft.arrivalGlow = 1.0; // Bloom burst on arrival
 ft.transitionEdgeAlpha = 0;
 // Invalidate adjacency cache for new focus
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 updateFlythroughUI(ft.focusId, ft.currentIdx, ft.pathIds.length, ft.pathName);
 }
 }
 if (ft.active) {
 const currentNode = this.nodeMap.get(ft.focusId);
 if (currentNode) {
 if (ft.progress < ft.dwellTime) {
 // Dwell phase: slowly orbit around current node with gentle movement
 const orbitSpeed = 0.12;
 this.targetSpherical.theta += orbitSpeed * dt;
 this.targetOrbitTarget.lerp(currentNode.pos, 0.04);
 this.targetSpherical.radius += (28 - this.targetSpherical.radius) * 0.02;
 ft.transitionEdgeAlpha *= 0.95; // Decay transition edge
 } else {
 // Transition phase: move toward next node with animated connecting edge
 const nextIdx = Math.min(ft.currentIdx + 1, ft.pathIds.length - 1);
 const nextNode = this.nodeMap.get(ft.pathIds[nextIdx]);
 if (nextNode) {
 const t = (ft.progress - ft.dwellTime) / ft.transitionTime;
 const easedT = t * t * (3 - 2 * t); // smoothstep
 // Animate transition edge alpha
 ft.transitionEdgeAlpha = Math.sin(t * Math.PI); // peaks at 0.5, zero at 0 and 1
 // Camera tracks between nodes (pooled vector)
 if (!this._lerpVec) this._lerpVec = new THREE.Vector3();
 this._lerpVec.copy(currentNode.pos).lerp(nextNode.pos, easedT);
 this.targetOrbitTarget.lerp(this._lerpVec, 0.06);
 // Pull back slightly during transition for wider view
 this.targetSpherical.radius += (36 - this.targetSpherical.radius) * 0.025;
 }
 }
 }
 // Restore scale on non-focused nodes (only check nodes that might have been scaled)
 if (ft.prevFocusId) {
 const prevNode = this.nodeMap.get(ft.prevFocusId);
 if (prevNode && prevNode.mesh) {
 const tgtS = prevNode.radius;
 const cur = prevNode.mesh.scale.x;
 if (Math.abs(cur - tgtS) > 0.005) {
 prevNode.mesh.scale.setScalar(cur + (tgtS - cur) * 0.12);
 }
 }
 }
 }
 // Keep animation alive during flythrough
 this._dirtyFrames = Math.max(this._dirtyFrames, 5);
 } else if (this.flythrough.active && this.flythrough.paused) {
 // Even when paused, keep flythrough state influencing visuals
 this._dirtyFrames = Math.max(this._dirtyFrames, 2);
 }

 // Render scene
 this.renderer.render(this.scene, this.camera);
 // ── Schedule next frame only if not paused ──
 if (!this._paused && !document.hidden) {
 this.animFrame = requestAnimationFrame(() => this.animate());
 }
 },

 // ── Improvement #23: Flythrough Methods ──
 startFlythrough(pathIds, pathName, pathColor) {
 if (!pathIds || pathIds.length < 2) return;
 // Filter to only nodes that exist in the 3D scene
 const validIds = pathIds.filter(id => this.nodeMap.has(id));
 if (validIds.length < 2) return;
 const nodeSet = new Set(validIds);
 this.flythrough = {
 active: true, paused: false,
 pathIds: validIds, currentIdx: 0, progress: 0,
 dwellTime: 5.5, transitionTime: 2.5,
 pathName: pathName || '', pathColor: pathColor || '#e0c050',
 nodeSet: nodeSet,
 focusId: validIds[0],
 prevFocusId: null,
 transitionEdgeAlpha: 0,
 arrivalGlow: 1.0,
 };
 // Clear other highlights
 this.selectedNodeId = null;
 this.hoveredNodeId = null;
 this.filterCategory = null;
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 // Start at first node
 const firstNode = this.nodeMap.get(validIds[0]);
 if (firstNode) {
 this.targetOrbitTarget.copy(firstNode.pos);
 this.targetSpherical.radius = 28;
 }
 this.markDirty();
 // UI
 const overlay = document.getElementById('flythrough-overlay');
 if (overlay) overlay.classList.add('active');
 // Hide legend and bottombar to avoid obstructing flythrough view
 const legend = document.getElementById('legend');
 if (legend) legend.style.display = 'none';
 const bottombar = document.getElementById('bottombar');
 if (bottombar) bottombar.style.display = 'none';
 updateFlythroughUI(validIds[0], 0, validIds.length, pathName);
 },

 stopFlythrough() {
 // Restore any scaled nodes back to normal
 if (this.flythrough.active) {
 for (let i = 0; i < this.nodes.length; i++) {
 const n = this.nodes[i];
 if (n.mesh) n.mesh.scale.setScalar(n.radius);
 }
 }
 this.flythrough.active = false;
 this.flythrough.paused = false;
 this.flythrough.focusId = null;
 this.flythrough.prevFocusId = null;
 this.flythrough.nodeSet = null;
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 const overlay = document.getElementById('flythrough-overlay');
 if (overlay) overlay.classList.remove('active');
 // Restore legend and bottombar
 const legend = document.getElementById('legend');
 if (legend) legend.style.display = '';
 const bottombar = document.getElementById('bottombar');
 if (bottombar) bottombar.style.display = '';
 const text = document.getElementById('flythrough-text');
 if (text) text.classList.remove('visible');
 this.markDirty();
 },

 toggleFlythroughPause() {
 this.flythrough.paused = !this.flythrough.paused;
 const btn = document.getElementById('flythrough-pause');
 if (btn) btn.textContent = this.flythrough.paused ? 'Resume' : 'Pause';
 this.markDirty();
 },

 navigateFlythroughTo(index) {
 const ft = this.flythrough;
 if (!ft.active || index < 0 || index >= ft.pathIds.length) return;
 // Pause auto-advance when user manually navigates
 ft.paused = true;
 const btn = document.getElementById('flythrough-pause');
 if (btn) btn.textContent = 'Resume';
 ft.prevFocusId = ft.focusId;
 ft.currentIdx = index;
 ft.focusId = ft.pathIds[index];
 ft.progress = 0;
 ft.arrivalGlow = 1.0;
 ft.transitionEdgeAlpha = 0;
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 // Snap camera to new node
 const node = this.nodeMap.get(ft.focusId);
 if (node) {
 this.targetOrbitTarget.copy(node.pos);
 this.targetSpherical.radius = 28;
 }
 this.markDirty();
 updateFlythroughUI(ft.focusId, ft.currentIdx, ft.pathIds.length, ft.pathName);
 },




 destroy() {
 if (this.animFrame) cancelAnimationFrame(this.animFrame);
 if (this._boundVisibility) document.removeEventListener('visibilitychange', this._boundVisibility);
 if (this._resizeObserver) { this._resizeObserver.disconnect(); this._resizeObserver = null; }
 if (this.renderer) {
 this.renderer.dispose();
 if (this.renderer.domElement && this.renderer.domElement.parentNode) {
 this.renderer.domElement.parentNode.removeChild(this.renderer.domElement);
 }
 }
 this.nodes = []; this.edges = []; this.nodeMap.clear(); this.meshToId.clear();
 this.arrowMeshes = [];
 if (this.arrowGroup) { this.scene.remove(this.arrowGroup); this.arrowGroup = null; }
 this.flythrough = { active: false, paused: false, pathIds: [], currentIdx: 0, progress: 0, dwellTime: 5.5, transitionTime: 2.5, pathName: '', pathColor: '#e0c050', nodeSet: null, focusId: null, prevFocusId: null, transitionEdgeAlpha: 0, arrivalGlow: 0 };
 this.octree = new Octree();
 this.adjacency = new EdgeAdjacency();
 this._hoverConnsCache = null;
 this._hoverConnsCacheId = null;
 this._activePointerId = null;
 this._lastPointer = null;
 }
};

// ═══════════════════════════════════════════
// §7b - ENGINE BRIDGE (Error Boundary)
// All UI code accesses ThreeEngine exclusively through
// ActiveEngine. Every call is guarded with try-catch and
// an `threeInitialized` gate so that:
// 1. If Three.js never loaded, calls are harmless no-ops.
// 2. If ThreeEngine throws at runtime (WebGL context lost,
// shader compilation failure, OOM), the error is caught,
// a degradation banner is shown, and the rest of the app
// (search, panels, study paths, keyboard nav) continues.
// 3. A single `_runtimeFailed` latch prevents repeated
// banner spam after the first crash.
// ═══════════════════════════════════════════
let threeInitialized = false;

const ActiveEngine = {
 _runtimeFailed: false,

 /** Safely execute a ThreeEngine method. Returns undefined on failure. */
 _guard(label, fn) {
 if (!threeInitialized || this._runtimeFailed) return;
 try {
 return fn();
 } catch (err) {
 Log.error(`[ActiveEngine] ${label} failed:`, err);
 this._handleRuntimeFailure(err);
 }
 },

 _handleRuntimeFailure(err) {
 if (this._runtimeFailed) return; // already degraded
 this._runtimeFailed = true;
 threeInitialized = false;
 // Attempt cleanup - but don't let cleanup itself throw
 try { ThreeEngine.destroy(); } catch (e) { /* swallow */ }
 showDegradationBanner(
 '3D rendering encountered an error and has been disabled. ' +
 'Search, study panels, and paths remain fully functional.'
 );
 },

 focusNode(id, zoom) {
 this._guard('focusNode', () => ThreeEngine.focusNode(id, zoom));
 },
 filterByCategory(cat) {
 this._guard('filterByCategory', () => ThreeEngine.filterByCategory(cat));
 },
 setSelectedNode(id) {
 this._guard('setSelectedNode', () => { ThreeEngine.selectedNodeId = id; ThreeEngine._autoRotate = false; });
 },
 clearSelectedNode() {
 this._guard('clearSelectedNode', () => { ThreeEngine.selectedNodeId = null; });
 },
 markDirty() {
 this._guard('markDirty', () => ThreeEngine.markDirty());
 },
 resize() {
 this._guard('resize', () => ThreeEngine.resize());
 }
};

// ═══════════════════════════════════════════
// §8 - UI CONTROLLER
// ═══════════════════════════════════════════
let activePath = null;
let activePathIndex = 0;
let breadcrumbHistory = [];
let searchHighlightIds = null;

// ── Deep Linking ──
function handleDeepLink() {
 const hash = window.location.hash.slice(1);
 if (hash && nodeIndex.has(hash)) {
 setTimeout(() => openPanel(hash), 600);
 }
}
function setDeepLink(nodeId) {
 history.replaceState(null, '', '#' + nodeId);
}

// ── Tooltip ──
let _tooltipHideTimer = null;
function updateTooltip(nodeId, pointer) {
 const tooltip = document.getElementById('tooltip');
 if (!nodeId) {
 tooltip.classList.remove('visible');
 if (_tooltipHideTimer) { clearTimeout(_tooltipHideTimer); _tooltipHideTimer = null; }
 return;
 }
 const data = nodeIndex.get(nodeId);
 if (!data) return;

 document.getElementById('tooltip-name').innerHTML = safeHTML(data.n);
 const cat = CATEGORIES[data.ct];
 const catEl = document.getElementById('tooltip-category');
 if (data.type === 'sub' && data.parentId) {
 const parent = nodeIndex.get(data.parentId);
 catEl.textContent = parent ? parent.n : (cat ? cat.label : 'Sub-Topic');
 } else {
 catEl.textContent = cat ? cat.label : 'Major Locus';
 }
 catEl.style.color = data.c || (cat ? cat.color : '#888');

 const studiedEl = document.getElementById('tooltip-studied');
 studiedEl.textContent = studiedNodes.has(nodeId) ? '✓ Reviewed' : '';

 document.getElementById('tooltip-summary').innerHTML = safeHTML(extractFirstSentence(data.d || ''));

 tooltip.classList.add('visible');

 // ── Mobile: center tooltip at bottom of screen (CSS handles this) ──
 if (DeviceCapabilities.isMobile) {
 // CSS @media handles positioning; just auto-hide after 3s
 if (_tooltipHideTimer) clearTimeout(_tooltipHideTimer);
 _tooltipHideTimer = setTimeout(() => {
 tooltip.classList.remove('visible');
 _tooltipHideTimer = null;
 }, 3000);
 } else {
 // Desktop: follow mouse pointer
 const rect = document.getElementById('graph-container').getBoundingClientRect();
 tooltip.style.left = Math.min(window.innerWidth - 290, pointer.x + rect.left + 16) + 'px';
 tooltip.style.top = Math.max(10, pointer.y + rect.top - 20) + 'px';
 }
}

// ── Panel ──
function openPanel(nodeId) {
 const data = nodeIndex.get(nodeId);
 if (!data) return;

 // Save focus trigger for restoration on close
 if (!document.getElementById('study-panel').classList.contains('open')) {
 A11y.panelTrigger = document.activeElement;
 }

 ActiveEngine.setSelectedNode(nodeId);
 ActiveEngine.markDirty();
 setDeepLink(nodeId);

 const panel = document.getElementById('study-panel');
 document.getElementById('panel-title').innerHTML = safeHTML(data.n);
 document.getElementById('panel-layer').textContent = data.type === 'locus' ? 'MAJOR LOCUS' : 'SUB-TOPIC';
 document.getElementById('panel-color-bar').style.background =
 `linear-gradient(90deg, ${data.c || '#888'}, transparent)`;

 // Update panel label for screen readers
 panel.setAttribute('aria-label', 'Study: ' + stripHtml(data.n));

 // Study toggle
 const studyBtn = document.getElementById('panel-study-toggle');
 const isStudied = studiedNodes.has(nodeId);
 studyBtn.className = 'panel-study-toggle' + (isStudied ? ' studied' : '');
 studyBtn.setAttribute('aria-pressed', isStudied ? 'true' : 'false');
 studyBtn.innerHTML = isStudied
 ? '<span class="check-icon" aria-hidden="true">✓</span> Reviewed'
 : '<span class="check-icon" aria-hidden="true">☐</span> Mark as reviewed';
 studyBtn.onclick = () => {
 const willStudy = !studiedNodes.has(nodeId);
 toggleStudied(nodeId);
 animateStudiedToggle(studyBtn, nodeId, willStudy);
 };

 // Summary (first sentence) + Description (full, collapsed)
 const fullDesc = data.d || '';
 const firstSentence = extractFirstSentence(fullDesc);
 document.getElementById('panel-summary').innerHTML = safeHTML(firstSentence);

 const descWrapper = document.getElementById('panel-desc-wrapper');
 const descEl = document.getElementById('panel-description');
 const readMoreBtn = document.getElementById('panel-read-more');
 descEl.innerHTML = safeHTML(fullDesc);
 descWrapper.classList.remove('expanded', 'no-overflow');
 readMoreBtn.classList.remove('hidden');
 readMoreBtn.textContent = 'Read more';
 readMoreBtn.setAttribute('aria-expanded', 'false');

 // After layout: check if description actually overflows
 requestAnimationFrame(() => {
 if (descEl.scrollHeight <= descWrapper.clientHeight + 2) {
 descWrapper.classList.add('no-overflow');
 readMoreBtn.classList.add('hidden');
 }
 });

 readMoreBtn.onclick = () => {
 // P1 #10: Set exact scrollHeight as CSS variable for efficient transition
 if (!descWrapper.classList.contains('expanded')) {
 descWrapper.style.setProperty('--desc-expanded-height', descEl.scrollHeight + 'px');
 }
 const isExpanded = descWrapper.classList.toggle('expanded');
 readMoreBtn.textContent = isExpanded ? 'Read less' : 'Read more';
 readMoreBtn.setAttribute('aria-expanded', isExpanded ? 'true' : 'false');
 };

 // ── Extract & display references with authority-level distinction ──
 // Scripture = <i>norma normans</i> (the norming norm) : supreme authority
 // Confessional Standards = <i>norma normata</i> (the normed norm) : subordinate to Scripture
 const scripturesEl = document.getElementById('panel-scriptures');
 const confessionalsEl = document.getElementById('panel-confessionals');
 const scriptureSection = document.getElementById('panel-scripture-section');
 const confessionalSection = document.getElementById('panel-confessional-section');
 scripturesEl.innerHTML = '';
 confessionalsEl.innerHTML = '';

 const scriptureRefs = extractScriptureRefs(data.d || '');
 const confessionalRefs = extractConfessionalRefs(data.d || '');

 // Scripture references (<i>norma normans</i>)
 if (scriptureRefs.length > 0) {
 scriptureSection.style.display = '';
 scriptureRefs.slice(0, 12).forEach(ref => {
 const tag = document.createElement('span');
 tag.className = 'scripture-tag';
 tag.textContent = ref;
 scripturesEl.appendChild(tag);
 });
 } else {
 scriptureSection.style.display = 'none';
 }

 // Confessional standard references (<i>norma normata</i>)
 if (confessionalRefs.length > 0) {
 confessionalSection.style.display = '';
 confessionalRefs.slice(0, 10).forEach(ref => {
 const tag = document.createElement('span');
 tag.className = 'confessional-tag';
 tag.textContent = ref;
 confessionalsEl.appendChild(tag);
 });
 } else {
 confessionalSection.style.display = 'none';
 }

 // Keywords (interactive - make keyboard accessible)
 const keywordsEl = document.getElementById('panel-keywords');
 keywordsEl.innerHTML = '';
 (data.k || []).slice(0, 14).forEach(kw => {
 const tag = document.createElement('button');
 tag.className = 'keyword-tag';
 // Strip HTML tags from keywords for display (some contain <i> markup)
 const cleanKw = kw.replace(/<[^>]*>/g, '');
 tag.textContent = cleanKw;
 tag.setAttribute('aria-label', 'Search for keyword: ' + cleanKw);
 tag.onclick = () => {
 document.getElementById('search-input').value = cleanKw;
 performSearch(cleanKw);
 };
 keywordsEl.appendChild(tag);
 });

 // Historical Controversies (hc field)
 const hcContainer = document.getElementById('panel-controversies');
 const hcList = document.getElementById('panel-controversies-list');
 hcList.innerHTML = '';
 const controversies = data.hc || [];
 if (controversies.length > 0) {
 hcContainer.style.display = '';
 controversies.forEach(hc => {
 const tag = document.createElement('span');
 tag.style.cssText = 'font-family:var(--font-ui);font-size:10px;padding:3px 8px;background:rgba(204,102,85,0.12);color:#cc8866;border:1px solid rgba(204,102,85,0.2);border-radius:3px;cursor:default;';
 tag.textContent = hc;
 hcList.appendChild(tag);
 });
 } else {
 hcContainer.style.display = 'none';
 }

 // Connections tab - Sub-topics (DOM-safe, focusable, keyboard-operable)
 const subSection = document.getElementById('subtopics-section');
 const subList = document.getElementById('subtopics-list');
 subList.innerHTML = '';
 const locus = LOCI.find(l => l.id === (data.type === 'locus' ? nodeId : data.parentId));
 if (data.type === 'locus' && data.s) {
 subSection.style.display = '';
 data.s.forEach(sub => {
 const item = document.createElement('div');
 item.className = 'connection-item';
 item.setAttribute('role', 'listitem');
 item.tabIndex = 0;
 item.setAttribute('aria-label', stripHtml(sub.n) + (studiedNodes.has(sub.id) ? ' (studied)' : ''));

 const dot = document.createElement('div');
 dot.className = 'connection-dot';
 dot.style.background = data.c;
 dot.style.boxShadow = '0 0 6px ' + data.c;
 dot.setAttribute('aria-hidden', 'true');

 const name = document.createElement('span');
 name.className = 'connection-name';
 name.innerHTML = safeHTML(sub.n);

 item.append(dot, name);
 if (studiedNodes.has(sub.id)) {
 const studied = document.createElement('div');
 studied.className = 'connection-studied';
 studied.textContent = '✓';
 studied.setAttribute('aria-hidden', 'true');
 item.appendChild(studied);
 }

 const navigate = () => openPanel(sub.id);
 item.onclick = navigate;
 item.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); navigate(); } };
 subList.appendChild(item);
 });
 } else {
 subSection.style.display = 'none';
 }

 // Cross-refs (DOM-safe, focusable, keyboard-operable)
 const crossSection = document.getElementById('crossrefs-section');
 const crossList = document.getElementById('crossrefs-list');
 crossList.innerHTML = '';
 if (data.cl) {
 crossSection.style.display = '';
 data.cl.forEach(refId => {
 const refData = nodeIndex.get(refId);
 if (!refData) return;
 const item = document.createElement('div');
 item.className = 'connection-item';
 item.setAttribute('role', 'listitem');
 item.tabIndex = 0;
 item.setAttribute('aria-label', stripHtml(refData.n) + ', cross-reference' + (studiedNodes.has(refId) ? ' (studied)' : ''));

 const dot = document.createElement('div');
 dot.className = 'connection-dot';
 dot.style.background = refData.c;
 dot.style.boxShadow = '0 0 6px ' + refData.c;
 dot.setAttribute('aria-hidden', 'true');

 const name = document.createElement('span');
 name.className = 'connection-name';
 name.innerHTML = safeHTML(refData.n);

 const type = document.createElement('span');
 type.className = 'connection-type';
 type.textContent = 'cross-ref';

 item.append(dot, name, type);
 if (studiedNodes.has(refId)) {
 const studied = document.createElement('div');
 studied.className = 'connection-studied';
 studied.textContent = '✓';
 studied.setAttribute('aria-hidden', 'true');
 item.appendChild(studied);
 }

 const navigate = () => openPanel(refId);
 item.onclick = navigate;
 item.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); navigate(); } };
 crossList.appendChild(item);
 });
 } else {
 crossSection.style.display = 'none';
 }

 // Related Topics (algorithmically discovered - keyword/scripture/category overlap)
 const relatedSection = document.getElementById('related-section');
 const relatedList = document.getElementById('related-list');
 relatedList.innerHTML = '';
 const related = relatedTopicsCache.get(nodeId) || [];
 if (related.length > 0) {
 relatedSection.style.display = '';
 related.forEach(rel => {
 const relData = nodeIndex.get(rel.id);
 if (!relData) return;
 const item = document.createElement('div');
 item.className = 'connection-item';
 item.setAttribute('role', 'listitem');
 item.tabIndex = 0;
 item.setAttribute('aria-label', stripHtml(relData.n) + ', related topic' + (studiedNodes.has(rel.id) ? ' (studied)' : ''));

 const dot = document.createElement('div');
 dot.className = 'connection-dot';
 dot.style.background = relData.c;
 dot.style.boxShadow = '0 0 6px ' + relData.c;
 dot.setAttribute('aria-hidden', 'true');

 const name = document.createElement('span');
 name.className = 'connection-name';
 name.innerHTML = safeHTML(relData.n);

 const reason = document.createElement('span');
 reason.className = 'related-reason';
 reason.textContent = rel.reasons[0] || '';

 item.append(dot, name, reason);
 if (studiedNodes.has(rel.id)) {
 const studied = document.createElement('div');
 studied.className = 'connection-studied';
 studied.textContent = '✓';
 studied.setAttribute('aria-hidden', 'true');
 item.appendChild(studied);
 }

 const navigate = () => openPanel(rel.id);
 item.onclick = navigate;
 item.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); navigate(); } };
 relatedList.appendChild(item);
 });
 } else {
 relatedSection.style.display = 'none';
 }

 // Study tab cards (DOM-safe, focusable when clickable)
 const studyCards = document.getElementById('study-cards');
 studyCards.innerHTML = '';
 const cards = data.type === 'locus' && data.s ? data.s : [data];
 cards.forEach(item => {
 const card = document.createElement('div');
 card.className = 'study-card';
 const h5 = document.createElement('h5');
 h5.innerHTML = safeHTML(item.n);
 const p = document.createElement('p');
 p.innerHTML = safeHTML(item.d);
 card.append(h5, p);
 if (item.id !== nodeId) {
 card.tabIndex = 0;
 card.setAttribute('role', 'button');
 card.setAttribute('aria-label', 'Study ' + stripHtml(item.n));
 const navigate = () => openPanel(item.id);
 card.onclick = navigate;
 card.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); navigate(); } };
 }
 studyCards.appendChild(card);
 });

 // Breadcrumb
 const bcIdx = breadcrumbHistory.findIndex(b => b.id === nodeId);
 if (bcIdx >= 0) breadcrumbHistory = breadcrumbHistory.slice(0, bcIdx + 1);
 else breadcrumbHistory.push({ id: nodeId, name: data.n });
 renderBreadcrumb();

 // Reset tabs to overview (ARIA tab pattern)
 document.querySelectorAll('.panel-tab').forEach(t => {
 t.classList.remove('active');
 t.setAttribute('aria-selected', 'false');
 t.tabIndex = -1;
 });
 document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
 const overviewTab = document.querySelector('.panel-tab[data-tab="overview"]');
 overviewTab.classList.add('active');
 overviewTab.setAttribute('aria-selected', 'true');
 overviewTab.tabIndex = 0;
 document.getElementById('tab-overview').classList.add('active');

 // Focus graph
 ActiveEngine.focusNode(nodeId, data.type === 'locus' ? 1.2 : 1.8);

 // P2 #18: Reset scroll position before opening panel with new content
 panel.scrollTop = 0;
 panel.classList.add('open');
 // ── Reset any swipe transform from mobile gesture ──
 panel.style.transform = '';
 panel.style.opacity = '';

 // Focus management: move focus into panel after slide-in transition completes
 A11y.disableFocusTrap();
 const onTransitionDone = () => {
 panel.removeEventListener('transitionend', onTransitionDone);
 // Guard: panel may have been closed during the transition
 if (!panel.classList.contains('open')) return;
 A11y.enableFocusTrap(panel);
 const title = document.getElementById('panel-title');
 if (title) title.focus();
 };
 panel.addEventListener('transitionend', onTransitionDone);
 // Safety fallback if transitionend doesn't fire (e.g. reduced-motion, already open)
 setTimeout(() => {
 if (A11y.trapFocusHandler === null) onTransitionDone();
 }, 600);
}

function closePanel() {
 const panel = document.getElementById('study-panel');
 panel.classList.remove('open');
 A11y.disableFocusTrap();
 ActiveEngine.clearSelectedNode();
 // Resume auto-rotation from current position (no snap-back)
 ActiveEngine._guard('closePanel', () => {
 ThreeEngine.targetOrbitTarget.set(0, 0, 0);
 ThreeEngine._autoRotate = true;
 });
 ActiveEngine.markDirty();
 breadcrumbHistory = [];
 renderBreadcrumb();
 // Restore focus to the element that opened the panel
 if (A11y.panelTrigger && A11y.panelTrigger.isConnected) {
 A11y.panelTrigger.focus();
 }
 A11y.panelTrigger = null;
}

function renderBreadcrumb() {
 const el = document.getElementById('breadcrumb');
 el.innerHTML = '';
 if (breadcrumbHistory.length < 2) return;
 breadcrumbHistory.forEach((b, i) => {
 if (i > 0) {
 const sep = document.createElement('span');
 sep.className = 'sep';
 sep.textContent = '›';
 sep.setAttribute('aria-hidden', 'true');
 el.appendChild(sep);
 }
 const isLast = i === breadcrumbHistory.length - 1;
 const span = document.createElement('span');
 span.innerHTML = safeHTML(b.name);
 span.tabIndex = 0;
 span.setAttribute('role', 'link');
 if (isLast) span.setAttribute('aria-current', 'page');
 const navigate = () => openPanel(b.id);
 span.onclick = navigate;
 span.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); navigate(); } };
 el.appendChild(span);
 });
}

function resetView() {
 ActiveEngine._guard('resetView', () => {
 ThreeEngine.targetSpherical.theta = Math.PI * 0.35;
 ThreeEngine.targetSpherical.phi = Math.PI * 0.22;
 ThreeEngine.targetSpherical.radius = 57;
 ThreeEngine._autoRotate = true;
 ThreeEngine.targetOrbitTarget.set(0, 0, 0);
 ThreeEngine.filterCategory = null;
 });
 searchHighlightIds = null;
 ActiveEngine.markDirty();
 document.querySelectorAll('.legend-item').forEach(l => {
 l.classList.remove('active');
 l.setAttribute('aria-pressed', 'false');
 });
}

// ── Search UI ──
function performSearch(query) {
 const resultsEl = document.getElementById('search-results');
 const input = document.getElementById('search-input');

 // Reset active descendant state
 A11y.resetSearchIndex();

 if (!query || query.length < 2) {
 resultsEl.classList.remove('visible');
 input.setAttribute('aria-expanded', 'false');
 searchHighlightIds = null;
 ActiveEngine.markDirty();
 A11y.announce('');
 return;
 }

 const results = searchNodes(query);
 if (results.length === 0) {
 resultsEl.innerHTML = '<div class="search-empty" role="status">No results found</div>';
 resultsEl.classList.add('visible');
 input.setAttribute('aria-expanded', 'true');
 searchHighlightIds = null;
 ActiveEngine.markDirty();
 A11y.announce('No results found');
 return;
 }

 // Highlight matching nodes on graph
 searchHighlightIds = new Set(results.map(r => r.id));
 ActiveEngine.markDirty();

 resultsEl.innerHTML = '';
 results.forEach((result, index) => {
 const data = result.data;
 const cat = CATEGORIES[data.ct];
 const color = data.c || (cat ? cat.color : '#888');

 const item = document.createElement('div');
 item.className = 'search-result-item';
 item.setAttribute('role', 'option');
 item.setAttribute('aria-selected', 'false');
 item.id = 'search-option-' + index;
 item.setAttribute('aria-label', stripHtml(data.n) + ', ' + (cat ? cat.label : 'Doctrine'));

 const dot = document.createElement('div');
 dot.className = 'search-result-dot';
 dot.style.background = color;
 dot.style.boxShadow = '0 0 6px ' + color;
 dot.setAttribute('aria-hidden', 'true');

 const info = document.createElement('div');
 info.className = 'search-result-info';

 const nameEl = document.createElement('div');
 nameEl.className = 'search-result-name';
 nameEl.appendChild(highlightMatch(data.n, query));

 const catEl = document.createElement('div');
 catEl.className = 'search-result-category';
 catEl.style.color = color;
 catEl.textContent = cat ? cat.label : 'Doctrine';

 const snippetEl = document.createElement('div');
 snippetEl.className = 'search-result-snippet';
 snippetEl.appendChild(getSnippet(data.d || '', query));

 info.append(nameEl, catEl, snippetEl);
 item.append(dot, info);
 item.onclick = () => {
 openPanel(result.id);
 resultsEl.classList.remove('visible');
 input.setAttribute('aria-expanded', 'false');
 A11y.resetSearchIndex();
 searchHighlightIds = null;
 };
 resultsEl.appendChild(item);
 });
 resultsEl.classList.add('visible');
 input.setAttribute('aria-expanded', 'true');
 A11y.announce(results.length + ' result' + (results.length === 1 ? '' : 's') + ' found');
}

// Returns a DocumentFragment with query matches wrapped in <mark> tags (XSS-safe)
// Handles node names that contain HTML (e.g. <i> tags for Latin terms)
function highlightMatch(text, query) {
 const frag = document.createDocumentFragment();
 // Strip HTML to find match position, then reconstruct
 const plainText = text.replace(/<[^>]*>/g, '');
 const idx = plainText.toLowerCase().indexOf(query.toLowerCase());
 if (idx === -1) {
 // No match in plain text — render with HTML intact (sanitized)
 const span = document.createElement('span');
 span.innerHTML = safeHTML(text);
 frag.appendChild(span);
 return frag;
 }
 // For simple cases where name has no HTML, use fast textNode path
 if (plainText === text) {
 frag.appendChild(document.createTextNode(text.substring(0, idx)));
 const mark = document.createElement('mark');
 mark.textContent = text.substring(idx, idx + query.length);
 frag.appendChild(mark);
 frag.appendChild(document.createTextNode(text.substring(idx + query.length)));
 return frag;
 }
 // HTML-containing name: render full HTML (sanitized; match highlighting is secondary to correct display)
 const span = document.createElement('span');
 span.innerHTML = safeHTML(text);
 frag.appendChild(span);
 return frag;
}

// Returns a DocumentFragment with a contextual snippet around the query match (XSS-safe)
function getSnippet(text, query) {
 const frag = document.createDocumentFragment();
 const idx = text.toLowerCase().indexOf(query.toLowerCase());
 if (idx === -1) {
 frag.appendChild(document.createTextNode(text.substring(0, 120) + '…'));
 return frag;
 }
 const start = Math.max(0, idx - 40);
 const end = Math.min(text.length, idx + query.length + 80);
 const snippet = (start > 0 ? '…' : '') + text.substring(start, end) + (end < text.length ? '…' : '');
 frag.appendChild(document.createTextNode(snippet));
 return frag;
}

// ── Paths ──
function startPath(pathKey) {
 const path = STUDY_PATHS[pathKey];
 if (!path) return;
 activePath = { key: pathKey, ids: path.ids, name: path.name, _idsSet: new Set(path.ids) };
 activePathIndex = 0;
 ActiveEngine.markDirty();
 navigateToPathNode(0);

 document.getElementById('path-indicator').classList.add('visible');
 document.getElementById('path-name').textContent = path.name;
 document.getElementById('paths-popup').classList.remove('visible');
 document.getElementById('btn-paths').classList.remove('active');
}

function stopPath() {
 activePath = null;
 activePathIndex = 0;
 document.getElementById('path-indicator').classList.remove('visible');
 searchHighlightIds = null;
 ActiveEngine.markDirty();
}

function navigateToPathNode(index) {
 if (!activePath || index < 0 || index >= activePath.ids.length) return;
 activePathIndex = index;
 const nodeId = activePath.ids[index];
 openPanel(nodeId);
 document.getElementById('path-counter').textContent = `${index + 1}/${activePath.ids.length}`;
}

// ── Legend ──
function buildLegend() {
 const legendEl = document.getElementById('legend');
 const entries = Object.entries(CATEGORIES);
 entries.forEach(([key, cat], index) => {
 const item = document.createElement('div');
 item.className = 'legend-item';
 item.setAttribute('role', 'button');
 item.setAttribute('aria-pressed', 'false');
 item.setAttribute('aria-label', 'Filter by ' + cat.label);
 item.tabIndex = index === 0 ? 0 : -1; // roving tabindex

 const dot = document.createElement('div');
 dot.className = 'legend-dot';
 dot.style.background = cat.color;
 dot.style.boxShadow = '0 0 8px ' + cat.color;
 dot.setAttribute('aria-hidden', 'true');

 const label = document.createElement('span');
 label.className = 'legend-label';
 label.textContent = cat.label;

 item.append(dot, label);

 const toggle = () => {
 const isActive = item.classList.contains('active');
 document.querySelectorAll('.legend-item').forEach(l => {
 l.classList.remove('active');
 l.setAttribute('aria-pressed', 'false');
 });
 if (!isActive) {
 item.classList.add('active');
 item.setAttribute('aria-pressed', 'true');
 ActiveEngine.filterByCategory(key);
 } else {
 ActiveEngine.filterByCategory(null);
 }
 };

 item.onclick = toggle;
 item.onkeydown = (e) => {
 if (e.key === 'Enter' || e.key === ' ') {
 e.preventDefault(); toggle();
 }
 // Roving tabindex: arrow key navigation within toolbar
 const items = [...legendEl.querySelectorAll('.legend-item')];
 const idx = items.indexOf(item);
 let next = -1;
 if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
 e.preventDefault(); next = (idx + 1) % items.length;
 } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
 e.preventDefault(); next = (idx - 1 + items.length) % items.length;
 } else if (e.key === 'Home') {
 e.preventDefault(); next = 0;
 } else if (e.key === 'End') {
 e.preventDefault(); next = items.length - 1;
 }
 if (next >= 0) {
 items[idx].tabIndex = -1;
 items[next].tabIndex = 0;
 items[next].focus();
 }
 };
 legendEl.appendChild(item);
 });
}

// ── Paths Popup ──
function buildPathsPopup() {
 const listEl = document.getElementById('paths-list');
 Object.entries(STUDY_PATHS).forEach(([key, path]) => {
 const progressCount = path.ids.filter(id => studiedNodes.has(id)).length;
 const progressPct = Math.round((progressCount / path.ids.length) * 100);
 const item = document.createElement('div');
 item.className = 'path-item';
 item.setAttribute('role', 'listitem');
 item.tabIndex = 0;
 item.setAttribute('aria-label', path.name + ', ' + path.ids.length + ' nodes, ' + progressPct + '% complete. ' + path.description);

 const small = document.createElement('small');
 small.textContent = 'GUIDED PATH';
 const nameSpan = document.createElement('span');
 nameSpan.className = 'path-name';
 nameSpan.textContent = path.name;
 const meta = document.createElement('span');
 meta.className = 'path-meta';
 meta.textContent = path.ids.length + ' nodes · ' + path.description;
 const progress = document.createElement('div');
 progress.className = 'path-progress';
 progress.setAttribute('role', 'progressbar');
 progress.setAttribute('aria-valuenow', progressPct);
 progress.setAttribute('aria-valuemin', '0');
 progress.setAttribute('aria-valuemax', '100');
 progress.setAttribute('aria-label', path.name + ' progress');
 const fill = document.createElement('div');
 fill.className = 'path-progress-fill';
 fill.style.width = progressPct + '%';
 progress.appendChild(fill);
 item.append(small, nameSpan, meta, progress);

 const activate = () => startPath(key);
 item.onclick = activate;
 item.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); activate(); } };
 listEl.appendChild(item);
 });
}

// ═══════════════════════════════════════════
// §6e - FLYTHROUGH UI (Improvement #23)
// ═══════════════════════════════════════════
function updateFlythroughUI(nodeId, idx, total, pathName) {
 const titleEl = document.getElementById('flythrough-node-title');
 const descEl = document.getElementById('flythrough-node-desc');
 const dotsEl = document.getElementById('flythrough-dots');
 const textEl = document.getElementById('flythrough-text');
 const locusEl = document.getElementById('flythrough-locus-name');
 if (!titleEl || !descEl || !dotsEl || !textEl) return;

 const data = nodeIndex.get(nodeId);
 if (!data) return;

 // Fade out then in
 textEl.classList.remove('visible');
 setTimeout(() => {
 // Show path name and category context
 if (locusEl) {
 const catName = data.ct ? data.ct.replace(/_/g, ' ') : '';
 locusEl.textContent = pathName ? (pathName + (catName ? ' · ' + catName : '')) : catName;
 }
 titleEl.innerHTML = safeHTML(data.n || nodeId);
 // Show full description in flythrough overlay
 const desc = data.d || '';
 descEl.innerHTML = safeHTML(desc);

 // Build progress dots (clickable for direct navigation)
 dotsEl.innerHTML = '';
 // Add counter text
 const counter = document.createElement('span');
 counter.style.cssText = 'font-family:var(--font-ui);font-size:10px;color:var(--text-muted);letter-spacing:0.04em;margin-right:4px;';
 counter.textContent = (idx + 1) + '/' + total;
 dotsEl.appendChild(counter);
 for (let i = 0; i < total; i++) {
 const dot = document.createElement('div');
 dot.className = 'flythrough-dot';
 if (i < idx) dot.classList.add('past');
 if (i === idx) dot.classList.add('active');
 dot.style.cursor = 'pointer';
 dot.setAttribute('role', 'button');
 dot.setAttribute('aria-label', 'Go to stop ' + (i + 1));
 const dotIdx = i;
 dot.onclick = () => ThreeEngine.navigateFlythroughTo(dotIdx);
 dotsEl.appendChild(dot);
 }

 textEl.classList.add('visible');
 }, 350);
}

// ── Wire UI ──
function wireUI() {
 // ── Platform-aware search shortcut label ──
 var shortcutLabel = document.getElementById('search-shortcut-label');
 var keyboardHints = document.getElementById('keyboard-hints');
 var isMac = navigator.platform && navigator.platform.indexOf('Mac') > -1;
 if (shortcutLabel) {
 shortcutLabel.textContent = isMac ? '⌘K' : 'Ctrl K';
 }
 if (keyboardHints && !isMac) {
 keyboardHints.innerHTML = keyboardHints.innerHTML.replace('⌘K', 'Ctrl K');
 }

 // ── Panel tabs (ARIA tablist keyboard pattern) ──
 const tabs = [...document.querySelectorAll('.panel-tab')];
 function activateTab(tab) {
 tabs.forEach(t => {
 t.classList.remove('active');
 t.setAttribute('aria-selected', 'false');
 t.tabIndex = -1;
 });
 document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
 tab.classList.add('active');
 tab.setAttribute('aria-selected', 'true');
 tab.tabIndex = 0;
 tab.focus();
 document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
 }
 tabs.forEach(tab => {
 tab.onclick = () => activateTab(tab);
 tab.onkeydown = (e) => {
 const idx = tabs.indexOf(tab);
 let next = -1;
 if (e.key === 'ArrowRight') { e.preventDefault(); next = (idx + 1) % tabs.length; }
 else if (e.key === 'ArrowLeft') { e.preventDefault(); next = (idx - 1 + tabs.length) % tabs.length; }
 else if (e.key === 'Home') { e.preventDefault(); next = 0; }
 else if (e.key === 'End') { e.preventDefault(); next = tabs.length - 1; }
 if (next >= 0) activateTab(tabs[next]);
 };
 });

 // ── Panel close ──
 document.getElementById('panel-close').onclick = closePanel;

 // ── Search with keyboard navigation (combobox + listbox pattern) ──
 const searchInput = document.getElementById('search-input');
 const resultsEl = document.getElementById('search-results');
 let searchTimeout;

 searchInput.oninput = function() {
 clearTimeout(searchTimeout);
 const query = this.value.trim();
 A11y.resetSearchIndex();
 // ── Adaptive debounce: longer on mobile to reduce jank during typing ──
 const debounceMs = DeviceCapabilities.isMobile ? 200 : 120;
 searchTimeout = setTimeout(() => performSearch(query), debounceMs);
 };

 searchInput.addEventListener('focus', function() {
 if (this.value.trim().length >= 2) performSearch(this.value.trim());
 });

 searchInput.addEventListener('keydown', function(e) {
 const options = [...resultsEl.querySelectorAll('[role="option"]')];
 if (!options.length || !resultsEl.classList.contains('visible')) return;

 if (e.key === 'ArrowDown') {
 e.preventDefault();
 A11y.searchActiveIndex = Math.min(A11y.searchActiveIndex + 1, options.length - 1);
 } else if (e.key === 'ArrowUp') {
 e.preventDefault();
 A11y.searchActiveIndex = Math.max(A11y.searchActiveIndex - 1, -1);
 } else if (e.key === 'Enter' && A11y.searchActiveIndex >= 0) {
 e.preventDefault();
 options[A11y.searchActiveIndex].click();
 return;
 } else {
 return;
 }

 // Update aria-activedescendant and visual highlight
 options.forEach(opt => opt.setAttribute('aria-selected', 'false'));
 if (A11y.searchActiveIndex >= 0) {
 const active = options[A11y.searchActiveIndex];
 active.setAttribute('aria-selected', 'true');
 searchInput.setAttribute('aria-activedescendant', active.id);
 active.scrollIntoView({ block: 'nearest' });
 } else {
 searchInput.setAttribute('aria-activedescendant', '');
 }
 });

 document.addEventListener('click', e => {
 if (!e.target.closest('.search-container')) {
 resultsEl.classList.remove('visible');
 searchInput.setAttribute('aria-expanded', 'false');
 A11y.resetSearchIndex();
 }
 });

 // ── Paths popup with aria-expanded + focus trap ──
 const pathsPopup = document.getElementById('paths-popup');
 const pathsBtn = document.getElementById('btn-paths');
 pathsBtn.onclick = function() {
 const isVisible = pathsPopup.classList.contains('visible');
 pathsPopup.classList.toggle('visible');
 this.classList.toggle('active', !isVisible);
 this.setAttribute('aria-expanded', !isVisible ? 'true' : 'false');
 if (!isVisible) {
 // Opening: focus first item, enable focus trap
 const firstItem = pathsPopup.querySelector('[tabindex="0"]');
 if (firstItem) setTimeout(() => firstItem.focus(), 100);
 A11y.enableFocusTrap(pathsPopup);
 } else {
 // Closing: disable focus trap, return focus
 A11y.disableFocusTrap();
 pathsBtn.focus();
 }
 };
 // Close paths popup on outside click
 document.addEventListener('click', e => {
 if (pathsPopup.classList.contains('visible') &&
 !e.target.closest('#paths-popup') && !e.target.closest('#btn-paths')) {
 pathsPopup.classList.remove('visible');
 pathsBtn.classList.remove('active');
 pathsBtn.setAttribute('aria-expanded', 'false');
 A11y.disableFocusTrap();
 }
 });
 document.getElementById('path-close').onclick = stopPath;
 document.getElementById('path-prev').onclick = () => navigateToPathNode(activePathIndex - 1);
 document.getElementById('path-next').onclick = () => navigateToPathNode(activePathIndex + 1);

 // ── Flythrough picker references (declared early for closure access) ──
 const flythroughPicker = document.getElementById('flythrough-picker');
 const flythroughBackdrop = document.getElementById('flythrough-picker-backdrop');
 const flythroughList = document.getElementById('flythrough-picker-list');
 function closeFlythroughPicker() {
 flythroughPicker.classList.remove('visible');
 flythroughBackdrop.classList.remove('visible');
 }

 // ── Reset view ──
 document.getElementById('btn-reset').onclick = () => {
 closePanel();
 stopPath();
 // Also stop flythrough if running
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active) {
 ThreeEngine.stopFlythrough();
 }
 closeFlythroughPicker();
 resetView();
 };

 // ── Meditate button (Improvement #23) : The Reformed tradition opens path picker ──

 function openFlythroughPicker() {
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active) {
 ThreeEngine.stopFlythrough();
 return;
 }
 // Build picker items from FLYTHROUGH_PATHS
 flythroughList.innerHTML = '';
 FLYTHROUGH_PATHS.forEach(fp => {
 const item = document.createElement('div');
 item.className = 'picker-item';
 item.tabIndex = 0;
 item.setAttribute('role', 'button');
 const dot = document.createElement('div');
 dot.className = 'picker-item-dot';
 dot.style.background = fp.color;
 const info = document.createElement('div');
 info.className = 'picker-item-info';
 const name = document.createElement('div');
 name.className = 'picker-item-name';
 name.textContent = fp.name;
 const desc = document.createElement('div');
 desc.className = 'picker-item-desc';
 desc.textContent = fp.desc;
 info.append(name, desc);
 const count = document.createElement('div');
 count.className = 'picker-item-count';
 count.textContent = fp.ids.length + ' stops';
 item.append(dot, info, count);
 const launch = () => {
 closeFlythroughPicker();
 closePanel();
 stopPath();
 setTimeout(() => {
 ThreeEngine.startFlythrough(fp.ids, fp.name, fp.color);
 }, 200);
 };
 item.onclick = launch;
 item.onkeydown = (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); launch(); } };
 flythroughList.appendChild(item);
 });
 flythroughPicker.classList.add('visible');
 flythroughBackdrop.classList.add('visible');
 }

 document.getElementById('btn-meditate').onclick = openFlythroughPicker;
 flythroughBackdrop.onclick = closeFlythroughPicker;
 document.getElementById('flythrough-pause').onclick = () => {
 ThreeEngine.toggleFlythroughPause();
 };
 document.getElementById('flythrough-exit').onclick = () => {
 ThreeEngine.stopFlythrough();
 };
 document.getElementById('flythrough-prev').onclick = () => {
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active) {
 ThreeEngine.navigateFlythroughTo(ThreeEngine.flythrough.currentIdx - 1);
 }
 };
 document.getElementById('flythrough-next').onclick = () => {
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active) {
 ThreeEngine.navigateFlythroughTo(ThreeEngine.flythrough.currentIdx + 1);
 }
 };

 // ── Progress badge click to reset ──
 document.getElementById('progress-badge').onclick = () => {
 resetProgress();
 };

 // ── Keyboard shortcuts ──
 window.addEventListener('keydown', e => {
 const panel = document.getElementById('study-panel');
 const panelOpen = panel.classList.contains('open');

 // Inside search input: handle Escape to close results
 if (e.target === searchInput) {
 if (e.key === 'Escape') {
 e.target.blur();
 resultsEl.classList.remove('visible');
 searchInput.setAttribute('aria-expanded', 'false');
 A11y.resetSearchIndex();
 searchHighlightIds = null;
 ActiveEngine.markDirty();
 }
 return;
 }

 // Escape key - layered dismissal (innermost open surface first)
 if (e.key === 'Escape') {
 // 0a. If flythrough picker is open, close it
 if (flythroughPicker.classList.contains('visible')) {
 closeFlythroughPicker();
 return;
 }
 // 0b. If flythrough is active, stop it
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active) {
 ThreeEngine.stopFlythrough();
 return;
 }
 // 1. If paths popup is open, close it and return focus to trigger
 if (pathsPopup.classList.contains('visible')) {
 pathsPopup.classList.remove('visible');
 pathsBtn.classList.remove('active');
 pathsBtn.setAttribute('aria-expanded', 'false');
 A11y.disableFocusTrap();
 pathsBtn.focus();
 return;
 }
 // 2. If study panel is open, close it (focus restoration handled by closePanel)
 if (panelOpen) {
 closePanel();
 return;
 }
 // 3. Nothing modal open - global reset
 stopPath();
 resetView();
 return;
 }

 // Path navigation (only when not inside the panel)
 if (e.key === 'ArrowRight' && activePath && !panelOpen) navigateToPathNode(activePathIndex + 1);
 if (e.key === 'ArrowLeft' && activePath && !panelOpen) navigateToPathNode(activePathIndex - 1);

 // Flythrough navigation (arrows when flythrough is active)
 if (ThreeEngine.flythrough && ThreeEngine.flythrough.active && !panelOpen) {
 if (e.key === 'ArrowRight') ThreeEngine.navigateFlythroughTo(ThreeEngine.flythrough.currentIdx + 1);
 if (e.key === 'ArrowLeft') ThreeEngine.navigateFlythroughTo(ThreeEngine.flythrough.currentIdx - 1);
 }

 // Global search shortcut
 if ((e.key === 'k' && (e.metaKey || e.ctrlKey)) || e.key === '/') {
 e.preventDefault();
 searchInput.focus();
 }
 });

 // ── Onboarding ──
 const enterBtn = document.getElementById('enter-btn');
 const onboardingScreen = document.getElementById('onboarding-screen');

 enterBtn.onclick = () => {
 onboardingObserver.disconnect(); // ── FIX: Stop observing before removal to prevent leak ──
 onboardingScreen.classList.add('hidden');
 A11y.disableFocusTrap();
 // Show the 3D cosmos now that onboarding is dismissed
 document.getElementById('three-container').style.visibility = 'visible';
 document.getElementById('legend').style.visibility = 'visible';
 // Remove from DOM after transition completes to free resources
 setTimeout(() => onboardingScreen.remove(), 900);
 // Clean up old v1 FTUE key that may block the new tour
 try { localStorage.removeItem('stc_ftue_complete'); } catch(e) {}
 // Launch FTUE coach marks for first-time users (after cosmos is visible)
 setTimeout(() => {
 Log.log('[Init] Checking FTUE tour...');
 if (window.FTUETour) {
 if (window.FTUETour.shouldShow()) {
 Log.log('[Init] Starting FTUE tour.');
 window.FTUETour.start();
 } else {
 Log.log('[Init] FTUE already completed. Focusing search. (Run FTUETour.restart() to replay)');
 searchInput.focus();
 }
 } else {
 Log.warn('[Init] FTUETour not found on window.');
 searchInput.focus();
 }
 }, 600);
 };
 // Auto-focus the enter button and trap focus in onboarding when it becomes visible
 const onboardingObserver = new MutationObserver(() => {
 if (!onboardingScreen.classList.contains('hidden')) {
 A11y.enableFocusTrap(onboardingScreen);
 setTimeout(() => enterBtn.focus(), 400);
 }
 });
 onboardingObserver.observe(onboardingScreen, { attributes: true, attributeFilter: ['class'] });

 // ── Resize handler ── (handled by ThreeEngine.bindEvents via ResizeObserver + window.resize fallback)

 // ═══ MOBILE-SPECIFIC ENHANCEMENTS ═══
 if (DeviceCapabilities.isMobile || DeviceCapabilities.isTablet) {

 // ── Mobile Legend Toggle ──
 const legendToggle = document.getElementById('btn-legend-mobile');
 const legend = document.getElementById('legend');
 if (legendToggle) {
 legendToggle.style.display = '';
 legendToggle.onclick = () => {
 const isOpen = legend.classList.contains('mobile-open');
 legend.classList.toggle('mobile-open');
 legendToggle.classList.toggle('active', !isOpen);
 legendToggle.setAttribute('aria-expanded', !isOpen ? 'true' : 'false');
 };
 // Close legend on outside tap
 document.addEventListener('click', e => {
 if (legend.classList.contains('mobile-open') &&
 !e.target.closest('#legend') && !e.target.closest('#btn-legend-mobile')) {
 legend.classList.remove('mobile-open');
 legendToggle.classList.remove('active');
 legendToggle.setAttribute('aria-expanded', 'false');
 }
 });
 }

 // ── Swipe-to-close Panel Gesture ──
 const studyPanel = document.getElementById('study-panel');
 let swipeStartX = 0, swipeStartY = 0, isSwiping = false;
 const SWIPE_THRESHOLD = 80; // px to trigger close
 const SWIPE_ANGLE_LIMIT = 30; // max degrees from horizontal

 studyPanel.addEventListener('touchstart', e => {
 if (!studyPanel.classList.contains('open')) return;
 const touch = e.touches[0];
 swipeStartX = touch.clientX;
 swipeStartY = touch.clientY;
 isSwiping = false;
 }, { passive: true });

 studyPanel.addEventListener('touchmove', e => {
 if (!studyPanel.classList.contains('open')) return;
 const touch = e.touches[0];
 const dx = touch.clientX - swipeStartX;
 const dy = touch.clientY - swipeStartY;
 // Only track horizontal swipes to the right
 if (!isSwiping && Math.abs(dx) > 15 && Math.abs(dy) < Math.abs(dx)) {
 isSwiping = true;
 }
 if (isSwiping && dx > 0) {
 // P3 #27: Prevent simultaneous scrolling during horizontal swipe gesture
 e.preventDefault();
 // Visual feedback: translate panel proportionally
 const progress = Math.min(dx / (window.innerWidth * 0.5), 1);
 studyPanel.style.transition = 'none';
 studyPanel.style.transform = `translateX(${dx}px)`;
 studyPanel.style.opacity = 1 - progress * 0.3;
 }
 }, { passive: false });

 studyPanel.addEventListener('touchend', e => {
 if (!isSwiping) return;
 const touch = e.changedTouches[0];
 const dx = touch.clientX - swipeStartX;
 studyPanel.style.transition = '';
 studyPanel.style.opacity = '';
 if (dx > SWIPE_THRESHOLD) {
 // Close the panel
 closePanel();
 } else {
 // Snap back
 studyPanel.style.transform = '';
 }
 isSwiping = false;
 }, { passive: true });

 // ── Touch-friendly tooltip: auto-dismiss handled in updateTooltip() via DeviceCapabilities.isMobile check ──
 }
}

// ═══════════════════════════════════════════
// §9 - INITIALIZATION (Milestone-based)
// ═══════════════════════════════════════════

// ── Deterministic progress tracker ──
const InitProgress = {
 milestones: {
 fonts: { weight: 10, done: false, label: 'Loading typefaces' },
 threejs: { weight: 10, done: false, label: 'Loading 3D engine' },
 data: { weight: 25, done: false, label: 'Indexing doctrine data' },
 ui: { weight: 20, done: false, label: 'Building interface' },
 engine: { weight: 25, done: false, label: 'Initializing renderer' },
 render: { weight: 10, done: false, label: 'First render' },
 },
 _fill: null,
 _step: null,
 _bar: null,

 init() {
 this._fill = document.getElementById('loading-fill');
 this._step = document.getElementById('loading-step');
 this._bar = document.querySelector('.loading-bar');
 },

 complete(key) {
 if (!this.milestones[key] || this.milestones[key].done) return;
 this.milestones[key].done = true;
 this._update();
 },

 _update() {
 let pct = 0;
 let lastPendingLabel = null;
 for (const [, m] of Object.entries(this.milestones)) {
 if (m.done) pct += m.weight;
 else if (!lastPendingLabel) lastPendingLabel = m.label;
 }
 pct = Math.min(pct, 100);
 if (this._fill) {
 this._fill.style.width = pct + '%';
 }
 if (this._bar) {
 this._bar.setAttribute('aria-valuenow', String(pct));
 }
 if (this._step) {
 this._step.textContent = pct >= 100 ? 'Ready' : (lastPendingLabel || 'Finishing up') + '\u2026';
 }
 if (pct >= 100) this._dismiss();
 },

 _dismiss() {
 setTimeout(() => {
 const ls = document.getElementById('loading-screen');
 ls.classList.add('hidden');
 // Remove from DOM after transition to stop infinite CSS animations
 setTimeout(() => ls.remove(), 900);
 document.getElementById('onboarding-screen').classList.remove('hidden');
 }, 350);
 }
};

// Helper: yield to browser so the progress bar can repaint between sync steps
function yieldThen(fn) {
 return new Promise(resolve => {
 requestAnimationFrame(() => { fn(); resolve(); });
 });
}

async function initialize() {
 try {
 await _initializeInner();
 } catch (err) {
 Log.error('[Init] Fatal initialization error:', err);
 // Force-dismiss the loading screen so the user isn't stuck staring at it
 const ls = document.getElementById('loading-screen');
 if (ls) ls.classList.add('hidden');
 showDegradationBanner(
 'The application encountered an error during startup. ' +
 'Some features may be unavailable. Please refresh to try again.'
 );
 }
}

async function _initializeInner() {
 InitProgress.init();

 // ── Resolve async asset milestones that may already be settled ──
 // Fonts
 if (window.__fontsLoaded === true) {
 InitProgress.complete('fonts');
 } else if (window.__fontsLoaded === false) {
 InitProgress.complete('fonts'); // failed but resolved - we have fallbacks
 } else {
 // Still pending - listen for resolution
 const fontDone = () => InitProgress.complete('fonts');
 document.addEventListener('fonts-load-failed', fontDone, { once: true });
 if (document.fonts && document.fonts.ready) {
 document.fonts.ready.then(() => {
 document.fonts.load('400 16px "Cinzel"').then(fontDone).catch(fontDone);
 });
 }
 // Safety timeout - don't block forever
 setTimeout(fontDone, 6000);
 }

 // Three.js
 if (window.__threeAvailable === true || window.__threeAvailable === false) {
 InitProgress.complete('threejs');
 } else {
 const threeDone = () => InitProgress.complete('threejs');
 document.addEventListener('three-load-success', threeDone, { once: true });
 document.addEventListener('three-load-failed', threeDone, { once: true });
 setTimeout(threeDone, 6000);
 }

 // ── Synchronous steps with yields for repaint ──
 await yieldThen(() => {
 buildDataIndex();
 buildRelatedTopicsIndex();
 loadProgress();
 updateProgressBadge();
 InitProgress.complete('data');
 });

 await yieldThen(() => {
 buildLegend();
 buildPathsPopup();
 wireUI();
 InitProgress.complete('ui');
 });

 // ── Render engine (3D only) ──
 await yieldThen(() => {
 if (window.__threeAvailable) {
 try {
 ThreeEngine.init();
 threeInitialized = true;
 } catch (e) {
 Log.error('[Init] Three.js init failed:', e);
 window.__threeAvailable = false;
 showDegradationBanner('3D rendering failed to initialize. Please refresh or try a different browser.');
 }
 } else {
 Log.error('[Init] Three.js not available. 3D cosmos cannot render.');
 showDegradationBanner('3D engine could not be loaded. Please check your connection and refresh.');
 }
 InitProgress.complete('engine');
 });

 // ── First render - wait for an actual frame to paint ──
 // P3 #23: Single rAF is sufficient for marking the milestone
 requestAnimationFrame(() => {
 InitProgress.complete('render');
 });

 // Handle deep link
 setTimeout(handleDeepLink, 800);
}

// ── Degradation Banner Helper ──
function showDegradationBanner(message) {
 const banner = document.getElementById('degradation-banner');
 if (banner) {
 document.getElementById('banner-message').textContent = message;
 banner.classList.add('visible');
 }
}

// ── Listen for asset load failures and show appropriate messages ──
document.addEventListener('three-load-failed', function() {
 Log.error('[Three.js] All CDN sources failed. 3D cosmos will not be available.');
 showDegradationBanner('3D engine could not be loaded. Please check your connection and refresh.');
});

document.addEventListener('fonts-load-failed', function() {
 // Silent degradation: CSS already specifies Georgia as fallback in all font stacks.
 // No user-facing banner needed - the fallback is visually seamless.
 Log.log('[Fonts] Using system fallback fonts (Georgia, serif).');
});

// ── Global error handler - catch unhandled errors that could freeze the app ──
window.addEventListener('error', function(event) {
 // Only intervene for WebGL / Three.js errors (not general JS bugs)
 const msg = (event.message || '').toLowerCase();
 const isGLError = msg.includes('webgl') || msg.includes('three') ||
 msg.includes('gl_') || msg.includes('shader') ||
 msg.includes('context');
 if (isGLError && threeInitialized && !ActiveEngine._runtimeFailed) {
 Log.error('[Global] Caught WebGL/Three.js error:', event.message);
 ActiveEngine._handleRuntimeFailure(new Error(event.message));
 }
});

// ── WebGL Context Lost / Restored ──
// If the GPU reclaims the WebGL context (e.g. system sleep, driver crash),
// Three.js will throw on the next draw call. We catch it proactively.
document.addEventListener('DOMContentLoaded', function() {
 // Deferred: canvas won't exist until ThreeEngine.init()
 const observer = new MutationObserver(function(mutations) {
 const canvas = document.querySelector('#three-container canvas');
 if (canvas) {
 observer.disconnect();
 canvas.addEventListener('webglcontextlost', function(e) {
 e.preventDefault();
 Log.error('[WebGL] Context lost');
 if (!ActiveEngine._runtimeFailed) {
 ActiveEngine._handleRuntimeFailure(new Error('WebGL context lost'));
 }
 });
 canvas.addEventListener('webglcontextrestored', function() {
 Log.log('[WebGL] Context restored - reload may be needed for full recovery');
 });
 }
 });
 const container = document.getElementById('three-container');
 if (container) observer.observe(container, { childList: true });
});

// ── Boot: wait for Three.js loader to resolve, or start after a timeout ──
(function boot() {
 // If Three.js is already confirmed available or failed, start immediately
 if (window.__threeAvailable === true || window.__threeAvailable === false) {
 initialize();
 return;
 }
 // Wait briefly for async script loader, then start regardless
 var bootTimeout = setTimeout(function() {
 document.removeEventListener('three-load-success', onReady);
 document.removeEventListener('three-load-failed', onReady);
 initialize();
 }, 3000);

 function onReady() {
 clearTimeout(bootTimeout);
 document.removeEventListener('three-load-success', onReady);
 document.removeEventListener('three-load-failed', onReady);
 initialize();
 }
 document.addEventListener('three-load-success', onReady);
 document.addEventListener('three-load-failed', onReady);
})();
</script>
</body>
</html>
