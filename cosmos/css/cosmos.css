/* ═══════════════════════════════════════════════════════════
 SYSTEMATIC THEOLOGY 4.0 - INTERACTIVE THEOLOGICAL COSMOS
 A world-class theological study tool with constellation
 graph navigation. Clean architecture, responsive, accessible.
 ═══════════════════════════════════════════════════════════ */

/* ── Design Tokens ── */
:root {
 /* Backgrounds - deeper, richer darks with subtle warmth */
 --bg-primary: #000000;
 --bg-secondary: #07070f;
 --bg-tertiary: #0b0b16;
 --bg-surface: #10101c;
 --bg-elevated: #141428;
 --bg-hover: rgba(224,192,80,0.025);
 --bg-active: rgba(224,192,80,0.045);

 /* Borders - warmer, more refined */
 --border-subtle: rgba(224,192,80,0.05);
 --border-default: rgba(224,192,80,0.09);
 --border-strong: rgba(224,192,80,0.16);

 /* Text - warmer parchment tones */
 --text-primary: #ece8da;
 --text-secondary: #d0cbc0;
 --text-tertiary: #9e9a90;
 --text-muted: #6b675e;

 /* Accent - Refined Gold (richer, more luminous) */
 --gold: #dcc15a;
 --gold-dim: #b89b3e;
 --gold-glow: rgba(220,193,90,0.13);
 --gold-surface: rgba(220,193,90,0.06);
 --gold-bright: #f0d96c;
 --gold-deep: #9a7e2e;

 /* Category Colors - refined, more jewel-toned */
 --cat-theology: #e0c860;
 --cat-christology: #d9a055;
 --cat-anthropology: #5eb868;
 --cat-ecclesiology: #b888d8;
 --cat-eschatology: #50b8b8;
 --cat-prolegomena: #6da8d8;
 --cat-hamartiology: #d86868;
 --cat-pneumatology: #90d0b8;
 --cat-soteriology: #d0886c;
 --cat-ethics: #c0ac60;
 --cat-polemics: #c46050;
 --cat-piety: #d4a874;
 --cat-biblical_theology: #7db88a;

 /* Typography */
 --font-display: 'Cinzel', Georgia, serif;
 --font-heading: 'Cormorant Garamond', Georgia, serif;
 --font-body: 'EB Garamond', Georgia, serif;
 --font-ui: 'Spectral', Georgia, serif;
 --font-accent: 'Cormorant', Georgia, serif;

 /* Spacing */
 --space-xs: 4px;
 --space-sm: 8px;
 --space-md: 16px;
 --space-lg: 24px;
 --space-xl: 32px;
 --space-2xl: 48px;

 /* Transitions */
 --ease-out: cubic-bezier(0, 0, 0.2, 1);
 --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
 --duration-fast: 150ms;
 --duration-normal: 300ms;
 --duration-slow: 500ms;

 /* Layout */
 --panel-width: 520px;
 --topbar-height: 56px;
 --search-width: 380px;

 /* ── NEW: Mobile viewport height fix ── */
 /* dvh = dynamic viewport height (respects browser chrome) */
 --vh-full: 100dvh;
 --vh-full-fallback: 100vh;

 /* ── NEW: Safe area insets for notched devices ── */
 --safe-top: env(safe-area-inset-top, 0px);
 --safe-bottom: env(safe-area-inset-bottom, 0px);
 --safe-left: env(safe-area-inset-left, 0px);
 --safe-right: env(safe-area-inset-right, 0px);

 /* ── NEW: Touch target minimum (WCAG 2.5.8) ── */
 --touch-min: 44px;
}

/* ═══ APPLE-QUALITY MICRO-INTERACTIONS ═══
 Principles: physical, responsive, felt-not-seen.
 Every tap gives instant feedback. Hovers breathe life.
 Spring curves make everything feel tangible. */

/* ── Universal Interactive Foundation ──
 All clickable elements get hardware-accelerated transforms
 and a refined spring-out on release */
.enter-btn,
.control-btn,
.bottom-btn,
.flythrough-btn,
.ftue-next,
.ftue-skip,
.panel-close-btn,
.panel-study-toggle,
.panel-read-more,
.panel-tab,
.path-nav-btn,
.path-close-btn,
.banner-dismiss,
.progress-badge,
.scripture-tag,
.confessional-tag,
.keyword-tag,
.legend-item,
.picker-item,
.path-item,
.connection-item,
.search-result-item,
.study-card,
#breadcrumb span:not(.sep) {
 -webkit-tap-highlight-color: transparent;
 will-change: transform;
 transform: translateZ(0); /* promote to compositor layer */
}

/* ── Button Press: Tactile Scale ──
 Apple's signature: quick press-in, spring-out on release.
 120ms in, 400ms spring out : feels like touching glass */
.enter-btn:active {
 transform: scale(0.965) !important;
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1) !important;
}
.control-btn:active,
.bottom-btn:active,
.flythrough-btn:active,
.path-nav-btn:active,
.path-close-btn:active,
.banner-dismiss:active {
 transform: scale(0.94);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}
/* Spring release for all buttons */
.control-btn,
.bottom-btn,
.flythrough-btn,
.path-nav-btn,
.path-close-btn,
.banner-dismiss {
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ── Progress Badge: Haptic Press ── */
.progress-badge:active {
 transform: scale(0.93);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── FTUE Buttons: Confident Press ── */
.ftue-next:active {
 transform: scale(0.95) !important;
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1) !important;
}
.ftue-skip:active {
 transform: scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Panel Close: Subtle Rotation on Hover ── */
.panel-close-btn {
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.panel-close-btn:hover {
 transform: rotate(90deg);
}
.panel-close-btn:active {
 transform: rotate(90deg) scale(0.88);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Panel Tabs: Smooth Underline Slide ──
 Active tab gets a sliding underline via pseudo-element */
.panel-tab {
 position: relative;
 transition: all 0.4s var(--ease-out), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.panel-tab:active {
 transform: scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Tags: Micro-lift + Glow ──
 Scripture and keyword tags feel like pressable chips */
.scripture-tag,
.confessional-tag,
.keyword-tag {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.scripture-tag:hover,
.confessional-tag:hover,
.keyword-tag:hover {
 transform: translateY(-1px);
}
.scripture-tag:active,
.confessional-tag:active,
.keyword-tag:active {
 transform: translateY(0) scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Cards: Lift on Hover, Settle on Press ──
 Study cards and picker items feel like physical cards */
.study-card {
 transition: all 0.45s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.study-card:active {
 transform: translateY(0) scale(0.98) !important;
 box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1);
}

.picker-item {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.picker-item:hover {
 transform: translateX(2px);
}
.picker-item:active {
 transform: translateX(2px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Connection Items: Slide + Press ── */
.connection-item {
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.connection-item:active {
 transform: translateX(3px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Path Items: Press Feedback ── */
.path-item {
 transition: background 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.path-item:hover {
 transform: translateX(2px);
}
.path-item:active {
 transform: translateX(2px) scale(0.98);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Search Results: Subtle Highlight ── */
.search-result-item {
 transition: background 0.25s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.search-result-item:active {
 transform: scale(0.985);
 background: rgba(220,193,90,0.04);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Legend Items: Dot Pulse on Press ── */
.legend-item {
 transition:
 transform 0.5s cubic-bezier(0.23, 1.1, 0.32, 1),
 opacity 0.3s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:active {
 transform: translateX(6px) scale(0.96);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}
.legend-item:active .legend-dot {
 transform: scale(1.8);
 transition: transform 120ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Breadcrumb: Color + Lift ── */
#breadcrumb span:not(.sep) {
 transition: color var(--duration-fast), transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
}
#breadcrumb span:not(.sep):active {
 transform: scale(0.93);
 transition: transform 80ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Read More: Elegant Arrow Shift ── */
.panel-read-more {
 transition: color var(--duration-fast), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), letter-spacing 0.4s var(--ease-out);
}
.panel-read-more:hover {
 letter-spacing: 0.1em;
}
.panel-read-more:active {
 transform: scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Enter Button: Enhanced Spring ──
 The most important CTA : give it extra presence */
.enter-btn {
 transition: all 0.5s var(--ease-out), transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* ── Reset ── */
*, *:before, *:after { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
 width: 100%; height: 100%;
 height: var(--vh-full, var(--vh-full-fallback));
 overflow: hidden;
 background: var(--bg-primary); color: var(--text-primary);
 font-family: var(--font-body);
 font-size: 16px;
 line-height: 1.6;
 -webkit-font-smoothing: antialiased;
 -moz-osx-font-smoothing: grayscale;
 /* ── Prevent pull-to-refresh and overscroll bounce ── */
 overscroll-behavior: none;
 -webkit-overflow-scrolling: touch;
 /* ── Prevent accidental text selection during 3D interaction ── */
 -webkit-touch-callout: none;
}

/* ── Reduced Motion: disable all animations for vestibular sensitivity ── */
@media (prefers-reduced-motion: reduce) {
 *, *:before, *:after {
 animation-duration: 0.01ms !important;
 animation-iteration-count: 1 !important;
 transition-duration: 0.01ms !important;
 scroll-behavior: auto !important;
 }
}

/* ── Scrollbar ── */
:-webkit-scrollbar { width: 3px; }
:-webkit-scrollbar-track { background: transparent; }
:-webkit-scrollbar-thumb { background: rgba(220,193,90,0.08); border-radius: 2px; }
:-webkit-scrollbar-thumb:hover { background: rgba(220,193,90,0.15); }
:selection { background: rgba(220,193,90,0.15); color: var(--text-primary); }

/* ═══ LOADING SCREEN ═══ */
#loading-screen {
 position: fixed; inset: 0; z-index: 10000;
 background: var(--bg-primary);
 display: flex; flex-direction: column; align-items: center; justify-content: center;
 transition: opacity 1.2s var(--ease-out), visibility 1.2s;
}
#loading-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
#loading-screen h1 {
 font-family: var(--font-display); font-weight: 400; font-size: 14px;
 letter-spacing: 0.6em; color: var(--gold-dim); margin-bottom: 8px;
 animation: breatheGlow 3s ease-in-out infinite;
}
/* Elegant ornamental divider below title */
#loading-screen h1:after {
 content: '';
 display: block;
 width: 48px; height: 1px;
 background: linear-gradient(90deg, transparent, var(--gold-dim), transparent);
 margin: 12px auto 0;
 opacity: 0.5;
}
@keyframes breatheGlow {
 0%, 100% { opacity: 0.5; text-shadow: 0 0 0 transparent; }
 50% { opacity: 1; text-shadow: 0 0 30px rgba(220,193,90,0.1); }
}
#loading-screen p {
 font-family: var(--font-accent), Georgia, serif; font-size: 10.5px; color: var(--text-muted);
 letter-spacing: 0.22em; font-style: italic; font-weight: 300;
}
#loading-step {
 margin-top: 16px; font-size: 9px; letter-spacing: 0.14em;
 color: var(--text-muted); opacity: 0.6;
 transition: opacity 0.3s var(--ease-out);
 font-family: var(--font-ui);
}
.loading-bar {
 width: 240px; height: 1px; background: rgba(220,193,90,0.08);
 margin-top: 28px; overflow: hidden; border-radius: 1px;
}
.loading-bar-fill {
 height: 100%; width: 0%;
 background: linear-gradient(90deg, var(--gold-dim), var(--gold), var(--gold-dim));
 background-size: 200% 100%;
 animation: barShimmer 1.5s ease-in-out infinite;
 transition: width 0.4s var(--ease-out);
}
@keyframes barShimmer {
 0% { background-position: 200% 0; }
 100% { background-position: -200% 0; }
}

/* ═══ ONBOARDING ═══ */
#onboarding-screen {
 position: fixed; inset: 0; z-index: 9998;
 background: #030308;
 display: flex; flex-direction: column; align-items: center; justify-content: center;
 transition: opacity 1.2s var(--ease-out), visibility 1.2s;
 padding: var(--space-lg);
}
/* Subtle radial vignette for depth */
#onboarding-screen:before {
 content: '';
 position: absolute; inset: 0;
 background: radial-gradient(ellipse 70% 60% at 50% 45%, rgba(220,193,90,0.015) 0%, transparent 60%);
 pointer-events: none;
}
#onboarding-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

.onboarding-content {
 max-width: 640px; text-align: center; position: relative;
}
.onboarding-content h1 {
 font-family: var(--font-display); font-weight: 400;
 font-size: clamp(15px, 2.4vw, 22px); letter-spacing: 0.55em;
 color: var(--gold); margin-bottom: 10px;
 animation: fadeUp 1s var(--ease-out) both;
}
/* Ornamental flourish beneath the title : removed */
.onboarding-content h2 {
 font-family: var(--font-accent), Georgia, serif; font-weight: 300;
 font-size: clamp(13px, 1.7vw, 17px); color: var(--text-tertiary);
 letter-spacing: 0.12em; margin-bottom: 10px; font-style: italic;
 animation: fadeUp 1s 0.15s var(--ease-out) both;
}
.ob-author {
 font-family: var(--font-heading); font-weight: 300; font-style: italic;
 font-size: clamp(11px, 1.1vw, 13px);
 color: rgba(184, 155, 62, 0.35);
 letter-spacing: 0.06em; margin-bottom: 50px;
 animation: fadeUp 1s 0.25s var(--ease-out) both;
}
.ob-row {
 display: flex; gap: 0; margin-bottom: 56px; flex-wrap: wrap;
 justify-content: center; animation: fadeUp 1s 0.35s var(--ease-out) both;
}
.ob-f {
 text-align: center; width: 140px; padding: 0 24px;
 border-right: 1px solid rgba(220,193,90,0.06);
}
.ob-f:last-child { border-right: none; }
.ob-lb {
 font-family: var(--font-ui); font-size: 9.5px; letter-spacing: 0.08em;
 text-transform: uppercase; color: var(--text-tertiary); line-height: 2;
}

.enter-btn {
 position: relative; overflow: hidden;
 padding: 14px 56px; background: transparent;
 border: 1px solid rgba(184,155,62,0.4); border-radius: 6px;
 font-family: var(--font-display); font-size: 10px;
 letter-spacing: 0.4em; text-transform: uppercase;
 color: var(--gold); cursor: pointer;
 transition: all 0.5s var(--ease-out), transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
 animation: fadeUp 1s 0.55s var(--ease-out) both;
}
.enter-btn:hover {
 background: rgba(220,193,90,0.05); border-color: var(--gold);
 box-shadow: 0 0 60px rgba(220,193,90,0.06), inset 0 0 30px rgba(220,193,90,0.03);
 letter-spacing: 0.5em;
}
.enter-btn:after {
 content: ''; position: absolute; inset: -1px; border-radius: 7px;
 background: transparent; pointer-events: none;
 animation: btnPulse 4s ease-in-out infinite;
}
@keyframes btnPulse {
 0%, 100% { box-shadow: 0 0 0 0 rgba(220,193,90,0); }
 50% { box-shadow: 0 0 30px 3px rgba(220,193,90,0.05); }
}

@keyframes fadeUp {
 from { opacity: 0; transform: translateY(16px); }
 to { opacity: 1; transform: none; }
}

/* ═══ MAIN LAYOUT ═══ */
#app {
 position: fixed; inset: 0; display: flex; flex-direction: column;
 /* ── Use dynamic viewport height for mobile browser chrome ── */
 height: var(--vh-full, var(--vh-full-fallback));
 /* ── Safe area padding for notched devices ── */
 padding-top: var(--safe-top);
 padding-left: var(--safe-left);
 padding-right: var(--safe-right);
}

/* ── Top Bar ── */
#topbar {
 position: relative; z-index: 100; height: var(--topbar-height);
 display: flex; align-items: center; justify-content: space-between;
 padding: 0 var(--space-lg);
 background: linear-gradient(180deg, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) 50%, rgba(0,0,0,0) 100%);
 pointer-events: none;
}
#topbar > * { pointer-events: auto; }

.brand {
 user-select: none; white-space: nowrap;
 display: flex; flex-direction: column; align-items: flex-end;
 gap: 0;
 cursor: default;
}
.brand-title {
 font-family: var(--font-display); font-weight: 400;
 font-size: 9px; letter-spacing: 0.5em; text-transform: uppercase;
 color: var(--gold-deep);
 opacity: 0.6;
 transition: opacity 0.4s cubic-bezier(0, 0, 0.2, 1),
 color 0.6s cubic-bezier(0, 0, 0.2, 1);
}
/* Hairline gradient rule : the hinge between classical and cosmic */
.brand-rule {
 width: 100%; height: 1px;
 background: linear-gradient(90deg, transparent 0%, var(--gold-deep) 35%, var(--gold-deep) 65%, transparent 100%);
 opacity: 0.12;
 margin: 5px 0 4px;
 transform: scaleX(0.6);
 transform-origin: right center;
 transition: transform 0.7s cubic-bezier(0.23, 1, 0.32, 1),
 opacity 0.6s cubic-bezier(0, 0, 0.2, 1);
}
.brand-cosmos {
 font-family: var(--font-display); font-weight: 400;
 font-size: 10.5px; text-transform: uppercase;
 color: var(--gold-deep);
 letter-spacing: 0.82em;
 /* Compensate trailing letter-spacing so right edge aligns flush with title */
 padding-right: 0.82em;
 box-sizing: border-box;
 width: 100%;
 text-align: right;
 opacity: 0.3;
 transition: opacity 0.5s 0.06s cubic-bezier(0, 0, 0.2, 1),
 letter-spacing 0.7s cubic-bezier(0.23, 1, 0.32, 1),
 text-shadow 0.6s cubic-bezier(0, 0, 0.2, 1);
 text-shadow: 0 0 0 transparent;
}

/* ── Hover orchestration: light arrives <i>in se</i>quence ── */
.brand:hover .brand-title {
 opacity: 0.9;
 color: var(--gold-dim);
}
.brand:hover .brand-rule {
 transform: scaleX(1);
 opacity: 0.25;
}
.brand:hover .brand-cosmos {
 opacity: 0.55;
 letter-spacing: 0.85em;
 text-shadow: 0 0 20px rgba(220,193,90,0.08);
}

/* ── Search ── */
.search-container {
 position: relative; width: var(--search-width); max-width: 50vw;
}
.search-icon {
 position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
 color: var(--text-muted); width: 14px; height: 14px; pointer-events: none;
}
#search-input {
 width: 100%; padding: 8px 44px 8px 36px;
 background: rgba(220,193,90,0.02); border: 1px solid rgba(220,193,90,0.06);
 border-radius: 8px; color: var(--text-primary);
 font-family: var(--font-ui); font-size: 12px; outline: none;
 transition: all 0.4s var(--ease-out);
}
#search-input:focus {
 border-color: rgba(220,193,90,0.2); background: rgba(220,193,90,0.04);
 box-shadow: 0 0 0 3px rgba(220,193,90,0.05), 0 8px 32px rgba(0,0,0,0.3);
}
#search-input:placeholder { color: rgba(145,141,130,0.4); font-style: italic; }
.search-shortcut {
 position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
 font-family: var(--font-ui); font-size: 9px; color: var(--text-muted);
 padding: 2px 6px; border: 1px solid var(--border-subtle); border-radius: 3px;
 pointer-events: none;
}

/* Search Results Dropdown */
#search-results {
 position: absolute; top: calc(100% + 8px); left: 0; right: 0;
 background: rgba(11,11,22,0.96); border: 1px solid rgba(220,193,90,0.08);
 border-radius: 10px; max-height: 400px; overflow-y: auto;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
 display: none; z-index: 200;
}
#search-results.visible {
 display: block;
 animation: dropIn 0.2s var(--ease-out) both;
}
@keyframes dropIn {
 from { opacity: 0; transform: translateY(-6px); }
 to { opacity: 1; transform: none; }
}
.search-result-item {
 display: flex; align-items: flex-start; gap: 12px;
 padding: 12px 16px; cursor: pointer;
 border-bottom: 1px solid rgba(220,193,90,0.03);
 transition: background 0.25s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.search-result-item:last-child { border-bottom: none; }
.search-result-item:hover { background: rgba(220,193,90,0.025); }
.search-result-dot {
 width: 8px; height: 8px; border-radius: 50%;
 flex-shrink: 0; margin-top: 5px;
}
.search-result-info { flex: 1; min-width: 0; }
.search-result-name {
 font-family: var(--font-heading); font-size: 16px; color: var(--text-primary);
 margin-bottom: 2px;
}
.search-result-name mark {
 background: rgba(220,193,90,0.2); color: var(--gold); border-radius: 2px;
 padding: 0 2px;
}
.search-result-category {
 font-family: var(--font-ui); font-size: 9px; letter-spacing: 0.08em;
 text-transform: uppercase;
}
.search-result-snippet {
 font-family: var(--font-body); font-size: 12px; color: var(--text-tertiary);
 margin-top: 4px; line-height: 1.5;
 overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
}
.search-empty {
 padding: 24px; text-align: center;
 font-family: var(--font-ui); font-size: 12px; color: var(--text-muted);
}

/* ── Right Controls ── */
.topbar-controls {
 display: flex; align-items: center; gap: 8px;
}
.control-btn {
 padding: 6px 14px; background: rgba(220,193,90,0.015);
 border: 1px solid rgba(220,193,90,0.06); border-radius: 6px;
 font-family: var(--font-ui); font-size: 9.5px; letter-spacing: 0.06em;
 color: var(--text-tertiary); cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); user-select: none;
}
.control-btn:hover { border-color: rgba(220,193,90,0.15); color: var(--text-secondary); box-shadow: 0 0 20px rgba(220,193,90,0.03); }
.control-btn.active {
 background: var(--gold-surface); border-color: rgba(220,193,90,0.2); color: var(--gold);
}
.progress-badge {
 font-family: var(--font-ui); font-size: 9px;
 padding: 3px 10px; border-radius: 12px;
 background: rgba(220,193,90,0.04); color: var(--gold-dim);
 border: 1px solid rgba(220,193,90,0.08);
 cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
 user-select: none;
}
.progress-badge:hover {
 background: rgba(220,193,90,0.1); border-color: rgba(220,193,90,0.18);
 color: var(--gold);
 box-shadow: 0 0 24px rgba(220,193,90,0.05);
}

/* ═══ MAIN CONTENT AREA ═══ */
#main-content {
 flex: 1; display: flex; overflow: hidden; position: relative;
}

/* ── Graph Container ── */
#graph-container {
 flex: 1; position: relative; overflow: hidden;
 background: var(--bg-primary);
}

/* 3D Container */
#three-container {
 position: absolute; inset: 0; overflow: hidden;
 visibility: hidden;
 /* ── Prevent browser handling of touch gestures (we handle them) ── */
 touch-action: none;
 /* ── GPU layer isolation for independent compositing ── */
 contain: strict;
 will-change: transform;
}
#three-container canvas {
 display: block; width: 100%; height: 100%; cursor: grab;
 touch-action: none;
}
#three-container canvas:active { cursor: grabbing; }

/* Graph Vignette */
#graph-vignette {
 position: absolute; inset: 0; pointer-events: none;
 background: 
 radial-gradient(ellipse 75% 70% at 50% 50%, transparent 35%, rgba(0,0,0,0.35) 100%),
 linear-gradient(180deg, rgba(0,0,0,0.15) 0%, transparent 12%, transparent 88%, rgba(0,0,0,0.2) 100%);
}

/* ── Legend ── */
#legend {
 position: absolute; left: 18px; top: 50%; transform: translateY(-50%);
 display: flex; flex-direction: column; gap: 5px; z-index: 10;
 visibility: hidden;
}
.legend-item {
 display: flex; align-items: center; gap: 8px;
 cursor: pointer; opacity: 0.45;
 padding: 3px 8px; border-radius: 4px;
 /* Spring curve on position, faster ease on opacity : staggered feels organic */
 transition:
 transform 0.5s cubic-bezier(0.23, 1.1, 0.32, 1),
 opacity 0.3s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover, .legend-item.active { opacity: 1; }
.legend-item:hover { transform: translateX(6px); }
.legend-dot {
 width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0;
 /* Dot responds slightly slower : trails behind the nudge */
 transition:
 transform 0.55s cubic-bezier(0.23, 1.1, 0.32, 1),
 box-shadow 0.6s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover .legend-dot {
 transform: scale(1.35);
 box-shadow: 0 0 6px currentColor, 0 0 12px rgba(255,255,255,0.04);
}
.legend-label {
 font-family: var(--font-ui); font-size: 9px;
 letter-spacing: 0.1em; text-transform: uppercase;
 color: var(--text-tertiary);
 white-space: nowrap;
 /* Label color warms up last : the finishing touch */
 transition: color 0.45s cubic-bezier(0, 0, 0.2, 1);
}
.legend-item:hover .legend-label { color: var(--text-secondary); }

/* ── Breadcrumb ── */
#breadcrumb {
 position: absolute; top: 8px; left: 16px;
 display: flex; gap: 4px; align-items: center; z-index: 10;
 font-family: var(--font-ui); font-size: 10px; color: var(--text-muted);
}
#breadcrumb span { cursor: pointer; transition: color var(--duration-fast); }
#breadcrumb span:hover { color: var(--gold); }
#breadcrumb .sep { color: var(--border-strong); cursor: default; }

/* ── Tooltip ── */
#tooltip {
 position: fixed; pointer-events: none; z-index: 500;
 padding: 12px 18px; background: rgba(14,14,28,0.94);
 border: 1px solid rgba(220,193,90,0.08); border-radius: 8px;
 opacity: 0; transition: opacity 100ms;
 box-shadow: 0 12px 40px rgba(0,0,0,0.5), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px);
 max-width: 280px;
}
#tooltip.visible { opacity: 1; }
.tooltip-name {
 font-family: var(--font-heading); font-size: 16px;
 color: var(--text-primary); margin-bottom: 3px;
}
.tooltip-category {
 font-family: var(--font-ui); font-size: 8.5px;
 letter-spacing: 0.08em; text-transform: uppercase;
}
.tooltip-studied {
 font-family: var(--font-ui); font-size: 8px;
 color: var(--gold-dim); margin-top: 4px;
 letter-spacing: 0.06em;
}
.tooltip-summary {
 font-family: var(--font-body); font-size: 11px;
 color: var(--text-tertiary); margin-top: 5px;
 line-height: 1.5;
 overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
}

/* ═══ FLYTHROUGH OVERLAY (Improvement #23) ═══ */
#flythrough-overlay {
 position: absolute; inset: 0; pointer-events: none; z-index: 25;
 display: none; flex-direction: column; justify-content: center; align-items: flex-end;
 padding: var(--space-xl);
 padding-right: calc(var(--space-xl) + var(--safe-right));
 background: none;
}
#flythrough-overlay.active { display: flex; }
.flythrough-text {
 max-width: 380px; width: 380px; opacity: 0;
 transition: opacity 0.8s var(--ease-out), transform 0.8s var(--ease-out);
 transform: translateX(12px);
 background: rgba(6,6,14,0.9);
 border: 1px solid rgba(220,193,90,0.06);
 border-radius: 12px;
 padding: 22px 24px;
 backdrop-filter: blur(20px) saturate(1.2); -webkit-backdrop-filter: blur(20px) saturate(1.2);
 box-shadow: 0 16px 48px rgba(0,0,0,0.5), 0 0 0 0.5px rgba(220,193,90,0.03);
 max-height: 70vh;
 overflow-y: auto;
 pointer-events: auto;
}
.flythrough-text.visible { opacity: 1; transform: none; }
.flythrough-locus-name {
 font-family: var(--font-ui); font-size: 8px; letter-spacing: 0.12em;
 text-transform: uppercase; color: var(--text-muted); margin-bottom: 4px;
}
.flythrough-title {
 font-family: var(--font-display); font-weight: 400;
 font-size: clamp(11px, 1.6vw, 14px); letter-spacing: 0.4em;
 text-transform: uppercase; color: var(--gold);
 margin-bottom: 8px;
}
.flythrough-desc {
 font-family: var(--font-body); font-size: clamp(14px, 1.5vw, 17px);
 color: var(--text-secondary); line-height: 1.85;
}
.flythrough-progress {
 margin-top: 16px; display: flex; gap: 6px; align-items: center;
}
.flythrough-dot {
 width: 6px; height: 6px; border-radius: 50%;
 background: rgba(255,255,255,0.15); transition: all 0.4s var(--ease-out);
}
.flythrough-dot.active { background: var(--gold); box-shadow: 0 0 8px rgba(224,192,80,0.4); transform: scale(1.3); }
.flythrough-dot.past { background: rgba(224,192,80,0.35); }
.flythrough-controls {
 position: absolute; top: 16px; right: 16px;
 display: flex; gap: 8px; pointer-events: auto;
}
.flythrough-btn {
 padding: 6px 14px; background: rgba(10,10,18,0.85);
 border: 1px solid var(--border-subtle); border-radius: 5px;
 font-family: var(--font-ui); font-size: 9px; letter-spacing: 0.06em;
 color: var(--text-tertiary); cursor: pointer;
 transition: all var(--duration-normal) var(--ease-out);
}
.flythrough-btn:hover { border-color: var(--gold-dim); color: var(--gold); }

/* Flythrough path picker popup */
#flythrough-picker {
 position: fixed; z-index: 9500;
 right: 24px; bottom: 72px;
 background: rgba(10,10,18,0.96); border: 1px solid rgba(220,193,90,0.07);
 border-radius: 14px; padding: 26px 30px; width: 340px;
 max-height: calc(var(--vh-full, 100vh) - 130px); overflow-y: auto;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.03);
 display: none;
 backdrop-filter: blur(20px) saturate(1.2); -webkit-backdrop-filter: blur(20px) saturate(1.2);
}
#flythrough-picker.visible { display: block; animation: dropIn 0.25s var(--ease-out) both; }
#flythrough-picker-backdrop {
 position: fixed; inset: 0; z-index: 9499;
 background: transparent; display: none;
}
#flythrough-picker-backdrop.visible { display: block; }
.picker-title {
 font-family: var(--font-display); font-size: 10px; letter-spacing: 0.35em;
 text-transform: uppercase; color: var(--gold-dim); margin-bottom: 4px;
}
.picker-subtitle {
 font-family: var(--font-ui); font-size: 9px; color: var(--text-muted);
 letter-spacing: 0.06em; margin-bottom: 20px;
}
.picker-item {
 display: flex; align-items: center; gap: 12px;
 padding: 10px 14px; border-radius: 8px; cursor: pointer;
 border: 1px solid transparent;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
 margin-bottom: 4px;
}
.picker-item:hover { background: rgba(220,193,90,0.025); border-color: rgba(220,193,90,0.05); }
.picker-item-dot {
 width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
}
.picker-item-info { flex: 1; min-width: 0; }
.picker-item-name {
 font-family: var(--font-heading); font-size: 14px; color: var(--text-primary);
 margin-bottom: 2px;
}
.picker-item-desc {
 font-family: var(--font-ui); font-size: 9.5px; color: var(--text-tertiary);
 margin-top: 1px;
}
.picker-item-count {
 font-family: var(--font-ui); font-size: 9px; color: var(--text-muted);
 letter-spacing: 0.06em;
 margin-top: 4px;
}

/* ── Path Indicator ── */
#path-indicator {
 position: absolute; top: 8px; left: 50%; transform: translateX(-50%);
 padding: 8px 22px; background: rgba(10,10,18,0.96);
 border: 1px solid rgba(220,193,90,0.12); border-radius: 20px;
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.06em;
 color: var(--gold); display: none; z-index: 20;
 box-shadow: 0 8px 32px rgba(0,0,0,0.4), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
 align-items: center; gap: 10px; white-space: nowrap;
}
#path-indicator.visible { display: flex; }
.path-pulse {
 width: 6px; height: 6px; border-radius: 50%;
 background: var(--gold); animation: pulse 1.2s infinite;
}
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.25; } }
.path-close-btn {
 background: none; border: none; color: var(--text-muted);
 cursor: pointer; font-size: 14px; margin-left: 4px;
 transition: color var(--duration-fast);
}
.path-close-btn:hover { color: var(--text-primary); }
.path-nav-btn {
 background: none; border: 1px solid var(--border-subtle);
 border-radius: 4px; color: var(--text-tertiary); cursor: pointer;
 font-size: 11px; padding: 2px 8px; transition: all var(--duration-fast);
}
.path-nav-btn:hover { border-color: var(--gold-dim); color: var(--gold); }

/* ═══ STUDY PANEL ═══ */
#study-panel {
 position: absolute; right: 0; top: 0; bottom: 0;
 width: var(--panel-width); max-width: 100vw;
 background: rgba(6,6,12,0.98);
 border-left: 1px solid rgba(220,193,90,0.05);
 transform: translateX(100%);
 transition: transform 0.6s cubic-bezier(0.32, 0.72, 0, 1);
 overflow-y: auto; z-index: 50;
 scrollbar-width: thin; scrollbar-color: rgba(220,193,90,0.05) transparent;
 /* ── GPU compositing for smooth slide ── */
 will-change: transform;
 /* ── Layout containment - prevent reflows from propagating ── */
 contain: layout style;
 /* ── Prevent overscroll propagation to body ── */
 overscroll-behavior: contain;
 /* ── Momentum scrolling on iOS ── */
 -webkit-overflow-scrolling: touch;
 /* ── Safe area bottom padding for home indicator ── */
 padding-bottom: var(--safe-bottom);
 /* Subtle inner glow at the left edge */
 box-shadow: inset 1px 0 40px rgba(220,193,90,0.01);
}
#study-panel.open { transform: translateX(0); }
#study-panel.open .panel-title { animation: panelFadeIn 0.5s 0.1s var(--ease-out) both; }
#study-panel.open .panel-color-bar { animation: shimmerIn 1s 0.15s var(--ease-out) both; }
#study-panel.open .panel-study-toggle { animation: panelFadeIn 0.4s 0.2s var(--ease-out) both; }
#study-panel.open .panel-tabs { animation: panelFadeIn 0.4s 0.25s var(--ease-out) both; }
#study-panel.open .panel-summary { animation: panelFadeIn 0.45s 0.3s var(--ease-out) both; }
#study-panel.open .tab-pane.active { animation: panelFadeIn 0.5s 0.35s var(--ease-out) both; }

@keyframes panelFadeIn {
 from { opacity: 0; transform: translateY(10px); }
 to { opacity: 1; transform: none; }
}
@keyframes shimmerIn {
 0% { opacity: 0; background-size: 0% 100%; }
 50% { opacity: 1; }
 100% { opacity: 1; background-size: 100% 100%; }
}

.panel-header {
 position: sticky; top: 0; z-index: 5;
 display: flex; align-items: center; justify-content: space-between;
 padding: 16px 28px;
 background: rgba(6,6,12,0.97);
 border-bottom: 1px solid rgba(220,193,90,0.04);
 backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
}
.panel-layer-label {
 font-family: var(--font-ui); font-size: 9px;
 letter-spacing: 0.14em; text-transform: uppercase; color: var(--text-muted);
}
.panel-close-btn {
 width: 30px; height: 30px; border: none;
 background: rgba(220,193,90,0.03); border-radius: 50%;
 color: var(--text-muted); cursor: pointer; font-size: 12px;
 display: flex; align-items: center; justify-content: center;
 transition: all 0.3s;
}
.panel-close-btn:hover { background: rgba(220,193,90,0.08); color: var(--text-primary); }

.panel-inner { padding: 28px 32px 44px; }

.panel-title {
 font-family: var(--font-heading); font-weight: 400;
 font-size: 28px; line-height: 1.25; color: var(--text-primary);
 margin-bottom: 8px;
}
.panel-color-bar {
 width: 100%; height: 2px; border-radius: 1px; margin-bottom: 14px;
 opacity: 0.7;
}
.panel-study-toggle {
 display: inline-flex; align-items: center; gap: 7px;
 padding: 5px 16px; border-radius: 14px;
 font-family: var(--font-ui); font-size: 9px; letter-spacing: 0.08em;
 cursor: pointer; transition: all 0.4s;
 margin-bottom: 22px; border: 1px solid rgba(220,193,90,0.06);
 color: var(--text-tertiary); background: transparent;
}
.panel-study-toggle:hover { border-color: rgba(220,193,90,0.15); color: var(--gold); background: rgba(220,193,90,0.02); }
.panel-study-toggle.studied {
 background: rgba(220,193,90,0.05); border-color: rgba(220,193,90,0.15); color: var(--gold);
}
.panel-study-toggle .check-icon { font-size: 11px; }

/* ── Review Toggle Micro-interactions ── */
.panel-study-toggle {
 position: relative;
 overflow: visible;
}

/* Checkmark morph animation */
.panel-study-toggle .check-icon {
 display: inline-block;
 transition: transform 0.4s var(--ease-spring), opacity 0.2s var(--ease-out);
}
.panel-study-toggle.studying-in .check-icon {
 animation: checkMorphIn 0.5s var(--ease-spring) both;
}
.panel-study-toggle.studying-out .check-icon {
 animation: checkMorphOut 0.35s var(--ease-out) both;
}

@keyframes checkMorphIn {
 0% { transform: scale(0.3) rotate(-90deg); opacity: 0; }
 50% { transform: scale(1.3) rotate(10deg); opacity: 1; }
 100% { transform: scale(1) rotate(0deg); opacity: 1; }
}
@keyframes checkMorphOut {
 0% { transform: scale(1) rotate(0deg); opacity: 1; }
 40% { transform: scale(0.6) rotate(30deg); opacity: 0.5; }
 100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

/* Success ring pulse (marking reviewed) */
.panel-study-toggle.studying-in:before {
 content: '';
 position: absolute; inset: -3px; border-radius: 18px;
 border: 1.5px solid var(--gold);
 animation: ringPulse 0.6s var(--ease-out) both;
 pointer-events: none;
}
@keyframes ringPulse {
 0% { transform: scale(0.95); opacity: 0.8; }
 60% { transform: scale(1.12); opacity: 0.3; }
 100% { transform: scale(1.2); opacity: 0; }
}

/* Glow burst behind button on mark */
.panel-study-toggle.studying-in:after {
 content: '';
 position: absolute; inset: -8px; border-radius: 24px;
 background: radial-gradient(circle, var(--gold-glow) 0%, transparent 70%);
 animation: glowBurst 0.7s var(--ease-out) both;
 pointer-events: none; z-index: -1;
}
@keyframes glowBurst {
 0% { opacity: 0; transform: scale(0.6); }
 30% { opacity: 1; transform: scale(1); }
 100% { opacity: 0; transform: scale(1.3); }
}

/* Confetti particle base */
.studied-confetti {
 position: absolute;
 width: 4px; height: 4px;
 border-radius: 50%;
 pointer-events: none;
 animation: confettiBurst 0.7s var(--ease-out) both;
 z-index: 10;
}
@keyframes confettiBurst {
 0% { opacity: 1; transform: translate(0, 0) scale(1); }
 100% { opacity: 0; transform: var(--confetti-end) scale(0); }
}

/* Panel Tabs */
.panel-tabs {
 display: flex; border-bottom: 1px solid rgba(220,193,90,0.05); margin-bottom: 22px;
}
.panel-tab {
 flex: 1; padding: 11px 0; text-align: center; cursor: pointer;
 font-family: var(--font-ui); font-size: 9.5px;
 letter-spacing: 0.1em; text-transform: uppercase;
 color: var(--text-muted); background: none; border: none;
 border-bottom: 1.5px solid transparent;
 transition: all 0.4s var(--ease-out);
}
.panel-tab:hover { color: var(--text-secondary); }
.panel-tab.active { color: var(--gold); border-bottom-color: var(--gold-dim); }
.tab-pane { display: none; opacity: 0; transform: translateY(4px); }
.tab-pane.active { display: block; animation: panelFadeIn 0.3s var(--ease-out) both; }

/* Overview Tab */
.panel-summary {
 font-family: var(--font-heading); font-size: 17px; font-weight: 400;
 font-style: italic; color: var(--text-secondary);
 line-height: 1.65; margin-bottom: 18px;
 padding-left: 16px; border-left: 1.5px solid rgba(220,193,90,0.25);
}
.panel-desc-wrapper {
 position: relative; overflow: hidden;
 max-height: 5.7em; /* ~3 lines at 1.9 line-height */
 transition: max-height var(--duration-slow) var(--ease-out);
}
.panel-desc-wrapper.expanded {
 max-height: 2000px;
}
.panel-desc-fade {
 position: absolute; bottom: 0; left: 0; right: 0; height: 3em;
 background: linear-gradient(to bottom, transparent, rgba(6,6,12,0.98));
 pointer-events: none;
 transition: opacity var(--duration-normal) var(--ease-out);
}
.panel-desc-wrapper.expanded .panel-desc-fade,
.panel-desc-wrapper.no-overflow .panel-desc-fade {
 opacity: 0;
}
.panel-description {
 font-family: var(--font-body); font-size: 15.5px;
 line-height: 1.95; color: var(--text-secondary); margin-bottom: 0;
}
.panel-read-more {
 display: inline-block; margin: 8px 0 20px;
 background: none; border: none; padding: 0;
 font-family: var(--font-ui); font-size: 10px; letter-spacing: 0.06em;
 text-transform: uppercase; color: var(--gold-dim);
 cursor: pointer; transition: color var(--duration-fast);
}
.panel-read-more:hover { color: var(--gold); }
.panel-read-more.hidden { display: none; }
/* ── Authority-Level Section Labels ── */
.refs-section-label {
 font-family: var(--font-ui); font-size: 8.5px; letter-spacing: 0.1em;
 text-transform: uppercase; margin-bottom: 5px; display: flex;
 align-items: center; gap: 6px;
}
.refs-section-label:after {
 content: ''; flex: 1; height: 1px; opacity: 0.3;
}
.refs-section-label.norma-normans {
 color: var(--cat-prolegomena);
}
.refs-section-label.norma-normans:after {
 background: var(--cat-prolegomena);
}
.refs-section-label.norma-normata {
 color: var(--gold-dim);
}
.refs-section-label.norma-normata:after {
 background: var(--gold-dim);
}

/* ── Scripture References (<i>Norma Normans</i>) ── */
.panel-scripture-refs {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 14px;
}
.scripture-tag {
 display: inline-block; padding: 3px 11px;
 background: rgba(109,168,216,0.04); border: 1px solid rgba(109,168,216,0.1);
 border-radius: 4px; font-family: var(--font-ui); font-size: 9.5px;
 color: var(--cat-prolegomena); letter-spacing: 0.03em;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.scripture-tag:hover { background: rgba(109,168,216,0.08); }

/* ── Confessional Standards (<i>Norma Normata</i>) ── */
.panel-confessional-refs {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 16px;
}
.confessional-tag {
 display: inline-block; padding: 3px 11px;
 background: rgba(220,193,90,0.03); border: 1px solid rgba(220,193,90,0.10);
 border-radius: 4px; font-family: var(--font-ui); font-size: 9px;
 color: var(--gold-dim); letter-spacing: 0.03em; font-style: italic;
 transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.confessional-tag:hover { background: rgba(220,193,90,0.07); }
.panel-keywords {
 display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px;
}
.keyword-tag {
 display: inline-block; padding: 3px 11px;
 background: transparent; border: 1px solid rgba(220,193,90,0.06); border-radius: 4px;
 font-family: var(--font-ui); font-size: 9px; color: var(--text-muted);
 cursor: pointer; transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.keyword-tag:hover { border-color: rgba(220,193,90,0.18); color: var(--gold); background: rgba(220,193,90,0.03); }

/* Connections Tab */
.connections-section { margin-bottom: 22px; }
.connections-section h4 {
 font-family: var(--font-ui); font-size: 9px;
 letter-spacing: 0.14em; text-transform: uppercase;
 color: var(--text-muted); margin-bottom: 10px;
 padding-bottom: 6px; border-bottom: 1px solid rgba(220,193,90,0.04);
}
.connection-item {
 display: flex; align-items: center; gap: 10px;
 padding: 9px 12px; margin-bottom: 2px; border-radius: 6px;
 cursor: pointer; transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.connection-item:hover { background: rgba(220,193,90,0.025); transform: translateX(3px); }
.connection-dot {
 width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0;
 transition: transform var(--duration-fast), box-shadow var(--duration-fast);
}
.connection-item:hover .connection-dot { transform: scale(1.4); }
.connection-name {
 font-family: var(--font-body); font-size: 14px; color: var(--text-tertiary);
 transition: color var(--duration-fast); flex: 1;
}
.connection-item:hover .connection-name { color: var(--text-primary); }
.connection-type {
 font-family: var(--font-ui); font-size: 8px;
 color: var(--text-muted); letter-spacing: 0.05em;
 text-transform: uppercase;
}
.connection-studied {
 width: 14px; height: 14px; display: flex; align-items: center; justify-content: center;
 font-size: 9px; color: var(--gold-dim);
}

/* Study Tab */
.study-card {
 padding: 18px; margin-bottom: 10px;
 background: rgba(220,193,90,0.01);
 border: 1px solid rgba(220,193,90,0.04); border-radius: 8px;
 cursor: pointer; transition: all 0.45s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.study-card:hover {
 border-color: rgba(220,193,90,0.1); background: rgba(220,193,90,0.025);
 transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.25), 0 0 0 0.5px rgba(220,193,90,0.06);
}
.study-card h5 {
 font-family: var(--font-heading); font-size: 16px; font-weight: 400;
 color: var(--text-primary); margin-bottom: 6px;
}
.study-card p {
 font-family: var(--font-body); font-size: 13px;
 line-height: 1.8; color: var(--text-tertiary);
}

/* ═══ BOTTOM BAR ═══ */
#bottombar {
 position: absolute; bottom: 0; left: 0; right: 0;
 padding: 14px 24px 18px; z-index: 20; pointer-events: none;
 background: linear-gradient(0deg, rgba(0,0,0,0.92) 0%, rgba(0,0,0,0.4) 50%, transparent 100%);
 display: flex; align-items: flex-end; justify-content: space-between;
}
#bottombar > * { pointer-events: auto; }
.bottom-controls {
 display: flex; gap: 6px; flex-wrap: wrap;
}
.bottom-btn {
 padding: 6px 16px; background: rgba(220,193,90,0.015);
 border: 1px solid rgba(220,193,90,0.06); border-radius: 5px;
 font-family: var(--font-ui); font-size: 9px; letter-spacing: 0.06em;
 color: var(--text-muted); cursor: pointer;
 transition: all 0.4s var(--ease-out), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); user-select: none;
}
.bottom-btn:hover { border-color: rgba(220,193,90,0.15); color: var(--text-secondary); box-shadow: 0 0 20px rgba(220,193,90,0.03); }
.bottom-btn:active { transform: scale(0.94); transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1); }
.bottom-btn.active {
 background: var(--gold-surface); border-color: rgba(220,193,90,0.2); color: var(--gold);
}
.keyboard-hints {
 font-family: var(--font-ui); font-size: 7.5px; color: rgba(145,141,130,0.25);
}
.keyboard-hints kbd {
 padding: 1px 5px; border: 1px solid rgba(220,193,90,0.06);
 border-radius: 3px; font-family: inherit; font-size: inherit;
}

/* ═══ PATHS POPUP ═══ */
#paths-popup {
 position: absolute; bottom: 56px; left: 24px; width: 360px;
 max-height: calc(100vh - 120px);
 background: rgba(11,11,22,0.96); border: 1px solid rgba(220,193,90,0.08);
 border-radius: 10px; display: none; z-index: 30;
 box-shadow: 0 20px 60px rgba(0,0,0,0.6), 0 0 0 0.5px rgba(220,193,90,0.04);
 backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
 overflow-y: auto;
}
#paths-popup.visible { display: block; animation: dropIn 0.25s var(--ease-out) both; }
.paths-title {
 padding: 16px 20px; font-family: var(--font-ui); font-size: 9px;
 letter-spacing: 0.14em; text-transform: uppercase;
 color: var(--text-muted); border-bottom: 1px solid rgba(220,193,90,0.04);
}
.path-item {
 padding: 13px 20px; cursor: pointer;
 border-bottom: 1px solid rgba(220,193,90,0.03);
 transition: background 0.35s cubic-bezier(0.25, 0.1, 0.25, 1), transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.path-item:last-child { border-bottom: none; }
.path-item:hover { background: rgba(220,193,90,0.025); }
.path-item small {
 display: block; font-family: var(--font-ui); font-size: 8px;
 letter-spacing: 0.1em; text-transform: uppercase; color: var(--gold-dim); margin-bottom: 3px;
}
.path-item .path-name {
 font-family: var(--font-body); font-size: 13.5px; color: var(--text-secondary);
}
.path-item:hover .path-name { color: var(--text-primary); }
.path-item .path-meta {
 font-family: var(--font-ui); font-size: 8.5px;
 color: var(--text-muted); margin-top: 3px;
}
.path-item .path-progress {
 margin-top: 6px; height: 2px; background: var(--border-subtle); border-radius: 1px; overflow: hidden;
}
.path-item .path-progress-fill {
 height: 100%; background: var(--gold-dim); border-radius: 1px; transition: width 0.3s;
}

/* ═══ RELATED TOPICS BADGE ═══ */
.related-badge {
 display: inline-block; font-family: var(--font-ui); font-size: 7.5px;
 letter-spacing: 0.06em; text-transform: uppercase;
 color: var(--text-muted); background: rgba(255,255,255,0.04);
 border: 1px solid var(--border-subtle); border-radius: 3px;
 padding: 1px 6px; margin-left: 6px; vertical-align: middle;
 font-weight: 400;
}
.related-reason {
 font-family: var(--font-ui); font-size: 7.5px; letter-spacing: 0.04em;
 color: var(--text-muted); margin-left: auto; white-space: nowrap; flex-shrink: 0;
}

/* ═══ STUDY PATHS DISCOVERY PROMPT ═══ */

/* ═══ MOBILE RESPONSIVE ═══ */
@media (max-width: 768px) {
 :root {
 --panel-width: 100vw;
 --topbar-height: 48px;
 --search-width: 100%;
 }

 #topbar {
 padding: 0 12px; flex-wrap: nowrap;
 /* ── Safe area padding ── */
 padding-left: calc(12px + var(--safe-left));
 padding-right: calc(12px + var(--safe-right));
 }
 .brand { display: none; }
 .search-container { flex: 1; max-width: none; margin-right: 8px; }
 .search-shortcut { display: none; }
 .topbar-controls .control-btn span.desktop-label { display: none; }

 /* ── Touch-friendly control buttons (min 44px tap target) ── */
 .control-btn {
 min-height: var(--touch-min);
 min-width: var(--touch-min);
 display: flex; align-items: center; justify-content: center;
 }
 .bottom-btn {
 min-height: var(--touch-min);
 padding: 10px 18px;
 }
 .progress-badge {
 min-height: 36px;
 display: flex; align-items: center; justify-content: center;
 }

 /* ── Legend: slide-up drawer on mobile instead of hidden ── */
 #legend {
 position: fixed; bottom: 0; left: 0; right: 0;
 top: auto; transform: translateY(100%);
 flex-direction: row; flex-wrap: wrap;
 justify-content: center; gap: 8px;
 padding: 16px 12px calc(16px + var(--safe-bottom));
 background: rgba(8,8,14,0.96);
 border-top: 1px solid var(--border-subtle);
 z-index: 60;
 transition: transform 0.4s var(--ease-out), visibility 0.4s;
 visibility: hidden;
 display: flex;
 }
 #legend.mobile-open {
 transform: translateY(0);
 visibility: visible;
 }
 .legend-item { padding: 6px 10px; }

 #study-panel {
 width: 100vw; border-left: none;
 /* ── Swipe-to-close handle area ── */
 padding-top: 0;
 }

 .panel-inner { padding: 20px 16px calc(40px + var(--safe-bottom)); }
 .panel-title { font-size: 22px; }

 /* ── Panel swipe handle for mobile ── */
 .panel-header:before {
 content: '';
 position: absolute; top: 6px; left: 50%; transform: translateX(-50%);
 width: 36px; height: 4px; border-radius: 2px;
 background: rgba(255,255,255,0.15);
 }

 #bottombar {
 padding: 10px 12px calc(14px + var(--safe-bottom));
 padding-left: calc(12px + var(--safe-left));
 padding-right: calc(12px + var(--safe-right));
 }
 #paths-popup {
 width: calc(100vw - 24px - var(--safe-left) - var(--safe-right));
 left: calc(12px + var(--safe-left));
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
 #flythrough-picker {
 right: 12px; left: 12px; width: auto;
 bottom: 68px;
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
 /* ── Flythrough info card: bottom on mobile ── */
 #flythrough-overlay {
 justify-content: flex-end; align-items: center;
 padding-bottom: calc(var(--space-xl) + var(--safe-bottom));
 }
 .flythrough-text {
 max-width: calc(100vw - 32px); width: auto;
 max-height: 40vh;
 }
 .keyboard-hints { display: none; }

 .ob-row { gap: 20px; }

 /* ── Tooltip repositioned for touch ── */
 #tooltip {
 bottom: 80px; left: 50% !important; top: auto !important;
 transform: translateX(-50%);
 max-width: calc(100vw - 32px);
 }

 /* ── Search results - ensure scrollable on small screens ── */
 #search-results {
 max-height: calc(var(--vh-full, 100vh) - 120px);
 }
}

@media (max-width: 480px) {
 /* ── iOS zoom prevention: input must be >= 16px ── */
 #search-input { font-size: 16px; padding: 10px 12px 10px 36px; }
 .panel-description { font-size: 15px; }
 .panel-summary { font-size: 15px; }
 .panel-read-more { font-size: 11px; }
}

/* ═══ LARGE DESKTOP ═══ */
@media (min-width: 1600px) {
 :root {
 --panel-width: 600px;
 --search-width: 440px;
 }
}

/* ═══ HIGH DPI SCREENS ═══ */
@media (-webkit-min-device-pixel-ratio: 3), (min-resolution: 3dppx) {
 :-webkit-scrollbar { width: 3px; }
}

/* ═══ DEGRADATION BANNER ═══ */
#degradation-banner {
 position: fixed; bottom: 0; left: 0; right: 0; z-index: 9999;
 padding: 10px 20px; text-align: center;
 font-family: var(--font-ui), Georgia, serif; font-size: 11px;
 letter-spacing: 0.03em; line-height: 1.6;
 color: var(--text-secondary);
 background: rgba(10,10,18,0.97);
 border-top: 1px solid rgba(220,193,90,0.08);
 backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
 transform: translateY(100%);
 transition: transform 0.5s var(--ease-out);
}
#degradation-banner.visible { transform: translateY(0); }
#degradation-banner .banner-icon { color: var(--gold-dim); margin-right: 6px; }
#degradation-banner .banner-dismiss {
 background: none; border: 1px solid var(--border-subtle); border-radius: 4px;
 color: var(--text-tertiary); font-family: var(--font-ui); font-size: 10px;
 padding: 3px 10px; margin-left: 12px; cursor: pointer; letter-spacing: 0.04em;
 transition: all var(--duration-fast);
}
#degradation-banner .banner-dismiss:hover {
 border-color: var(--border-strong); color: var(--text-secondary);
}

/* ═══ FIRST-TIME USER EXPERIENCE (FTUE) ═══ */
/* Apple HIG-inspired coach marks. Fully opaque overlay blocks
 all cosmos interaction. Spotlight is visual-only via
 radial-gradient (no SVG mask holes). */

#ftue-overlay {
 position: fixed; inset: 0; z-index: 9000;
 opacity: 0; pointer-events: none;
 transition: opacity 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
 /* This gradient IS the backdrop + spotlight. Updated by JS. */
 background: radial-gradient(
 ellipse 200px 180px at 50% 50%,
 rgba(0,0,0,0.18) 0%,
 rgba(0,0,0,0.55) 50%,
 rgba(0,0,0,0.78) 100%
 );
}
#ftue-overlay.active {
 opacity: 1; pointer-events: auto;
 /* Block EVERYTHING underneath : no accidental cosmos interaction */
 cursor: default;
}
#ftue-overlay.exiting {
 opacity: 0; pointer-events: none;
 transition: opacity 0.8s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Spotlight ring : purely decorative, floats over the target area */
.ftue-spotlight-ring {
 position: fixed; z-index: 9001;
 border-radius: 50%; pointer-events: none;
 box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.18),
 0 0 24px 2px rgba(224, 192, 80, 0.06),
 inset 0 0 20px 4px rgba(224, 192, 80, 0.03);
 opacity: 0;
 transition:
 top 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 left 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 width 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 height 0.7s cubic-bezier(0.25, 0.1, 0.25, 1),
 opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-spotlight-ring.visible { opacity: 1; }

/* Subtle breathing animation on the ring */
@keyframes ftueRingBreathe {
 0%, 100% { box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.18),
 0 0 24px 2px rgba(224, 192, 80, 0.06),
 inset 0 0 20px 4px rgba(224, 192, 80, 0.03); }
 50% { box-shadow:
 0 0 0 1px rgba(224, 192, 80, 0.30),
 0 0 36px 4px rgba(224, 192, 80, 0.10),
 inset 0 0 24px 6px rgba(224, 192, 80, 0.05); }
}
.ftue-spotlight-ring.visible {
 animation: ftueRingBreathe 3s ease-in-out infinite;
}

/* ── Card ── */
.ftue-card {
 position: fixed; z-index: 9002;
 width: 300px;
 padding: 0;
 background: rgba(10, 10, 20, 0.94);
 border: 1px solid rgba(220, 193, 90, 0.06);
 border-radius: 16px;
 box-shadow:
 0 24px 80px rgba(0, 0, 0, 0.5),
 0 2px 12px rgba(0, 0, 0, 0.3),
 0 0 0 0.5px rgba(220, 193, 90, 0.03);
 backdrop-filter: blur(40px) saturate(1.3);
 -webkit-backdrop-filter: blur(40px) saturate(1.3);
 overflow: hidden;
 opacity: 0;
 transform: translateY(8px) scale(0.98);
 transition:
 opacity 0.5s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible {
 opacity: 1;
 transform: translateY(0) scale(1);
}
/* Transition out state */
.ftue-card.leaving {
 opacity: 0;
 transform: translateY(-6px) scale(0.98);
 transition:
 opacity 0.25s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.25s cubic-bezier(0.25, 0.1, 0.25, 1);
}

/* Top accent bar */
.ftue-card-accent {
 height: 2px; width: 100%;
 background: linear-gradient(90deg,
 transparent 0%,
 rgba(224, 192, 80, 0.0) 15%,
 rgba(224, 192, 80, 0.35) 50%,
 rgba(224, 192, 80, 0.0) 85%,
 transparent 100%
 );
}

.ftue-card-body {
 padding: 22px 24px 8px;
}

/* Icon : clean SVG-based, not emoji */
.ftue-icon-wrap {
 width: 36px; height: 36px;
 border-radius: 10px;
 background: rgba(224, 192, 80, 0.06);
 border: 1px solid rgba(224, 192, 80, 0.10);
 display: flex; align-items: center; justify-content: center;
 margin-bottom: 14px;
 opacity: 0; transform: scale(0.8);
 transition: opacity 0.4s 0.15s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.4s 0.15s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.ftue-card.visible .ftue-icon-wrap {
 opacity: 1; transform: scale(1);
}
.ftue-icon-wrap svg {
 width: 18px; height: 18px;
 stroke: var(--gold); fill: none;
 stroke-width: 1.5; stroke-linecap: round; stroke-linejoin: round;
}

/* Step counter */
.ftue-counter {
 font-family: var(--font-ui); font-size: 10px;
 letter-spacing: 0.12em; text-transform: uppercase;
 color: var(--text-muted);
 margin-bottom: 10px;
 opacity: 0; transform: translateY(4px);
 transition: opacity 0.4s 0.2s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.4s 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-counter {
 opacity: 1; transform: translateY(0);
}
.ftue-counter-current { color: var(--gold-dim); font-weight: 500; }

/* Title */
.ftue-title {
 font-family: var(--font-heading); font-weight: 400;
 font-size: 20px; line-height: 1.25;
 color: var(--text-primary);
 margin-bottom: 8px;
 opacity: 0; transform: translateY(6px);
 transition: opacity 0.45s 0.22s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.45s 0.22s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-title {
 opacity: 1; transform: translateY(0);
}

/* Description */
.ftue-desc {
 font-family: var(--font-body); font-size: 14px;
 color: rgba(187, 183, 173, 0.85); line-height: 1.65;
 margin-bottom: 0;
 opacity: 0; transform: translateY(6px);
 transition: opacity 0.45s 0.28s cubic-bezier(0.25, 0.1, 0.25, 1),
 transform 0.45s 0.28s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-desc {
 opacity: 1; transform: translateY(0);
}

/* Keyboard hint */
.ftue-kbd {
 display: inline-block;
 padding: 1px 5px; margin: 0 1px;
 background: rgba(255, 255, 255, 0.06);
 border: 1px solid rgba(255, 255, 255, 0.10);
 border-radius: 4px;
 font-family: var(--font-ui); font-size: 11px;
 color: var(--text-secondary);
 vertical-align: 1px;
 letter-spacing: 0;
}

/* ── Footer ── */
.ftue-footer {
 display: flex; align-items: center; justify-content: space-between;
 padding: 14px 24px 18px;
 opacity: 0;
 transition: opacity 0.4s 0.32s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-card.visible .ftue-footer { opacity: 1; }

/* Progress bar : minimal, Apple-style */
.ftue-progress {
 flex: 1; height: 2px; max-width: 100px;
 background: rgba(255, 255, 255, 0.06);
 border-radius: 1px; overflow: hidden;
}
.ftue-progress-fill {
 height: 100%;
 background: linear-gradient(90deg, var(--gold-dim), var(--gold));
 border-radius: 1px;
 transition: width 0.6s cubic-bezier(0.25, 0.1, 0.25, 1);
}

.ftue-actions { display: flex; gap: 4px; align-items: center; }

/* Skip : ghostly, minimal */
.ftue-skip {
 padding: 7px 14px; background: none; border: none;
 font-family: var(--font-ui); font-size: 11px;
 letter-spacing: 0.02em; color: var(--text-muted);
 cursor: pointer; border-radius: 8px;
 transition: color 0.2s, background 0.2s;
}
.ftue-skip:hover {
 color: var(--text-secondary);
 background: rgba(255, 255, 255, 0.04);
}

/* Next : solid, confident */
.ftue-next {
 padding: 7px 18px;
 background: rgba(224, 192, 80, 0.10);
 border: 1px solid rgba(224, 192, 80, 0.22);
 border-radius: 8px;
 font-family: var(--font-ui); font-size: 11px;
 letter-spacing: 0.02em; color: var(--gold);
 cursor: pointer; white-space: nowrap;
 transition: all 0.25s cubic-bezier(0.25, 0.1, 0.25, 1);
}
.ftue-next:hover {
 background: rgba(224, 192, 80, 0.18);
 border-color: rgba(224, 192, 80, 0.38);
 box-shadow: 0 0 20px rgba(224, 192, 80, 0.06);
}
.ftue-next:active {
 transform: scale(0.95);
 transition: transform 100ms cubic-bezier(0.2, 0, 0.7, 1);
}

/* ── Mobile ── */
@media (max-width: 768px) {
 .ftue-card {
 width: calc(100vw - 32px) !important;
 left: 16px !important; right: 16px !important;
 max-width: none;
 }
 .ftue-title { font-size: 18px; }
 .ftue-desc { font-size: 13px; }
 .ftue-kbd { display: none; }
}

/* ── Accessibility ── */
.sr-only {
 position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
 overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
}

#skip-link {
 position: fixed; top: -100%; left: 50%; transform: translateX(-50%);
 z-index: 10000; padding: 12px 24px;
 background: var(--gold); color: #000;
 font-family: var(--font-ui); font-size: 13px; font-weight: 600;
 letter-spacing: 0.04em; border-radius: 0 0 8px 8px;
 text-decoration: none; transition: top 0.15s;
}
#skip-link:focus { top: 0; }

/* Focus-visible ring for all interactive elements */
*:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
}
/* Canvas and containers shouldn't show focus ring */
canvas:focus-visible, #three-container:focus-visible {
 outline: 2px solid var(--gold-dim);
 outline-offset: -2px;
}
/* Suppress outline for mouse clicks where focus-visible is not triggered */
*:focus:not(:focus-visible) { outline: none; }

/* Search result keyboard-active state */
.search-result-item[aria-selected="true"] {
 background: var(--bg-hover);
 outline: 2px solid var(--gold-dim);
 outline-offset: -2px;
}

/* Legend item keyboard focus */
.legend-item:focus-visible {
 opacity: 1;
 outline: 2px solid var(--gold);
 outline-offset: 1px;
}

/* Panel tab keyboard focus */
.panel-tab:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: -2px;
}

/* Connection items keyboard focus */
.connection-item:focus-visible, .study-card:focus-visible, .path-item:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: -1px;
}

/* ── Enhanced Focus Rings (HIG / Linear-compliant) ── */
/* Buttons in top-bar and bottom-bar */
.control-btn:focus-visible,
.bottom-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 box-shadow: 0 0 0 4px rgba(224,192,80,0.15);
}
/* Panel close button */
.panel-close-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 background: rgba(255,255,255,0.08);
}
/* Study toggle pill */
.panel-study-toggle:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 box-shadow: 0 0 0 4px rgba(224,192,80,0.12);
}
/* Keyword tags */
.keyword-tag:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 1px;
 border-color: var(--gold-dim);
 color: var(--gold);
}
/* Enter cosmos button */
.enter-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 4px;
 box-shadow: 0 0 0 6px rgba(224,192,80,0.12);
}
/* Path indicator nav/close buttons */
.path-nav-btn:focus-visible,
.path-close-btn:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 1px;
}
/* Degradation banner dismiss */
.banner-dismiss:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
}
/* Breadcrumb links */
#breadcrumb span:focus-visible {
 outline: 2px solid var(--gold);
 outline-offset: 2px;
 color: var(--gold);
}
